<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Additional Configuration Steps for Using Classic Capture</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="description" content="This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in classic capture mode." />
<meta name="dcterms.created" content="2018-07-26T05:17:29Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Using Oracle GoldenGate for Oracle Database" />
<meta name="dcterms.identifier" content="E88785-05" />
<meta name="dcterms.isVersionOf" content="GGODB" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2010, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="http://docs.oracle.com/goldengate/c1230/gg-winux/index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="additional-oracle-goldengate-configuration-considerations.htm" title="Previous" type="text/html" />
<link rel="Next" href="additional-configuration-steps-using-nonintegrated-replicat.htm" title="Next" type="text/html" />
<link rel="alternate" href="GGODB.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-139116DA-90DB-40C9-B0DA-48FC7C465BEC"></a> <span id="PAGE" style="display:none;">13/28</span> <!-- End Header -->
<script  >
//<![CDATA[
window.name='additional-configuration-steps-using-classic-capture'
//]]>
</script> <script  >
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" ><head><title>');
   
    msg.document.write('Footnote&amp;nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('');
    msg.document.write('<style> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
</script><noscript>
<p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
</noscript>
<h1 id="GGODB-GUID-139116DA-90DB-40C9-B0DA-48FC7C465BEC" class="sect1"><span class="enumeration_chapter">10</span> Additional Configuration Steps for Using Classic Capture</h1>
<div>
<div><span>This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in <span class="italic">classic capture</span> mode.</span></div>
<p>These requirements supplement the basic configuration requirements documented in <a class="olink GIORA-GUID-6AF9D6B6-60F6-4542-A68F-EA251F098B1F" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GIORA-GUID-6AF9D6B6-60F6-4542-A68F-EA251F098B1F">Configuring Capture in Classic Mode</a>.</p>
<p><span class="bold">Topics:</span></p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-28F99A48-A930-4991-BA48-436FB35AFF57">Configuring Oracle TDE Data in Classic Capture Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-8DEA74B2-C78A-4046-93EA-4DE36CACCBE1">Using Classic Capture in an Oracle RAC Environment</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-4792E855-20B9-44BE-8344-581BBE68F2BE">Mining ASM-stored Logs in Classic Capture Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-A46BCF1C-D08D-4095-8C67-88A32F7CBBFE">Ensuring Data Availability for Classic Capture</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-8C86A061-A85B-4173-B281-1552EE474624">Configuring Classic Capture in Archived Log Only Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-F2B9181C-791B-4950-8A66-D9B8AE39EFC8">Configuring Classic Capture in Oracle Active Data Guard Only Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-81D9AF8E-BCC0-4F2D-9058-2C3D89C8EDBD">Avoiding Log-read Bottlenecks in Classic Capture</a><br /></li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-28F99A48-A930-4991-BA48-436FB35AFF57"></a>
<h2 id="GGODB-GUID-28F99A48-A930-4991-BA48-436FB35AFF57" class="sect2"><span class="enumeration_section">10.1</span> Configuring Oracle TDE Data in Classic Capture Mode</h2>
<div>
<div class="section">
<p>The following special configuration steps are required to support TDE when Extract is in classic capture mode. This section <span class="italic">does not</span> apply to Extract in integrated capture mode.</p>
<div class="infobox-note" id="GUID-28F99A48-A930-4991-BA48-436FB35AFF57__GUID-6E023834-945E-4A7F-A049-E4C0265F1C4E">
<p class="notep1">Note:</p>
<p>When in integrated mode, Extract leverages the database logging server and supports TDE column encryption and TDE tablespace encryption without special setup requirements or parameter settings. For more information about integrated capture, see <a class="olink GIORA-GUID-6D3A40A4-BA62-4704-8C4D-07EBDBDB1B22" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GIORA-GUID-6D3A40A4-BA62-4704-8C4D-07EBDBDB1B22">Choosing Capture and Apply Modes</a>.</p>
</div>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-A96CD763-589A-49AB-A8DE-5475551905EB">Overview of TDE Support in Classic Capture Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-DE3C3BCA-CFEE-477A-A43E-1D837750B58B">Requirements for Capturing TDE in Classic Capture Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-7DC596E3-51D5-4B92-8BE8-DE238004B4A8">Required Database Patches for TDE Support</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-BDCA62A2-A622-402C-9A62-5C2164AEA7B5">Configuring Classic Capture for TDE Support</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-3EFA1752-759A-4670-8D64-40391E09D82C">Recommendations for Maintaining Data Security after Decryption</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-C09D1863-4CEA-4666-A542-A96A85A7A114">Performing DDL while TDE Capture is Active</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-8E71E092-E334-498A-8B4D-B2DAB254072A">Rekeying after a Database Upgrade</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-46F9C5BD-5FF5-4A2E-89AA-0FD1CD10BD9D">Updating the Oracle Shared Secret in the Parameter File</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-139116DA-90DB-40C9-B0DA-48FC7C465BEC" title="This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in classic capture mode.">Additional Configuration Steps for Using Classic Capture</a></p>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-A96CD763-589A-49AB-A8DE-5475551905EB"></a>
<h3 id="GGODB-GUID-A96CD763-589A-49AB-A8DE-5475551905EB" class="sect3"><span class="enumeration_section">10.1.1</span> Overview of TDE Support in Classic Capture Mode</h3>
<div>
<p>TDE support when Extract is in classic capture mode requires the exchange of two kinds of keys:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <span class="italic">encrypted key</span> can be a table key (column-level encryption), an encrypted redo log key (tablespace-level encryption), or both. This key is shared between the Oracle Database and Extract.</p>
</li>
<li>
<p>The <span class="italic">decryption key</span> is named <code class="codeph">ORACLEGG</code> and its password is known as the <span class="italic">shared secret</span>. This key is stored securely in the Oracle and Oracle GoldenGate domains. Only a party that has possession of the shared secret can decrypt the table and redo log keys.</p>
</li>
</ul>
<p>The encrypted keys are delivered to the Extract process by means of built-in PL/SQL code. Extract uses the shared secret to decrypt the data. Extract never handles the wallet master key itself, nor is it aware of the master key password. Those remain within the Oracle Database security framework.</p>
<p>Extract never writes the decrypted data to any file other than a trail file, not even a discard file (specified with the <code class="codeph">DISCARDFILE</code> parameter). The word "<code class="codeph">ENCRYPTED</code>" will be written to any discard file that is in use.</p>
<p>The impact of this feature on Oracle GoldenGate performance should mirror that of the impact of decryption on database performance. Other than a slight increase in Extract startup time, there should be a minimal affect on performance from replicating TDE data.</p>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-28F99A48-A930-4991-BA48-436FB35AFF57">Configuring Oracle TDE Data in Classic Capture Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-DE3C3BCA-CFEE-477A-A43E-1D837750B58B"></a>
<h3 id="GGODB-GUID-DE3C3BCA-CFEE-477A-A43E-1D837750B58B" class="sect3"><span class="enumeration_section">10.1.2</span> Requirements for Capturing TDE in Classic Capture Mode</h3>
<div>
<div class="section">
<p>The following are requirements for Extract to support TDE capture:</p>
<ul style="list-style-type: disc;">
<li>
<p>To maintain high security standards, the Oracle GoldenGate Extract process should run as part of the <code class="codeph">oracle</code> user (the user that runs the Oracle Database). That way, the keys are protected in memory by the same privileges as the <code class="codeph">oracle</code> user.</p>
</li>
<li>
<p>The Extract process must run on the same machine as the database installation.</p>
</li>
<li>
<p>Even if using TDE with a Hardware Security Module, you must use a software wallet. Instructions are provided in <a class="olink GIORA-GUID-4E96749A-02CF-455C-AF3C-DF6E7F7A5994" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GIORA-GUID-4E96749A-02CF-455C-AF3C-DF6E7F7A5994">Oracle Security Officer Tasks</a> in the configuration steps for moving from an HSM-only to an HSM-plus-wallet configuration and configuring the <code class="codeph">sqlnet.ora</code> file correctly.</p>
</li>
<li>
<p>Whenever the source database is upgraded, you must rekey the master key.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-28F99A48-A930-4991-BA48-436FB35AFF57">Configuring Oracle TDE Data in Classic Capture Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-7DC596E3-51D5-4B92-8BE8-DE238004B4A8"></a>
<h3 id="GGODB-GUID-7DC596E3-51D5-4B92-8BE8-DE238004B4A8" class="sect3"><span class="enumeration_section">10.1.3</span> Required Database Patches for TDE Support</h3>
<div>
<div class="section">
<p>To support TDE on Oracle 11.2.0.2, refer to article 1557031.1 on the My Oracle Support website (<a href="https://support.oracle.com" target="_blank"><code class="codeph">https://support.oracle.com</code></a>).</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-28F99A48-A930-4991-BA48-436FB35AFF57">Configuring Oracle TDE Data in Classic Capture Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-BDCA62A2-A622-402C-9A62-5C2164AEA7B5"></a>
<h3 id="GGODB-GUID-BDCA62A2-A622-402C-9A62-5C2164AEA7B5" class="sect3"><span class="enumeration_section">10.1.4</span> Configuring Classic Capture for TDE Support</h3>
<div>
<div class="section">
<p>The following outlines the steps that the Oracle Security Officer and the Oracle GoldenGate Administrator take to establish communication between the Oracle server and the Extract process.</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-525FE278-87A4-4152-9797-3BDAF002A25D">Agree on a Shared Secret that Meets Oracle Standards</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-B658A59C-69BA-483A-975C-30F8335227B6">Oracle DBA Tasks</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-BA824F82-D677-4A18-9401-7BFCC8B10576">Oracle Security Officer Tasks</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-5A8D1FD3-D32C-4774-B8E1-D6DF9600754E">Oracle GoldenGate Administrator Tasks</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-28F99A48-A930-4991-BA48-436FB35AFF57">Configuring Oracle TDE Data in Classic Capture Mode</a></p>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-525FE278-87A4-4152-9797-3BDAF002A25D"></a>
<h4 id="GGODB-GUID-525FE278-87A4-4152-9797-3BDAF002A25D" class="sect4"><span class="enumeration_section">10.1.4.1</span> Agree on a Shared Secret that Meets Oracle Standards</h4>
<div>
<div class="section">
<p>Agree on a <span class="italic">shared secret</span> password that meets or exceeds Oracle password standards. This password must not be known by anyone else. For guidelines on creating secure passwords, see <a class="olink DBSEG-GUID-8C779885-01F2-48E0-9612-E33508885B19" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=DBSEG-GUID-8C779885-01F2-48E0-9612-E33508885B19"><span class="italic"><span><cite>Oracle Database Security Guide</cite></span></span></a>.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-BDCA62A2-A622-402C-9A62-5C2164AEA7B5">Configuring Classic Capture for TDE Support</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-B658A59C-69BA-483A-975C-30F8335227B6"></a>
<h4 id="GGODB-GUID-B658A59C-69BA-483A-975C-30F8335227B6" class="sect4"><span class="enumeration_section">10.1.4.2</span> Oracle DBA Tasks</h4>
<div>
<ol>
<li class="stepexpand"><span>Log in to SQL*Plus as a user with the <code class="codeph">SYSDBA</code> system privilege. For example:</span>
<div>
<pre dir="ltr">
sqlplus sys/as sysdba
Connected.
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">prvtclkm.plb</code> file that is installed in the Oracle <code class="codeph">admin</code> directory. The <code class="codeph">prvtclkm.plb</code> file creates the <code class="codeph">DBMS_INTERNAL_CLKM</code> PL/SQL package, which enables Oracle GoldenGate to extract encrypted data from an Oracle Database.</span>
<div>
<pre dir="ltr">
@?/app/oracle/product/orcl111/rdbms/admin/prvtclkm.plb
</pre></div>
</li>
<li class="stepexpand"><span>Grant <code class="codeph">EXEC</code> privilege on <code class="codeph">DBMS_INTERNAL_CLKM</code> PL/SQL package to the Extract database user.</span>
<div>
<pre dir="ltr">
GRANT EXECUTE ON DBMS_INTERNAL_CLKM TO <span class="italic">psmith</span>;
</pre></div>
</li>
<li class="stepexpand"><span>Exit SQL*Plus.</span></li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-BDCA62A2-A622-402C-9A62-5C2164AEA7B5">Configuring Classic Capture for TDE Support</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-BA824F82-D677-4A18-9401-7BFCC8B10576"></a>
<h4 id="GGODB-GUID-BA824F82-D677-4A18-9401-7BFCC8B10576" class="sect4"><span class="enumeration_section">10.1.4.3</span> Oracle Security Officer Tasks</h4>
<div>
<div class="section">
<ol>
<li>
<p>Oracle GoldenGate requires the use of a software wallet even with HSM. If you are currently using HSM-only mode, move to HSM-plus-wallet mode by taking the following steps:</p>
<ol>
<li>
<p>Change the <code class="codeph">sqlnet.ora</code> file configuration as shown in the following example, where the wallet directory can be any location on disk that is accessible (rwx) by the owner of the Oracle Database. This example shows a best-practice location, where <code class="codeph">my_db</code> is the <code class="codeph">$ORACLE_SID</code>.</p>
<pre dir="ltr">
ENCRYPTION_WALLET_LOCATION=
 (SOURCE=(METHOD=HSM)(METHOD_DATA=
   (DIRECTORY=/etc/oracle/wallets/my_db)))
</pre></li>
<li>
<p>Log in to <code class="codeph">orapki</code> (or Wallet Manager) as the owner of the Oracle Database, and create an auto-login wallet in the location that you specified in the <code class="codeph">sqlnet.ora</code> file. When prompted for the wallet password, specify the <span class="bold">same password as the HSM password (or HSM Connect String)</span>. These two passwords must be identical.</p>
<pre dir="ltr">
cd /etc/oracle/wallets/my_db
orapki wallet create -wallet . -auto_login[_local] 
</pre>
<div class="infobox-note" id="GUID-BA824F82-D677-4A18-9401-7BFCC8B10576__GUID-727251CA-FA3F-48AA-B531-08EBE49DA40E">
<p class="notep1">Note:</p>
<p>The Oracle Database owner must have full operating system privileges on the wallet.</p>
</div>
</li>
<li>
<p>Add the following entry to the empty wallet to enable an 'auto-open' HSM:</p>
<pre dir="ltr">
mkstore -wrl . -createEntry ORACLE.TDE.HSM.AUTOLOGIN <span class="italic">non-empty-string</span> 
</pre></li>
</ol>
</li>
<li>
<p>Create an entry named <code class="codeph">ORACLEGG</code> in the wallet. <span class="bold"><code class="codeph">ORACLEGG</code></span> <span class="bold">must be the name of this key.</span> The password for this key must be the agreed-upon shared secret, but do not enter this password on the command line. Instead, wait to be prompted.</p>
<pre dir="ltr">
mkstore -wrl ./ -createEntry ORACLE.SECURITY.CL.ENCRYPTION.ORACLEGG
Oracle Secret Store Tool : Version 11.2.0.3.0 - Production
Copyright (c) 2004, 2011, Oracle and/or its affiliates. All rights reserved.
Your secret/Password is missing in the command line
Enter your secret/Password: <span class="italic">sharedsecret</span>
Re-enter your secret/Password: <span class="italic">sharedsecret</span>
Enter wallet password: <span class="italic">hsm/wallet_password</span>
</pre></li>
<li>
<p>Verify the <code class="codeph">ORACLEGG</code> entry.</p>
<pre dir="ltr">
mkstore -wrl . -list
Oracle Secret Store Tool : Version 11.2.0.3.0 - Production
Copyright (c) 2004, 2011, Oracle and/or its affiliates. All rights reserved.
Enter wallet password: <span class="italic">hsm/wallet_password</span>
Oracle Secret Store entries:
ORACLE.SECURITY.CL.ENCRYPTION.ORACLEGG
</pre></li>
<li>
<p>Log in to SQL*Plus as a user with the <code class="codeph">SYSDBA</code> system privilege.</p>
</li>
<li>
<p>Close and then re-open the wallet.</p>
<pre dir="ltr">
SQL&gt; alter system set encryption wallet close identified by "<span class="italic">hsm/wallet_password</span>";
System altered.
SQL&gt; alter system set encryption wallet open identified by "<span class="italic">hsm/wallet_password</span>";
System altered.
</pre>
<p>This inserts the password into the auto-open wallet, so that no password is required to access encrypted data with the TDE master encryption key stored in HSM.</p>
</li>
<li>
<p>Switch log files.</p>
<pre dir="ltr">
alter system switch logfile;
System altered.
</pre></li>
<li>
<p>If this is an Oracle RAC environment and you are using copies of the wallet on each node, make the copies now and then reopen each wallet.</p>
</li>
</ol>
<div class="infobox-note" id="GUID-BA824F82-D677-4A18-9401-7BFCC8B10576__GUID-881FACB1-4AE1-4F1F-8910-28EFF6EB93FE">
<p class="notep1">Note:</p>
<p>Oracle recommends using one wallet in a shared location, with synchronized access among all Oracle RAC nodes.</p>
</div>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-BDCA62A2-A622-402C-9A62-5C2164AEA7B5">Configuring Classic Capture for TDE Support</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-5A8D1FD3-D32C-4774-B8E1-D6DF9600754E"></a>
<h4 id="GGODB-GUID-5A8D1FD3-D32C-4774-B8E1-D6DF9600754E" class="sect4"><span class="enumeration_section">10.1.4.4</span> Oracle GoldenGate Administrator Tasks</h4>
<div>
<ol>
<li class="stepexpand"><span>Run GGSCI.</span></li>
<li class="stepexpand"><span>Issue the <code class="codeph">ENCRYPT PASSWORD</code> command to encrypt the shared secret so that it is obfuscated within the Extract parameter file. <span class="italic">This is a security requirement</span>.</span>
<div>
<pre dir="ltr">
ENCRYPT PASSWORD <span class="italic">sharedsecret</span> {AES128 | AES192 | AES256} ENCRYPTKEY <span class="italic">keyname</span>
</pre>
<p><span class="bold">Where:</span></p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">sharedsecret</code></span> is the clear-text shared secret. This value is case-sensitive.</p>
</li>
<li>
<p><code class="codeph">{AES128 | AES192 | AES256}</code> specifies Advanced Encryption Standard (AES) encryption. Specify one of the values, which represents the desired key length.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">keyname</code></span> is the logical name of the encryption key in the <code class="codeph">ENCKEYS</code> lookup file. Oracle GoldenGate uses this key to look up the actual key in the <code class="codeph">ENCKEYS</code> file. To create a key and <code class="codeph">ENCKEYS</code> file, see <a class="olink GWUAD-GUID-C8E42442-ACE7-4812-A32D-ACB1F047185B" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GWUAD-GUID-C8E42442-ACE7-4812-A32D-ACB1F047185B"><span id="GUID-5A8D1FD3-D32C-4774-B8E1-D6DF9600754E__GWUAD"><cite>Administering Oracle GoldenGate</cite></span></a>.</p>
<p>Example:</p>
<pre dir="ltr">
ENCRYPT PASSWORD sharedsecret AES256 ENCRYPTKEY <span class="italic">mykey1</span>
</pre></li>
</ul>
</div>
</li>
<li class="stepexpand"><span>In the Extract parameter file, use the <code class="codeph">DBOPTIONS</code> parameter with the <code class="codeph">DECRYPTPASSWORD</code> option. As input, supply the encrypted shared secret and the decryption key.</span>
<div>
<pre dir="ltr">
DBOPTIONS DECRYPTPASSWORD <span class="italic">sharedsecret</span> {AES128 | AES192 | AES256} ENCRYPTKEY <span class="italic">keyname</span>
</pre>
<p><span class="bold">Where:</span></p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">sharedsecret</code></span> is the encrypted shared secret.</p>
</li>
<li>
<p><code class="codeph">{AES128 | AES192 | AES256}</code> must be same value that was used for <code class="codeph">ENCRYPT PASSWORD</code>.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">keyname</code></span> is the logical name of the encryption key in the <code class="codeph">ENCKEYS</code> lookup file.</p>
<p>Example:</p>
<pre dir="ltr">
DBOPTIONS DECRYPTPASSWORD AACAAAAAAAAAAAIALCKDZIRHOJBHOJUH AES256 ENCRYPTKEY mykey1
</pre></li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Log in to SQL*Plus as a user with the <code class="codeph">SYSDBA</code> system privilege.</span></li>
<li class="stepexpand"><span>Close and then re-open the wallet.</span>
<div>
<pre dir="ltr">
SQL&gt; alter system set encryption wallet close identified by "<span class="italic">hsm/wallet_password</span>";
System altered.
SQL&gt; alter system set encryption wallet open identified by "<span class="italic">hsm/wallet_password</span>";
System altered.
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-BDCA62A2-A622-402C-9A62-5C2164AEA7B5">Configuring Classic Capture for TDE Support</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-3EFA1752-759A-4670-8D64-40391E09D82C"></a>
<h3 id="GGODB-GUID-3EFA1752-759A-4670-8D64-40391E09D82C" class="sect3"><span class="enumeration_section">10.1.5</span> Recommendations for Maintaining Data Security after Decryption</h3>
<div>
<div class="section">
<p>Extract decrypts the TDE data and writes it to the trail as clear text. To maintain data security throughout the path to the target database, it is recommended that you also deploy Oracle GoldenGate security features to:</p>
<ul style="list-style-type: disc;">
<li>
<p>encrypt the data in the trails</p>
</li>
<li>
<p>encrypt the data in transit across TCP/IP</p>
</li>
</ul>
<p>For more information, see <a class="olink GWUAD354" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GWUAD354"><span class="italic"><span id="GUID-3EFA1752-759A-4670-8D64-40391E09D82C__GWUAD"><cite>Administering Oracle GoldenGate</cite></span></span></a>.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-28F99A48-A930-4991-BA48-436FB35AFF57">Configuring Oracle TDE Data in Classic Capture Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-C09D1863-4CEA-4666-A542-A96A85A7A114"></a>
<h3 id="GGODB-GUID-C09D1863-4CEA-4666-A542-A96A85A7A114" class="sect3"><span class="enumeration_section">10.1.6</span> Performing DDL while TDE Capture is Active</h3>
<div>
<div class="section">
<p>If DDL will ever be performed on a table that has column-level encryption, or if table keys will ever be re-keyed, you must either quiesce the table while the DDL is performed or enable Oracle GoldenGate DDL support. It is more practical to have the DDL environment active so that it is ready, because a re-key usually is a response to a security violation and must be performed immediately. To install the Oracle GoldenGate DDL environment, see <a href="installing-trigger-based-ddl-capture-1.htm#GUID-70B1B422-2369-40BA-B845-7AE2F7D08A3E" title="This appendix contains instructions for installing the objects that support the trigger-based method of Oracle GoldenGate DDL support.">Installing Trigger-Based DDL Capture</a>. To configure Oracle GoldenGate DDL support, see <a href="configuring-ddl-support.htm#GUID-A2997164-CBDF-4E9B-B2B0-2CE6889BC2DF" title="This chapter contains information to help you understand and configure DDL support in Oracle GoldenGate.">Configuring DDL Support</a>. For tablespace-level encryption, the Oracle GoldenGate DDL support is not required.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-28F99A48-A930-4991-BA48-436FB35AFF57">Configuring Oracle TDE Data in Classic Capture Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-8E71E092-E334-498A-8B4D-B2DAB254072A"></a>
<h3 id="GGODB-GUID-8E71E092-E334-498A-8B4D-B2DAB254072A" class="sect3"><span class="enumeration_section">10.1.7</span> Rekeying after a Database Upgrade</h3>
<div>
<div class="section">
<p>Whenever the source database is upgraded and Oracle GoldenGate is capturing TDE data, you must rekey the master key, and then restart the database and Extract. The commands to rekey the master key are:</p>
<pre dir="ltr">
alter system set encryption key identified by "mykey";
</pre></div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-28F99A48-A930-4991-BA48-436FB35AFF57">Configuring Oracle TDE Data in Classic Capture Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-46F9C5BD-5FF5-4A2E-89AA-0FD1CD10BD9D"></a>
<h3 id="GGODB-GUID-46F9C5BD-5FF5-4A2E-89AA-0FD1CD10BD9D" class="sect3"><span class="enumeration_section">10.1.8</span> Updating the Oracle Shared Secret in the Parameter File</h3>
<div>
<div class="section">
<p>Use this procedure to update and encrypt the TDE shared secret within the Extract parameter file.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Run GGSCI.</span></li>
<li class="stepexpand"><span>Stop the Extract process.</span>
<div>
<pre dir="ltr">
STOP EXTRACT <span class="italic">group</span>
</pre></div>
</li>
<li class="stepexpand"><span>Modify the <code class="codeph">ORACLEGG</code> entry in the Oracle wallet. <code class="codeph">ORACLEGG</code> must remain the name of the key. For instructions, see <a class="olink ASOAG" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=ASOAG"><span class="italic"><span><cite>Oracle Database Advanced Security Guide</cite></span></span></a>.</span></li>
<li class="stepexpand"><span>Issue the <code class="codeph">ENCRYPT PASSWORD</code> command to encrypt the new shared secret.</span>
<div>
<pre dir="ltr">
ENCRYPT PASSWORD <span class="italic">sharedsecret</span> {AES128 | AES192 | AES256} ENCRYPTKEY <span class="italic">keyname</span>
</pre>
<p><span class="bold">Where:</span></p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">sharedsecret</code></span> is the clear-text shared secret. This value is case-sensitive.</p>
</li>
<li>
<p><code class="codeph">{AES128 | AES192 | AES256}</code> specifies Advanced Encryption Standard (AES) encryption. Specify one of the values, which represents the desired key length.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">keyname</code></span> is the logical name of the encryption key in the <code class="codeph">ENCKEYS</code> lookup file.</p>
<p>Example:</p>
<pre dir="ltr">
ENCRYPT PASSWORD sharedsecret AES256 ENCRYPTKEY <span class="italic">mykey1</span>
</pre></li>
</ul>
</div>
</li>
<li class="stepexpand"><span>In the Extract parameter file, use the <code class="codeph">DBOPTIONS</code> parameter with the <code class="codeph">DECRYPTPASSWORD</code> option. As input, supply the encrypted shared secret and the Oracle GoldenGate-generated or user-defined decryption key.</span>
<div>
<pre dir="ltr">
DBOPTIONS DECRYPTPASSWORD <span class="italic">sharedsecret</span> {AES128 | AES192 | AES256} ENCRYPTKEY <span class="italic">keyname</span>
</pre>
<p><span class="bold">Where:</span></p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">sharedsecret</code></span> is the encrypted shared secret.</p>
</li>
<li>
<p><code class="codeph">{AES128 | AES192 | AES256}</code> must be same value that was used for <code class="codeph">ENCRYPT PASSWORD</code>.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">keyname</code></span> is the logical name of the encryption key in the <code class="codeph">ENCKEYS</code> lookup file.</p>
<p>Example:</p>
<pre dir="ltr">
DBOPTIONS DECRYPTPASSWORD AACAAAAAAAAAAAIALCKDZIRHOJBHOJUH AES256 ENCRYPTKEY mykey1
</pre></li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Log in to SQL*Plus as a user with the <code class="codeph">SYSDBA</code> system privilege.</span></li>
<li class="stepexpand"><span>Close and then re-open the wallet.</span>
<div>
<pre dir="ltr">
SQL&gt; alter system set encryption wallet close identified by "<span class="italic">hsm/wallet_password</span>";
System altered.
SQL&gt; alter system set encryption wallet open identified by "<span class="italic">hsm/wallet_password</span>";
System altered.
</pre></div>
</li>
<li class="stepexpand"><span>Start Extract.</span>
<div>
<pre dir="ltr">
START EXTRACT <span class="italic">group</span>
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-28F99A48-A930-4991-BA48-436FB35AFF57">Configuring Oracle TDE Data in Classic Capture Mode</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-8DEA74B2-C78A-4046-93EA-4DE36CACCBE1"></a>
<h2 id="GGODB-GUID-8DEA74B2-C78A-4046-93EA-4DE36CACCBE1" class="sect2"><span class="enumeration_section">10.2</span> Using Classic Capture in an Oracle RAC Environment</h2>
<div>
<div class="section">
<p>The following general guidelines apply to Oracle RAC when Extract is operating in classic capture mode.</p>
<ul style="list-style-type: disc;">
<li>
<p>During operations, if the primary database instance against which Oracle GoldenGate is running stops or fails for any reason, Extract abends. To resume processing, you can restart the instance or mount the Oracle GoldenGate binaries to another node where the database is running and then restart the Oracle GoldenGate processes. Stop the Manager process on the original node before starting Oracle GoldenGate processes from another node.</p>
</li>
<li>
<p>Whenever the number of redo threads changes, the Extract group must be dropped and re-created. For the recommended procedure, see <a class="olink GWUAD-GUID-84E413AC-A785-46FA-BB64-F53A3EFB3885" target="_blank" href="../GWUAD/performing-administrative-operations.htm#GWUAD-GUID-84E413AC-A785-46FA-BB64-F53A3EFB3885"><span id="GUID-8DEA74B2-C78A-4046-93EA-4DE36CACCBE1__GWUAD"><cite>Administering Oracle GoldenGate</cite></span></a>.</p>
</li>
<li>
<p>Extract ensures that transactions are written to the trail file in commit order, regardless of the RAC instance where the transaction originated. When Extract is capturing in archived-log-only mode, where one or more RAC instances may be idle, you may need to perform archive log switching on the idle nodes to ensure that operations from the active instances are recorded in the trail file in a timely manner. You can instruct the Oracle RDBMS to do this log archiving automatically at a preset interval by setting the <code class="codeph">archive_lag_target</code> parameter. For example, to ensure that logs are archived every fifteen minutes, regardless of activity, you can issue the following command in all instances of the RAC system:</p>
<pre dir="ltr">
SQL&gt; alter system set archive_lag_target 900
</pre></li>
<li>
<p>To process the last transaction in a RAC cluster before shutting down Extract, insert a dummy record into a source table that Oracle GoldenGate is replicating, and then switch log files on all nodes. This updates the Extract checkpoint and confirms that all available archive logs can be read. It also confirms that all transactions in those archive logs are captured and written to the trail in the correct order.</p>
</li>
</ul>
<p>The following table shows some Oracle GoldenGate parameters that are of specific benefit in Oracle RAC.</p>
</div>
<!-- class="section" -->
<div class="tblformalwide" id="GUID-8DEA74B2-C78A-4046-93EA-4DE36CACCBE1__GUID-94934E14-608C-47E8-AFFA-F9E59C4634D0">
<p class="titleintable">Table 10-1 Classic Extract Parameters for Oracle RAC</p>
<table class="cellalignment500" title="Classic Extract Parameters for Oracle RAC" summary="This table describes the Oracle Classic Extract parameters for Oracle RAC.">
<thead>
<tr class="cellalignment483">
<th class="cellalignment523" id="d26736e1164">Parameter</th>
<th class="cellalignment524" id="d26736e1167">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment483">
<td class="cellalignment525" id="d26736e1172" headers="d26736e1164">
<p><code class="codeph">THREADOPTIONS</code> parameter with the <code class="codeph">INQUEUESIZE</code> and <code class="codeph">OUTQUEUESIZE</code> options</p>
</td>
<td class="cellalignment526" headers="d26736e1172 d26736e1167">
<p>Sets the amount of data that Extract queues in memory before sending it to the target system. Tuning these parameters might increase Extract performance on Oracle RAC.</p>
</td>
</tr>
<tr class="cellalignment483">
<td class="cellalignment525" id="d26736e1187" headers="d26736e1164">
<p><code class="codeph">TRANLOGOPTIONS</code> parameter with the <code class="codeph">PURGEORPHANEDTRANSACTIONS | NOPURGEORPHANEDTRANSACTIONS</code> and <code class="codeph">TRANSCLEANUPFREQUENCY</code> options</p>
</td>
<td class="cellalignment526" headers="d26736e1187 d26736e1167">
<p>Controls how Extract handles orphaned transactions, which can occur when a node fails during a transaction and Extract cannot capture the rollback. Although the database performs the rollback on the failover node, the transaction would otherwise remain in the Extract transaction list indefinitely and prevent further checkpointing for the Extract thread that was processing the transaction. By default, Oracle GoldenGate purges these transactions from its list after they are confirmed as orphaned. This functionality can also be controlled on demand with the <code class="codeph">SEND EXTRACT</code> command in GGSCI.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-139116DA-90DB-40C9-B0DA-48FC7C465BEC" title="This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in classic capture mode.">Additional Configuration Steps for Using Classic Capture</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-4792E855-20B9-44BE-8344-581BBE68F2BE"></a>
<h2 id="GGODB-GUID-4792E855-20B9-44BE-8344-581BBE68F2BE" class="sect2"><span class="enumeration_section">10.3</span> Mining ASM-stored Logs in Classic Capture Mode</h2>
<div>
<div class="section">
<p>This topic covers additional configuration requirements that apply when Oracle GoldenGate mines transaction logs that are stored in Oracle Automatic Storage Management (ASM).</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-E42F531E-39D1-4230-9E0A-C5DC0A97B408">Accessing the Transaction Logs in ASM</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-5E2FCC1E-3E44-4ABB-A378-DC51FCCA89DE">Ensuring ASM Connectivity</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-139116DA-90DB-40C9-B0DA-48FC7C465BEC" title="This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in classic capture mode.">Additional Configuration Steps for Using Classic Capture</a></p>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-E42F531E-39D1-4230-9E0A-C5DC0A97B408"></a>
<h3 id="GGODB-GUID-E42F531E-39D1-4230-9E0A-C5DC0A97B408" class="sect3"><span class="enumeration_section">10.3.1</span> Accessing the Transaction Logs in ASM</h3>
<div>
<div class="section">
<p>Extract must be configured to read logs that are stored in ASM. Depending on the database version, the following options are available:</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-10D128D5-199F-4CA4-8ED0-022F3A58D0FA">Reading Transaction Logs Through the RDBMS</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-D2D26CDF-D900-43BA-811E-9CE1B6356BB6">ASM Direct Connection</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-4792E855-20B9-44BE-8344-581BBE68F2BE">Mining ASM-stored Logs in Classic Capture Mode</a></p>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-10D128D5-199F-4CA4-8ED0-022F3A58D0FA"></a>
<h4 id="GGODB-GUID-10D128D5-199F-4CA4-8ED0-022F3A58D0FA" class="sect4"><span class="enumeration_section">10.3.1.1</span> Reading Transaction Logs Through the RDBMS</h4>
<div>
<div class="section">
<p>Use the <code class="codeph">TRANLOGOPTIONS</code> parameter with the <code class="codeph">DBLOGREADER</code> option in the Extract parameter file if the RDBMS is Oracle 11.1.0.7 or Oracle 11.2.0.2 or later 11g R2 versions.</p>
<p>An API is available in those releases (but not in Oracle 11g R1 versions) that uses the database server to access the redo and archive logs. When used, this API enables Extract to use a read buffer size of up to 4 MB in size. A larger buffer may improve the performance of Extract when redo rate is high. You can use the <code class="codeph">DBLOGREADERBUFSIZE</code> option of <code class="codeph">TRANLOGOPTIONS</code> to specify a buffer size.</p>
<div class="infobox-note" id="GUID-10D128D5-199F-4CA4-8ED0-022F3A58D0FA__GUID-79911B7A-0B97-4120-A37E-0887CF71C0AD">
<p class="notep1">Note:</p>
<p><code class="codeph">DBLOGREADER</code> also can be used when the redo and archive logs are on regular disk or on a raw device.</p>
</div>
<p>When using <code class="codeph">DBLOGREADER</code> and using Oracle Data Vault, grant the <code class="codeph">DV_GOLDENGATE_REDO_ACCESS</code> Role to the Extract database user in addition to the privileges that are listed in <a href="establishing-oracle-goldengate-credentials.htm#GUID-E40B375A-5042-4195-B563-BE7EDC251880" title="Learn how to create database users for the processes that interacts with the database, assign the correct privileges, and secure the credentials from unauthorized use.">Establishing Oracle GoldenGate Credentials</a>.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-E42F531E-39D1-4230-9E0A-C5DC0A97B408">Accessing the Transaction Logs in ASM</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-D2D26CDF-D900-43BA-811E-9CE1B6356BB6"></a>
<h4 id="GGODB-GUID-D2D26CDF-D900-43BA-811E-9CE1B6356BB6" class="sect4"><span class="enumeration_section">10.3.1.2</span> ASM Direct Connection</h4>
<div>
<div class="section">
<p>If the RDBMS version is not one of those listed in <a href="additional-configuration-steps-using-classic-capture.htm#GUID-10D128D5-199F-4CA4-8ED0-022F3A58D0FA">Reading Transaction Logs Through the RDBMS</a>, do the following:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Create a user for the Extract process to access the ASM instance directly. Assign this user <code class="codeph">SYS</code> or <code class="codeph">SYSDBA</code> privileges in the ASM instance. Oracle GoldenGate does not support using operating-system authentication for the ASM user.</span>
<div>
<div class="tblformal" id="GUID-D2D26CDF-D900-43BA-811E-9CE1B6356BB6__BABIHGEH">
<p class="titleintable">Table 10-2 Extract Database Privileges &mdash; ASM Instance</p>
<table class="cellalignment527" title="Extract Database Privileges &mdash; ASM Instance" summary="This table lists the Extract database privileges &mdash; ASM instance. It gives the ASM password configuration and the permitted user.">
<thead>
<tr class="cellalignment483">
<th class="cellalignment528" id="d26736e1414">ASM password configuration(1)</th>
<th class="cellalignment528" id="d26736e1429">Permitted user</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment483">
<td class="cellalignment529" id="d26736e1434" headers="d26736e1414">
<p>ASM instance and the database share a password file</p>
</td>
<td class="cellalignment529" headers="d26736e1434 d26736e1429">
<p>You can use the Oracle GoldenGate source database user if you grant that user <code class="codeph">SYSDBA</code>, or you can use any other database user that has <code class="codeph">SYSDBA</code> privileges.</p>
</td>
</tr>
<tr class="cellalignment483">
<td class="cellalignment529" id="d26736e1447" headers="d26736e1414">
<p>ASM instance and the source database have separate password files</p>
</td>
<td class="cellalignment529" headers="d26736e1447 d26736e1429">
<p>You can overwrite the ASM password file with the source database password file, understanding that this procedure changes the <code class="codeph">SYS</code> password in the ASM instance to the value that is contained in the database password file, and it also grants ASM access to the other users in the database password file. Save a copy of the ASM file before overwriting it.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1</sup> To view how the current ASM password file is configured, log on to the ASM instance and issue the following command in SQL*Plus: SQL&gt; SELECT name, value FROM v$parameter WHERE name = 'remote_login_passwordfile';</p>
</div>
</li>
<li class="stepexpand"><span>Add the ASM user credentials to the Oracle GoldenGate credential store by issuing the <code class="codeph">ALTER CREDENTIALSTORE</code> command. See <a class="olink GWURF895" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GWURF895"><span class="italic"><span id="GUID-D2D26CDF-D900-43BA-811E-9CE1B6356BB6__GWURF"><cite>Reference for Oracle GoldenGate</cite></span></span></a> for usage instructions and syntax.</span></li>
<li class="stepexpand"><span>Specify the ASM login alias in the Extract parameter file by including the <code class="codeph">TRANLOGOPTIONS</code> parameter with the <code class="codeph">ASMUSERALIAS</code> option. For more information about <code class="codeph">TRANLOGOPTIONS</code>, see <a class="olink GWURF712" target="_blank" href="../GWURF/tranlogoptions.htm#GWURF712"><span class="italic"><span><cite>Reference for Oracle GoldenGate</cite></span></span></a>.</span></li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-E42F531E-39D1-4230-9E0A-C5DC0A97B408">Accessing the Transaction Logs in ASM</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-5E2FCC1E-3E44-4ABB-A378-DC51FCCA89DE"></a>
<h3 id="GGODB-GUID-5E2FCC1E-3E44-4ABB-A378-DC51FCCA89DE" class="sect3"><span class="enumeration_section">10.3.2</span> Ensuring ASM Connectivity</h3>
<div>
<div class="section">
<p>To ensure that the Oracle GoldenGate Extract process can connect to an ASM instance, list the ASM instance in the <code class="codeph">tnsnames.ora</code> file. The recommended method for connecting to an ASM instance when Oracle GoldenGate is running on the database host machine is to use a bequeath (BEQ) protocol. The BEQ protocol does not require a listener. If you prefer to use the TCP/IP protocol, verify that the Oracle listener is listening for new connections to the ASM instance. The <code class="codeph">listener.ora</code> file must contain an entry similar to the following.</p>
<pre dir="ltr">
SID_LIST_LISTENER_ASM =
  (SID_LIST =
    (SID_DESC =
      (GLOBAL_DBNAME = ASM)
      (ORACLE_HOME = /u01/app/grid)
    (SID_NAME = +ASM1)
  )
)
</pre>
<div class="infobox-note" id="GUID-5E2FCC1E-3E44-4ABB-A378-DC51FCCA89DE__GUID-8E2A43B5-6C5C-4139-BF55-934FA0C51E39">
<p class="notep1">Note:</p>
<p>A BEQ connection does not work when using a remote Extract configuration. Use <code class="codeph">TNSNAMES</code> with the TCP/IP protocol.</p>
</div>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-4792E855-20B9-44BE-8344-581BBE68F2BE">Mining ASM-stored Logs in Classic Capture Mode</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-A46BCF1C-D08D-4095-8C67-88A32F7CBBFE"></a>
<h2 id="GGODB-GUID-A46BCF1C-D08D-4095-8C67-88A32F7CBBFE" class="sect2"><span class="enumeration_section">10.4</span> Ensuring Data Availability for Classic Capture</h2>
<div>
<div class="section">
<p>To ensure the continuity and integrity of capture processing when Extract operates in classic capture mode, enable archive logging. The archive logs provide a secondary data source should the online logs recycle before Extract is finished with them. The archive logs for open transactions must be retained on the system in case Extract needs to recapture data from them to perform a recovery.</p>
<div class="infoboxnotewarn" id="GUID-A46BCF1C-D08D-4095-8C67-88A32F7CBBFE__GUID-3735310F-9CEF-4C17-A885-FF412499F894">
<p class="notep1">WARNING:</p>
<p>If you cannot enable archive logging, there is a high risk that you will need to completely resynchronize the source and target objects and reinstantiate replication should there be a failure that causes an Extract outage while transactions are still active. If you must operate this way, configure the online logs according to the following guidelines to retain enough data for Extract to capture what it needs before the online logs recycle. Allow for Extract backlogs caused by network outages and other external factors, as well as long-running transactions.</p>
</div>
<p>In a RAC configuration, Extract must have access to the online and archived logs for all nodes in the cluster, including the one where Oracle GoldenGate is installed.</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-58E5346B-0076-4DB2-8C8D-ED720B6C1AA1">Log Retention Requirements per Extract Recovery Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-DDA8F481-A4AC-4848-BAB4-1557DAD25DF5">Log Retention Options</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-43FF127E-5FC7-41FA-824F-B98B2B0161C7">Determining How Much Data to Retain</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-AAAB8163-B646-4BAE-90B8-422254A672FD">Purging Log Archives</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-6B5EEF83-BB04-488B-B8C2-383E44BC9E4E">Specifying the Archive Location</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-CC76A9A0-569A-4AE7-96E0-9686B3327CA6">Mounting Logs that are Stored on Other Platforms</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-139116DA-90DB-40C9-B0DA-48FC7C465BEC" title="This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in classic capture mode.">Additional Configuration Steps for Using Classic Capture</a></p>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-58E5346B-0076-4DB2-8C8D-ED720B6C1AA1"></a>
<h3 id="GGODB-GUID-58E5346B-0076-4DB2-8C8D-ED720B6C1AA1" class="sect3"><span class="enumeration_section">10.4.1</span> Log Retention Requirements per Extract Recovery Mode</h3>
<div>
<div class="section">
<p>The following summarizes the different recovery modes that Extract might use and their log-retention requirements:</p>
<ul style="list-style-type: disc;">
<li>
<p>By default, the Bounded Recovery mode is in effect, and Extract requires access to the logs only as far back as twice the Bounded Recovery interval that is set with the <code class="codeph">BR</code> parameter. This interval is an integral multiple of the standard Extract checkpoint interval, as controlled by the <code class="codeph">CHECKPOINTSECS</code> parameter. These two parameters control the Oracle GoldenGate Bounded Recovery feature, which ensures that Extract can recover in-memory captured data after a failure, no matter how old the oldest open transaction was at the time of failure. For more information about Bounded Recovery, see <a class="olink GWURF-GUID-10850FD1-13AA-421D-801A-0E1A4C33EAE3" target="_blank" href="../GWURF/genloadfiles.htm#GWURF-GUID-10850FD1-13AA-421D-801A-0E1A4C33EAE3">Reference for Oracle GoldenGate</a>.</p>
</li>
<li>
<p>In the unlikely event that the Bounded Recovery mechanism fails when Extract attempts a recovery, Extract reverts to normal recovery mode and must have access to the archived log that contains the beginning of the oldest open transaction in memory at the time of failure and all logs thereafter.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-A46BCF1C-D08D-4095-8C67-88A32F7CBBFE">Ensuring Data Availability for Classic Capture</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-DDA8F481-A4AC-4848-BAB4-1557DAD25DF5"></a>
<h3 id="GGODB-GUID-DDA8F481-A4AC-4848-BAB4-1557DAD25DF5" class="sect3"><span class="enumeration_section">10.4.2</span> Log Retention Options</h3>
<div>
<div class="section">
<p>Depending on the version of Oracle, there are different options for ensuring that the required logs are retained on the system.</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-1135F0EF-93C1-4961-965C-D718DE44AD46">Oracle Enterprise Edition 11g and Later</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-5F5DBD60-97EF-4367-85E7-6983A14C5AD5">All Other Oracle Versions</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-A46BCF1C-D08D-4095-8C67-88A32F7CBBFE">Ensuring Data Availability for Classic Capture</a></p>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-1135F0EF-93C1-4961-965C-D718DE44AD46"></a>
<h4 id="GGODB-GUID-1135F0EF-93C1-4961-965C-D718DE44AD46" class="sect4"><span class="enumeration_section">10.4.2.1</span> Oracle Enterprise Edition 11g and Later</h4>
<div>
<div class="section">
<p>For these versions, Extract can be configured to work with Oracle Recovery Manager (RMAN) to retain the logs that Extract needs for recovery. You enable this feature when you issue the <code class="codeph">REGISTER EXTRACT</code> command. See <a href="creating-process-groups.htm#GUID-268E5A2D-5EA3-4534-B37A-5C456C95ED12" title='This chapter contains instructions for creating Oracle GoldenGate process groups, collectively known as the "change-synchronization" processes. At minimum, you will create one primary Extract, one data pump, and one Replicat process group.'>Creating Process Groups</a> for more information. To use this feature, the Extract database user must have the following privileges, in addition to the basic privileges listed in <a href="establishing-oracle-goldengate-credentials.htm#GUID-E40B375A-5042-4195-B563-BE7EDC251880" title="Learn how to create database users for the processes that interacts with the database, assign the correct privileges, and secure the credentials from unauthorized use.">Establishing Oracle GoldenGate Credentials</a>.</p>
</div>
<!-- class="section" -->
<div class="tblformalwide" id="GUID-1135F0EF-93C1-4961-965C-D718DE44AD46__BABEJGHB">
<p class="titleintable">Table 10-3 Extract Database Privileges &mdash;Log Retention</p>
<table class="cellalignment500" title="Extract Database Privileges &mdash;Log Retention" summary="This table lists the Extract database privileges &mdash;Log retention in Oracle EE 10.2 and later.">
<thead>
<tr class="cellalignment483">
<th class="cellalignment517" id="d26736e1752">Oracle EE version</th>
<th class="cellalignment530" id="d26736e1755">Privileges</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment483">
<td class="cellalignment518" id="d26736e1760" headers="d26736e1752">
<p>11.1 and 11.2.0.1</p>
</td>
<td class="cellalignment531" headers="d26736e1760 d26736e1755">
<ol>
<li>
<p>Run package to grant Oracle GoldenGate admin privilege.</p>
<pre dir="ltr">
exec dbms_streams_auth.grant_admin_privilege('<span class="italic">user</span>')
</pre></li>
<li>
<p>Grant the '<code class="codeph">become user</code>' privilege.</p>
<pre dir="ltr">
grant become user to <span class="italic">user</span>;
</pre></li>
</ol>
</td>
</tr>
<tr class="cellalignment483">
<td class="cellalignment518" id="d26736e1787" headers="d26736e1752">
<p>11.2.0.3 and later</p>
</td>
<td class="cellalignment531" headers="d26736e1787 d26736e1755">
<p>Run package to grant Oracle GoldenGate admin privilege.</p>
<pre dir="ltr">
exec dbms_goldengate_auth.grant_admin_privilege('<span class="italic">user</span>')
</pre></td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p>When log retention is enabled, Extract retains enough logs to perform a Bounded Recovery, but you can configure Extract to retain enough logs through RMAN for a normal recovery by using the <code class="codeph">TRANLOGOPTIONS</code> parameter with the <code class="codeph">LOGRETENTION</code> option set to <code class="codeph">SR</code>. There also is an option to disable the use of RMAN log retention. Review the options of <code class="codeph">LOGRETENTION</code> in the <span class="italic"><span id="GUID-1135F0EF-93C1-4961-965C-D718DE44AD46__GWURF"><cite>Reference for Oracle GoldenGate</cite></span></span> before you configure Extract. If you set <code class="codeph">LOGRETENTION</code> to <code class="codeph">DISABLED</code>, see <a href="additional-configuration-steps-using-classic-capture.htm#GUID-43FF127E-5FC7-41FA-824F-B98B2B0161C7">Determining How Much Data to Retain</a>,.</p>
<div class="infobox-note" id="GUID-1135F0EF-93C1-4961-965C-D718DE44AD46__GUID-A2B1BB79-919E-4F85-9B02-4627ECDE0B04">
<p class="notep1">Note:</p>
<p>To support RMAN log retention on Oracle RAC for Oracle versions prior to 11.2.0.3, you must download and install the database patch that is provided in BUGFIX 11879974 before you add the Extract groups.</p>
</div>
<p>The RMAN log retention feature creates an underlying (but non-functioning) Oracle Streams Capture process for each Extract group. The name of the Capture is based on the name of the associated Extract group. The log retention feature can operate concurrently with other local Oracle Streams installations. When you create an Extract group, the logs are retained from the current database SCN.</p>
<div class="infobox-note" id="GUID-1135F0EF-93C1-4961-965C-D718DE44AD46__GUID-52AC848C-7C72-44C2-BF3C-47E35458395E">
<p class="notep1">Note:</p>
<p>If the storage area is full, RMAN purges the archive logs even when needed by Extract. This limitation exists so that the requirements of Extract (and other Oracle replication components) do not interfere with the availability of redo to the database.</p>
</div>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-DDA8F481-A4AC-4848-BAB4-1557DAD25DF5">Log Retention Options</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-5F5DBD60-97EF-4367-85E7-6983A14C5AD5"></a>
<h4 id="GGODB-GUID-5F5DBD60-97EF-4367-85E7-6983A14C5AD5" class="sect4"><span class="enumeration_section">10.4.2.2</span> All Other Oracle Versions</h4>
<div>
<div class="section">
<p>For versions of Oracle other than Enterprise Edition, you must manage the log retention process with your preferred administrative tools. Follow the directions in <a href="additional-configuration-steps-using-classic-capture.htm#GUID-43FF127E-5FC7-41FA-824F-B98B2B0161C7">Determining How Much Data to Retain</a>.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-DDA8F481-A4AC-4848-BAB4-1557DAD25DF5">Log Retention Options</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-43FF127E-5FC7-41FA-824F-B98B2B0161C7"></a>
<h3 id="GGODB-GUID-43FF127E-5FC7-41FA-824F-B98B2B0161C7" class="sect3"><span class="enumeration_section">10.4.3</span> Determining How Much Data to Retain</h3>
<div>
<div class="section">
<p>When managing log retention, try to ensure rapid access to the logs that Extract would require to perform a normal recovery (not a Bounded Recovery). See <a class="olink GIORA-GUID-1FFF852E-0B74-48AE-8A55-A1F702310532" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GIORA-GUID-1FFF852E-0B74-48AE-8A55-A1F702310532">Log Retention Requirements per Extract Recovery Mode</a>. If you must move the archives off the database system, the <code class="codeph">TRANLOGOPTIONS</code> parameter provides a way to specify an alternate location. See <a class="olink GIORA-GUID-22B3C34E-71EB-40F5-9B9F-A3EACAE24626" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GIORA-GUID-22B3C34E-71EB-40F5-9B9F-A3EACAE24626">Specifying the Archive Location</a>.</p>
<p>The recommended retention period is at least 24 hours worth of transaction data, including both online and archived logs. To determine the oldest log that Extract might need at any given point, issue the <code class="codeph">SEND EXTRACT</code> command with the <code class="codeph">SHOWTRANS</code> option. You might need to do some testing to determine the best retention time given your data volume and business requirements.</p>
<p>If data that Extract needs during processing was not retained, either in online or archived logs, one of the following corrective actions might be required:</p>
<ul style="list-style-type: disc;">
<li>
<p>Alter Extract to capture from a later point in time for which log data is available (and accept possible data loss on the target).</p>
</li>
<li>
<p>Resynchronize the source and target data, and then start the Oracle GoldenGate environment over again.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-A46BCF1C-D08D-4095-8C67-88A32F7CBBFE">Ensuring Data Availability for Classic Capture</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-AAAB8163-B646-4BAE-90B8-422254A672FD"></a>
<h3 id="GGODB-GUID-AAAB8163-B646-4BAE-90B8-422254A672FD" class="sect3"><span class="enumeration_section">10.4.4</span> Purging Log Archives</h3>
<div>
<div class="section">
<p>Make certain not to use backup or archive options that cause old archive files to be overwritten by new backups. Ideally, new backups should be separate files with different names from older ones. This ensures that if Extract looks for a particular log, it will still exist, and it also ensures that the data is available in case it is needed for a support case.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-A46BCF1C-D08D-4095-8C67-88A32F7CBBFE">Ensuring Data Availability for Classic Capture</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-6B5EEF83-BB04-488B-B8C2-383E44BC9E4E"></a>
<h3 id="GGODB-GUID-6B5EEF83-BB04-488B-B8C2-383E44BC9E4E" class="sect3"><span class="enumeration_section">10.4.5</span> Specifying the Archive Location</h3>
<div>
<div class="section">
<p>If the archived logs reside somewhere other than the Oracle default directory, specify that directory with the <code class="codeph">ALTARCHIVELOGDEST</code> option of the <code class="codeph">TRANLOGOPTIONS</code> parameter in the Extract parameter file.</p>
<p>You might also need to use the <code class="codeph">ALTARCHIVEDLOGFORMAT</code> option of <code class="codeph">TRANLOGOPTIONS</code> if the format that is specified with the Oracle parameter <code class="codeph">LOG_ARCHIVE_FORMAT</code> contains sub-directories. <code class="codeph">ALTARCHIVEDLOGFORMAT</code> specifies an alternate format that removes the sub-directory from the path. For example, <code class="codeph">%T/log_%t_%s_%r.arc</code> would be changed to <code class="codeph">log_%t_%s_%r.arc</code>. As an alternative to using <code class="codeph">ALTARCHIVEDLOGFORMAT</code>, you can create the sub-directory manually, and then move the log files to it.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-A46BCF1C-D08D-4095-8C67-88A32F7CBBFE">Ensuring Data Availability for Classic Capture</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-CC76A9A0-569A-4AE7-96E0-9686B3327CA6"></a>
<h3 id="GGODB-GUID-CC76A9A0-569A-4AE7-96E0-9686B3327CA6" class="sect3"><span class="enumeration_section">10.4.6</span> Mounting Logs that are Stored on Other Platforms</h3>
<div>
<div class="section">
<p>If the online and archived redo logs are stored on a different platform from the one that Extract is built for, do the following:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>NFS-mount the archive files.</p>
</li>
<li>
<p>Map the file structure to the structure of the source system by using the <code class="codeph">LOGSOURCE</code> and <code class="codeph">PATHMAP</code> options of the Extract parameter <code class="codeph">TRANLOGOPTIONS</code>. For more information, see <a class="olink GWURF712" target="_blank" href="../GWURF/tranlogoptions.htm#GWURF712"><span class="italic">Reference for Oracle GoldenGate</span></a>.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-A46BCF1C-D08D-4095-8C67-88A32F7CBBFE">Ensuring Data Availability for Classic Capture</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-8C86A061-A85B-4173-B281-1552EE474624"></a>
<h2 id="GGODB-GUID-8C86A061-A85B-4173-B281-1552EE474624" class="sect2"><span class="enumeration_section">10.5</span> Configuring Classic Capture in Archived Log Only Mode</h2>
<div>
<div class="section">
<p>You can configure Extract to read exclusively from the archived logs. This is known as <span class="bold">Archived Log Only (ALO)</span> mode. In this mode, Extract reads exclusively from archived logs that are stored in a specified location. ALO mode enables Extract to use production logs that are shipped to a secondary database (such as a standby) as the data source. The online logs are not used at all. Oracle GoldenGate connects to the secondary database to get metadata and other required data as needed. As an alternative, ALO mode is supported on the production system.</p>
<div class="infobox-note" id="GUID-8C86A061-A85B-4173-B281-1552EE474624__GUID-61BC4137-A899-4EAA-8ADD-6C4DA2FC0C3D">
<p class="notep1">Note:</p>
<p>ALO mode is not compatible with Extract operating in integrated capture mode.</p>
</div>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-0B183D12-4D50-4D69-82C9-54D84777F870">Limitations and Requirements for Using ALO Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-98F875D1-4458-40E4-8DB7-3A9581889095">Configuring Extract for ALO mode</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-139116DA-90DB-40C9-B0DA-48FC7C465BEC" title="This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in classic capture mode.">Additional Configuration Steps for Using Classic Capture</a></p>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-0B183D12-4D50-4D69-82C9-54D84777F870"></a>
<h3 id="GGODB-GUID-0B183D12-4D50-4D69-82C9-54D84777F870" class="sect3"><span class="enumeration_section">10.5.1</span> Limitations and Requirements for Using ALO Mode</h3>
<div>
<div class="section">
<p>Observe the following limitations and requirements when using Extract in ALO mode.</p>
<ul style="list-style-type: disc;">
<li>
<p>Log resets (<code class="codeph">RESETLOG</code>) cannot be done on the source database after the standby database is created.</p>
</li>
<li>
<p>ALO cannot be used on a standby database if the production system is Oracle RAC and the standby database is non-RAC. In addition to both systems being Oracle RAC, the number of nodes on each system must be identical.</p>
</li>
<li>
<p>ALO on Oracle RAC requires a dedicated connection to the source server. If that connection is lost, Oracle GoldenGate processing will stop.</p>
</li>
<li>
<p>It is a best practice to use separate archive log directories when using Oracle GoldenGate for Oracle RAC in ALO mode. This will avoid any possibility of the same file name showing up twice, which could result in Extract returning an "out of order scn" error.</p>
</li>
<li>
<p>The <code class="codeph">LOGRETENTION</code> parameter defaults to <code class="codeph">DISABLED</code> when Extract is in ALO mode. You can override this with a specific <code class="codeph">LOGRETENTION</code> setting, if needed.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-8C86A061-A85B-4173-B281-1552EE474624">Configuring Classic Capture in Archived Log Only Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-98F875D1-4458-40E4-8DB7-3A9581889095"></a>
<h3 id="GGODB-GUID-98F875D1-4458-40E4-8DB7-3A9581889095" class="sect3"><span class="enumeration_section">10.5.2</span> Configuring Extract for ALO mode</h3>
<div>
<div class="section">
<p>To configure Extract for ALO mode, follow these steps as part of the overall process for configuring Oracle GoldenGate, as documented in <a class="olink GIORA-GUID-D5993E67-5FDA-45DB-8303-5D3636729703" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GIORA-GUID-D5993E67-5FDA-45DB-8303-5D3636729703">Configuring Capture in Classic Mode</a>.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Enable supplemental logging at the table level and the database level for the tables in the source database. (See <a class="olink GIORA-GUID-D47FE4D5-06D0-4A62-9430-AF0010EFBE75" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GIORA-GUID-D47FE4D5-06D0-4A62-9430-AF0010EFBE75">Configuring Logging Properties</a>.)</span></li>
<li class="stepexpand"><span>When Oracle GoldenGate is running on a different server from the source database, make certain that SQL*Net is configured properly to connect to a remote server, such as providing the correct entries in a <code class="codeph">TNSNAMES</code> file. Extract must have permission to maintain a SQL*Net connection to the source database.</span></li>
<li class="stepexpand"><span>Use a SQL*Net connect string for the name of the user in the credential store that is assigned to the process. Specify the alias of this user in the following:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">USERIDALIAS</code> parameter in the parameter file of every Oracle GoldenGate process that connects to that database.</p>
</li>
<li>
<p>The <code class="codeph">USERIDALIAS</code> portion of the <code class="codeph">DBLOGIN</code> command in GGSCI.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-98F875D1-4458-40E4-8DB7-3A9581889095__GUID-CDD3CB08-A599-42B2-B071-0C29AC625788">
<p class="notep1">Note:</p>
<p>If you have a standby server that is local to the server that Oracle GoldenGate is running on, you do not need to use a connect string for the user specified in <code class="codeph">USERIDALIAS</code>. You can just supply the user login name.</p>
</div>
<p>See <a class="olink GWUAD354" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GWUAD354"><span class="italic"><span id="GUID-98F875D1-4458-40E4-8DB7-3A9581889095__GWUAD"><cite>Administering Oracle GoldenGate</cite></span></span></a> for more information about using a credential store.</p>
</div>
</li>
<li class="stepexpand"><span>Use the Extract parameter <code class="codeph">TRANLOGOPTIONS</code> with the <code class="codeph">ARCHIVEDLOGONLY</code> option. This option forces Extract to operate in ALO mode against a primary or logical standby database, as determined by a value of <code class="codeph">PRIMARY</code> or <code class="codeph">LOGICAL</code> <code class="codeph">STANDBY</code> in the <code class="codeph">db_role</code> column of the <code class="codeph">v$database</code> view. The default is to read the online logs. <code class="codeph">TRANLOGOPTIONS</code> with <code class="codeph">ARCHIVEDLOGONLY</code> is not needed if using ALO mode against a physical standby database, as determined by a value of <code class="codeph">PHYSICAL</code> <code class="codeph">STANDBY</code> in the <code class="codeph">db_role</code> column of <code class="codeph">v$database</code>. Extract automatically operates in ALO mode if it detects that the database is a physical standby.</span></li>
<li class="stepexpand"><span>Other <code class="codeph">TRANLOGOPTIONS</code> options might be required for your environment. For example, depending on the copy program that you use, you might need to use the <code class="codeph">COMPLETEARCHIVEDLOGONLY</code> option to prevent Extract errors.</span></li>
<li class="stepexpand"><span>Use the <code class="codeph">MAP</code> parameter for Extract to map the table names to the source object IDs. For more information, see <a class="olink GWURF546" target="_blank" href="../GWURF/table-map.htm#GWURF546"><span class="italic"><span id="GUID-98F875D1-4458-40E4-8DB7-3A9581889095__GWURF"><cite>Reference for Oracle GoldenGate</cite></span></span></a>.</span></li>
<li class="stepexpand"><span>Add the Extract group by issuing the <code class="codeph">ADD EXTRACT</code> command with a timestamp as the <code class="codeph">BEGIN</code> option, or by using <code class="codeph">ADD EXTRACT</code> with the <code class="codeph">SEQNO</code> and <code class="codeph">RBA</code> options. It is best to give Extract a known start point at which to begin extracting data, rather than by using the <code class="codeph">NOW</code> argument. The start time of <code class="codeph">NOW</code> corresponds to the time of the current <span class="italic">online</span> redo log, but an ALO Extract cannot read the online logs, so it must wait for that log to be archived when Oracle switches logs. The timing of the switch depends on the size of the redo logs and the volume of database activity, so there might be a lag between when you start Extract and when data starts being captured. This can happen in both regular and RAC database configurations.</span></li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-8C86A061-A85B-4173-B281-1552EE474624">Configuring Classic Capture in Archived Log Only Mode</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-F2B9181C-791B-4950-8A66-D9B8AE39EFC8"></a>
<h2 id="GGODB-GUID-F2B9181C-791B-4950-8A66-D9B8AE39EFC8" class="sect2"><span class="enumeration_section">10.6</span> Configuring Classic Capture in Oracle Active Data Guard Only Mode</h2>
<div>
<div class="section">
<p>You can configure Classic Extract to access both redo data and metadata in real-time to successfully replicate source database activities using Oracle Active Data Guard. This is known as <span class="italic">Active Data Guard</span> (ADG) mode. ADG mode enables Extract to use production logs that are shipped to a standby database as the data source. The online logs are not used at all. Oracle GoldenGate connects to the standby database to get metadata and other required data as needed.</p>
<p>This mode is useful in load sensitive environments where ADG is already in place or can be implemented. It can also be used as cost effective method to implement high availability using the ADG Broker role planned (switchover) and failover (unplanned) changes. In an ADG configuration, switchover and failover are considered <span class="italic">roles</span>. When either of the operations occur, it is considered a <span class="italic">role change</span>. For more information, see <a class="olink GUID-5E73667D-4A56-445E-911F-1E99092DD8D7" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GUID-5E73667D-4A56-445E-911F-1E99092DD8D7">Oracle Data Guard Concepts and Administration</a> and <a class="olink DGBKR-GUID-723E5B73-A350-4B2E-AF3C-5EA4EFC83966" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=DGBKR-GUID-723E5B73-A350-4B2E-AF3C-5EA4EFC83966">Oracle Data Guard Broker</a>.</p>
<p>You can configure Integrated Extract to fetch table data and metadata required for the fetch from an ADG instead of the source database. This is possible because an ADG is a physical replica of the source database. Fetching from an ADG using the <code class="codeph">FETCHUSER</code> parameter is supported by Extract in all configurations except when running as Classic Extract. Classic Extract already has the ability to connect directly to an ADG and mine its redo logs and fetch from it using standard connection information supplied using the <code class="codeph">USERID</code> parameter. The impact to the source database is minimized because Extract gathers information from the source database at startup, including compatibility level, database type, and source database validation checks, when fetching from an ADG.</p>
<p>All previous fetch functionality and parameters are supported.</p>
<div class="infobox-note" id="GUID-F2B9181C-791B-4950-8A66-D9B8AE39EFC8__GUID-622E08DB-F332-4CBB-8D2F-8EFF7ECF74C2">
<p class="notep1">Note:</p>
Integrated Extract cannot capture from a standby database because it requires <code class="codeph">READ</code> and <code class="codeph">WRITE</code> access to the database, and an ADG standby only provides <code class="codeph">READ ONLY</code> access.</div>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-31B64425-B4AC-4989-8404-D80D45C83C38">Limitations and Requirements for Using ADG Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-FC91F877-217A-4156-A250-2D8081FFE986">Configuring Classic Extract for ADG Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-FC5F4919-F5B8-4248-A22F-E225B61CFCE7">Configuring Integrated Extract for ADG Mode</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-1128F796-29EE-4577-9488-6F2292DED03B">Migrating Classic Extract To and From an ADG Database</a><br /></li>
<li class="ulchildlink"><a href="additional-configuration-steps-using-classic-capture.htm#GUID-CAE9EC48-2793-4381-8AC8-3A3B8418F239">Handling Role Changes In an ADG Configuration</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-139116DA-90DB-40C9-B0DA-48FC7C465BEC" title="This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in classic capture mode.">Additional Configuration Steps for Using Classic Capture</a></p>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-31B64425-B4AC-4989-8404-D80D45C83C38"></a>
<h3 id="GGODB-GUID-31B64425-B4AC-4989-8404-D80D45C83C38" class="sect3"><span class="enumeration_section">10.6.1</span> Limitations and Requirements for Using ADG Mode</h3>
<div>
<div class="section">
<p>Observe the following limitations and requirements when using Extract in ADG mode.</p>
<ul style="list-style-type: disc;">
<li>
<p>Extract in ADG mode will only apply redo data that has been applied to the standby database by the apply process. If Extract runs ahead of the standby database, it will wait for the standby database to catch up.</p>
</li>
<li>
<p>You must explicitly specify ADG mode in your classic Extract parameter file to run extract on the standby database.</p>
</li>
<li>
<p>You must specify the database user and password to connect to the ADG system because fetch and other metadata resolution occurs in the database.</p>
</li>
<li>
<p>The number of redo threads in the standby logs in the standby database must match the number of nodes from the primary database.</p>
</li>
<li>
<p>No new RAC instance can be added to the primary database after classic Extract has been created on the standby database. If you do add new instances, the redo data from the new thread will not be captured by classic Extract.</p>
</li>
<li>
<p>Archived logs and standby redo logs accessed from the standby database will be an exact duplicate of the primary database. The size and the contents will match, including redo data, transactional data, and supplemental data. This is guaranteed by a properly configured ADG deployment.</p>
</li>
<li>
<p>ADG role changes are infrequent and require user intervention in both cases.</p>
</li>
<li>
<p>With a switchover, there will be an indicator in the redo log file header (end of the redo log or EOR marker) to indicate end of log stream so that classic Extract on the standby can complete the RAC coordination successfully and ship all of the committed transactions to the trail file.</p>
</li>
<li>
<p>With a failover, a new incarnation is created on both the primary and the standby databases with a new incarnation ID, <code class="codeph">RESETLOG</code> sequence number, and SCN value.</p>
</li>
<li>
<p>You must connect to the primary database from GGSCI to add <code class="codeph">TRANDATA</code> or <code class="codeph">SCHEMATRANDATA</code> because this is done on the primary database.</p>
</li>
<li>
<p>DDL triggers cannot be used on the standby database, in order to support DDL replication (except <code class="codeph">ADDTRANDATA</code>). You must install the Oracle GoldenGate DDL package on the primary database.</p>
</li>
<li>
<p>DDL <code class="codeph">ADDTRANDATA</code> is not supported in ADG mode; you must use <code class="codeph">ADDSCHEMATRANDATA</code> for DDL replication.</p>
</li>
<li>
<p>When adding extract on the standby database, you must specify the starting position using a specific SCN value, timestamp, or log position. Relative timestamp values, such as <code class="codeph">NOW</code>, become ambiguous and may lead to data inconsistency.</p>
</li>
<li>
<p>When adding extract on the standby database, you must specify the number of threads that will include all of the relevant threads from the primary database.</p>
</li>
<li>
<p>During or after failover or switchover, no thread can be added or dropped from either primary or standby databases.</p>
</li>
<li>
<p>Classic Extract will only use one intervening <code class="codeph">RESETLOG</code> operation.</p>
</li>
<li>
<p>If you do not want to relocate your Oracle GoldenGate installation, then you must position it in a shared space where the Oracle GoldenGate installation directory can be accessed from both the primary and standby databases.</p>
</li>
<li>
<p>If you are moving capture off of an ADG standby database to a primary database, then you must point your net alias to the primary database and you must remove the <code class="codeph">TRANLOG</code> options.</p>
</li>
<li>
<p>Only Oracle Database releases that are running with compatibility setting of 10.2 or higher (10g Release 2) are supported.</p>
</li>
<li>
<p>Classic Extract cannot use the <code class="codeph">DBLOGREADER</code> option. Use <code class="codeph">ASMUSER</code> (there is approximately a 20gb/hr read limit) or move the online and archive logs outside of the Application Security Manager on both the primary and the standby databases.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-F2B9181C-791B-4950-8A66-D9B8AE39EFC8">Configuring Classic Capture in Oracle Active Data Guard Only Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-FC91F877-217A-4156-A250-2D8081FFE986"></a>
<h3 id="GGODB-GUID-FC91F877-217A-4156-A250-2D8081FFE986" class="sect3"><span class="enumeration_section">10.6.2</span> Configuring Classic Extract for ADG Mode</h3>
<div>
<div class="section">
<p>To configure Classic Extract for ADG mode, follow these steps as part of the overall process for configuring Oracle GoldenGate, as documented in <a href="configuring-capture-classic-mode.htm#GUID-D5993E67-5FDA-45DB-8303-5D3636729703" title="This chapter contains instructions for configuring the Oracle GoldenGate capture process in classic mode.">Configuring Capture in Classic Mode</a>.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Enable supplemental logging at the table level and the database level for the tables in the <span class="italic">primary</span> database using the <code class="codeph">ADD SCHEMATRANDATA</code> parameter. If necessary, create a DDL capture. (See <a href="preparing-database-oracle-goldengate.htm#GUID-9FFB0F47-A681-4EC8-8E2E-4A03B451D916">Configuring Logging Properties</a>.)</span></li>
<li class="stepexpand"><span>When Oracle GoldenGate is running on a different server from the source database, make certain that SQL*Net is configured properly to connect to a remote server, such as providing the correct entries in a <code class="codeph">TNSNAMES</code> file. Extract must have permission to maintain a SQL*Net connection to the source database.</span></li>
<li class="stepexpand"><span>On the <span class="italic">standby</span> database, use the Extract parameter <code class="codeph">TRANLOGOPTIONS</code> with the <code class="codeph">MINEFROMACTIVEDG</code> option. This option forces Extract to operate in ADG mode against a standby database, as determined by a value of <code class="codeph">PRIMARY</code> or <code class="codeph">LOGICAL</code> <code class="codeph">STANDBY</code> in the <code class="codeph">db_role</code> column of the <code class="codeph">v$database</code> view.</span>
<div>
<p>Other <code class="codeph">TRANLOGOPTIONS</code> options might be required for your environment. For example, depending on the copy program that you use, you might need to use the <code class="codeph">COMPLETEARCHIVEDLOGONLY</code> option to prevent Extract errors.</p>
</div>
</li>
<li class="stepexpand"><span>On the <span class="italic">standby</span> database, add the Extract group by issuing the <code class="codeph">ADD EXTRACT</code> command specifying the number of threads active on the <span class="italic">primary</span> database at the given SCN. The timing of the switch depends on the size of the redo logs and the volume of database activity, so there might be a limited lag between when you start Extract and when data starts being captured. This can happen in both regular and RAC database configurations.</span></li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-F2B9181C-791B-4950-8A66-D9B8AE39EFC8">Configuring Classic Capture in Oracle Active Data Guard Only Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-FC5F4919-F5B8-4248-A22F-E225B61CFCE7"></a>
<h3 id="GGODB-GUID-FC5F4919-F5B8-4248-A22F-E225B61CFCE7" class="sect3"><span class="enumeration_section">10.6.3</span> Configuring Integrated Extract for ADG Mode</h3>
<div>
<div class="section">
<p>To configure Integrated Extract for ADG mode, follow these steps as part of the overall process for configuring Oracle GoldenGate, as documented in <a class="olink GIORA-GUID-74E23910-A441-4939-BDFD-FE0B2EE9783F" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GIORA-GUID-74E23910-A441-4939-BDFD-FE0B2EE9783F">Configuring Capture in Integrated Mode</a>.</p>
<div class="infobox-note" id="GUID-FC5F4919-F5B8-4248-A22F-E225B61CFCE7__GUID-931C97C1-5356-48B0-A7F8-CF142A25DB18">
<p class="notep1">Note:</p>
<p>When using integrated Replicat in an ADG environment where the trail and checkpoint files are stored to a file system outside of the database (not using a DBFS) and there is a data loss fail over causing the checkpoint file to be ahead of the apply process, when Replicat restarts it starts from the checkpoint file position. Thus, losing data that has not been applied to the database. This problem can also occurs when the target database is flashed back and the checkpoint file is outside the database.</p>
</div>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Enable supplemental logging at the table level and the database level for the tables in the <span class="italic">primary</span> database using the <code class="codeph">ADD SCHEMATRANDATA</code> parameter. If necessary, create a DDL capture. (See <a class="olink GIORA-GUID-D47FE4D5-06D0-4A62-9430-AF0010EFBE75" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E81615-01&amp;id=GIORA-GUID-D47FE4D5-06D0-4A62-9430-AF0010EFBE75">Configuring Logging Propertie</a>.)</span></li>
<li class="stepexpand"><span>When Oracle GoldenGate is running on a different server from the source database, make certain that SQL*Net is configured properly to connect to a remote server, such as providing the correct entries in a <code class="codeph">TNSNAMES</code> file. Extract must have permission to maintain a SQL*Net connection to the source database.</span></li>
<li class="stepexpand"><span>On the <span class="italic">standby</span> database, use the Extract parameter <code class="codeph">TRANLOGOPTIONS</code> with the <code class="codeph">MINEFROMACTIVEDG</code> option. This option forces Extract to operate in ADG mode against a standby database, as determined by a value of <code class="codeph">PRIMARY</code> or <code class="codeph">LOGICAL</code> <code class="codeph">STANDBY</code> in the <code class="codeph">db_role</code> column of the <code class="codeph">v$database</code> view.</span>
<div>
<p>Other <code class="codeph">TRANLOGOPTIONS</code> options might be required for your environment. For example, depending on the copy program that you use, you might need to use the <code class="codeph">COMPLETEARCHIVEDLOGONLY</code> option to prevent Extract errors.</p>
</div>
</li>
<li class="stepexpand"><span>On the <span class="italic">primary</span> database, use the Extract parameter <code class="codeph">FETCHUSER</code> to enable fetching from the ADG database.</span></li>
<li class="stepexpand"><span>(Optional) You can control fetch consistency using the <code class="codeph">FETCHTIMEOUT</code>, <code class="codeph">FETCHCHECKFREQ</code>, and <code class="codeph">FETCHRETRYCOUNT</code> options of the <code class="codeph">DBOPTIONS</code> parameter.</span></li>
<li class="stepexpand"><span>On the <span class="italic">standby</span> database, add the Extract group by issuing the <code class="codeph">ADD EXTRACT</code> command specifying the number of threads active on the <span class="italic">primary</span> database at the given SCN. The timing of the switch depends on the size of the redo logs and the volume of database activity, so there might be a limited lag between when you start Extract and when data starts being captured. This can happen in both regular and RAC database configurations.</span></li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-F2B9181C-791B-4950-8A66-D9B8AE39EFC8">Configuring Classic Capture in Oracle Active Data Guard Only Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-1128F796-29EE-4577-9488-6F2292DED03B"></a>
<h3 id="GGODB-GUID-1128F796-29EE-4577-9488-6F2292DED03B" class="sect3"><span class="enumeration_section">10.6.4</span> Migrating Classic Extract To and From an ADG Database</h3>
<div>
<div class="section">
<p>You must have your parameter files, checkpoint files, bounded recovery files, and trail files stored in shared storage or copied to the ADG database before attempting to migrate a classic Extract to or from an ADG database. Additionally, you must ensure that there has not been any intervening role change or Extract will mine the same branch of redo.</p>
<p>Use the following steps to move to an ADG database:</p>
<ol>
<li>
<p>Edit the parameter file <code class="codeph">ext1.prm</code> to add the following parameters:</p>
<pre dir="ltr">
DBLOGIN USERID <span class="italic">userid</span>@ADG PASSWORD <span class="italic">password</span>
TRANLOGOPTIONS MINEFROMACTIVEDG
</pre></li>
<li>
<p>Start Extract by issuing the <code class="codeph">START EXTRACT ext1</code> command.</p>
</li>
</ol>
<p>Use the following steps to move from an ADG database:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Edit the parameter file <code class="codeph">ext1.prm</code> to remove the following parameters:</span>
<div>
<pre dir="ltr">
DBLOGIN USERID <span class="italic">userid</span>@ADG PASSWORD <span class="italic">password</span>
TRANLOGOPTIONS MINEFROMACTIVEDG
</pre></div>
</li>
<li class="stepexpand"><span>Start Extract by issuing the <code class="codeph">START EXTRACT ext1</code> command.</span></li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-F2B9181C-791B-4950-8A66-D9B8AE39EFC8">Configuring Classic Capture in Oracle Active Data Guard Only Mode</a></p>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-CAE9EC48-2793-4381-8AC8-3A3B8418F239"></a>
<h3 id="GGODB-GUID-CAE9EC48-2793-4381-8AC8-3A3B8418F239" class="sect3"><span class="enumeration_section">10.6.5</span> Handling Role Changes In an ADG Configuration</h3>
<div>
<div class="section">
<p>In a role change involving a standby database, all sessions in the primary and the standby database are first disconnected including the connections used by Extract. Then both databases are shut down, then the original primary is mounted as a standby database, and the original standby is opened as the primary database.</p>
<p>The procedure for a role change is determined by the initial deployment of Classic Extract and the deployment relation that you want, database or role. The following table outlines the four possible role changes and is predicated on an ADG configuration comprised of two databases, <code class="codeph">prisys</code> and <code class="codeph">stansys</code>. The <code class="codeph">prisys</code> system contains the primary database and the <code class="codeph">stansys</code> system contains the standby database; <code class="codeph">prisys</code> has two redo threads active, whereas <code class="codeph">stansys</code> has four redo threads active.</p>
<div class="tblformal" id="GUID-CAE9EC48-2793-4381-8AC8-3A3B8418F239__GUID-B7C26194-3E19-47D0-836B-D5CDEDF46820">
<table class="cellalignment495" summary="Two column table detailing the Initial Deployment.">
<thead>
<tr class="cellalignment483">
<th class="cellalignment528" id="d26736e2954">Initial Deployment Primary (prisys)</th>
<th class="cellalignment528" id="d26736e2960">Initial Deployment ADG (stansys)</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment483">
<td class="cellalignment529" id="d26736e2968" headers="d26736e2954">
<p><span class="bold">Original Deployment:</span></p>
</td>
<td class="cellalignment529" headers="d26736e2968 d26736e2960">&nbsp;</td>
</tr>
<tr class="cellalignment483">
<td class="cellalignment529" id="d26736e2974" headers="d26736e2954">
<pre dir="ltr">
ext1.prm
DBLOGIN USERID <span class="italic">userid</span>@prisys, PASSWORD <span class="italic">password</span>
</pre></td>
<td class="cellalignment529" headers="d26736e2974 d26736e2960">
<pre dir="ltr">
ext1.prm
DBLOGIN USERID <span class="italic">userid</span>@stansys, PASSWORD <span class="italic">password</span>
TRANLOGOPTIONS MINEFROMACTIVEDG
</pre></td>
</tr>
<tr class="cellalignment483">
<td class="cellalignment529" id="d26736e2992" headers="d26736e2954">
<p><span class="bold">Database Related:</span></p>
</td>
<td class="cellalignment529" headers="d26736e2992 d26736e2960">&nbsp;</td>
</tr>
<tr class="cellalignment483">
<td class="cellalignment529" id="d26736e2998" headers="d26736e2954">
<p><span class="underline">After Role Transition: Classic Extract to ADG</span></p>
<ol>
<li>
<p>Edit the <code class="codeph">ext1.prm</code> file to add:</p>
<p><code class="codeph">TRANLOGOPTIONS MINEFROMACTIVEDG</code></p>
</li>
<li>
<p>If a failover, add <code class="codeph">TRANLOGOPTIONS USEPREVRESETLOGSID</code>.</p>
</li>
<li>
<p>Start Extract:</p>
<p><code class="codeph">START EXTRACT ext1</code></p>
<p>Extract will abend once it reaches the role transition point, then it does an internal <code class="codeph">BR_RESET</code> and moves both the I/O checkpoint and current checkpoint to SCN <span class="italic">s</span>.</p>
</li>
<li>
<p>If failover, edit the parameter file again and remove:</p>
<p><code class="codeph">TRANLOGOPTIONS USEPREVRESETLOGSID</code></p>
</li>
<li>
<p>Execute <code class="codeph">ALTER EXTRACT ext1 SCN</code> <code class="codeph">#</code>, where <span class="italic"><code class="codeph">#</code></span> is the SCN value from role switch message.</p>
</li>
<li>
<p>Based on the thread counts, do one of the following:</p>
<p>If the thread counts are same between the databases, then execute the <code class="codeph">START EXTRACT ext1;</code> command.</p>
<p>or</p>
<p>If thread counts are different between the databases, then execute the following commands:</p>
<p><code class="codeph">DROP EXTRACT ext1</code></p>
<p><code class="codeph">ADD EXTRACT ext1 THREADS t BEGIN SCN s</code></p>
<p><code class="codeph">START EXTRACT ext1</code></p>
</li>
</ol>
</td>
<td class="cellalignment529" headers="d26736e2998 d26736e2960">
<p><span class="underline">After Role Transition: ADG to classic Extract</span></p>
<ol>
<li>
<p>Edit <code class="codeph">ext1.prm</code> and remove:</p>
<p><code class="codeph">TRANLOGOPTIONS MINEFROMACTIVEDG</code></p>
</li>
<li>
<p>If a failover, add <code class="codeph">TRANLOGOPTIONS USEPREVRESETLOGSID</code>.</p>
</li>
<li>
<p>Start Extract:</p>
<p><code class="codeph">START EXTRACT ext1</code></p>
<p>Extract will abend once it reaches the role transition point, then it does an internal <code class="codeph">BR_RESET</code> and moves both the I/O checkpoint and current checkpoint to SCN <span class="italic">s</span>.</p>
</li>
<li>
<p>If failover, edit the parameter file again and remove:</p>
<p><code class="codeph">TRANLOGOPTIONS USEPREVRESETLOGSID</code></p>
</li>
<li>
<p>Execute <code class="codeph">ALTER EXTRACT ext1 SCN</code> <span class="italic"><code class="codeph">#</code></span>, where <span class="italic"><code class="codeph">#</code></span> is the SCN value from role switch message.</p>
</li>
<li>
<p>Based on the thread counts, do one of the following:</p>
<p>If the thread counts are same between the databases, then execute the <code class="codeph">START EXTRACT ext1;</code> command.</p>
<p>or</p>
<p>If thread counts are different between the databases, then execute the following commands:</p>
<p><code class="codeph">DROP EXTRACT ext1</code></p>
<p><code class="codeph">ADD EXTRACT ext1 THREADS t BEGIN SCN s</code></p>
<p><code class="codeph">START EXTRACT ext1</code></p>
</li>
</ol>
</td>
</tr>
<tr class="cellalignment483">
<td class="cellalignment529" id="d26736e3148" headers="d26736e2954">
<p><span class="bold">Role Related:</span></p>
</td>
<td class="cellalignment529" headers="d26736e3148 d26736e2960">&nbsp;</td>
</tr>
<tr class="cellalignment483">
<td class="cellalignment529" id="d26736e3154" headers="d26736e2954">
<p><span class="underline">After Role Transition: Classic Extract to classic Extract</span></p>
<ol>
<li>
<p>Edit <code class="codeph">ext1.prm</code> to change the database system to the standby system:</p>
<p><code class="codeph">DBLOGIN USERID userid@stansys, PASSWORD</code> <span class="italic"><code class="codeph">password</code></span></p>
</li>
<li>
<p>If a failover, add <code class="codeph">TRANLOGOPTIONS USEPREVRESETLOGSID</code>.</p>
</li>
<li>
<p>Start Extract:</p>
<p><code class="codeph">START EXTRACT ext1</code></p>
<p>Extract will abend once it reaches the role transition point, then it does an internal <code class="codeph">BR_RESET</code> and moves both the I/O checkpoint and current checkpoint to SCN s.</p>
</li>
<li>
<p>If failover, edit the parameter file again and remove:</p>
<p><code class="codeph">TRANLOGOPTIONS USEPREVRESETLOGSID</code></p>
</li>
<li>
<p>Execute <code class="codeph">ALTER EXTRACT ext1 SCN</code> <span class="italic"><code class="codeph">#</code></span>, where<span class="italic"><code class="codeph">#</code></span> is the SCN value from role switch message.</p>
</li>
<li>
<p>Based on the thread counts, do one of the following:</p>
<p>If the thread counts are same between the databases, then execute the <code class="codeph">START EXTRACT ext1;</code> command.</p>
<p>or</p>
<p>If thread counts are different between the databases, then execute the following commands:</p>
<p><code class="codeph">DROP EXTRACT ext1</code></p>
<p><code class="codeph">ADD EXTRACT ext1 THREADS t BEGIN SCN s</code></p>
<p><code class="codeph">START EXTRACT ext1</code></p>
</li>
</ol>
</td>
<td class="cellalignment529" headers="d26736e3154 d26736e2960">
<p><span class="underline">After Role Transition: ADG to ADG</span></p>
<ol>
<li>
<p>Edit <code class="codeph">ext1.prm</code> to change the database system to the primary system:</p>
<p><code class="codeph">DBLOGIN USERID userid@prisys, PASSWORD</code> <span class="italic"><code class="codeph">password</code></span></p>
</li>
<li>
<p>If a failover, add <code class="codeph">TRANLOGOPTIONS USEPREVRESETLOGSID</code>.</p>
</li>
<li>
<p>Start Extract:</p>
<p><code class="codeph">START EXTRACT ext1</code></p>
<p>Extract will abend once it reaches the role transition point, then it does an internal <code class="codeph">BR_RESET</code> and moves both the I/O checkpoint and current checkpoint to SCN <span class="italic">s</span>.</p>
</li>
<li>
<p>If failover, edit the parameter file again and remove:</p>
<p><code class="codeph">TRANLOGOPTIONS USEPREVRESETLOGSID</code></p>
</li>
<li>
<p>Execute <code class="codeph">ALTER EXTRACT ext1 SCN</code> <span class="italic"><code class="codeph">#</code></span>, where<span class="italic"><code class="codeph">#</code></span> is the SCN value from role switch message.</p>
</li>
<li>
<p>Based on the thread counts, do one of the following:</p>
<p>If the thread counts are same between the databases, then execute the <code class="codeph">START EXTRACT ext1;</code> command.</p>
<p>or</p>
<p>If thread counts are different between the databases, then execute the following commands:</p>
<p><code class="codeph">DROP EXTRACT ext1</code></p>
<p><code class="codeph">ADD EXTRACT ext1 THREADS t BEGIN SCN s</code></p>
<p><code class="codeph">START EXTRACT ext1</code></p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-F2B9181C-791B-4950-8A66-D9B8AE39EFC8">Configuring Classic Capture in Oracle Active Data Guard Only Mode</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-81D9AF8E-BCC0-4F2D-9058-2C3D89C8EDBD"></a>
<h2 id="GGODB-GUID-81D9AF8E-BCC0-4F2D-9058-2C3D89C8EDBD" class="sect2"><span class="enumeration_section">10.7</span> Avoiding Log-read Bottlenecks in Classic Capture</h2>
<div>
<div class="section">
<p>When Oracle GoldenGate captures data from the redo logs, I/O bottlenecks can occur because Extract is reading the same files that are being written by the database logging mechanism. Performance degradation increases with the number of Extract processes that read the same logs. You can:</p>
<ul style="list-style-type: disc;">
<li>
<p>Try using faster drives and a faster controller. Both Extract and the database logging mechanism will be faster on a faster I/O system.</p>
</li>
<li>
<p>Store the logs on RAID 0+1. Avoid RAID 5, which performs checksums on every block written and is not a good choice for high levels of continuous I/O.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="additional-configuration-steps-using-classic-capture.htm#GUID-139116DA-90DB-40C9-B0DA-48FC7C465BEC" title="This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in classic capture mode.">Additional Configuration Steps for Using Classic Capture</a></p>
</div>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment482">
<tr>
<td class="cellalignment492">
<table class="cellalignment487">
<tr>
<td class="cellalignment486"><a href="additional-oracle-goldengate-configuration-considerations.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment486"><a href="additional-configuration-steps-using-nonintegrated-replicat.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2010, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment494">
<table class="cellalignment485">
<tr>
<td class="cellalignment486"><a href="http://docs.oracle.com/goldengate/c1230/gg-winux/index.html"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment486"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment486"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
</body>
</html>
