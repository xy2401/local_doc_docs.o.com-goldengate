<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Using the Metadata Provider</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2017-09-08T08:33:14Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Integrating Oracle GoldenGate for Big Data" />
<meta name="dcterms.identifier" content="E89478-02" />
<meta name="dcterms.isVersionOf" content="GADBD" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2015, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="using-mongodb-handler.htm" title="Previous" type="text/html" />
<link rel="Next" href="using-pluggable-formatters.htm" title="Next" type="text/html" />
<link rel="alternate" href="GADBD.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65"></a> <span id="PAGE" style="display:none;">15/24</span> <!-- End Header -->
<a id="GADBD570"></a><a id="GADBD569"></a>
<h1 id="GADBD-GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65" class="sect1"><span class="enumeration_chapter">12</span> Using the Metadata Provider</h1>
<div>
<p>This chapter explains the Metadata Provider functionality, different types of Metadata Providers, and examples that can be used to understand the functionality.</p>
<p><span class="bold">Topics:</span></p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-8D813797-6C3B-4037-AB28-A02E79710080">About the Metadata Provider</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-737CF013-FC71-4D10-8F03-709A6D86096F">Avro Metadata Provider</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-DB549C6D-6B63-49BD-AFFA-99B7897E0446">Java Database Connectivity Metadata Provider</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-B68DF414-3FE0-4C0D-B13B-BC9A024DABD5">Hive Metadata Provider</a><br /></li>
</ul>
</div>
<div class="sect2"><a id="GUID-8D813797-6C3B-4037-AB28-A02E79710080"></a>
<h2 id="GADBD-GUID-8D813797-6C3B-4037-AB28-A02E79710080" class="sect2"><span class="enumeration_section">12.1</span> About the Metadata Provider</h2>
<div>
<p>The Metadata Provider is valid only if handlers are configured to run with a Replicat process.</p>
<p>The Replicat process provides functionality to perform source table to target table and source column to target column mapping using syntax in the Replicat configuration file. The source metadata definitions are included in the Oracle GoldenGate trail file (or by source definitions files for Oracle GoldenGate releases 12.2 and later). When the replication target is a database, the Replicat process obtains the target metadata definitions from the target database. However, this is a shortcoming when pushing data to Big Data applications or Java Delivery in general. Big Data applications generally provide no target metadata so the Replicat mapping is not possible. The Metadata Provider exists to address this deficiency. The Metadata Provider can be used to define target metadata using either Avro or Hive which in turn enables source table to target table and source column to target column Replicat mapping.</p>
<p>The use of the Metadata Provider is optional and is enabled if the <code class="codeph">gg.mdp.type</code> property is specified in the Java Adapter Properties file.. If the metadata included in the source Oracle GoldenGate trail file is acceptable for the output, then do not use the Metadata Provider. The Metadata Provider should be used in the following cases:</p>
<ul style="list-style-type: disc;">
<li>
<p>The requirement is for mapping source table names into target table names that do not match.</p>
</li>
<li>
<p>The requirement is for mapping of source column names into target column name that do not match.</p>
</li>
<li>
<p>The requirement is for the inclusion of certain columns from the source trail file and omitting other columns.</p>
</li>
</ul>
<p>Replicat mapping has a general limitation in that the mapping defined in the Replicat configuration file is static. Oracle GoldenGate 12.2 and later provides functionality for DDL propagation when using an Oracle Database as the source. The proper handling of schema evolution can be problematic when the Metadata Provider and Replicat mapping are being used. You should consider your use cases for schema evolution and plan for how you want to update the Metadata Provider and the Replicat mapping syntax for required changes.</p>
<p>For every table mapped in <code class="codeph">REPLICAT</code> using <code class="codeph">COLMAP</code>, the metadata will be retrieved from a configured metadata provider and retrieved metadata will then be used by <code class="codeph">REPLICAT</code> for column mapping functionality.</p>
<p>You have choice of configuring one Metadata Provider implementation. Currently Hive and Avro Metadata Providers are supported.</p>
<div class="section">
<p class="subhead2">Scenarios - When to use Metadata Provider</p>
</div>
<!-- class="section" -->
<ol>
<li>
<p>The following scenarios do <span class="italic">not</span> require the Metadata Provider to be configured:</p>
<p>The mapping of schema name whereby the source schema named <code class="codeph">GG</code> is mapped to the target schema named <code class="codeph">GGADP</code>.*</p>
<p>The mapping of schema and table name whereby the schema <code class="codeph">GG.TCUSTMER</code> is mapped to the table name <code class="codeph">GGADP.TCUSTMER_NEW</code></p>
<pre dir="ltr">
MAP GG.*, TARGET GGADP.*;
(OR)
MAP GG.TCUSTMER, TARGET GG_ADP.TCUSTMER_NEW;
</pre></li>
<li>
<p>The following scenario requires Metadata Provider to be configured:</p>
<p>The mapping of column names whereby the source column name does not match the target column name. For example source column <code class="codeph">CUST_CODE</code> mapped to target column <code class="codeph">CUST_CODE_NEW</code></p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_ADP.TCUSTMER_NEW, COLMAP(USEDEFAULTS, CUST_CODE_NEW=CUST_CODE, CITY2=CITY);
</pre></li>
</ol>
</div>
</div>
<a id="GADBD571"></a>
<div class="props_rev_3"><a id="GUID-737CF013-FC71-4D10-8F03-709A6D86096F"></a>
<h2 id="GADBD-GUID-737CF013-FC71-4D10-8F03-709A6D86096F" class="sect2"><span class="enumeration_section">12.2</span> Avro Metadata Provider</h2>
<div>
<p>The Avro Metadata Provider is used to retrieve the table metadata from Avro Schema files. For every table mapped in Replicat using <code class="codeph">COLMAP</code>, the metadata will be retrieved from Avro Schema and retrieved metadata will then be used by Replicat for column mapping.</p>
<p><span class="bold">Topics:</span></p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-3DDEF373-5995-464A-9D40-43614D55F59D">Detailed Functionality</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-0BBA0061-FF79-4891-B17D-3092DA4B275C">Runtime Prerequisites</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-6DB2B303-636D-4B10-A075-D4A2FA624711">Classpath Configuration</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B">Avro Metadata Provider Configuration</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-BCFE0447-C562-4BDC-814B-58BB2928DBA0">Sample Configuration</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-2B8DD4B9-CA20-41DA-BDA0-1E0F921E8B64">Metadata Change Event</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-97F91AE5-1461-41AC-98B6-50890313AC19">Limitations</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-2EE6F213-BB7B-4D02-9FD3-BD84084C8CD9">Troubleshooting</a><br /></li>
</ul>
</div>
<a id="GADBD573"></a><a id="GADBD574"></a><a id="GADBD572"></a>
<div class="props_rev_3"><a id="GUID-3DDEF373-5995-464A-9D40-43614D55F59D"></a>
<h3 id="GADBD-GUID-3DDEF373-5995-464A-9D40-43614D55F59D" class="sect3"><span class="enumeration_section">12.2.1</span> Detailed Functionality</h3>
<div>
<div class="section">
<p>The Avro Metadata Provider uses Avro schema definition files to retrieve metadata. The Avro schemas are defined using the JSON. For each table mapped in <code class="codeph"><span class="codeinlineitalic">process_name.</span>prm</code> file, a corresponding The Avro schema definition file should be created. More information on defining Avro schemas is found at:</p>
<p><a href="http://avro.apache.org/docs/current/gettingstartedjava.html#Defining+a+schema" target="_blank"><code class="codeph">http://avro.apache.org/docs/current/gettingstartedjava.html#Defining+a+schema</code></a></p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Avro Metadata Provider Schema definition syntax:</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">
{"namespace": "[$catalogname.]$schemaname",
"type": "record",
"name": "$tablename",
"fields": [
     {"name": "$col1", "type": "$datatype"},
     {"name": "$col2 ",  "type": "$datatype ", "primary_key":true}, 
     {"name": "$col3", "type": "$datatype ", "primary_key":true}, 
     {"name": "$col4", "type": ["$datatype","null"]}   
   ]
}
 
namespace            - name of catalog/schema being mapped
name                 - name of the table being mapped
fields.name          - array of column names
fields.type          - datatype of the column
fields.primary_key   - indicates the column is part of primary key.

Representing nullable and not nullable columns:

"type":"$datatype" - indicates the column is not nullable, where "$datatype" is the actual datatype.
"type": ["$datatype","null"] - indicates the column is nullable, where "$datatype" is the actual datatype
</pre>
<p>The file naming convention for Avro schema files accessed by the Avro Metadata Provider must be in the following format:</p>
<pre dir="ltr">
[$catalogname.]$schemaname.$tablename.mdp.avsc
 
$catalogname    - name of the catalog if exists
$schemaname   - name of the schema
$tablename        - name of the table
.mdp.avsc           -  constant, which should be appended always
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Supported Avro Data Types:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>boolean</p>
</li>
<li>
<p>bytes</p>
</li>
<li>
<p>double</p>
</li>
<li>
<p>float</p>
</li>
<li>
<p>int</p>
</li>
<li>
<p>long</p>
</li>
<li>
<p>string</p>
</li>
</ul>
<p>For more information on Avro data types, see <a href="https://avro.apache.org/docs/1.7.5/spec.html#schema_primitive" target="_blank"><code class="codeph">https://avro.apache.org/docs/1.7.5/spec.html#schema_primitive</code></a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD575"></a>
<div class="props_rev_3"><a id="GUID-0BBA0061-FF79-4891-B17D-3092DA4B275C"></a>
<h3 id="GADBD-GUID-0BBA0061-FF79-4891-B17D-3092DA4B275C" class="sect3"><span class="enumeration_section">12.2.2</span> Runtime Prerequisites</h3>
<div>
<div class="section">
<p>The Avro schema definitions should be created for all tables mapped in Replicat's parameter file before starting the Replicat process.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD576"></a>
<div class="props_rev_3"><a id="GUID-6DB2B303-636D-4B10-A075-D4A2FA624711"></a>
<h3 id="GADBD-GUID-6DB2B303-636D-4B10-A075-D4A2FA624711" class="sect3"><span class="enumeration_section">12.2.3</span> Classpath Configuration</h3>
<div>
<div class="section">
<p>There is no additional classpath setting required for Avro Metadata Provider.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD577"></a>
<div class="props_rev_3"><a id="GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B"></a>
<h3 id="GADBD-GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B" class="sect3"><span class="enumeration_section">12.2.4</span> Avro Metadata Provider Configuration</h3>
<div>
<div class="section">
<p>The configuration properties of Oracle GoldenGate Avro Metadata Provider are detailed in this section.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B__GUID-8322C613-8A8E-4014-B559-6D08AB2F0F88">
<table class="cellalignment77" summary="Five column table describing the configuration properties of the Avro Metadata Provider.">
<thead>
<tr class="cellalignment62">
<th class="cellalignment71" id="d38976e356">Property</th>
<th class="cellalignment70" id="d38976e360">Required/Optional</th>
<th class="cellalignment97" id="d38976e367">Legal Values</th>
<th class="cellalignment71" id="d38976e371">Default</th>
<th class="cellalignment97" id="d38976e375">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment62">
<td class="cellalignment75" id="d38976e381" headers="d38976e356">
<p><code class="codeph">gg.mdp.type</code></p>
</td>
<td class="cellalignment74" headers="d38976e381 d38976e360">
<p>Required</p>
</td>
<td class="cellalignment99" headers="d38976e381 d38976e367">
<p><code class="codeph">avro</code></p>
</td>
<td class="cellalignment75" headers="d38976e381 d38976e371">
<p><code class="codeph">-</code></p>
</td>
<td class="cellalignment99" headers="d38976e381 d38976e375">
<p>Selects the Avro Metadata Provider</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment75" id="d38976e400" headers="d38976e356">
<p><code class="codeph">gg.mdp.schemaFilesPath</code></p>
</td>
<td class="cellalignment74" headers="d38976e400 d38976e360">
<p>Required</p>
</td>
<td class="cellalignment99" headers="d38976e400 d38976e367">
<p>Example for a legal value could be <code class="codeph">/home/user/ggadp/avroschema/</code></p>
</td>
<td class="cellalignment75" headers="d38976e400 d38976e371">
<p><code class="codeph">-</code></p>
</td>
<td class="cellalignment99" headers="d38976e400 d38976e375">
<p>Path to Avro schema files directory</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment75" id="d38976e420" headers="d38976e356">
<p><code class="codeph">gg.mdp.charset</code></p>
</td>
<td class="cellalignment74" headers="d38976e420 d38976e360">
<p>Optional</p>
</td>
<td class="cellalignment99" headers="d38976e420 d38976e367">
<p>Valid character set</p>
</td>
<td class="cellalignment75" headers="d38976e420 d38976e371">
<p><code class="codeph">UTF-8</code></p>
</td>
<td class="cellalignment99" headers="d38976e420 d38976e375">
<p>Specifies the character set of the column with character data type. This is used to convert the source data from trail file to the correct target character set.</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment75" id="d38976e438" headers="d38976e356">
<p><code class="codeph">gg.mdp.nationalCharse</code><code class="codeph">t</code></p>
</td>
<td class="cellalignment74" headers="d38976e438 d38976e360">
<p>Optional</p>
</td>
<td class="cellalignment99" headers="d38976e438 d38976e367">
<p>Valid character set</p>
</td>
<td class="cellalignment75" headers="d38976e438 d38976e371">
<p><code class="codeph">UTF-8</code></p>
</td>
<td class="cellalignment99" headers="d38976e438 d38976e375">
<p>Specifies the character set of the column with character data type. This is used to convert the source data from trail file to the correct target character set.</p>
<p>Example: Indicates character set of columns like <code class="codeph">NCHAR</code>, <code class="codeph">NVARCHAR</code>with an Oracle Database.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD578"></a>
<div class="props_rev_3"><a id="GUID-BCFE0447-C562-4BDC-814B-58BB2928DBA0"></a>
<h3 id="GADBD-GUID-BCFE0447-C562-4BDC-814B-58BB2928DBA0" class="sect3"><span class="enumeration_section">12.2.5</span> Sample Configuration</h3>
<div>
<div class="section">
<p>This section provides an example for configuring the Avro Metadata Provider. Consider a source with following table:</p>
<pre dir="ltr">
TABLE GG.TCUSTMER {
     CUST_CODE VARCHAR(4) PRIMARY KEY,
     NAME VARCHAR(100),
     CITY VARCHAR(200),
     STATE VARCHAR(200)
}
</pre>
<p>Mapping column<code class="codeph">CUST_CODE (GG.TCUSTMER)</code> in source to <code class="codeph">CUST_CODE2 (GG_AVRO.TCUSTMER_AVRO)</code> on target and column <code class="codeph">CITY</code> <code class="codeph">(GG.TCUSTMER)</code> in source to <code class="codeph">CITY2</code> <code class="codeph">(GG_AVRO.TCUSTMER_AVRO)</code> on target. Thus, the mapping in <code class="codeph"><span class="codeinlineitalic">process_name.</span>prm</code> file is:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, CUST_CODE2=CUST_CODE, CITY2=CITY);
 
</pre>
<p>Mapping definition in this example:</p>
<ul style="list-style-type: disc;">
<li>
<p>Source schema <code class="codeph">GG</code> is mapped to target schema <code class="codeph">GG_AVRO</code>.</p>
</li>
<li>
<p>Source column <code class="codeph">CUST_CODE</code> is mapped to target column <code class="codeph">CUST_CODE2</code>.</p>
</li>
<li>
<p>Source column <code class="codeph">CITY</code> is mapped to target column <code class="codeph">CITY2</code>.</p>
</li>
<li>
<p><code class="codeph">USEDEFAULTS</code> specifies that rest of the columns names are same on both source and target (<code class="codeph">NAME</code> and <code class="codeph">STATE</code> columns).</p>
</li>
</ul>
<p>The Avro schema definition file for the preceding example:</p>
<p>File path: <code class="codeph">/home/ggadp/avromdpGG_AVRO.TCUSTMER_AVRO.mdp.avsc</code></p>
<pre dir="ltr">
{"namespace": "GG_AVRO",
"type": "record",
"name": "TCUSTMER_AVRO",
"fields": [
     {"name": "NAME", "type": "string"},
    {"name": "CUST_CODE2",  "type": "string", "primary_key":true},
     {"name": "CITY2", "type": "string"},
     {"name": "STATE", "type": ["string","null"]}
]
}
</pre>
<p>The configuration in the Java Adapter properties file includes the following:</p>
<pre dir="ltr">
gg.mdp.type = avro
gg.mdp.schemaFilesPath = /home/ggadp/avromdp
</pre>
<p>Following is the sample output using delimited text formatter with a semi-colon as the delimiter for the preceding example.</p>
<pre dir="ltr">
I;GG_AVRO.TCUSTMER_AVRO;2013-06-02 22:14:36.000000;NAME;BG SOFTWARE CO;CUST_CODE2;WILL;CITY2;SEATTLE;STATE;WA
</pre>
<p>The Oracle GoldenGate for Big Data installation include a sample Replicat configuration file, a sample Java Adapter properties file, and sample Avro schemas at:</p>
<p><span class="italic"><code class="codeph">GoldenGate_install_directory</code></span><code class="codeph">/AdapterExamples/big-data/metadata_provider/avro</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD579"></a>
<div class="props_rev_3"><a id="GUID-2B8DD4B9-CA20-41DA-BDA0-1E0F921E8B64"></a>
<h3 id="GADBD-GUID-2B8DD4B9-CA20-41DA-BDA0-1E0F921E8B64" class="sect3"><span class="enumeration_section">12.2.6</span> Metadata Change Event</h3>
<div>
<div class="section">
<p>The Avro schema definitions and the mappings in the Replicat configuration file may need to be modified if there is a DDL change in the source database tables. You may want to stop or suspend the Replicat process in the case of a metadata change event. The Replicat process can be stopped by adding the following to the Replicat configuration file (<code class="codeph"><span class="codeinlineitalic">process_name.</span>prm</code>):</p>
<p><code class="codeph">DDL INCLUDE ALL, EVENTACTIONS (ABORT)</code></p>
<p>Alternatively, the Replicat process can be suspended by adding the following to the Replication configuration file.</p>
<p><code class="codeph">DDL INCLUDE ALL, EVENTACTIONS (SUSPEND)</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD580"></a>
<div class="props_rev_3"><a id="GUID-97F91AE5-1461-41AC-98B6-50890313AC19"></a>
<h3 id="GADBD-GUID-97F91AE5-1461-41AC-98B6-50890313AC19" class="sect3"><span class="enumeration_section">12.2.7</span> Limitations</h3>
<div>
<div class="section">
<p>Avro bytes data type cannot be used as primary key.</p>
<p>The source to target mapping defined in the Replicat configuration file is static. Oracle GoldenGate 12.2 and later supports DDL propagation and source schema evolution for Oracle Databases as the replication source. However, evolution of the source schemas may be problematic the static mapping configured in the Replicat configuration file.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD581"></a>
<div class="props_rev_3"><a id="GUID-2EE6F213-BB7B-4D02-9FD3-BD84084C8CD9"></a>
<h3 id="GADBD-GUID-2EE6F213-BB7B-4D02-9FD3-BD84084C8CD9" class="sect3"><span class="enumeration_section">12.2.8</span> Troubleshooting</h3>
<div>
<p><span class="bold">Topics:</span></p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-91CF5CB4-627F-4E56-AF3C-BB72750B753E">Invalid Schema Files Location</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-9854F8C8-44C0-4F16-B3C0-54E5D32BCFD9">Invalid Schema File Name</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-9893F974-4F15-443A-BFBA-23CC5BCEA237">Invalid Namespace in Schema File</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-AAA0ADE9-1BC0-4C7D-A0A4-6F42A08684E4">Invalid Table Name in Schema File</a><br /></li>
</ul>
</div>
<a id="GADBD582"></a>
<div class="props_rev_3"><a id="GUID-91CF5CB4-627F-4E56-AF3C-BB72750B753E"></a>
<h4 id="GADBD-GUID-91CF5CB4-627F-4E56-AF3C-BB72750B753E" class="sect4"><span class="enumeration_section">12.2.8.1</span> Invalid Schema Files Location</h4>
<div>
<div class="section">
<p>The Avro schema files directory location specified by the configuration property <code class="codeph">gg.mdp.schemaFilesPath</code> should be a valid directory. Failure to configure a valid directory in <code class="codeph">gg.mdp.schemaFilesPath</code> property leads to following exception:</p>
<pre dir="ltr">
oracle.goldengate.util.ConfigException: Error initializing Avro metadata provider
Specified schema location does not exist. {/path/to/schema/files/dir}
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD583"></a>
<div class="props_rev_3"><a id="GUID-9854F8C8-44C0-4F16-B3C0-54E5D32BCFD9"></a>
<h4 id="GADBD-GUID-9854F8C8-44C0-4F16-B3C0-54E5D32BCFD9" class="sect4"><span class="enumeration_section">12.2.8.2</span> Invalid Schema File Name</h4>
<div>
<div class="section">
<p>For every table mapped in the <code class="codeph"><span class="codeinlineitalic">process_name.</span>prm</code> file, a corresponding Avro schema file must be created in the directory specified in <code class="codeph">gg.mdp.schemaFilesPath</code>.</p>
<p>For example, consider the following scenario:</p>
<p>Mapping:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, cust_code2=cust_code, CITY2 = CITY);
 
</pre>
<p>Property:</p>
<pre dir="ltr">
gg.mdp.schemaFilesPath=/home/usr/avro/
</pre>
<p>A file called <code class="codeph">GG_AVRO.TCUSTMER_AVRO.mdp.avsc</code> must be created in the <code class="codeph">/home/usr/avro/</code> directory. that is, <code class="codeph">/home/usr/avro/GG_AVRO.TCUSTMER_AVRO.mdp.avsc</code></p>
<p>Failing to create the <code class="codeph">/home/usr/avro/GG_AVRO.TCUSTMER_AVRO.mdp.avsc</code> file results in the following exception:</p>
<pre dir="ltr">
java.io.FileNotFoundException: /home/usr/avro/GG_AVRO.TCUSTMER_AVRO.mdp.avsc
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD584"></a>
<div class="props_rev_3"><a id="GUID-9893F974-4F15-443A-BFBA-23CC5BCEA237"></a>
<h4 id="GADBD-GUID-9893F974-4F15-443A-BFBA-23CC5BCEA237" class="sect4"><span class="enumeration_section">12.2.8.3</span> Invalid Namespace in Schema File</h4>
<div>
<div class="section">
<p>The target schema name specified in <code class="codeph">REPLICAT</code> mapping must be same as namespace in the Avro schema definition file.</p>
<p>For example, consider the following scenario:</p>
<p><span class="bold">Mapping</span>:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, cust_code2 = cust_code, CITY2 = CITY);
 
Avro Schema Definition:
 
{
"namespace": "GG_AVRO",
..
}
</pre>
<p>In this scenario, <code class="codeph">REPLICAT</code> abends with following exception if the target schema name specified in Replicat mapping does not match with Avro schema namespace:</p>
<pre dir="ltr">
Unable to retrieve table matadata. Table : GG_AVRO.TCUSTMER_AVRO
Mapped [catalogname.]schemaname (GG_AVRO) does not match with the schema namespace {schema namespace}
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD585"></a>
<div class="props_rev_3"><a id="GUID-AAA0ADE9-1BC0-4C7D-A0A4-6F42A08684E4"></a>
<h4 id="GADBD-GUID-AAA0ADE9-1BC0-4C7D-A0A4-6F42A08684E4" class="sect4"><span class="enumeration_section">12.2.8.4</span> Invalid Table Name in Schema File</h4>
<div>
<div class="section">
<p>The target table name specified in Replicat mapping must be same as name in the Avro schema definition file.</p>
<p>For example, consider the following scenario:</p>
<p>Mapping:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, cust_code2 = cust_code, CITY2 = CITY);
</pre>
<p>Avro Schema Definition:</p>
<pre dir="ltr">
{
"namespace": "GG_AVRO",
"name": "TCUSTMER_AVRO",
..
}
</pre>
<p>In this scenario, <code class="codeph">REPLICAT</code> abends with following exception if the target table name specified in Replicat mapping does not match with Avro schema name.</p>
<pre dir="ltr">
Unable to retrieve table matadata. Table : GG_AVRO.TCUSTMER_AVRO
Mapped table name (TCUSTMER_AVRO) does not match with the schema table name {table name}
</pre></div>
<!-- class="section" --></div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-DB549C6D-6B63-49BD-AFFA-99B7897E0446"></a>
<h2 id="GADBD-GUID-DB549C6D-6B63-49BD-AFFA-99B7897E0446" class="sect2"><span class="enumeration_section">12.3</span> Java Database Connectivity Metadata Provider</h2>
<div>
<p>The Java Database Connectivity (JDBC) Metadata Provider is used to retrieve the table metadata from any target database that supports a JDBC connection and has a database schema. The JDBC Metadata Provider should be the preferred metadata provider for any target database that is an RDBMS, although there are various other non-RDBMS targets that also provide a JDBC driver</p>
<p><span class="bold">Topics:</span></p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-73D77AFF-7DE6-4B59-8876-00B151AFAE74">JDBC Detailed Functionality</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-2CE6B1B1-7589-4A03-9757-3C69BE1171C2">Java Classpath</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-E11DF6E2-6B08-4DF2-A214-723B03585914">JDBC Metadata Provider Configuration</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-A4FA5A42-4557-4824-9DEB-3BDDCFD1AA5D">Sample Configuration</a><br /></li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-73D77AFF-7DE6-4B59-8876-00B151AFAE74"></a>
<h3 id="GADBD-GUID-73D77AFF-7DE6-4B59-8876-00B151AFAE74" class="sect3"><span class="enumeration_section">12.3.1</span> JDBC Detailed Functionality</h3>
<div>
<div class="section">
<p>The JDBC Metadata Provider uses the JDBC Driver provided with your target database. The metadata is retrieved using the JDBC Driver for every target table mapped in the Replicat properties file. Replicat processes use the retrieved target metadata for the column mapping functionality.</p>
<p>You can enable this feature for JDBC Handler by configuring the <code class="codeph">REPERROR</code> in your Replicat parameter file. In addition, you need to define the error codes specific to your RDBMS JDBC target in the JDBC Handler properties file as follows:</p>
<div class="tblformal" id="GUID-73D77AFF-7DE6-4B59-8876-00B151AFAE74__GUID-072A8835-B2B4-47B3-ACBC-B27C38EB019C">
<p class="titleintable">Table 12-1 JDBC <code class="codeph">REPERROR</code> Codes</p>
<table class="cellalignment77" title="JDBC REPERROR Codes" summary="A three column table detailing the REPERROR error codes.">
<thead>
<tr class="cellalignment62">
<th class="cellalignment78" id="d38976e925">Property</th>
<th class="cellalignment78" id="d38976e927">Value</th>
<th class="cellalignment78" id="d38976e929">Required</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment62">
<td class="cellalignment62" id="d38976e933" headers="d38976e925">
<pre dir="ltr">
gg.error.duplicateErrorCodes
</pre></td>
<td class="cellalignment62" headers="d38976e933 d38976e927">
<p>Comma-separated integer values of error codes that mean duplicate errors</p>
</td>
<td class="cellalignment62" headers="d38976e933 d38976e929">
<p>No</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment62" id="d38976e943" headers="d38976e925">
<pre dir="ltr">
gg.error.notFoundErrorCodes
</pre></td>
<td class="cellalignment62" headers="d38976e943 d38976e927">
<p>Comma-separated integer values of error codes that mean duplicate errors</p>
</td>
<td class="cellalignment62" headers="d38976e943 d38976e929">
<p>No</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment62" id="d38976e953" headers="d38976e925">
<pre dir="ltr">
gg.error.deadlockErrorCodes 
</pre></td>
<td class="cellalignment62" headers="d38976e953 d38976e927">
<p>Comma-separated integer values of error codes that mean duplicate errors</p>
</td>
<td class="cellalignment62" headers="d38976e953 d38976e929">
<p>No</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>For example:</p>
<pre dir="ltr">
#ErrorCode
gg.error.duplicateErrorCodes=1062,1088,1092,1291,1330,1331,1332,1333
gg.error.notFoundErrorCodes=0
gg.error.deadlockErrorCodes=1213
</pre>
<p>To understand how the various JDBC types are mapped to database-specific SQL types, review the specifics at:</p>
<p><a href="https://docs.oracle.com/javase/6/docs/technotes/guides/jdbc/getstart/mapping.html#table1" target="_blank">https://docs.oracle.com/javase/6/docs/technotes/guides/jdbc/getstart/mapping.html#table1</a></p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-2CE6B1B1-7589-4A03-9757-3C69BE1171C2"></a>
<h3 id="GADBD-GUID-2CE6B1B1-7589-4A03-9757-3C69BE1171C2" class="sect3"><span class="enumeration_section">12.3.2</span> Java Classpath</h3>
<div>
<p>The JDBC Java Driver location must be included in the class path of the handler using the <code class="codeph">gg.classpath</code> property.</p>
<p>For example, the configuration for a MySQL database could be:</p>
<pre dir="ltr">
gg.classpath= /path/to/jdbc/driver/jar/mysql-connector-java-5.1.39-bin.jar
</pre></div>
</div>
<div class="props_rev_3"><a id="GUID-E11DF6E2-6B08-4DF2-A214-723B03585914"></a>
<h3 id="GADBD-GUID-E11DF6E2-6B08-4DF2-A214-723B03585914" class="sect3"><span class="enumeration_section">12.3.3</span> JDBC Metadata Provider Configuration</h3>
<div>
<div class="section">
<p>The following are the configurable values for the JDBC Metadata Provider. These properties are located in the Java Adapter properties file (not in the Replicat properties file).</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-E11DF6E2-6B08-4DF2-A214-723B03585914__GUID-2F0D04A3-FC62-428E-A3AC-44349A09933F">
<p class="titleintable">Table 12-2 JDBC Metadata Provider Properties</p>
<table class="cellalignment77" title="JDBC Metadata Provider Properties" summary="JDBC Metadata Provider Properties">
<thead>
<tr class="cellalignment62">
<th class="cellalignment87" id="d38976e1028">Properties</th>
<th class="cellalignment88" id="d38976e1031">Required/ Optional</th>
<th class="cellalignment89" id="d38976e1034">Legal Values</th>
<th class="cellalignment90" id="d38976e1037">Default</th>
<th class="cellalignment91" id="d38976e1040">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment62">
<td class="cellalignment92" id="d38976e1045" headers="d38976e1028">
<p><code class="codeph">gg.mdp.type</code></p>
</td>
<td class="cellalignment93" headers="d38976e1045 d38976e1031">
<p>Required</p>
</td>
<td class="cellalignment94" headers="d38976e1045 d38976e1034">
<p><code class="codeph">jdbc</code></p>
</td>
<td class="cellalignment95" headers="d38976e1045 d38976e1037">
<p>None</p>
</td>
<td class="cellalignment96" headers="d38976e1045 d38976e1040">
<p>Entering <code class="codeph">jdbc</code> at a command prompt activates the use of the JDBC Metadata Provider.</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment92" id="d38976e1066" headers="d38976e1028">
<p><code class="codeph">gg.mdp.ConnectionUrl</code></p>
</td>
<td class="cellalignment93" headers="d38976e1066 d38976e1031">
<p>Required</p>
</td>
<td class="cellalignment94" headers="d38976e1066 d38976e1034">
<p><code class="codeph">jdbc:<span class="codeinlineitalic">subprotocol</span>:<span class="codeinlineitalic">subname</span></code></p>
</td>
<td class="cellalignment95" headers="d38976e1066 d38976e1037">
<p>None</p>
</td>
<td class="cellalignment96" headers="d38976e1066 d38976e1040">
<p>The target database JDBC URL.</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment92" id="d38976e1089" headers="d38976e1028">
<p><code class="codeph">gg.mdp.DriverClassName</code></p>
</td>
<td class="cellalignment93" headers="d38976e1089 d38976e1031">
<p>Required</p>
</td>
<td class="cellalignment94" headers="d38976e1089 d38976e1034">
<p>Java class name of the JDBC driver</p>
</td>
<td class="cellalignment95" headers="d38976e1089 d38976e1037">
<p>None</p>
</td>
<td class="cellalignment96" headers="d38976e1089 d38976e1040">
<p>The fully qualified Java class name of the JDBC driver.</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment92" id="d38976e1106" headers="d38976e1028">
<p><code class="codeph">gg.mdp.userName</code></p>
</td>
<td class="cellalignment93" headers="d38976e1106 d38976e1031">
<p>Optional</p>
</td>
<td class="cellalignment94" headers="d38976e1106 d38976e1034">
<p>A legal username string.</p>
</td>
<td class="cellalignment95" headers="d38976e1106 d38976e1037">
<p>None</p>
</td>
<td class="cellalignment96" headers="d38976e1106 d38976e1040">
<p>The user name for the JDBC connection. Alternatively, you can provide the user name using the <code class="codeph">ConnectionURL</code> property.</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment92" id="d38976e1126" headers="d38976e1028">
<p><code class="codeph">gg.mdp.password</code></p>
</td>
<td class="cellalignment93" headers="d38976e1126 d38976e1031">
<p>Optional</p>
</td>
<td class="cellalignment94" headers="d38976e1126 d38976e1034">
<p>A legal password string.</p>
</td>
<td class="cellalignment95" headers="d38976e1126 d38976e1037">
<p>None</p>
</td>
<td class="cellalignment96" headers="d38976e1126 d38976e1040">
<p>The password for the JDBC connection. Alternatively, you can provide the user name using the <code class="codeph">ConnectionURL</code> property.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<div class="props_rev_3"><a id="GUID-A4FA5A42-4557-4824-9DEB-3BDDCFD1AA5D"></a>
<h3 id="GADBD-GUID-A4FA5A42-4557-4824-9DEB-3BDDCFD1AA5D" class="sect3"><span class="enumeration_section">12.3.4</span> Sample Configuration</h3>
<div>
<div class="section">
<p>This section provides examples for configuring the JDBC Metadata Provider.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">MySQL Driver Configuration:</p>
<pre dir="ltr">
gg.mdp.type=jdbc
gg.mdp.ConnectionUrl=jdbc:oracle:thin:@<span class="italic">myhost</span>:<span class="italic">1521</span>:<span class="italic">orcl</span>
gg.mdp.DriverClassName=oracle.jdbc.driver.OracleDriver
gg.mdp.UserName=<span class="italic">username</span>
gg.mdp.Password=<span class="italic">password</span>

</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Netezza Driver Configuration</p>
<pre dir="ltr">
gg.mdp.type=jdbc
gg.mdp.ConnectionUrl=jdbc:netezza://<span class="italic">hostname</span>:<span class="italic">port</span>/<span class="italic">databaseName</span>
gg.mdp.DriverClassName=org.netezza.Driver
gg.mdp.UserName=<span class="italic">username</span>
gg.mdp.Password=<span class="italic">password</span>
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Oracle OCI Driver configuration:</p>
<pre dir="ltr">
ggg.mdp.type=jdbc
gg.mdp.ConnectionUrl=jdbc:oracle:oci:@<span class="italic">myhost</span>:<span class="italic">1521</span>:<span class="italic">orcl</span>
gg.mdp.DriverClassName=oracle.jdbc.driver.OracleDriver
gg.mdp.UserName=<span class="italic">username</span>
gg.mdp.Password=<span class="italic">password</span>
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Oracle Teradata Driver configuration:</p>
<pre dir="ltr">
gg.mdp.type=jdbc
gg.mdp.ConnectionUrl=jdbc:teradata://10.111.11.111/USER=<span class="italic">username</span>,PASSWORD=<span class="italic">password</span>
gg.mdp.DriverClassName=com.teradata.jdbc.TeraDriver
gg.mdp.UserName=<span class="italic">username</span>
gg.mdp.Password=<span class="italic">password</span>
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Oracle Thin Driver Configuration:</p>
<pre dir="ltr">
gg.mdp.type=jdbc
gg.mdp.ConnectionUrl=jdbc:mysql://localhost/<span class="italic">databaseName</span>?user=<span class="italic">username</span>&amp;password=<span class="italic">password</span>
gg.mdp.DriverClassName=com.mysql.jdbc.Driver
gg.mdp.UserName=<span class="italic">username</span>
gg.mdp.Password=<span class="italic">password</span>

</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Redshift Driver Configuration</p>
<pre dir="ltr">
gg.mdp.type=jdbc
gg.mdp.ConnectionUrl=jdbc:redshift://<span class="italic">hostname</span>:<span class="italic">port</span>/<span class="italic">databaseName</span>
gg.mdp.DriverClassName=com.amazon.redshift.jdbc42.Driver
gg.mdp.UserName=<span class="italic">username</span>
gg.mdp.Password=<span class="italic">password</span>
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="GADBD586"></a>
<div class="props_rev_3"><a id="GUID-B68DF414-3FE0-4C0D-B13B-BC9A024DABD5"></a>
<h2 id="GADBD-GUID-B68DF414-3FE0-4C0D-B13B-BC9A024DABD5" class="sect2"><span class="enumeration_section">12.4</span> Hive Metadata Provider</h2>
<div>
<p>The Hive Metadata Provider is used to retrieve the table metadata from a Hive metastore. The metadata will be retrieved from Hive for every target table mapped in the Replicat properties file using the <code class="codeph">COLMAP</code> parameter. The retrieved target metadata is used by Replicat for the column mapping functionality.</p>
<p><span class="bold">Topics:</span></p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-26B08DED-3F72-4908-BA20-1DDE0533194E">Detailed Functionality</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-1F60E8D7-F8D9-4BA5-82F0-6499DA504034">Configuring Hive with a Remote Metastore Database</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-878B8590-AACE-49BF-A367-88C0A16B4A44">Classpath Configuration</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-F8FF91E9-ACF0-42F9-9DAE-A7C6833DB549">Hive Metadata Provider Configuration</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-D9AE0617-12FC-4B9A-BF15-BE929B5C94CF">Sample Configuration</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-1C45DFF2-5247-4784-875A-C2C0F18D23B0">Security</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-98187D5F-3EF3-44F7-B513-C66196DF930D">Metadata Change Event</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-1F284EFF-8A92-4EA6-8AA0-5641C0CEB7F3">Limitations</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-97EA18DB-4FBC-405B-86E0-ADAB9ACC3EAB">Additional Considerations</a><br /></li>
<li class="ulchildlink"><a href="using-metadata-provider.htm#GUID-BC62F29D-179D-4B8C-A440-AB7469C34BB5">Troubleshooting</a><br /></li>
</ul>
</div>
<a id="GADBD588"></a><a id="GADBD589"></a><a id="GADBD587"></a>
<div class="props_rev_3"><a id="GUID-26B08DED-3F72-4908-BA20-1DDE0533194E"></a>
<h3 id="GADBD-GUID-26B08DED-3F72-4908-BA20-1DDE0533194E" class="sect3"><span class="enumeration_section">12.4.1</span> Detailed Functionality</h3>
<div>
<div class="section">
<p>The Hive Metadata Provider uses both Hive JDBC and HCatalog interfaces to retrieve metadata from the Hive metastore. For each table mapped in the <code class="codeph"><span class="codeinlineitalic">process_name</span>.prm</code> file, a corresponding table should be created in Hive.</p>
<p>The default Hive configuration starts an embedded and local metastore Derby database. Apache Derby is designed to be an embedded database and only allows a single connection. The single connection limitation of the Derby Database as the Hive Metastore implementation means that it cannot function when working with the Hive Metadata Provider. To overcome this, you must configure Hive with a remote metastore database. More information on configuring Hive with remote metastore database can found at:</p>
<p><a href="https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-RemoteMetastoreDatabase" target="_blank"><code class="codeph">https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-RemoteMetastoreDatabase</code></a></p>
<p>Hive does not support Primary Key semantics, so the metadata retrieved from Hive metastore will not include any primary key definition. Replicat's <code class="codeph">KEYCOLS</code> parameter should be used to define primary keys when you use the Hive Metadata Provider.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3"><code class="codeph">KEYCOLS</code></p>
</div>
<!-- class="section" -->
<div class="section">
<p>The Replicat mapping <code class="codeph">KEYCOLS</code> parameter must be used to define primary keys in the target schema. The Oracle GoldenGate HBase Handler requires primary keys. Therefore, setting primary keys in the target schema is required when Replicat mapping is employed with HBase as the target.</p>
<p>Additionally, the output of the Avro Formatters includes an Array field to hold the primary column names. If Replicat mapping is employed with the Avro Formatters you should consider using <code class="codeph">KEYCOLS</code> to identify the primary key columns.</p>
<p>Examples of configuring <code class="codeph">KEYCOLS</code> is described in <a href="using-metadata-provider.htm#GUID-D9AE0617-12FC-4B9A-BF15-BE929B5C94CF">Sample Configuration</a>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Supported Hive Data types:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">BIGINT</code></p>
</li>
<li>
<p><code class="codeph">BINARY</code></p>
</li>
<li>
<p><code class="codeph">BOOLEAN</code></p>
</li>
<li>
<p><code class="codeph">CHAR</code></p>
</li>
<li>
<p><code class="codeph">DATE</code></p>
</li>
<li>
<p><code class="codeph">DECIMAL</code></p>
</li>
<li>
<p><code class="codeph">DOUBLE</code></p>
</li>
<li>
<p><code class="codeph">FLOAT</code></p>
</li>
<li>
<p><code class="codeph">INT</code></p>
</li>
<li>
<p><code class="codeph">SMALLINT</code></p>
</li>
<li>
<p><code class="codeph">STRING</code></p>
</li>
<li>
<p><code class="codeph">TIMESTAMP</code></p>
</li>
<li>
<p><code class="codeph">TINYINT</code></p>
</li>
<li>
<p><code class="codeph">VARCHAR</code></p>
</li>
</ul>
<p>For more information on Hive data types, see <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Types" target="_blank"><code class="codeph">https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Types</code></a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD590"></a>
<div class="props_rev_3"><a id="GUID-1F60E8D7-F8D9-4BA5-82F0-6499DA504034"></a>
<h3 id="GADBD-GUID-1F60E8D7-F8D9-4BA5-82F0-6499DA504034" class="sect3"><span class="enumeration_section">12.4.2</span> Configuring Hive with a Remote Metastore Database</h3>
<div>
<div class="section">
<p>A list of supported databases that can be used to configure remote Hive metastore can be found at <a href="https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-SupportedBackendDatabasesforMetastore" target="_blank"><code class="codeph">https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-SupportedBackendDatabasesforMetastore</code></a>.</p>
<p>In the following example, a MySQL database is configured as the Hive metastore using the following properties in the <code class="codeph">${HIVE_HOME}/conf/hive-site.xml</code> Hive configuration file:</p>
<div class="infobox-note" id="GUID-1F60E8D7-F8D9-4BA5-82F0-6499DA504034__GUID-ADE3F1F6-982B-4034-8C9E-17EFB6A78AB7">
<p class="notep1">Note:</p>
<p>The <code class="codeph">ConnectionURL</code> and driver class used in this example are specific to MySQL database. Change the values appropriately if any database other than MySQL is chosen.</p>
</div>
<pre dir="ltr">
&lt;property&gt;
         &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;        
         &lt;value&gt;jdbc:mysql://<span class="italic">MYSQL_DB_IP</span>:<span class="italic">MYSQL_DB_PORT</span>/<span class="italic">DB_NAME</span>?createDatabaseIfNotExist=false&lt;/value&gt;
 &lt;/property&gt;
 
 &lt;property&gt;
        &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
        &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
 &lt;/property&gt;
 
 &lt;property&gt;
          &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;
     &lt;value&gt;<span class="italic">MYSQL_CONNECTION_USERNAME</span>&lt;/value&gt;
 &lt;/property&gt;
 
 &lt;property&gt;
         &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;
         &lt;value&gt;<span class="italic">MYSQL_CONNECTION_PASSWORD</span>&lt;/value&gt;
 &lt;/property&gt;
</pre>
<p>The list of parameters to be configured in the <code class="codeph">hive-site.xml</code> file for a remote metastore can be found at <a href="https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-RemoteMetastoreDatabase" target="_blank"><code class="codeph">https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-RemoteMetastoreDatabase</code></a>.</p>
<div class="infobox-note" id="GUID-1F60E8D7-F8D9-4BA5-82F0-6499DA504034__GUID-08030351-8E6B-457B-AE50-ED4350D7120D">
<p class="notep1">Note:</p>
<p>MySQL JDBC connector JAR must be added in the Hive classpath:</p>
<ol>
<li>
<p>In <span class="italic"><code class="codeph">HIVE_HOME</code></span><code class="codeph">/lib/</code> directory. <span class="italic"><code class="codeph">DB_NAME</code></span> should be replaced by a valid database name created in MySQL.</p>
</li>
<li>
<p>Start the Hive Server:</p>
<p><span class="italic"><code class="codeph">HIVE_HOME</code></span><code class="codeph">/bin/hiveserver2/bin/hiveserver2</code></p>
</li>
<li>
<p>Start the Hive Remote Metastore Server:</p>
<p><span class="italic"><code class="codeph">HIVE_HOME</code></span><code class="codeph">/bin/hive --service metastore</code></p>
</li>
</ol>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD591"></a>
<div class="props_rev_3"><a id="GUID-878B8590-AACE-49BF-A367-88C0A16B4A44"></a>
<h3 id="GADBD-GUID-878B8590-AACE-49BF-A367-88C0A16B4A44" class="sect3"><span class="enumeration_section">12.4.3</span> Classpath Configuration</h3>
<div>
<div class="section">
<p>You must configure two things in the <code class="codeph">gg.classpath</code> configuration variable in order for the Hive Metadata Provider to connect to Hive and run. The first is the <code class="codeph">hive-site.xml</code> file, which is typically located in the <code class="codeph"><span class="codeinlineitalic">$HIVE_HOME</span>/conf</code> directory. The second are the Hive and HDFS client jars. The client JARs must match the version of Hive that the Hive Metadata Provider is connecting.</p>
<ol>
<li>
<p>Create <code class="codeph">hive-site.xml</code> file with the following properties:</p>
<pre dir="ltr">
&lt;configuration&gt;
&lt;!-- Mandatory Property --&gt; 
&lt;property&gt;
&lt;name&gt;hive.metastore.uris&lt;/name&gt;
&lt;value&gt;thrift://<span class="italic">HIVE_SERVER_HOST_IP</span>:9083&lt;/value&gt;
&lt;property&gt;
 
&lt;!-- Optional Property. Default value is 5 --&gt;
&lt;property&gt;
&lt;name&gt;hive.metastore.connect.retries&lt;/name&gt;
&lt;value&gt;3&lt;/value&gt;
&lt;/property&gt;
 
&lt;!-- Optional Property. Default value is 1 --&gt;
&lt;property&gt;
&lt;name&gt;hive.metastore.client.connect.retry.delay&lt;/name&gt;
&lt;value&gt;10&lt;/value&gt;
&lt;/property&gt;
 
&lt;!-- Optional Property. Default value is 600 seconds --&gt;
&lt;property&gt;
&lt;name&gt;hive.metastore.client.socket.timeout&lt;/name&gt;
&lt;value&gt;50&lt;/value&gt;
&lt;/property&gt;

 &lt;/configuration&gt;
</pre>
<div class="infobox-note" id="GUID-878B8590-AACE-49BF-A367-88C0A16B4A44__GUID-AA8533BE-986D-46FE-9FC2-18DECEFFC577">
<p class="notep1">Note:</p>
<p>For example, if the <code class="codeph">hive-site.xml</code> file is created in the <code class="codeph">/home/user/oggadp/dirprm</code> directory, then <code class="codeph">gg.classpath</code> entry is <code class="codeph">gg.classpath=/home/user/oggadp/dirprm/</code></p>
</div>
</li>
<li>
<p>The default location of the Hive and HDFS client jars are the following directories:</p>
<pre dir="ltr">
<span class="italic">HIVE_HOME</span>/hcatalog/share/hcatalog/*
<span class="italic">HIVE_HOME</span>/lib/*
<span class="italic">HIVE_HOME</span>/hcatalog/share/webhcat/java-client/*
<span class="italic">HADOOP_HOME</span>/share/hadoop/common/*
<span class="italic">HADOOP_HOME</span>/share/hadoop/common/lib/*
<span class="italic">HADOOP_HOME</span>/share/hadoop/mapreduce/*
</pre>
<p>Configure the <code class="codeph">gg.classpath</code> exactly as shown in the preceding step. Creating a path to the <code class="codeph">hive-site.xml</code> should contain the path with no wildcard appended. The inclusion of the <code class="codeph">*</code> wildcard in the path to the <code class="codeph">hive-site.xml</code> file causes it not to be picked up. Conversely, creating a path to the dependency JARs should include the <code class="codeph">*</code> wildcard character to include all of the JAR files in that directory in the associated classpath. Do <span class="italic">not</span> use <code class="codeph">*.jar.</code></p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD592"></a>
<div class="props_rev_3"><a id="GUID-F8FF91E9-ACF0-42F9-9DAE-A7C6833DB549"></a>
<h3 id="GADBD-GUID-F8FF91E9-ACF0-42F9-9DAE-A7C6833DB549" class="sect3"><span class="enumeration_section">12.4.4</span> Hive Metadata Provider Configuration</h3>
<div>
<div class="section">
<p>The configuration properties of the Hive Metadata Provider are detailed in this section.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-F8FF91E9-ACF0-42F9-9DAE-A7C6833DB549__GUID-C30F24BE-80E3-4DB5-A6D0-5692F16F22EB">
<table class="cellalignment77" summary="Five column table describing the configuration properties of the Hive Metadata Provider">
<thead>
<tr class="cellalignment62">
<th class="cellalignment69" id="d38976e1733">Property</th>
<th class="cellalignment101" id="d38976e1737">Required/Optional</th>
<th class="cellalignment102" id="d38976e1744">Legal Values</th>
<th class="cellalignment88" id="d38976e1748">Default</th>
<th class="cellalignment103" id="d38976e1752">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment62">
<td class="cellalignment73" id="d38976e1758" headers="d38976e1733">
<p><code class="codeph">gg.mdp.type</code></p>
</td>
<td class="cellalignment104" headers="d38976e1758 d38976e1737">
<p>Required</p>
</td>
<td class="cellalignment105" headers="d38976e1758 d38976e1744">
<p><code class="codeph">hive</code></p>
</td>
<td class="cellalignment93" headers="d38976e1758 d38976e1748">
<p><code class="codeph">-</code></p>
</td>
<td class="cellalignment106" headers="d38976e1758 d38976e1752">
<p>Selects Hive Metadata Provider</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment73" id="d38976e1777" headers="d38976e1733">
<p><code class="codeph">gg.mdp.connectionUrl</code></p>
</td>
<td class="cellalignment104" headers="d38976e1777 d38976e1737">
<p>Required</p>
</td>
<td class="cellalignment105" headers="d38976e1777 d38976e1744">
<p>Format without Kerberos Authentication:</p>
<p>j<code class="codeph">dbc:hive2://</code><span class="italic"><code class="codeph">HIVE_SERVER_IP:HIVE_JDBC_PORT/HIVE_DB</code></span></p>
<p>Format with Kerberos Authentication:</p>
<p><code class="codeph">jdbc:hive2://</code><span class="italic"><code class="codeph">HIVE_SERVER_IP:HIVE_JDBC_PORT/HIVE_DB;</code></span> <code class="codeph">principal=user/FQDN@MY.REALM</code></p>
</td>
<td class="cellalignment93" headers="d38976e1777 d38976e1748">
<p><code class="codeph">-</code></p>
</td>
<td class="cellalignment106" headers="d38976e1777 d38976e1752">
<p>JDBC Connection URL of Hive Server</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment73" id="d38976e1814" headers="d38976e1733">
<p><code class="codeph">gg.mdp.driverClassName</code></p>
</td>
<td class="cellalignment104" headers="d38976e1814 d38976e1737">
<p>Required</p>
</td>
<td class="cellalignment105" headers="d38976e1814 d38976e1744">
<p><code class="codeph">org.apache.hive.jdbc.HiveDriver</code></p>
</td>
<td class="cellalignment93" headers="d38976e1814 d38976e1748">
<p><code class="codeph">-</code></p>
</td>
<td class="cellalignment106" headers="d38976e1814 d38976e1752">
<p>Fully qualified Hive JDBC Driver class name.</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment73" id="d38976e1833" headers="d38976e1733">
<p><code class="codeph">gg.mdp.userName</code></p>
</td>
<td class="cellalignment104" headers="d38976e1833 d38976e1737">
<p>Optional</p>
</td>
<td class="cellalignment105" headers="d38976e1833 d38976e1744">
<p>Valid username</p>
</td>
<td class="cellalignment93" headers="d38976e1833 d38976e1748">
<p><code class="codeph">""</code></p>
</td>
<td class="cellalignment106" headers="d38976e1833 d38976e1752">
<p>User name to connect to the Hive Database. The <code class="codeph">userName</code> property is not required when Kerberos Authentication is used. The Kerberos principal should be specified in the connection URL as specified in <code class="codeph">connectionUrl</code> property's legal values.</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment73" id="d38976e1857" headers="d38976e1733">
<p><code class="codeph">gg.mdp.password</code></p>
</td>
<td class="cellalignment104" headers="d38976e1857 d38976e1737">
<p>Optional</p>
</td>
<td class="cellalignment105" headers="d38976e1857 d38976e1744">
<p>Valid Password</p>
</td>
<td class="cellalignment93" headers="d38976e1857 d38976e1748">
<p><code class="codeph">""</code></p>
</td>
<td class="cellalignment106" headers="d38976e1857 d38976e1752">
<p>Password to connect to Hive Database</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment73" id="d38976e1875" headers="d38976e1733">
<p><code class="codeph">gg.mdp.charset</code></p>
</td>
<td class="cellalignment104" headers="d38976e1875 d38976e1737">
<p>Optional</p>
</td>
<td class="cellalignment105" headers="d38976e1875 d38976e1744">
<p>Valid character set</p>
</td>
<td class="cellalignment93" headers="d38976e1875 d38976e1748">
<p><code class="codeph">UTF-8</code></p>
</td>
<td class="cellalignment106" headers="d38976e1875 d38976e1752">
<p>Specifies the character set of the column with character data type. This is used to convert the source data from trail file to the correct target character set.</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment73" id="d38976e1894" headers="d38976e1733">
<p><code class="codeph">gg.mdp.nationalCharset</code></p>
</td>
<td class="cellalignment104" headers="d38976e1894 d38976e1737">
<p>Optional</p>
</td>
<td class="cellalignment105" headers="d38976e1894 d38976e1744">
<p>Valid character set</p>
</td>
<td class="cellalignment93" headers="d38976e1894 d38976e1748">
<p><code class="codeph">UTF-8</code></p>
</td>
<td class="cellalignment106" headers="d38976e1894 d38976e1752">
<p>Specifies the character set of the column with character data type. This is used to convert the source data from trail file to the correct target character set.</p>
<p>For example, Indicates character set of columns like <code class="codeph">NCHAR</code>, <code class="codeph">NVARCHAR</code> in an Oracle Database.</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment73" id="d38976e1920" headers="d38976e1733">
<p><code class="codeph">gg.mdp.authType</code></p>
</td>
<td class="cellalignment104" headers="d38976e1920 d38976e1737">
<p>Optional</p>
</td>
<td class="cellalignment105" headers="d38976e1920 d38976e1744">
<p>kerberos</p>
</td>
<td class="cellalignment93" headers="d38976e1920 d38976e1748">
<p>none</p>
</td>
<td class="cellalignment106" headers="d38976e1920 d38976e1752">&nbsp;</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment73" id="d38976e1936" headers="d38976e1733">
<p><code class="codeph">gg.mdp.kerberosKeytabFile</code></p>
</td>
<td class="cellalignment104" headers="d38976e1936 d38976e1737">
<p>Optional (Required if <code class="codeph">authType=kerberos</code>)</p>
</td>
<td class="cellalignment105" headers="d38976e1936 d38976e1744">
<p>Relative or absolute path to a Kerberos keytab file.</p>
</td>
<td class="cellalignment93" headers="d38976e1936 d38976e1748">
<p><code class="codeph">-</code></p>
</td>
<td class="cellalignment106" headers="d38976e1936 d38976e1752">
<p>The <code class="codeph">keytab</code> file allows Hive to access a password to perform <code class="codeph">kinit</code> operation for Kerberos security.</p>
</td>
</tr>
<tr class="cellalignment62">
<td class="cellalignment73" id="d38976e1963" headers="d38976e1733">
<p><code class="codeph">gg.mdp.kerberosPrincipal</code></p>
</td>
<td class="cellalignment104" headers="d38976e1963 d38976e1737">
<p>Optional (Required if <code class="codeph">authType=kerberos</code>)</p>
</td>
<td class="cellalignment105" headers="d38976e1963 d38976e1744">
<p>A legal Kerberos principal name(<code class="codeph">user/FQDN@MY.REALM</code>)</p>
</td>
<td class="cellalignment93" headers="d38976e1963 d38976e1748">
<p><code class="codeph">-</code></p>
</td>
<td class="cellalignment106" headers="d38976e1963 d38976e1752">
<p>The Kerberos principal name for Kerberos authentication.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD593"></a>
<div class="props_rev_3"><a id="GUID-D9AE0617-12FC-4B9A-BF15-BE929B5C94CF"></a>
<h3 id="GADBD-GUID-D9AE0617-12FC-4B9A-BF15-BE929B5C94CF" class="sect3"><span class="enumeration_section">12.4.5</span> Sample Configuration</h3>
<div>
<div class="section">
<p>The following is an example for configuring the Hive Metadata Provider. Consider a source with following table:</p>
<pre dir="ltr">
TABLE GG.TCUSTMER {
     CUST_CODE VARCHAR(4)   PRIMARY KEY,
     NAME VARCHAR(100),
     CITY VARCHAR(200),
     STATE VARCHAR(200)}
</pre>
<p>The example maps the column <code class="codeph">CUST_CODE</code> <code class="codeph">(GG.TCUSTMER)</code> in the source to <code class="codeph">CUST_CODE2</code> <code class="codeph">(GG_HIVE.TCUSTMER_HIVE)</code> on the target and column <code class="codeph">CITY</code> <code class="codeph">(GG.TCUSTMER</code>) in the source to <code class="codeph">CITY2</code> <code class="codeph">(GG_HIVE.TCUSTMER_HIVE)</code>on the target.</p>
<p>Mapping configuration in the <code class="codeph"><span class="codeinlineitalic">process_name.</span>prm</code> file:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_HIVE.TCUSTMER_HIVE, COLMAP(USEDEFAULTS, CUST_CODE2=CUST_CODE, CITY2=CITY) KEYCOLS(CUST_CODE2); 
</pre>
<p>The mapping definition for this example is:</p>
<ul style="list-style-type: disc;">
<li>
<p>Source schema <code class="codeph">GG</code> is mapped to target schema <code class="codeph">GG_HIVE</code></p>
</li>
<li>
<p>Source column <code class="codeph">CUST_CODE</code> is mapped to target column <code class="codeph">CUST_CODE2</code></p>
</li>
<li>
<p>Source column <code class="codeph">CITY</code> is mapped to target column <code class="codeph">CITY2</code></p>
</li>
<li>
<p><code class="codeph">USEDEFAULTS</code> specifies that rest of the columns names are same on both source and target (<code class="codeph">NAME</code> and <code class="codeph">STATE</code> columns).</p>
</li>
<li>
<p><code class="codeph">KEYCOLS</code> is used to specify that <code class="codeph">CUST_CODE2</code> should be treated as primary key.</p>
</li>
</ul>
<p>Since primary keys cannot be specified in Hive DDL, the <code class="codeph">KEYCOLS</code> parameter is used to specify the primary keys.</p>
<p>Create schema and tables in Hive for the preceding example:</p>
<div class="infobox-note" id="GUID-D9AE0617-12FC-4B9A-BF15-BE929B5C94CF__GUID-94E8FF10-AA6C-4A60-BDA1-D69D1BAA004A">
<p class="notep1">Note:</p>
<p>You can choose any schema name and are not restricted to the <code class="codeph">gg_hive schema</code> name. The Hive schema can be pre-existing or newly created. You do this by modifying the connection URL (<code class="codeph">gg.mdp.connectionUrl</code>) in the Java Adapter properties file and the mapping configuration in the <code class="codeph">Replicat.prm</code> file. Once the schema name is changed, the connection URL (<code class="codeph">gg.mdp.connectionUrl</code>) and mapping in the <code class="codeph">Replicat.prm</code> file should be updated.</p>
</div>
<p>To start the Hive CLI type the following command:</p>
<p><span class="italic"><code class="codeph">HIVE_HOME</code></span><code class="codeph">/bin/hive</code></p>
<p>To create a schema, <code class="codeph">GG_HIVE</code>, in Hive, use the following command:</p>
<pre dir="ltr">
hive&gt; create schema gg_hive;
OK
Time taken: 0.02 seconds
</pre>
<p>To create a table <code class="codeph">TCUSTMER_HIVE</code> in <code class="codeph">GG_HIVE</code> database type the following command:</p>
<pre dir="ltr">
hive&gt; CREATE EXTERNAL TABLE `TCUSTMER_HIVE`(
    &gt;   "CUST_CODE2" VARCHAR(4),
    &gt;   "NAME" VARCHAR(30),
    &gt;   "CITY2" VARCHAR(20),
    &gt;   "STATE" STRING);
OK
Time taken: 0.056 seconds
</pre>
<p>Configuration in the <code class="codeph">.properties</code> file can be like the following:</p>
<pre dir="ltr">
gg.mdp.type=hive
gg.mdp.connectionUrl=jdbc:hive2://<span class="italic">HIVE_SERVER_IP</span>:10000/gg_hive
gg.mdp.driverClassName=org.apache.hive.jdbc.HiveDriver
</pre>
<p>Following is the sample output using delimited text formatter with a comma as the delimiter for the preceding example.</p>
<pre dir="ltr">
I;GG_HIVE.TCUSTMER_HIVE;2015-10-07T04:50:47.519000;cust_code2;WILL;name;BG SOFTWARE CO;city2;SEATTLE;state;WA
</pre>
<p>A sample Replicat configuration file, Java Adapter properties file, and a Hive create table SQL script are included with the installation, and located at:</p>
<p><span class="italic"><code class="codeph">GoldenGate_install_directory</code></span><code class="codeph">/AdapterExamples/big-data/metadata_provider/hive</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD594"></a>
<div class="props_rev_3"><a id="GUID-1C45DFF2-5247-4784-875A-C2C0F18D23B0"></a>
<h3 id="GADBD-GUID-1C45DFF2-5247-4784-875A-C2C0F18D23B0" class="sect3"><span class="enumeration_section">12.4.6</span> Security</h3>
<div>
<div class="section">
<p>The Hive server can be secured using Kerberos Authentication. Refer to the Hive documentation for your specific Hive release for instructions on how to secure the Hive server. The Hive Metadata Provider can connect to a Kerberos secured Hive server.</p>
<p>The HDFS <code class="codeph">core-site.xml</code> and <code class="codeph">hive-site.xml</code> should be in handler's classpath.</p>
<p>Enable the following properties in <code class="codeph">core-site.xml</code>:</p>
<pre dir="ltr">
&lt;property&gt;
&lt;name&gt;hadoop.security.authentication&lt;/name&gt;
&lt;value&gt;kerberos&lt;/value&gt; 
&lt;/property&gt;
 
&lt;property&gt; 
&lt;name&gt;hadoop.security.authorization&lt;/name&gt; 
&lt;value&gt;true&lt;/value&gt; 
&lt;/property&gt;
</pre>
<p>Enable the following properties in <code class="codeph">hive-site.xml</code></p>
<pre dir="ltr">
&lt;property&gt;
&lt;name&gt;hive.metastore.sasl.enabled&lt;/name&gt;
&lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
 
&lt;property&gt;
&lt;name&gt;hive.metastore.kerberos.keytab.file&lt;/name&gt;
&lt;value&gt;/path/to/keytab&lt;/value&gt; &lt;!-- Change this value --&gt;
&lt;/property&gt;
 
&lt;property&gt;
&lt;name&gt;hive.metastore.kerberos.principal&lt;/name&gt;
&lt;value&gt;Kerberos Principal&lt;/value&gt; &lt;!-- Change this value --&gt;
&lt;/property&gt;
 
&lt;property&gt;
   &lt;name&gt;hive.server2.authentication&lt;/name&gt;
    &lt;value&gt;KERBEROS&lt;/value&gt;
&lt;/property&gt;
 
&lt;property&gt;
   &lt;name&gt;hive.server2.authentication.kerberos.principal&lt;/name&gt;
    &lt;value&gt;Kerberos Principal&lt;/value&gt; &lt;!-- Change this value --&gt;
&lt;/property&gt;
 
&lt;property&gt;
    &lt;name&gt;hive.server2.authentication.kerberos.keytab&lt;/name&gt;
    &lt;value&gt;/path/to/keytab&lt;/value&gt; &lt;!-- Change this value --&gt;
&lt;/property&gt;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD595"></a>
<div class="props_rev_3"><a id="GUID-98187D5F-3EF3-44F7-B513-C66196DF930D"></a>
<h3 id="GADBD-GUID-98187D5F-3EF3-44F7-B513-C66196DF930D" class="sect3"><span class="enumeration_section">12.4.7</span> Metadata Change Event</h3>
<div>
<div class="section">
<p>Tables in Hive metastore should be updated/altered/created manually if there is a change in source database tables. You may wish to abort or suspend the Replicat process in the case of a metadata change event. The Replicat process can be aborted by adding the following to the Replicat configuration file (<code class="codeph"><span class="codeinlineitalic">process_name.</span>prm</code>):</p>
<p><code class="codeph">DDL INCLUDE ALL, EVENTACTIONS (ABORT)</code></p>
<p>Alternatively, the Replicat process can be suspended by adding the following to the Replication configuration file (<code class="codeph"><span class="codeinlineitalic">process_name.</span>prm</code>):</p>
<p><code class="codeph">DDL INCLUDE ALL, EVENTACTIONS (SUSPEND)</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD596"></a>
<div class="props_rev_3"><a id="GUID-1F284EFF-8A92-4EA6-8AA0-5641C0CEB7F3"></a>
<h3 id="GADBD-GUID-1F284EFF-8A92-4EA6-8AA0-5641C0CEB7F3" class="sect3"><span class="enumeration_section">12.4.8</span> Limitations</h3>
<div>
<div class="section">
<p>Columns with binary data type cannot be used as primary key.</p>
<p>The source to target mapping defined in the Replicat configuration file is static. Oracle GoldenGate 12.2 and later supports DDL propagation and source schema evolution for Oracle Databases as the replication source. However, evolution of the source schemas may be problematic the static mapping configured in the Replicat configuration file.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD597"></a>
<div class="props_rev_3"><a id="GUID-97EA18DB-4FBC-405B-86E0-ADAB9ACC3EAB"></a>
<h3 id="GADBD-GUID-97EA18DB-4FBC-405B-86E0-ADAB9ACC3EAB" class="sect3"><span class="enumeration_section">12.4.9</span> Additional Considerations</h3>
<div>
<div class="section">
<p>The most common problems encountered are the Java classpath issues. The Hive Metadata Provider requires certain Hive and HDFS client libraries to be resolved in its classpath as a prerequisite.</p>
<p>The required client JAR directories are listed in <a href="using-metadata-provider.htm#GUID-878B8590-AACE-49BF-A367-88C0A16B4A44">Classpath Configuration</a>. Hive and HDFS client jars do not ship with Oracle GoldenGate for Big Data product. The client JARs should be the same version as the Hive version to which Hive Metadata Provider is connecting.</p>
<p>To establish a connection to the Hive server, the <code class="codeph">hive-site.xml</code> file must be in the classpath.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD598"></a>
<div class="props_rev_3"><a id="GUID-BC62F29D-179D-4B8C-A440-AB7469C34BB5"></a>
<h3 id="GADBD-GUID-BC62F29D-179D-4B8C-A440-AB7469C34BB5" class="sect3"><span class="enumeration_section">12.4.10</span> Troubleshooting</h3>
<div>
<div class="section">
<p>The Replicat process will abend with a <span class="italic">"Table metadata resolution exception"</span> if the mapped target table does not exist in Hive.</p>
<p>For example, consider the following mapping:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_HIVE.TCUSTMER_HIVE, COLMAP(USEDEFAULTS, CUST_CODE2=CUST_CODE, CITY2=CITY) KEYCOLS(CUST_CODE2);

</pre>
<p>The preceding mapping requires a table called <code class="codeph">TCUSTMER_HIVE</code> to be created in schema <code class="codeph">GG_HIVE</code> in the Hive metastore. Failure to create the <code class="codeph">GG_HIVE.TCUSTMER_HIVE</code> table in Hive will result in following exception:</p>
<pre dir="ltr">
ERROR [main) - Table Metadata Resolution Exception
Unable to retrieve table matadata. Table : GG_HIVE.TCUSTMER_HIVE
NoSuchObjectException(message:GG_HIVE.TCUSTMER_HIVE table not found)
</pre></div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment61">
<tr>
<td class="cellalignment79">
<table class="cellalignment66">
<tr>
<td class="cellalignment65"><a href="using-mongodb-handler.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment65"><a href="using-pluggable-formatters.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2015, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment81">
<table class="cellalignment64">
<tr>
<td class="cellalignment65"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment65"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
