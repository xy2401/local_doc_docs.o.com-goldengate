<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Using the Metadata Provider</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2016-12-07T16:58:45Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Integrating Oracle GoldenGate for Big Data" />
<meta name="dcterms.identifier" content="E79598-01" />
<meta name="dcterms.isVersionOf" content="GADBD" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2015, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm" title="Previous" type="text/html" />
<link rel="Next" href="GUID-1A409BCB-A8A2-41CD-B9D6-4D65D356D1A5.htm" title="Next" type="text/html" />
<link rel="alternate" href="GADBD.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="GADBD.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="GADBD.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>

                    <script>var w=window;if(w.performance||w.mozPerformance||w.msPerformance||w.webkitPerformance){var d=document;AKSB=w.AKSB||{},AKSB.q=AKSB.q||[],AKSB.mark=AKSB.mark||function(e,_){AKSB.q.push(["mark",e,_||(new Date).getTime()])},AKSB.measure=AKSB.measure||function(e,_,t){AKSB.q.push(["measure",e,_,t||(new Date).getTime()])},AKSB.done=AKSB.done||function(e){AKSB.q.push(["done",e])},AKSB.mark("firstbyte",(new Date).getTime()),AKSB.prof={custid:"322179",ustr:"",originlat:"0",clientrtt:"1",ghostip:"23.212.3.15",ipv6:false,pct:"10",clientip:"45.78.37.67",requestid:"29b4b91a",region:"32996",protocol:"",blver:14,akM:"dsca",akN:"ae",akTT:"O",akTX:"1",akTI:"29b4b91a",ai:"206465",ra:"false",pmgn:"",pmgi:"",pmp:"",qc:""},function(e){var _=d.createElement("script");_.async="async",_.src=e;var t=d.getElementsByTagName("script"),t=t[t.length-1];t.parentNode.insertBefore(_,t)}(("https:"===d.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/aksb.min.js")}</script>
                    <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65"></a> <span id="PAGE" style="display:none;">13/19</span> <!-- End Header -->
<a id="GADBD570"></a><a id="GADBD569"></a>
<h1 id="GADBD-GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65" class="sect1"><span class="enumeration_chapter">10</span> Using the Metadata Provider</h1>
<div>
<p>This chapter explains the Metadata Provider functionality, different types of Metadata Providers, and examples that can be used to understand the functionality.</p>
<p><span class="bold">Topics:</span></p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-8D813797-6C3B-4037-AB28-A02E79710080">About the Metadata Provider</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-737CF013-FC71-4D10-8F03-709A6D86096F">Avro Metadata Provider</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-DB549C6D-6B63-49BD-AFFA-99B7897E0446">Java Database Connectivity Metadata Provider</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-B68DF414-3FE0-4C0D-B13B-BC9A024DABD5">Hive Metadata Provider</a></strong><br /></li>
</ul>
</div>
<div class="sect2"><a id="GUID-8D813797-6C3B-4037-AB28-A02E79710080"></a>
<h2 id="GADBD-GUID-8D813797-6C3B-4037-AB28-A02E79710080" class="sect2"><span class="enumeration_section">10.1</span> About the Metadata Provider</h2>
<div>
<p>The Metadata Provider is valid only if handlers are configured to run with a Replicat process.</p>
<p>The Replicat process provides functionality to perform source table to target table and source column to target column mapping using syntax in the Replicat configuration file. The source metadata definitions are included in the Oracle GoldenGate trail file (or by source definitions files for Oracle GoldenGate releases 12.2 and later). When the replication target is a database, the Replicat process obtains the target metadata definitions from the target database. However, this is a shortcoming when pushing data to Big Data applications or Java Delivery in general. Big Data applications generally provide no target metadata so the Replicat mapping is not possible. The Metadata Provider exists to address this deficiency. The Metadata Provider can be used to define target metadata using either Avro or Hive which in turn enables source table to target table and source column to target column Replicat mapping.</p>
<p>The use of the Metadata Provider is optional and is enabled if the <code>gg.mdp.type</code> property is specified in the Java Adapter Properties file.. If the metadata included in the source Oracle GoldenGate trail file is acceptable for the output, then do not use the Metadata Provider. The Metadata Provider should be used in the following cases:</p>
<ul style="list-style-type: disc;">
<li>
<p>The requirement is for mapping source table names into target table names that do not match.</p>
</li>
<li>
<p>The requirement is for mapping of source column names into target column name that do not match.</p>
</li>
<li>
<p>The requirement is for the inclusion of certain columns from the source trail file and omitting other columns.</p>
</li>
</ul>
<p>Replicat mapping has a general limitation in that the mapping defined in the Replicat configuration file is static. Oracle GoldenGate 12.2 and later provides functionality for DDL propagation when using an Oracle Database as the source. The proper handling of schema evolution can be problematic when the Metadata Provider and Replicat mapping are being used. You should consider your use cases for schema evolution and plan for how you want to update the Metadata Provider and the Replicat mapping syntax for required changes.</p>
<p>For every table mapped in <code>REPLICAT</code> using <code>COLMAP</code>, the metadata will be retrieved from a configured metadata provider and retrieved metadata will then be used by <code>REPLICAT</code> for column mapping functionality.</p>
<p>You have choice of configuring one Metadata Provider implementation. Currently Hive and Avro Metadata Providers are supported.</p>
<div class="section">
<p class="subhead2">Scenarios - When to use Metadata Provider</p>
</div>
<!-- class="section" -->
<ol>
<li>
<p>The following scenarios do <span class="italic">not</span> require the Metadata Provider to be configured:</p>
<p>The mapping of schema name whereby the source schema named <code>GG</code> is mapped to the target schema named <code>GGADP</code>.*</p>
<p>The mapping of schema and table name whereby the schema <code>GG.TCUSTMER</code> is mapped to the table name <code>GGADP.TCUSTMER_NEW</code></p>
<pre dir="ltr">
MAP GG.*, TARGET GGADP.*;
(OR)
MAP GG.TCUSTMER, TARGET GG_ADP.TCUSTMER_NEW;
</pre></li>
<li>
<p>The following scenario requires Metadata Provider to be configured:</p>
<p>The mapping of column names whereby the source column name does not match the target column name. For example source column <code>CUST_CODE</code> mapped to target column <code>CUST_CODE_NEW</code></p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_ADP.TCUSTMER_NEW, COLMAP(USEDEFAULTS, CUST_CODE_NEW=CUST_CODE, CITY2=CITY);
</pre></li>
</ol>
</div>
</div>
<a id="GADBD571"></a>
<div class="props_rev_3"><a id="GUID-737CF013-FC71-4D10-8F03-709A6D86096F"></a>
<h2 id="GADBD-GUID-737CF013-FC71-4D10-8F03-709A6D86096F" class="sect2"><span class="enumeration_section">10.2</span> Avro Metadata Provider</h2>
<div>
<p>The Avro Metadata Provider is used to retrieve the table metadata from Avro Schema files. For every table mapped in <code>REPLICAT</code> using <code>COLMAP</code>, the metadata will be retrieved from Avro Schema and retrieved metadata will then be used by <code>REPLICAT</code> for column mapping.</p>
<p>This section contains the following:</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-3DDEF373-5995-464A-9D40-43614D55F59D">Detailed Functionality</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-0BBA0061-FF79-4891-B17D-3092DA4B275C">Runtime Prerequisites</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-6DB2B303-636D-4B10-A075-D4A2FA624711">Classpath Configuration</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B">Avro Metadata Provider Configuration</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-BCFE0447-C562-4BDC-814B-58BB2928DBA0">Sample Configuration</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-2B8DD4B9-CA20-41DA-BDA0-1E0F921E8B64">Metadata Change Event</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-97F91AE5-1461-41AC-98B6-50890313AC19">Limitations</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-2EE6F213-BB7B-4D02-9FD3-BD84084C8CD9">Troubleshooting</a></strong><br /></li>
</ul>
</div>
<a id="GADBD573"></a><a id="GADBD574"></a><a id="GADBD572"></a>
<div class="props_rev_3"><a id="GUID-3DDEF373-5995-464A-9D40-43614D55F59D"></a>
<h3 id="GADBD-GUID-3DDEF373-5995-464A-9D40-43614D55F59D" class="sect3"><span class="enumeration_section">10.2.1</span> Detailed Functionality</h3>
<div>
<div class="section">
<p>The Avro Metadata Provider uses Avro schema definition files to retrieve metadata. The Avro schemas are defined using the JSON. For each table mapped in <code><span class="codeinlineitalic">process_name.</span>prm</code> file, a corresponding The Avro schema definition file should be created. More information on defining Avro schemas is found at:</p>
<p><a href="http://avro.apache.org/docs/current/gettingstartedjava.html#Defining+a+schema" target="_blank"><code>http://avro.apache.org/docs/current/gettingstartedjava.html#Defining+a+schema</code></a></p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Avro Metadata Provider Schema definition syntax:</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">
{"namespace": "[$catalogname.]$schemaname",
"type": "record",
"name": "$tablename",
"fields": [
     {"name": "$col1", "type": "$datatype"},
     {"name": "$col2 ",  "type": "$datatype ", "primary_key":true}, 
     {"name": "$col3", "type": "$datatype ", "primary_key":true}, 
     {"name": "$col4", "type": ["$datatype","null"]}   
   ]
}
 
namespace            - name of catalog/schema being mapped
name                 - name of the table being mapped
fields.name          - array of column names
fields.type          - datatype of the column
fields.primary_key   - indicates the column is part of primary key.

Representing nullable and not nullable columns:

"type":"$datatype" - indicates the column is not nullable, where "$datatype" is the actual datatype.
"type": ["$datatype","null"] - indicates the column is nullable, where "$datatype" is the actual datatype
</pre>
<p>The file naming convention for Avro schema files accessed by the Avro Metadata Provider must be in the following format:</p>
<pre dir="ltr">
[$catalogname.]$schemaname.$tablename.mdp.avsc
 
$catalogname    - name of the catalog if exists
$schemaname   - name of the schema
$tablename        - name of the table
.mdp.avsc           -  constant, which should be appended always
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Supported Avro Data Types:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>boolean</p>
</li>
<li>
<p>bytes</p>
</li>
<li>
<p>double</p>
</li>
<li>
<p>float</p>
</li>
<li>
<p>int</p>
</li>
<li>
<p>long</p>
</li>
<li>
<p>string</p>
</li>
</ul>
<p>For more information on Avro data types, see <a href="https://avro.apache.org/docs/1.7.5/spec.html#schema_primitive" target="_blank"><code>https://avro.apache.org/docs/1.7.5/spec.html#schema_primitive</code></a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD575"></a>
<div class="props_rev_3"><a id="GUID-0BBA0061-FF79-4891-B17D-3092DA4B275C"></a>
<h3 id="GADBD-GUID-0BBA0061-FF79-4891-B17D-3092DA4B275C" class="sect3"><span class="enumeration_section">10.2.2</span> Runtime Prerequisites</h3>
<div>
<div class="section">
<p>The Avro schema definitions should be created for all tables mapped in Replicat's parameter file before starting the Replicat process.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD576"></a>
<div class="props_rev_3"><a id="GUID-6DB2B303-636D-4B10-A075-D4A2FA624711"></a>
<h3 id="GADBD-GUID-6DB2B303-636D-4B10-A075-D4A2FA624711" class="sect3"><span class="enumeration_section">10.2.3</span> Classpath Configuration</h3>
<div>
<div class="section">
<p>There is no additional classpath setting required for Avro Metadata Provider.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD577"></a>
<div class="props_rev_3"><a id="GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B"></a>
<h3 id="GADBD-GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B" class="sect3"><span class="enumeration_section">10.2.4</span> Avro Metadata Provider Configuration</h3>
<div>
<div class="section">
<p>The configuration properties of Oracle GoldenGate Avro Metadata Provider are detailed in this section.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B__GUID-8322C613-8A8E-4014-B559-6D08AB2F0F88">
<hr />
<table class="cellalignment52" summary="Five column table describing the configuration properties of the Avro Metadata Provider.">
<thead align="left">
<tr>
<th class="cellalignment66" id="d39581e361">Property</th>
<th class="cellalignment67" id="d39581e365">Required/Optional</th>
<th class="cellalignment68" id="d39581e372">Legal Values</th>
<th class="cellalignment66" id="d39581e376">Default</th>
<th class="cellalignment68" id="d39581e380">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment66" id="d39581e386" headers="d39581e361">
<p><code>gg.mdp.type</code></p>
</td>
<td class="cellalignment67" headers="d39581e386 d39581e365">
<p>Required</p>
</td>
<td class="cellalignment68" headers="d39581e386 d39581e372">
<p><code>avro</code></p>
</td>
<td class="cellalignment66" headers="d39581e386 d39581e376">
<p><code>-</code></p>
</td>
<td class="cellalignment68" headers="d39581e386 d39581e380">
<p>Selects the Avro Metadata Provider</p>
</td>
</tr>
<tr>
<td class="cellalignment66" id="d39581e405" headers="d39581e361">
<p><code>gg.mdp.schemaFilesPath</code></p>
</td>
<td class="cellalignment67" headers="d39581e405 d39581e365">
<p>Required</p>
</td>
<td class="cellalignment68" headers="d39581e405 d39581e372">
<p>Example for a legal value could be <code>/home/user/ggadp/avroschema/</code></p>
</td>
<td class="cellalignment66" headers="d39581e405 d39581e376">
<p><code>-</code></p>
</td>
<td class="cellalignment68" headers="d39581e405 d39581e380">
<p>Path to Avro schema files directory</p>
</td>
</tr>
<tr>
<td class="cellalignment66" id="d39581e425" headers="d39581e361">
<p><code>gg.mdp.charset</code></p>
</td>
<td class="cellalignment67" headers="d39581e425 d39581e365">
<p>Optional</p>
</td>
<td class="cellalignment68" headers="d39581e425 d39581e372">
<p>Valid character set</p>
</td>
<td class="cellalignment66" headers="d39581e425 d39581e376">
<p><code>UTF-8</code></p>
</td>
<td class="cellalignment68" headers="d39581e425 d39581e380">
<p>Specifies the character set of the column with character data type. This is used to convert the source data from trail file to the correct target character set.</p>
</td>
</tr>
<tr>
<td class="cellalignment66" id="d39581e443" headers="d39581e361">
<p><code>gg.mdp.nationalCharse</code><code>t</code></p>
</td>
<td class="cellalignment67" headers="d39581e443 d39581e365">
<p>Optional</p>
</td>
<td class="cellalignment68" headers="d39581e443 d39581e372">
<p>Valid character set</p>
</td>
<td class="cellalignment66" headers="d39581e443 d39581e376">
<p><code>UTF-8</code></p>
</td>
<td class="cellalignment68" headers="d39581e443 d39581e380">
<p>Specifies the character set of the column with character data type. This is used to convert the source data from trail file to the correct target character set.</p>
<p>Example: Indicates character set of columns like <code>NCHAR</code>, <code>NVARCHAR</code>with an Oracle Database.</p>
</td>
</tr>
</tbody>
</table>
<hr /></div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD578"></a>
<div class="props_rev_3"><a id="GUID-BCFE0447-C562-4BDC-814B-58BB2928DBA0"></a>
<h3 id="GADBD-GUID-BCFE0447-C562-4BDC-814B-58BB2928DBA0" class="sect3"><span class="enumeration_section">10.2.5</span> Sample Configuration</h3>
<div>
<div class="section">
<p>This section provides an example for configuring the Avro Metadata Provider. Consider a source with following table:</p>
<pre dir="ltr">
TABLE GG.TCUSTMER {
     CUST_CODE VARCHAR(4) PRIMARY KEY,
     NAME VARCHAR(100),
     CITY VARCHAR(200),
     STATE VARCHAR(200)
}
</pre>
<p>Mapping column<code>CUST_CODE (GG.TCUSTMER)</code> in source to <code>CUST_CODE2 (GG_AVRO.TCUSTMER_AVRO)</code> on target and column <code>CITY</code> <code>(GG.TCUSTMER)</code> in source to <code>CITY2</code> <code>(GG_AVRO.TCUSTMER_AVRO)</code> on target. Thus, the mapping in <code><span class="codeinlineitalic">process_name.</span>prm</code> file is:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, CUST_CODE2=CUST_CODE, CITY2=CITY);
 
</pre>
<p>Mapping definition in this example:</p>
<ul style="list-style-type: disc;">
<li>
<p>Source schema <code>GG</code> is mapped to target schema <code>GG_AVRO</code>.</p>
</li>
<li>
<p>Source column <code>CUST_CODE</code> is mapped to target column <code>CUST_CODE2</code>.</p>
</li>
<li>
<p>Source column <code>CITY</code> is mapped to target column <code>CITY2</code>.</p>
</li>
<li>
<p><code>USEDEFAULTS</code> specifies that rest of the columns names are same on both source and target (<code>NAME</code> and <code>STATE</code> columns).</p>
</li>
</ul>
<p>The Avro schema definition file for the preceding example:</p>
<p>File path: <code>/home/ggadp/avromdpGG_AVRO.TCUSTMER_AVRO.mdp.avsc</code></p>
<pre dir="ltr">
{"namespace": "GG_AVRO",
"type": "record",
"name": "TCUSTMER_AVRO",
"fields": [
     {"name": "NAME", "type": "string"},
    {"name": "CUST_CODE2",  "type": "string", "primary_key":true},
     {"name": "CITY2", "type": "string"},
     {"name": "STATE", "type": ["string","null"]}
]
}
</pre>
<p>The configuration in the Java Adapter properties file includes the following:</p>
<pre dir="ltr">
gg.mdp.type = avro
gg.mdp.schemaFilesPath = /home/ggadp/avromdp
</pre>
<p>Following is the sample output using delimited text formatter with a semi-colon as the delimiter for the preceding example.</p>
<pre dir="ltr">
I;GG_AVRO.TCUSTMER_AVRO;2013-06-02 22:14:36.000000;NAME;BG SOFTWARE CO;CUST_CODE2;WILL;CITY2;SEATTLE;STATE;WA
</pre>
<p>The Oracle GoldenGate for Big Data installation include a sample Replicat configuration file, a sample Java Adapter properties file, and sample Avro schemas at:</p>
<p><span class="italic"><code>GoldenGate_install_directory</code></span><code>/AdapterExamples/big-data/metadata_provider/avro</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD579"></a>
<div class="props_rev_3"><a id="GUID-2B8DD4B9-CA20-41DA-BDA0-1E0F921E8B64"></a>
<h3 id="GADBD-GUID-2B8DD4B9-CA20-41DA-BDA0-1E0F921E8B64" class="sect3"><span class="enumeration_section">10.2.6</span> Metadata Change Event</h3>
<div>
<div class="section">
<p>The Avro schema definitions and the mappings in the Replicat configuration file may need to be modified if there is a DDL change in the source database tables. You may want to stop or suspend the Replicat process in the case of a metadata change event. The Replicat process can be stopped by adding the following to the Replicat configuration file (<code><span class="codeinlineitalic">process_name.</span>prm</code>):</p>
<p><code>DDL INCLUDE ALL, EVENTACTIONS (ABORT)</code></p>
<p>Alternatively, the Replicat process can be suspended by adding the following to the Replication configuration file.</p>
<p><code>DDL INCLUDE ALL, EVENTACTIONS (SUSPEND)</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD580"></a>
<div class="props_rev_3"><a id="GUID-97F91AE5-1461-41AC-98B6-50890313AC19"></a>
<h3 id="GADBD-GUID-97F91AE5-1461-41AC-98B6-50890313AC19" class="sect3"><span class="enumeration_section">10.2.7</span> Limitations</h3>
<div>
<div class="section">
<p>Avro bytes data type cannot be used as primary key.</p>
<p>The source to target mapping defined in the Replicat configuration file is static. Oracle GoldenGate 12.2 and later supports DDL propagation and source schema evolution for Oracle Databases as the replication source. However, evolution of the source schemas may be problematic the static mapping configured in the Replicat configuration file.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD581"></a>
<div class="props_rev_3"><a id="GUID-2EE6F213-BB7B-4D02-9FD3-BD84084C8CD9"></a>
<h3 id="GADBD-GUID-2EE6F213-BB7B-4D02-9FD3-BD84084C8CD9" class="sect3"><span class="enumeration_section">10.2.8</span> Troubleshooting</h3>
<div>
<p>This section contains the following:</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-91CF5CB4-627F-4E56-AF3C-BB72750B753E">Invalid Schema Files Location</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-9854F8C8-44C0-4F16-B3C0-54E5D32BCFD9">Invalid Schema File Name</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-9893F974-4F15-443A-BFBA-23CC5BCEA237">Invalid Namespace in Schema File</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-AAA0ADE9-1BC0-4C7D-A0A4-6F42A08684E4">Invalid Table Name in Schema File</a></strong><br /></li>
</ul>
</div>
<a id="GADBD582"></a>
<div class="props_rev_3"><a id="GUID-91CF5CB4-627F-4E56-AF3C-BB72750B753E"></a>
<h4 id="GADBD-GUID-91CF5CB4-627F-4E56-AF3C-BB72750B753E" class="sect4"><span class="enumeration_section">10.2.8.1</span> Invalid Schema Files Location</h4>
<div>
<div class="section">
<p>The Avro schema files directory location specified by the configuration property <code>gg.mdp.schemaFilesPath</code> should be a valid directory. Failure to configure a valid directory in <code>gg.mdp.schemaFilesPath</code> property leads to following exception:</p>
<pre dir="ltr">
oracle.goldengate.util.ConfigException: Error initializing Avro metadata provider
Specified schema location does not exist. {/path/to/schema/files/dir}
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD583"></a>
<div class="props_rev_3"><a id="GUID-9854F8C8-44C0-4F16-B3C0-54E5D32BCFD9"></a>
<h4 id="GADBD-GUID-9854F8C8-44C0-4F16-B3C0-54E5D32BCFD9" class="sect4"><span class="enumeration_section">10.2.8.2</span> Invalid Schema File Name</h4>
<div>
<div class="section">
<p>For every table mapped in the <code><span class="codeinlineitalic">process_name.</span>prm</code> file, a corresponding Avro schema file must be created in the directory specified in <code>gg.mdp.schemaFilesPath</code>.</p>
<p>For example, consider the following scenario:</p>
<p>Mapping:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, cust_code2=cust_code, CITY2 = CITY);
 
</pre>
<p>Property:</p>
<pre dir="ltr">
gg.mdp.schemaFilesPath=/home/usr/avro/
</pre>
<p>A file called <code>GG_AVRO.TCUSTMER_AVRO.mdp.avsc</code> must be created in the <code>/home/usr/avro/</code> directory. that is, <code>/home/usr/avro/GG_AVRO.TCUSTMER_AVRO.mdp.avsc</code></p>
<p>Failing to create the <code>/home/usr/avro/GG_AVRO.TCUSTMER_AVRO.mdp.avsc</code> file results in the following exception:</p>
<pre dir="ltr">
java.io.FileNotFoundException: /home/usr/avro/GG_AVRO.TCUSTMER_AVRO.mdp.avsc
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD584"></a>
<div class="props_rev_3"><a id="GUID-9893F974-4F15-443A-BFBA-23CC5BCEA237"></a>
<h4 id="GADBD-GUID-9893F974-4F15-443A-BFBA-23CC5BCEA237" class="sect4"><span class="enumeration_section">10.2.8.3</span> Invalid Namespace in Schema File</h4>
<div>
<div class="section">
<p>The target schema name specified in <code>REPLICAT</code> mapping must be same as namespace in the Avro schema definition file.</p>
<p>For example, consider the following scenario:</p>
<p><span class="bold">Mapping</span>:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, cust_code2 = cust_code, CITY2 = CITY);
 
Avro Schema Definition:
 
{
"namespace": "GG_AVRO",
..
}
</pre>
<p>In this scenario, <code>REPLICAT</code> abends with following exception if the target schema name specified in Replicat mapping does not match with Avro schema namespace:</p>
<pre dir="ltr">
Unable to retrieve table matadata. Table : GG_AVRO.TCUSTMER_AVRO
Mapped [catalogname.]schemaname (GG_AVRO) does not match with the schema namespace {schema namespace}
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD585"></a>
<div class="props_rev_3"><a id="GUID-AAA0ADE9-1BC0-4C7D-A0A4-6F42A08684E4"></a>
<h4 id="GADBD-GUID-AAA0ADE9-1BC0-4C7D-A0A4-6F42A08684E4" class="sect4"><span class="enumeration_section">10.2.8.4</span> Invalid Table Name in Schema File</h4>
<div>
<div class="section">
<p>The target table name specified in Replicat mapping must be same as name in the Avro schema definition file.</p>
<p>For example, consider the following scenario:</p>
<p>Mapping:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, cust_code2 = cust_code, CITY2 = CITY);
</pre>
<p>Avro Schema Definition:</p>
<pre dir="ltr">
{
"namespace": "GG_AVRO",
"name": "TCUSTMER_AVRO",
..
}
</pre>
<p>In this scenario, <code>REPLICAT</code> abends with following exception if the target table name specified in Replicat mapping does not match with Avro schema name.</p>
<pre dir="ltr">
Unable to retrieve table matadata. Table : GG_AVRO.TCUSTMER_AVRO
Mapped table name (TCUSTMER_AVRO) does not match with the schema table name {table name}
</pre></div>
<!-- class="section" --></div>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-DB549C6D-6B63-49BD-AFFA-99B7897E0446"></a>
<h2 id="GADBD-GUID-DB549C6D-6B63-49BD-AFFA-99B7897E0446" class="sect2"><span class="enumeration_section">10.3</span> Java Database Connectivity Metadata Provider</h2>
<div>
<p>The Java Database Connectivity (JDBC) Metadata Provider is used to retrieve the table metadata from any target database that supports a JDBC connection and has a database schema. The JDBC Metadata Provider should be the preferred metadata provider for any target database that is an RDBMS, although there are various other non-RDBMS targets that also provide a JDBC driver</p>
<p>This section contains the following:</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-73D77AFF-7DE6-4B59-8876-00B151AFAE74">JDBC Detailed Functionality</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-2CE6B1B1-7589-4A03-9757-3C69BE1171C2">Java Classpath</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-E11DF6E2-6B08-4DF2-A214-723B03585914">JDBC Metadata Provider Configuration</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-A4FA5A42-4557-4824-9DEB-3BDDCFD1AA5D">Sample Configuration</a></strong><br /></li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-73D77AFF-7DE6-4B59-8876-00B151AFAE74"></a>
<h3 id="GADBD-GUID-73D77AFF-7DE6-4B59-8876-00B151AFAE74" class="sect3"><span class="enumeration_section">10.3.1</span> JDBC Detailed Functionality</h3>
<div>
<div class="section">
<p>The JDBC Metadata Provider uses the JDBC Driver provided with your target database. The metadata is retrieved using the JDBC Driver for every target table mapped in the Replicat properties file. Replicat processes use the retrieved target metadata for the column mapping functionality.</p>
<p>You can enable this feature for JDBC Handler by configuring the <code>REPERROR</code> in your Replicat parameter file. In addition, you need to define the error codes specific to your RDBMS JDBC target in the JDBC Handler properties file as follows:</p>
<div class="tblformal" id="GUID-73D77AFF-7DE6-4B59-8876-00B151AFAE74__GUID-072A8835-B2B4-47B3-ACBC-B27C38EB019C">
<p class="titleintable">Table 10-1 JDBC <code>REPERROR</code> Codes</p>
<table class="cellalignment52" title="JDBC REPERROR Codes" summary="A three column table detailing the REPERROR error codes.">
<thead align="left">
<tr>
<th class="cellalignment54" id="d39581e928">Property</th>
<th class="cellalignment54" id="d39581e930">Value</th>
<th class="cellalignment54" id="d39581e932">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment54" id="d39581e936" headers="d39581e928">
<pre dir="ltr">
gg.error.duplicateErrorCodes
</pre></td>
<td class="cellalignment54" headers="d39581e936 d39581e930">
<p>Comma-separated integer values of error codes that mean duplicate errors</p>
</td>
<td class="cellalignment54" headers="d39581e936 d39581e932">
<p>No</p>
</td>
</tr>
<tr>
<td class="cellalignment54" id="d39581e946" headers="d39581e928">
<pre dir="ltr">
gg.error.notFoundErrorCodes
</pre></td>
<td class="cellalignment54" headers="d39581e946 d39581e930">
<p>Comma-separated integer values of error codes that mean duplicate errors</p>
</td>
<td class="cellalignment54" headers="d39581e946 d39581e932">
<p>No</p>
</td>
</tr>
<tr>
<td class="cellalignment54" id="d39581e956" headers="d39581e928">
<pre dir="ltr">
gg.error.deadlockErrorCodes 
</pre></td>
<td class="cellalignment54" headers="d39581e956 d39581e930">
<p>Comma-separated integer values of error codes that mean duplicate errors</p>
</td>
<td class="cellalignment54" headers="d39581e956 d39581e932">
<p>No</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>For example:</p>
<pre dir="ltr">
#ErrorCode
gg.error.duplicateErrorCodes=1062,1088,1092,1291,1330,1331,1332,1333
gg.error.notFoundErrorCodes=0
gg.error.deadlockErrorCodes=1213
</pre>
<p>To understand how the various JDBC types are mapped to database-specific SQL types, review the specifics at:</p>
<p><a href="https://docs.oracle.com/javase/6/docs/technotes/guides/jdbc/getstart/mapping.html#table1" target="_blank">https://docs.oracle.com/javase/6/docs/technotes/guides/jdbc/getstart/mapping.html#table1</a></p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-2CE6B1B1-7589-4A03-9757-3C69BE1171C2"></a>
<h3 id="GADBD-GUID-2CE6B1B1-7589-4A03-9757-3C69BE1171C2" class="sect3"><span class="enumeration_section">10.3.2</span> Java Classpath</h3>
<div>
<p>The JDBC Java Driver location must be included in the class path of the handler using the <code>gg.classpath</code> property.</p>
<p>For example, the configuration for a MySQL database could be:</p>
<pre dir="ltr">
gg.classpath= /path/to/jdbc/driver/jar/mysql-connector-java-5.1.39-bin.jar
</pre></div>
</div>
<div class="props_rev_3"><a id="GUID-E11DF6E2-6B08-4DF2-A214-723B03585914"></a>
<h3 id="GADBD-GUID-E11DF6E2-6B08-4DF2-A214-723B03585914" class="sect3"><span class="enumeration_section">10.3.3</span> JDBC Metadata Provider Configuration</h3>
<div>
<div class="section">
<p>The following are the configurable values for the JDBC Metadata Provider. These properties are located in the Java Adapter properties file (not in the Replicat properties file).</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-E11DF6E2-6B08-4DF2-A214-723B03585914__GUID-2F0D04A3-FC62-428E-A3AC-44349A09933F">
<p class="titleintable">Table 10-2 JDBC Metadata Provider Properties</p>
<table class="cellalignment52" title="JDBC Metadata Provider Properties" summary="JDBC Metadata Provider Properties">
<thead align="left">
<tr>
<th class="cellalignment55" id="d39581e1031">Properties</th>
<th class="cellalignment56" id="d39581e1034">Required/ Optional</th>
<th class="cellalignment57" id="d39581e1037">Legal Values</th>
<th class="cellalignment58" id="d39581e1040">Default</th>
<th class="cellalignment59" id="d39581e1043">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment55" id="d39581e1048" headers="d39581e1031">
<p><code>gg.mdp.type</code></p>
</td>
<td class="cellalignment56" headers="d39581e1048 d39581e1034">
<p>Required</p>
</td>
<td class="cellalignment57" headers="d39581e1048 d39581e1037">
<p><code>jdbc</code></p>
</td>
<td class="cellalignment58" headers="d39581e1048 d39581e1040">
<p>None</p>
</td>
<td class="cellalignment59" headers="d39581e1048 d39581e1043">
<p>Entering <code>jdbc</code> at a command prompt activates the use of the JDBC Metadata Provider.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d39581e1069" headers="d39581e1031">
<p><code>gg.mdp.ConnectionUrl</code></p>
</td>
<td class="cellalignment56" headers="d39581e1069 d39581e1034">
<p>Required</p>
</td>
<td class="cellalignment57" headers="d39581e1069 d39581e1037">
<p><code>jdbc:<span class="codeinlineitalic">subprotocol</span>:<span class="codeinlineitalic">subname</span></code></p>
</td>
<td class="cellalignment58" headers="d39581e1069 d39581e1040">
<p>None</p>
</td>
<td class="cellalignment59" headers="d39581e1069 d39581e1043">
<p>The target database JDBC URL.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d39581e1092" headers="d39581e1031">
<p><code>gg.mdp.DriverClassName</code></p>
</td>
<td class="cellalignment56" headers="d39581e1092 d39581e1034">
<p>Required</p>
</td>
<td class="cellalignment57" headers="d39581e1092 d39581e1037">
<p>Java class name of the JDBC driver</p>
</td>
<td class="cellalignment58" headers="d39581e1092 d39581e1040">
<p>None</p>
</td>
<td class="cellalignment59" headers="d39581e1092 d39581e1043">
<p>The fully qualified Java class name of the JDBC driver.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d39581e1109" headers="d39581e1031">
<p><code>gg.mdp.userName</code></p>
</td>
<td class="cellalignment56" headers="d39581e1109 d39581e1034">
<p>Optional</p>
</td>
<td class="cellalignment57" headers="d39581e1109 d39581e1037">
<p>A legal username string.</p>
</td>
<td class="cellalignment58" headers="d39581e1109 d39581e1040">
<p>None</p>
</td>
<td class="cellalignment59" headers="d39581e1109 d39581e1043">
<p>The user name for the JDBC connection. Alternatively, you can provide the user name using the <code>ConnectionURL</code> property.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d39581e1129" headers="d39581e1031">
<p><code>gg.mdp.password</code></p>
</td>
<td class="cellalignment56" headers="d39581e1129 d39581e1034">
<p>Optional</p>
</td>
<td class="cellalignment57" headers="d39581e1129 d39581e1037">
<p>A legal password string.</p>
</td>
<td class="cellalignment58" headers="d39581e1129 d39581e1040">
<p>None</p>
</td>
<td class="cellalignment59" headers="d39581e1129 d39581e1043">
<p>The password for the JDBC connection. Alternatively, you can provide the user name using the <code>ConnectionURL</code> property.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<div class="props_rev_3"><a id="GUID-A4FA5A42-4557-4824-9DEB-3BDDCFD1AA5D"></a>
<h3 id="GADBD-GUID-A4FA5A42-4557-4824-9DEB-3BDDCFD1AA5D" class="sect3"><span class="enumeration_section">10.3.4</span> Sample Configuration</h3>
<div>
<div class="section">
<p>This section provides examples for configuring the JDBC Metadata Provider.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">MySQL Driver configuration:</p>
<pre dir="ltr">
gg.mdp.type=jdbc
gg.mdp.ConnectionUrl=jdbc:oracle:thin:@<span class="italic">myhost</span>:<span class="italic">1521</span>:<span class="italic">orcl</span>
gg.mdp.DriverClassName=oracle.jdbc.driver.OracleDriver
gg.mdp.UserName=<span class="italic">username</span>
gg.mdp.Password=<span class="italic">password</span>

</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Oracle Thin Driver configuration:</p>
<pre dir="ltr">
gg.mdp.type=jdbc
gg.mdp.ConnectionUrl=jdbc:mysql://localhost/<span class="italic">databaseName</span>?user=<span class="italic">username</span>&amp;password=<span class="italic">password</span>
gg.mdp.DriverClassName=com.mysql.jdbc.Driver
gg.mdp.UserName=<span class="italic">username</span>
gg.mdp.Password=<span class="italic">password</span>

</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Oracle OCI Driver configuration:</p>
<pre dir="ltr">
ggg.mdp.type=jdbc
gg.mdp.ConnectionUrl=jdbc:oracle:oci:@<span class="italic">myhost</span>:<span class="italic">1521</span>:<span class="italic">orcl</span>
gg.mdp.DriverClassName=oracle.jdbc.driver.OracleDriver
gg.mdp.UserName=<span class="italic">username</span>
gg.mdp.Password=<span class="italic">password</span>
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Oracle Teradata Driver configuration:</p>
<pre dir="ltr">
gg.mdp.type=jdbc
gg.mdp.ConnectionUrl=jdbc:teradata://10.111.11.111/USER=<span class="italic">username</span>,PASSWORD=<span class="italic">password</span>
gg.mdp.DriverClassName=com.teradata.jdbc.TeraDrivergg.mdp.UserName=<span class="italic">username</span>
gg.mdp.UserName=<span class="italic">username</span>
gg.mdp.Password=<span class="italic">password</span>
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="GADBD586"></a>
<div class="props_rev_3"><a id="GUID-B68DF414-3FE0-4C0D-B13B-BC9A024DABD5"></a>
<h2 id="GADBD-GUID-B68DF414-3FE0-4C0D-B13B-BC9A024DABD5" class="sect2"><span class="enumeration_section">10.4</span> Hive Metadata Provider</h2>
<div>
<p>The Hive Metadata Provider is used to retrieve the table metadata from a Hive metastore. The metadata will be retrieved from Hive for every target table mapped in the Replicat properties file using the <code>COLMAP</code> parameter. The retrieved target metadata is used by Replicat for the column mapping functionality.</p>
<p>This sections contains the following:</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-26B08DED-3F72-4908-BA20-1DDE0533194E">Detailed Functionality</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-1F60E8D7-F8D9-4BA5-82F0-6499DA504034">Configuring Hive with a Remote Metastore Database</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-878B8590-AACE-49BF-A367-88C0A16B4A44">Classpath Configuration</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-F8FF91E9-ACF0-42F9-9DAE-A7C6833DB549">Hive Metadata Provider Configuration</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-D9AE0617-12FC-4B9A-BF15-BE929B5C94CF">Sample Configuration</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-1C45DFF2-5247-4784-875A-C2C0F18D23B0">Security</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-98187D5F-3EF3-44F7-B513-C66196DF930D">Metadata Change Event</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-1F284EFF-8A92-4EA6-8AA0-5641C0CEB7F3">Limitations</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-97EA18DB-4FBC-405B-86E0-ADAB9ACC3EAB">Additional Considerations</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-BC62F29D-179D-4B8C-A440-AB7469C34BB5">Troubleshooting</a></strong><br /></li>
</ul>
</div>
<a id="GADBD588"></a><a id="GADBD589"></a><a id="GADBD587"></a>
<div class="props_rev_3"><a id="GUID-26B08DED-3F72-4908-BA20-1DDE0533194E"></a>
<h3 id="GADBD-GUID-26B08DED-3F72-4908-BA20-1DDE0533194E" class="sect3"><span class="enumeration_section">10.4.1</span> Detailed Functionality</h3>
<div>
<div class="section">
<p>The Hive Metadata Provider uses both Hive JDBC and HCatalog interfaces to retrieve metadata from the Hive metastore. For each table mapped in the <code><span class="codeinlineitalic">process_name</span>.prm</code> file, a corresponding table should be created in Hive.</p>
<p>The default Hive configuration starts an embedded and local metastore Derby database. Apache Derby is designed to be an embedded database and only allows a single connection. The single connection limitation of the Derby Database as the Hive Metastore implementation means that it cannot function when working with the Hive Metadata Provider. To overcome this, you must configure Hive with a remote metastore database. More information on configuring Hive with remote metastore database can found at:</p>
<p><a href="https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-RemoteMetastoreDatabase" target="_blank"><code>https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-RemoteMetastoreDatabase</code></a></p>
<p>Hive does not support Primary Key semantics, so the metadata retrieved from Hive metastore will not include any primary key definition. Replicat's <code>KEYCOLS</code> parameter should be used to define primary keys when you use the Hive Metadata Provider.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3"><code>KEYCOLS</code></p>
</div>
<!-- class="section" -->
<div class="section">
<p>The Replicat mapping <code>KEYCOLS</code> parameter must be used to define primary keys in the target schema. The Oracle GoldenGate HBase Handler requires primary keys. Therefore, setting primary keys in the target schema is required when Replicat mapping is employed with HBase as the target.</p>
<p>Additionally, the output of the Avro Formatters includes an Array field to hold the primary column names. If Replicat mapping is employed with the Avro Formatters you should consider using <code>KEYCOLS</code> to identify the primary key columns.</p>
<p>Examples of configuring <code>KEYCOLS</code> is described in <a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-D9AE0617-12FC-4B9A-BF15-BE929B5C94CF">Sample Configuration</a>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Supported Hive Data types:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code>BIGINT</code></p>
</li>
<li>
<p><code>BINARY</code></p>
</li>
<li>
<p><code>BOOLEAN</code></p>
</li>
<li>
<p><code>CHAR</code></p>
</li>
<li>
<p><code>DATE</code></p>
</li>
<li>
<p><code>DECIMAL</code></p>
</li>
<li>
<p><code>DOUBLE</code></p>
</li>
<li>
<p><code>FLOAT</code></p>
</li>
<li>
<p><code>INT</code></p>
</li>
<li>
<p><code>SMALLINT</code></p>
</li>
<li>
<p><code>STRING</code></p>
</li>
<li>
<p><code>TIMESTAMP</code></p>
</li>
<li>
<p><code>TINYINT</code></p>
</li>
<li>
<p><code>VARCHAR</code></p>
</li>
</ul>
<p>For more information on Hive data types, see <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Types" target="_blank"><code>https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Types</code></a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD590"></a>
<div class="props_rev_3"><a id="GUID-1F60E8D7-F8D9-4BA5-82F0-6499DA504034"></a>
<h3 id="GADBD-GUID-1F60E8D7-F8D9-4BA5-82F0-6499DA504034" class="sect3"><span class="enumeration_section">10.4.2</span> Configuring Hive with a Remote Metastore Database</h3>
<div>
<div class="section">
<p>A list of supported databases that can be used to configure remote Hive metastore can be found at <a href="https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-SupportedBackendDatabasesforMetastore" target="_blank"><code>https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-SupportedBackendDatabasesforMetastore</code></a>.</p>
<p>In the following example, a MySQL database is configured as the Hive metastore using the following properties in the <code>${HIVE_HOME}/conf/hive-site.xml</code> Hive configuration file:</p>
<div class="infobox-note" id="GUID-1F60E8D7-F8D9-4BA5-82F0-6499DA504034__GUID-ADE3F1F6-982B-4034-8C9E-17EFB6A78AB7">
<p class="notep1">Note:</p>
<p>The <code>ConnectionURL</code> and driver class used in this example are specific to MySQL database. Change the values appropriately if any database other than MySQL is chosen.</p>
</div>
<pre dir="ltr">
&lt;property&gt;
         &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;        
         &lt;value&gt;jdbc:mysql://<span class="italic">MYSQL_DB_IP</span>:<span class="italic">MYSQL_DB_PORT</span>/<span class="italic">DB_NAME</span>?createDatabaseIfNotExist=false&lt;/value&gt;
 &lt;/property&gt;
 
 &lt;property&gt;
        &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
        &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
 &lt;/property&gt;
 
 &lt;property&gt;
          &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;
     &lt;value&gt;<span class="italic">MYSQL_CONNECTION_USERNAME</span>&lt;/value&gt;
 &lt;/property&gt;
 
 &lt;property&gt;
         &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;
         &lt;value&gt;<span class="italic">MYSQL_CONNECTION_PASSWORD</span>&lt;/value&gt;
 &lt;/property&gt;
</pre>
<p>The list of parameters to be configured in the <code>hive-site.xml</code> file for a remote metastore can be found at <a href="https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-RemoteMetastoreDatabase" target="_blank"><code>https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-RemoteMetastoreDatabase</code></a>.</p>
<div class="infobox-note" id="GUID-1F60E8D7-F8D9-4BA5-82F0-6499DA504034__GUID-08030351-8E6B-457B-AE50-ED4350D7120D">
<p class="notep1">Note:</p>
<p>MySQL JDBC connector JAR must be added in the Hive classpath:</p>
<ol>
<li>
<p>In <span class="italic"><code>HIVE_HOME</code></span><code>/lib/</code> directory. <span class="italic"><code>DB_NAME</code></span> should be replaced by a valid database name created in MySQL.</p>
</li>
<li>
<p>Start the Hive Server:</p>
<p><span class="italic"><code>HIVE_HOME</code></span><code>/bin/hiveserver2/bin/hiveserver2</code></p>
</li>
<li>
<p>Start the Hive Remote Metastore Server:</p>
<p><span class="italic"><code>HIVE_HOME</code></span><code>/bin/hive --service metastore</code></p>
</li>
</ol>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD591"></a>
<div class="props_rev_3"><a id="GUID-878B8590-AACE-49BF-A367-88C0A16B4A44"></a>
<h3 id="GADBD-GUID-878B8590-AACE-49BF-A367-88C0A16B4A44" class="sect3"><span class="enumeration_section">10.4.3</span> Classpath Configuration</h3>
<div>
<div class="section">
<p>You must configure two things in the <code>gg.classpath</code> configuration variable in order for the Hive Metadata Provider to connect to Hive and run. The first is the <code>hive-site.xml</code> file and the second are the Hive and HDFS client jars. The client JARs must match the version of Hive that the Hive Metadata Provider is connecting.</p>
<ol>
<li>
<p>Create <code>hive-site.xml</code> file with the following properties:</p>
<pre dir="ltr">
&lt;configuration&gt;
&lt;!-- Mandatory Property --&gt; 
&lt;property&gt;
&lt;name&gt;hive.metastore.uris&lt;/name&gt;
&lt;value&gt;thrift://<span class="italic">HIVE_SERVER_HOST_IP</span>:9083&lt;/value&gt;
&lt;property&gt;
 
&lt;!-- Optional Property. Default value is 5 --&gt;
&lt;property&gt;
&lt;name&gt;hive.metastore.connect.retries&lt;/name&gt;
&lt;value&gt;3&lt;/value&gt;
&lt;/property&gt;
 
&lt;!-- Optional Property. Default value is 1 --&gt;
&lt;property&gt;
&lt;name&gt;hive.metastore.client.connect.retry.delay&lt;/name&gt;
&lt;value&gt;10&lt;/value&gt;
&lt;/property&gt;
 
&lt;!-- Optional Property. Default value is 600 seconds --&gt;
&lt;property&gt;
&lt;name&gt;hive.metastore.client.socket.timeout&lt;/name&gt;
&lt;value&gt;50&lt;/value&gt;
&lt;/property&gt;

 &lt;/configuration&gt;
</pre>
<div class="infobox-note" id="GUID-878B8590-AACE-49BF-A367-88C0A16B4A44__GUID-AA8533BE-986D-46FE-9FC2-18DECEFFC577">
<p class="notep1">Note:</p>
<p>For example, if the <code>hive-site.xml</code> file is created in the <code>/home/user/oggadp/dirprm</code> directory, then <code>gg.classpath</code> entry is <code>gg.classpath=/home/user/oggadp/dirprm/</code></p>
</div>
</li>
<li>
<p>The default location of the Hive and HDFS client jars are the following directories:</p>
<pre dir="ltr">
<span class="italic">HIVE_HOME</span>/hcatalog/share/hcatalog/*
<span class="italic">HIVE_HOME</span>/lib/*
<span class="italic">HIVE_HOME</span>/hcatalog/share/webhcat/java-client/*
<span class="italic">HADOOP_HOME</span>/share/hadoop/common/*
<span class="italic">HADOOP_HOME</span>/share/hadoop/common/lib/*
<span class="italic">HADOOP_HOME</span>/share/hadoop/mapreduce/*
</pre>
<p>Configure the <code>gg.classpath</code> exactly as shown in the preceding step. Creating a path to the <code>hive-site.xml</code> should contain the path with no wildcard appended. The inclusion of the <code>*</code> wildcard in the path to the <code>hive-site.xml</code> file causes it not to be picked up. Conversely, creating a path to the dependency JARs should include the <code>*</code> wildcard character to include all of the JAR files in that directory in the associated classpath. Do <span class="italic">not</span> use <code>*.jar.</code></p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD592"></a>
<div class="props_rev_3"><a id="GUID-F8FF91E9-ACF0-42F9-9DAE-A7C6833DB549"></a>
<h3 id="GADBD-GUID-F8FF91E9-ACF0-42F9-9DAE-A7C6833DB549" class="sect3"><span class="enumeration_section">10.4.4</span> Hive Metadata Provider Configuration</h3>
<div>
<div class="section">
<p>The configuration properties of the Hive Metadata Provider are detailed in this section.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-F8FF91E9-ACF0-42F9-9DAE-A7C6833DB549__GUID-C30F24BE-80E3-4DB5-A6D0-5692F16F22EB">
<hr />
<table class="cellalignment52" summary="Five column table describing the configuration properties of the Hive Metadata Provider">
<thead align="left">
<tr>
<th class="cellalignment69" id="d39581e1694">Property</th>
<th class="cellalignment70" id="d39581e1698">Required/Optional</th>
<th class="cellalignment71" id="d39581e1705">Legal Values</th>
<th class="cellalignment56" id="d39581e1709">Default</th>
<th class="cellalignment72" id="d39581e1713">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment69" id="d39581e1719" headers="d39581e1694">
<p><code>gg.mdp.type</code></p>
</td>
<td class="cellalignment70" headers="d39581e1719 d39581e1698">
<p>Required</p>
</td>
<td class="cellalignment71" headers="d39581e1719 d39581e1705">
<p><code>hive</code></p>
</td>
<td class="cellalignment56" headers="d39581e1719 d39581e1709">
<p><code>-</code></p>
</td>
<td class="cellalignment72" headers="d39581e1719 d39581e1713">
<p>Selects Hive Metadata Provider</p>
</td>
</tr>
<tr>
<td class="cellalignment69" id="d39581e1738" headers="d39581e1694">
<p><code>gg.mdp.connectionUrl</code></p>
</td>
<td class="cellalignment70" headers="d39581e1738 d39581e1698">
<p>Required</p>
</td>
<td class="cellalignment71" headers="d39581e1738 d39581e1705">
<p>Format without Kerberos Authentication:</p>
<p>j<code>dbc:hive2://</code><span class="italic"><code>HIVE_SERVER_IP:HIVE_JDBC_PORT/HIVE_DB</code></span></p>
<p>Format with Kerberos Authentication:</p>
<p><code>jdbc:hive2://</code><span class="italic"><code>HIVE_SERVER_IP:HIVE_JDBC_PORT/HIVE_DB;</code></span> <code>principal=user/FQDN@MY.REALM</code></p>
</td>
<td class="cellalignment56" headers="d39581e1738 d39581e1709">
<p><code>-</code></p>
</td>
<td class="cellalignment72" headers="d39581e1738 d39581e1713">
<p>JDBC Connection URL of Hive Server</p>
</td>
</tr>
<tr>
<td class="cellalignment69" id="d39581e1775" headers="d39581e1694">
<p><code>gg.mdp.driverClassName</code></p>
</td>
<td class="cellalignment70" headers="d39581e1775 d39581e1698">
<p>Required</p>
</td>
<td class="cellalignment71" headers="d39581e1775 d39581e1705">
<p><code>org.apache.hive.jdbc.HiveDriver</code></p>
</td>
<td class="cellalignment56" headers="d39581e1775 d39581e1709">
<p><code>-</code></p>
</td>
<td class="cellalignment72" headers="d39581e1775 d39581e1713">
<p>Fully qualified Hive JDBC Driver class name.</p>
</td>
</tr>
<tr>
<td class="cellalignment69" id="d39581e1794" headers="d39581e1694">
<p><code>gg.mdp.userName</code></p>
</td>
<td class="cellalignment70" headers="d39581e1794 d39581e1698">
<p>Optional</p>
</td>
<td class="cellalignment71" headers="d39581e1794 d39581e1705">
<p>Valid username</p>
</td>
<td class="cellalignment56" headers="d39581e1794 d39581e1709">
<p><code>""</code></p>
</td>
<td class="cellalignment72" headers="d39581e1794 d39581e1713">
<p>User name to connect to the Hive Database. The <code>userName</code> property is not required when Kerberos Authentication is used. The Kerberos principal should be specified in the connection URL as specified in <code>connectionUrl</code> property's legal values.</p>
</td>
</tr>
<tr>
<td class="cellalignment69" id="d39581e1818" headers="d39581e1694">
<p><code>gg.mdp.password</code></p>
</td>
<td class="cellalignment70" headers="d39581e1818 d39581e1698">
<p>Optional</p>
</td>
<td class="cellalignment71" headers="d39581e1818 d39581e1705">
<p>Valid Password</p>
</td>
<td class="cellalignment56" headers="d39581e1818 d39581e1709">
<p><code>""</code></p>
</td>
<td class="cellalignment72" headers="d39581e1818 d39581e1713">
<p>Password to connect to Hive Database</p>
</td>
</tr>
<tr>
<td class="cellalignment69" id="d39581e1836" headers="d39581e1694">
<p><code>gg.mdp.charset</code></p>
</td>
<td class="cellalignment70" headers="d39581e1836 d39581e1698">
<p>Optional</p>
</td>
<td class="cellalignment71" headers="d39581e1836 d39581e1705">
<p>Valid character set</p>
</td>
<td class="cellalignment56" headers="d39581e1836 d39581e1709">
<p><code>UTF-8</code></p>
</td>
<td class="cellalignment72" headers="d39581e1836 d39581e1713">
<p>Specifies the character set of the column with character data type. This is used to convert the source data from trail file to the correct target character set.</p>
</td>
</tr>
<tr>
<td class="cellalignment69" id="d39581e1855" headers="d39581e1694">
<p><code>gg.mdp.nationalCharset</code></p>
</td>
<td class="cellalignment70" headers="d39581e1855 d39581e1698">
<p>Optional</p>
</td>
<td class="cellalignment71" headers="d39581e1855 d39581e1705">
<p>Valid character set</p>
</td>
<td class="cellalignment56" headers="d39581e1855 d39581e1709">
<p><code>UTF-8</code></p>
</td>
<td class="cellalignment72" headers="d39581e1855 d39581e1713">
<p>Specifies the character set of the column with character data type. This is used to convert the source data from trail file to the correct target character set.</p>
<p>For example, Indicates character set of columns like <code>NCHAR</code>, <code>NVARCHAR</code> in an Oracle Database.</p>
</td>
</tr>
<tr>
<td class="cellalignment69" id="d39581e1881" headers="d39581e1694">
<p><code>gg.mdp.authType</code></p>
</td>
<td class="cellalignment70" headers="d39581e1881 d39581e1698">
<p>Optional</p>
</td>
<td class="cellalignment71" headers="d39581e1881 d39581e1705">
<p>kerberos</p>
</td>
<td class="cellalignment56" headers="d39581e1881 d39581e1709">
<p>none</p>
</td>
<td class="cellalignment72" headers="d39581e1881 d39581e1713">&nbsp;</td>
</tr>
<tr>
<td class="cellalignment69" id="d39581e1897" headers="d39581e1694">
<p><code>gg.mdp.kerberosKeytabFile</code></p>
</td>
<td class="cellalignment70" headers="d39581e1897 d39581e1698">
<p>Optional (Required if <code>authType=kerberos</code>)</p>
</td>
<td class="cellalignment71" headers="d39581e1897 d39581e1705">
<p>Relative or absolute path to a Kerberos keytab file.</p>
</td>
<td class="cellalignment56" headers="d39581e1897 d39581e1709">
<p><code>-</code></p>
</td>
<td class="cellalignment72" headers="d39581e1897 d39581e1713">
<p>The <code>keytab</code> file allows Hive to access a password to perform <code>kinit</code> operation for Kerberos security.</p>
</td>
</tr>
<tr>
<td class="cellalignment69" id="d39581e1924" headers="d39581e1694">
<p><code>gg.mdp.kerberosPrincipal</code></p>
</td>
<td class="cellalignment70" headers="d39581e1924 d39581e1698">
<p>Optional (Required if <code>authType=kerberos</code>)</p>
</td>
<td class="cellalignment71" headers="d39581e1924 d39581e1705">
<p>A legal Kerberos principal name(<code>user/FQDN@MY.REALM</code>)</p>
</td>
<td class="cellalignment56" headers="d39581e1924 d39581e1709">
<p><code>-</code></p>
</td>
<td class="cellalignment72" headers="d39581e1924 d39581e1713">
<p>The Kerberos principal name for Kerberos authentication.</p>
</td>
</tr>
</tbody>
</table>
<hr /></div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD593"></a>
<div class="props_rev_3"><a id="GUID-D9AE0617-12FC-4B9A-BF15-BE929B5C94CF"></a>
<h3 id="GADBD-GUID-D9AE0617-12FC-4B9A-BF15-BE929B5C94CF" class="sect3"><span class="enumeration_section">10.4.5</span> Sample Configuration</h3>
<div>
<div class="section">
<p>The following is an example for configuring the Hive Metadata Provider. Consider a source with following table:</p>
<pre dir="ltr">
TABLE GG.TCUSTMER {
     CUST_CODE VARCHAR(4)   PRIMARY KEY,
     NAME VARCHAR(100),
     CITY VARCHAR(200),
     STATE VARCHAR(200)}
</pre>
<p>The example maps the column <code>CUST_CODE</code> <code>(GG.TCUSTMER)</code> in the source to <code>CUST_CODE2</code> <code>(GG_HIVE.TCUSTMER_HIVE)</code> on the target and column <code>CITY</code> <code>(GG.TCUSTMER</code>) in the source to <code>CITY2</code> <code>(GG_HIVE.TCUSTMER_HIVE)</code>on the target.</p>
<p>Mapping configuration in the <code><span class="codeinlineitalic">process_name.</span>prm</code> file:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_HIVE.TCUSTMER_HIVE, COLMAP(USEDEFAULTS, CUST_CODE2=CUST_CODE, CITY2=CITY) KEYCOLS(CUST_CODE2); 
</pre>
<p>The mapping definition for this example is:</p>
<ul style="list-style-type: disc;">
<li>
<p>Source schema <code>GG</code> is mapped to target schema <code>GG_HIVE</code></p>
</li>
<li>
<p>Source column <code>CUST_CODE</code> is mapped to target column <code>CUST_CODE2</code></p>
</li>
<li>
<p>Source column <code>CITY</code> is mapped to target column <code>CITY2</code></p>
</li>
<li>
<p><code>USEDEFAULTS</code> specifies that rest of the columns names are same on both source and target (<code>NAME</code> and <code>STATE</code> columns).</p>
</li>
<li>
<p><code>KEYCOLS</code> is used to specify that <code>CUST_CODE2</code> should be treated as primary key.</p>
</li>
</ul>
<p>Since primary keys cannot be specified in Hive DDL, the <code>KEYCOLS</code> parameter is used to specify the primary keys.</p>
<p>Create schema and tables in Hive for the preceding example:</p>
<div class="infobox-note" id="GUID-D9AE0617-12FC-4B9A-BF15-BE929B5C94CF__GUID-94E8FF10-AA6C-4A60-BDA1-D69D1BAA004A">
<p class="notep1">Note:</p>
<p>You can choose any schema name and are not restricted to the <code>gg_hive schema</code> name. The Hive schema can be pre-existing or newly created. You do this by modifying the connection URL (<code>gg.mdp.connectionUrl</code>) in the Java Adapter properties file and the mapping configuration in the <code>Replicat.prm</code> file. Once the schema name is changed, the connection URL (<code>gg.mdp.connectionUrl</code>) and mapping in the <code>Replicat.prm</code> file should be updated.</p>
</div>
<p>To start the Hive CLI type the following command:</p>
<p><span class="italic"><code>HIVE_HOME</code></span><code>/bin/hive</code></p>
<p>To create a schema, <code>GG_HIVE</code>, in Hive, use the following command:</p>
<pre dir="ltr">
hive&gt; create schema gg_hive;
OK
Time taken: 0.02 seconds
</pre>
<p>To create a table <code>TCUSTMER_HIVE</code> in <code>GG_HIVE</code> database type the following command:</p>
<pre dir="ltr">
hive&gt; CREATE EXTERNAL TABLE `TCUSTMER_HIVE`(
    &gt;   "CUST_CODE2" VARCHAR(4),
    &gt;   "NAME" VARCHAR(30),
    &gt;   "CITY2" VARCHAR(20),
    &gt;   "STATE" STRING);
OK
Time taken: 0.056 seconds
</pre>
<p>Configuration in the <code>.properties</code> file can be like the following:</p>
<pre dir="ltr">
gg.mdp.type=hive
gg.mdp.connectionUrl=jdbc:hive2://<span class="italic">HIVE_SERVER_IP</span>:10000/gg_hive
gg.mdp.driverClassName=org.apache.hive.jdbc.HiveDriver
</pre>
<p>Following is the sample output using delimited text formatter with a comma as the delimiter for the preceding example.</p>
<pre dir="ltr">
I;GG_HIVE.TCUSTMER_HIVE;2015-10-07T04:50:47.519000;cust_code2;WILL;name;BG SOFTWARE CO;city2;SEATTLE;state;WA
</pre>
<p>A sample Replicat configuration file, Java Adapter properties file, and a Hive create table SQL script are included with the installation, and located at:</p>
<p><span class="italic"><code>GoldenGate_install_directory</code></span><code>/AdapterExamples/big-data/metadata_provider/hive</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD594"></a>
<div class="props_rev_3"><a id="GUID-1C45DFF2-5247-4784-875A-C2C0F18D23B0"></a>
<h3 id="GADBD-GUID-1C45DFF2-5247-4784-875A-C2C0F18D23B0" class="sect3"><span class="enumeration_section">10.4.6</span> Security</h3>
<div>
<div class="section">
<p>The Hive server can be secured using Kerberos Authentication. Refer to the Hive documentation for your specific Hive release for instructions on how to secure the Hive server. The Hive Metadata Provider can connect to a Kerberos secured Hive server.</p>
<p>The HDFS <code>core-site.xml</code> and <code>hive-site.xml</code> should be in handler's classpath.</p>
<p>Enable the following properties in <code>core-site.xml</code>:</p>
<pre dir="ltr">
&lt;property&gt;
&lt;name&gt;hadoop.security.authentication&lt;/name&gt;
&lt;value&gt;kerberos&lt;/value&gt; 
&lt;/property&gt;
 
&lt;property&gt; 
&lt;name&gt;hadoop.security.authorization&lt;/name&gt; 
&lt;value&gt;true&lt;/value&gt; 
&lt;/property&gt;
</pre>
<p>Enable the following properties in <code>hive-site.xml</code></p>
<pre dir="ltr">
&lt;property&gt;
&lt;name&gt;hive.metastore.sasl.enabled&lt;/name&gt;
&lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
 
&lt;property&gt;
&lt;name&gt;hive.metastore.kerberos.keytab.file&lt;/name&gt;
&lt;value&gt;/path/to/keytab&lt;/value&gt; &lt;!-- Change this value --&gt;
&lt;/property&gt;
 
&lt;property&gt;
&lt;name&gt;hive.metastore.kerberos.principal&lt;/name&gt;
&lt;value&gt;Kerberos Principal&lt;/value&gt; &lt;!-- Change this value --&gt;
&lt;/property&gt;
 
&lt;property&gt;
   &lt;name&gt;hive.server2.authentication&lt;/name&gt;
    &lt;value&gt;KERBEROS&lt;/value&gt;
&lt;/property&gt;
 
&lt;property&gt;
   &lt;name&gt;hive.server2.authentication.kerberos.principal&lt;/name&gt;
    &lt;value&gt;Kerberos Principal&lt;/value&gt; &lt;!-- Change this value --&gt;
&lt;/property&gt;
 
&lt;property&gt;
    &lt;name&gt;hive.server2.authentication.kerberos.keytab&lt;/name&gt;
    &lt;value&gt;/path/to/keytab&lt;/value&gt; &lt;!-- Change this value --&gt;
&lt;/property&gt;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD595"></a>
<div class="props_rev_3"><a id="GUID-98187D5F-3EF3-44F7-B513-C66196DF930D"></a>
<h3 id="GADBD-GUID-98187D5F-3EF3-44F7-B513-C66196DF930D" class="sect3"><span class="enumeration_section">10.4.7</span> Metadata Change Event</h3>
<div>
<div class="section">
<p>Tables in Hive metastore should be updated/altered/created manually if there is a change in source database tables. You may wish to abort or suspend the Replicat process in the case of a metadata change event. The Replicat process can be aborted by adding the following to the Replicat configuration file (<code><span class="codeinlineitalic">process_name.</span>prm</code>):</p>
<p><code>DDL INCLUDE ALL, EVENTACTIONS (ABORT)</code></p>
<p>Alternatively, the Replicat process can be suspended by adding the following to the Replication configuration file (<code><span class="codeinlineitalic">process_name.</span>prm</code>):</p>
<p><code>DDL INCLUDE ALL, EVENTACTIONS (SUSPEND)</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD596"></a>
<div class="props_rev_3"><a id="GUID-1F284EFF-8A92-4EA6-8AA0-5641C0CEB7F3"></a>
<h3 id="GADBD-GUID-1F284EFF-8A92-4EA6-8AA0-5641C0CEB7F3" class="sect3"><span class="enumeration_section">10.4.8</span> Limitations</h3>
<div>
<div class="section">
<p>Columns with binary data type cannot be used as primary key.</p>
<p>The source to target mapping defined in the Replicat configuration file is static. Oracle GoldenGate 12.2 and later supports DDL propagation and source schema evolution for Oracle Databases as the replication source. However, evolution of the source schemas may be problematic the static mapping configured in the Replicat configuration file.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD597"></a>
<div class="props_rev_3"><a id="GUID-97EA18DB-4FBC-405B-86E0-ADAB9ACC3EAB"></a>
<h3 id="GADBD-GUID-97EA18DB-4FBC-405B-86E0-ADAB9ACC3EAB" class="sect3"><span class="enumeration_section">10.4.9</span> Additional Considerations</h3>
<div>
<div class="section">
<p>The most common problems encountered are the Java classpath issues. The Hive Metadata Provider requires certain Hive and HDFS client libraries to be resolved in its classpath as a prerequisite.</p>
<p>The required client JAR directories are listed in <a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-878B8590-AACE-49BF-A367-88C0A16B4A44">Classpath Configuration</a>. Hive and HDFS client jars do not ship with Oracle GoldenGate for Big Data product. The client JARs should be the same version as the Hive version to which Hive Metadata Provider is connecting.</p>
<p>To establish a connection to the Hive server, the <code>hive-site.xml</code> file must be in the classpath.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD598"></a>
<div class="props_rev_3"><a id="GUID-BC62F29D-179D-4B8C-A440-AB7469C34BB5"></a>
<h3 id="GADBD-GUID-BC62F29D-179D-4B8C-A440-AB7469C34BB5" class="sect3"><span class="enumeration_section">10.4.10</span> Troubleshooting</h3>
<div>
<div class="section">
<p>The Replicat process will abend with a <span class="italic">"Table metadata resolution exception"</span> if the mapped target table does not exist in Hive.</p>
<p>For example, consider the following mapping:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_HIVE.TCUSTMER_HIVE, COLMAP(USEDEFAULTS, CUST_CODE2=CUST_CODE, CITY2=CITY) KEYCOLS(CUST_CODE2);

</pre>
<p>The preceding mapping requires a table called <code>TCUSTMER_HIVE</code> to be created in schema <code>GG_HIVE</code> in the Hive metastore. Failure to create the <code>GG_HIVE.TCUSTMER_HIVE</code> table in Hive will result in following exception:</p>
<pre dir="ltr">
ERROR [main) - Table Metadata Resolution Exception
Unable to retrieve table matadata. Table : GG_HIVE.TCUSTMER_HIVE
NoSuchObjectException(message:GG_HIVE.TCUSTMER_HIVE table not found)
</pre></div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment40">
<tr>
<td class="cellalignment47">
<table class="cellalignment51">
<tr>
<td class="cellalignment44"><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment44"><a href="GUID-1A409BCB-A8A2-41CD-B9D6-4D65D356D1A5.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2015, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment49">
<table class="cellalignment43">
<tr>
<td class="cellalignment44"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment44"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment44"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment44"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
