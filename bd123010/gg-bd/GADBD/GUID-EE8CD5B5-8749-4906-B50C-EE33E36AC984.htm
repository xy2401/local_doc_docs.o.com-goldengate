<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Using the Cassandra Handler</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2016-12-07T16:58:45Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Integrating Oracle GoldenGate for Big Data" />
<meta name="dcterms.identifier" content="E79598-01" />
<meta name="dcterms.isVersionOf" content="GADBD" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2015, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="GUID-2561CA12-9BAC-454B-A2E3-2D36C5C60EE5.htm" title="Previous" type="text/html" />
<link rel="Next" href="GUID-99985BA8-1EC6-4507-A3E1-56CE42F8C23E.htm" title="Next" type="text/html" />
<link rel="alternate" href="GADBD.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="GADBD.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="GADBD.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984"></a> <span id="PAGE" style="display:none;">9/19</span> <!-- End Header -->
<h1 id="GADBD-GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984" class="sect1"><span class="enumeration_chapter">6</span> Using the Cassandra Handler</h1>
<div>
<p>This chapter explains the Cassandra Handler and includes examples so that you can understand this functionality.</p>
<p><span class="bold">Topics:</span></p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-556ED26B-4CF0-440A-A457-A835EA1CD3C3">Overview</a></strong><br />
The Cassandra Handler provides the interface to Apache Cassandra databases.</li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-AC79514E-0938-4A92-9093-6B5AFE87EBC9">Detailed Functionality</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-C3AC0152-35C2-4E58-BDB1-7E3F6CAA655C">Setting Up and Running the Cassandra Handler</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-1B7ED49F-16B7-4B38-82EB-AFEC99C06BB8">Automated DDL Handling</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-F4363382-DDC4-45A4-831E-1C8A202A8F82">Performance Considerations</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-6A7D086D-84DD-4653-AED8-93411B301673">Additional Considerations</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-39AB73AD-2BB6-4825-8CF3-B3D24EF168F7">Troubleshooting</a></strong><br /></li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-556ED26B-4CF0-440A-A457-A835EA1CD3C3"></a>
<h2 id="GADBD-GUID-556ED26B-4CF0-440A-A457-A835EA1CD3C3" class="sect2"><span class="enumeration_section">6.1</span> Overview</h2>
<div>
<p>The Cassandra Handler provides the interface to Apache Cassandra databases.</p>
<div class="section">
<p>Apache Cassandra is a NoSQL Database Management System designed to store large amounts of data. A Cassandra cluster configuration provides horizontal scaling and replication of data across multiple machines. It can provide high-availability and eliminate a single point of failure by replicating data to multiple nodes within a Cassandra cluster. Apache Cassandra is open-source and designed to run on low cost commodity hardware.</p>
<p>Cassandra relaxes the axioms of traditional Relational Database Management Systems regarding atomicity, consistency, isolation, and durability. When considering implementing Cassandra it is important to understand its differences from a traditional RDBMS and how those differences affect your specific use case.</p>
<p>Cassandra provides eventual consistency. Under the eventual consistency model, accessing the state of data for a specific row will eventually return the latest state of the data for that row as defined by the most recent change. However, there may be a latency period between the creation and modification of the state of a row and what is returned when the state of that row is queried. The promise of eventual consistency is that the latency period is predictable based on your Cassandra configuration and the level of work load that your Cassandra cluster is currently under. See the Apache Cassandra website for more information:</p>
<p><a href="http://cassandra.apache.org/" target="_blank">http://cassandra.apache.org/</a></p>
<p>The Cassandra Handler provides some control over consistency with the configuration of the <code>gg.handler.name.consistencyLevel</code> property in the Java Adapter properties file.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-AC79514E-0938-4A92-9093-6B5AFE87EBC9"></a>
<h2 id="GADBD-GUID-AC79514E-0938-4A92-9093-6B5AFE87EBC9" class="sect2"><span class="enumeration_section">6.2</span> Detailed Functionality</h2>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-86AAA501-44A8-4099-9BA5-B45732F49BC9">Cassandra Data Types</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-1098485E-89E3-47F7-8811-230D334B9CBA">Catalog, Schema, Table, and Column Name Mapping</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-979E6279-DD6C-44CD-8021-3B1E9C5C6DAE">DDL Functionality</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-7F28C92F-2A0A-4C3B-B03F-2FEDDF47BC7A">Operation Processing</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-69B58DB7-EB16-4CB1-9419-4EB9E82D6E04">Compressed Updates vs. Full Image Updates</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-0CEE65D5-346F-431A-AA42-31E0AADDB00D">Primary Key Updates</a></strong><br /></li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-86AAA501-44A8-4099-9BA5-B45732F49BC9"></a>
<h3 id="GADBD-GUID-86AAA501-44A8-4099-9BA5-B45732F49BC9" class="sect3"><span class="enumeration_section">6.2.1</span> Cassandra Data Types</h3>
<div>
<div class="section">
<p>Cassandra provides a number of column data types and most of these data types are supported by the Cassandra Handler. A data type conversion from the column value in the source trail file to the corresponding Java type representing the Cassandra column type in the Cassandra Handler is required. This data conversion process does introduce the risk of a runtime conversion error. A poorly mapped field (like <code>varchar</code> as the source containing alpha numeric data to a Cassandra <code>int</code>) may cause a runtime error and cause the Cassandra Handler to abend. The following is a link to the Cassandra Java type mappings.</p>
<p><a href="https://github.com/datastax/java-driver/tree/3.x/manual#cql-to-java-type-mapping" target="_blank">https://github.com/datastax/java-driver/tree/3.x/manual#cql-to-java-type-mapping</a></p>
<p>The following Cassandra column data types are not supported:</p>
<ul style="list-style-type: disc;">
<li>
<p><code>list</code></p>
</li>
<li>
<p><code>map</code></p>
</li>
<li>
<p><code>set</code></p>
</li>
<li>
<p><code>tuple</code></p>
</li>
</ul>
<p>Certain use cases may exist where the data may require specialized processing to convert it to the corresponding Java type for intake into Cassandra. If this is the case, you have these options:</p>
<ol>
<li>
<p>You may be able to use the general regular expression search and replace functionality to get the source column value data formatted into a way that can be then converted into the Java data type for use in Cassandra.</p>
</li>
<li>
<p>You could implement or extend the default data type conversion logic to override it with your custom logic for your use case. If this is required, contact Oracle Support for guidance.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-1098485E-89E3-47F7-8811-230D334B9CBA"></a>
<h3 id="GADBD-GUID-1098485E-89E3-47F7-8811-230D334B9CBA" class="sect3"><span class="enumeration_section">6.2.2</span> Catalog, Schema, Table, and Column Name Mapping</h3>
<div>
<div class="section">
<p>Traditional RDBMSs separate structured data into tables. Related tables are included in higher-level collections called databases. Cassandra contains both of these concepts. Tables in an RDBMS are also tables in Cassandra while databases in an RDBMS are keyspaces in Cassandra.</p>
<p>It is important to understand how data maps from the metadata definition in the source trail file are mapped to the corresponding keyspace and table in Cassandra. Source tables are generally either two-part names defined as <code>schema.table</code>or three-part names defined as <code>catalog.schema.table</code>. The following table explains how catalog, schema, and table names map into Cassandra. Note that unless special syntax is used, Cassandra converts all keyspace, table names, and column names to lowercase.</p>
<div class="tblformal" id="GUID-1098485E-89E3-47F7-8811-230D334B9CBA__GUID-D49421DC-B6B5-45D5-BBA2-37E2E52C0D41">
<table class="cellalignment52" summary="Three column table describing Cassandra trail file, keyspace, and table names.">
<thead align="left">
<tr>
<th class="cellalignment53" id="d16937e247">Table Name in Source Trail File</th>
<th class="cellalignment53" id="d16937e250">Cassandra Keyspace Name</th>
<th class="cellalignment53" id="d16937e253">Cassandra Table Name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment54" rowspan="1" colspan="1" id="d16937e258" headers="d16937e247">
<p><code>QASOURCE.TCUSTMER</code></p>
</td>
<td class="cellalignment54" rowspan="1" colspan="1" headers="d16937e258 d16937e250">
<p><code>qasource</code></p>
</td>
<td class="cellalignment54" rowspan="1" colspan="1" headers="d16937e258 d16937e253">
<p><code>tcustmer</code></p>
</td>
</tr>
<tr>
<td class="cellalignment54" rowspan="1" colspan="1" id="d16937e271" headers="d16937e247">
<p><code>dbo.mytable</code></p>
</td>
<td class="cellalignment54" rowspan="1" colspan="1" headers="d16937e271 d16937e250">
<p><code>dbo</code></p>
</td>
<td class="cellalignment54" rowspan="1" colspan="1" headers="d16937e271 d16937e253">
<p><code>mytable</code></p>
</td>
</tr>
<tr>
<td class="cellalignment54" rowspan="1" colspan="1" id="d16937e284" headers="d16937e247">
<p><code>GG.QASOURCE.TCUSTORD</code></p>
</td>
<td class="cellalignment54" rowspan="1" colspan="1" headers="d16937e284 d16937e250">
<p><code>gg_qasource</code></p>
</td>
<td class="cellalignment54" rowspan="1" colspan="1" headers="d16937e284 d16937e253">
<p><code>tcustord</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-979E6279-DD6C-44CD-8021-3B1E9C5C6DAE"></a>
<h3 id="GADBD-GUID-979E6279-DD6C-44CD-8021-3B1E9C5C6DAE" class="sect3"><span class="enumeration_section">6.2.3</span> DDL Functionality</h3>
<div>
<div class="section"></div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-485955EE-29B2-4386-B3DC-E9975A71A768">Keyspaces</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-FA154135-EE2F-4CEC-9657-00D0A80D0BE4">Tables</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-FD83B4E2-A582-4F68-B219-58BDE98CD5C4">Add Column Functionality</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-E846FDEE-2C7D-4828-8514-05AC4BB40292">Drop Column Functionality</a></strong><br /></li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-485955EE-29B2-4386-B3DC-E9975A71A768"></a>
<h4 id="GADBD-GUID-485955EE-29B2-4386-B3DC-E9975A71A768" class="sect4"><span class="enumeration_section">6.2.3.1</span> Keyspaces</h4>
<div>
<div class="section">
<p class="subhead3"></p>
<p>The Cassandra Handler does <span class="italic">not</span> automatically create keyspaces in Cassandra. Keyspaces in Cassandra define a replication factor, the replication strategy, and topology. The Cassandra Handler does not possess enough information to create the keyspaces so you must manually create keyspaces.</p>
<p>You can create keyspaces in Cassandra using the <code>CREATE KEYSPACE</code> command from the Cassandra shell.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-FA154135-EE2F-4CEC-9657-00D0A80D0BE4"></a>
<h4 id="GADBD-GUID-FA154135-EE2F-4CEC-9657-00D0A80D0BE4" class="sect4"><span class="enumeration_section">6.2.3.2</span> Tables</h4>
<div>
<div class="section">
<p class="subhead3"></p>
<p>The Cassandra Handler can automatically create tables in Cassandra if you configure it to do so. The source table definition may be a poor source of information to create tables in Cassandra. Primary keys in Cassandra are divided into:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Partitioning keys</span> that define how data for a table is separated into partitions in Cassandra.</p>
</li>
<li>
<p><span class="bold">Clustering keys</span> that define the order of items within a partition.</p>
</li>
</ul>
<p>The default mapping for automated table creation is that the first primary key is the partition key and any additional primary keys are mapped as clustering keys.</p>
<p>Automated table creation by the Cassandra Handler may be fine for proof of concept though may result in data definitions that do not scale well. Creation of tables in Cassandra with poorly constructed primary keys may result in reduced performance for ingest and retrieval as the volume of data stored in Cassandra increases. Oracle recommends that you analyze the metadata of your replicated tables then strategically manually create the corresponding tables in Cassandra that are properly partitioned and clustered that can scale well.</p>
<p>Primary key definitions for tables in Cassandra are immutable once created. Changing a Cassandra table primary key definition requires the following manual steps:</p>
<ol>
<li>
<p>Create a staging table.</p>
</li>
<li>
<p>Populate the data in the staging table from original table.</p>
</li>
<li>
<p>Drop the original table.</p>
</li>
<li>
<p>Recreate the original table with the modified primary key definitions.</p>
</li>
<li>
<p>Populate the data in the original table from the staging table.</p>
</li>
<li>
<p>Drop the staging table.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-FD83B4E2-A582-4F68-B219-58BDE98CD5C4"></a>
<h4 id="GADBD-GUID-FD83B4E2-A582-4F68-B219-58BDE98CD5C4" class="sect4"><span class="enumeration_section">6.2.3.3</span> Add Column Functionality</h4>
<div>
<div class="section">
<p class="subhead3"></p>
<p>You can configure the Cassandra Handler to add columns that exist in the source trail file table definition though are missing in the Cassandra table definition. The Cassandra Handler can accommodate metadata change events of adding a column. A reconciliation process occurs that reconciles the source table definition to the Cassandra table definition. When configured to add columns, any columns found in the source table definition that do not exist in the Cassandra table definition are added. The reconciliation process for a table occurs after application start up the first time an operation for the table is encountered. The reconciliation process reoccurs after a metadata change event on a source table, when the first operation for the source table is encountered after the change event.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-E846FDEE-2C7D-4828-8514-05AC4BB40292"></a>
<h4 id="GADBD-GUID-E846FDEE-2C7D-4828-8514-05AC4BB40292" class="sect4"><span class="enumeration_section">6.2.3.4</span> Drop Column Functionality</h4>
<div>
<div class="section">
<p>You can configure the Cassandra Handler to drop columns that do not exist in the source trail file definition though exist in the Cassandra table definition. The Cassandra Handler can accommodate metadata change events of dropping a column. A reconciliation process occurs that reconciles the source table definition to the Cassandra table definition. When configured to drop columns any columns found in the Cassandra table definition that are not in the source table definition are dropped.</p>
<div class="infobox-note" id="GUID-E846FDEE-2C7D-4828-8514-05AC4BB40292__GUID-89422806-DA5A-4717-A872-F296B1D1E681">
<p class="notep1">Caution:</p>
<p>Dropping a column is potentially dangerous because it is permanently removing data from a Cassandra table. You should carefully consider your use case before configuring this mode.</p>
</div>
<div class="infobox-note" id="GUID-E846FDEE-2C7D-4828-8514-05AC4BB40292__GUID-B776842D-825C-4D3F-88F3-7BDC7AA442C2">
<p class="notep1">Note:</p>
<p>Primary key columns cannot be dropped. Attempting to do so results in an abend.</p>
</div>
<div class="infobox-note" id="GUID-E846FDEE-2C7D-4828-8514-05AC4BB40292__GUID-2488721B-8EF5-44CF-9DDB-AA8BE5D52934">
<p class="notep1">Note:</p>
<p>Column name changes are not well-handled because there is no actual DDL processing. A column name change event on the source database appears to the Cassandra Handler like dropping an existing column and adding a new column.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-7F28C92F-2A0A-4C3B-B03F-2FEDDF47BC7A"></a>
<h3 id="GADBD-GUID-7F28C92F-2A0A-4C3B-B03F-2FEDDF47BC7A" class="sect3"><span class="enumeration_section">6.2.4</span> Operation Processing</h3>
<div>
<div class="section">
<p>The Cassandra Handler pushes operations to Cassandra using either the asynchronous or synchronous API. In asynchronous mode, operations are flushed at transaction commit (grouped transaction commit using <code>GROUPTRANSOPS</code>) to ensure write durability. The Cassandra Handler does not interface with Cassandra in a transactional way.</p>
<p>Insert, update, and delete operations are processed differently in Cassandra than a traditional RDBMS. The following explains how insert, update, and delete operations are interpreted by Cassandra:</p>
<ul style="list-style-type: disc;">
<li>
<p>Inserts &ndash; If the row does not already exist in Cassandra, then an insert operation is processed as an insert. If the row already exists in Cassandra, then an insert operation is processed as an update.</p>
</li>
<li>
<p>Updates &ndash; &nbsp;If a row does not exist in Cassandra, then an update operation is processed as an insert. If the row already exists in Cassandra, then an update operation is processed as insert.</p>
</li>
<li>
<p>Delete &ndash; &nbsp;If the row does not exist in Cassandra, then a delete operation has no effect. If the row exists in Cassandra, then a delete operation is processed as a delete.</p>
</li>
</ul>
<p>The state of the data in Cassandra is eventually idempotent. You can replay the source trail files or replay sections of the trail files. Ultimately, the state of the Cassandra database should be the same regardless of the number of times the trail data was written into Cassandra.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-69B58DB7-EB16-4CB1-9419-4EB9E82D6E04"></a>
<h3 id="GADBD-GUID-69B58DB7-EB16-4CB1-9419-4EB9E82D6E04" class="sect3"><span class="enumeration_section">6.2.5</span> Compressed Updates vs. Full Image Updates</h3>
<div>
<div class="section">
<p>Oracle GoldenGate allows you to control the data that is propagated to the source trail file in the event of an update. The data for an update in the source trail file is either a compressed or a full image of the update and the column information is provided as follows:</p>
<dl>
<dt class="dlterm"><a id="GUID-69B58DB7-EB16-4CB1-9419-4EB9E82D6E04__GUID-1C746042-3029-4587-962F-E52D9FDC9D89"><!-- --></a>Compressed</dt>
<dd>
<p>For the primary keys and the columns for which the value changed. Data for columns that did not change is not provided in the trail file.</p>
</dd>
<dt class="dlterm"><a id="GUID-69B58DB7-EB16-4CB1-9419-4EB9E82D6E04__GUID-05D0D346-B659-4CB9-A899-2F34E2A45D39"><!-- --></a>Full Image</dt>
<dd>
<p>For all columns including primary keys, columns for which the value changed, and columns for which the value did not change.</p>
</dd>
</dl>
<p>The amount of available information on an update is important to the Cassandra Handler. If the source trail file contains full images of the change data then the Cassandra Handler can use prepared statements to perform row updates in Cassandra. Full images also allow the Cassandra Handler to perform primary key updates for a row in Cassandra. In Cassandra, primary keys are immutable so an update that changes a primary key must be treated as a delete and an insert. Conversely, compressed updates means that prepared statements cannot be used for Cassandra row updates. Simple statements identifying the changing values and primary keys must be dynamically created then executed. Compressed updates mean that primary key updates are not possible so the result is that the Cassandra Handler will abend.</p>
<p>You must set the control properties, <code>gg.handler.name.compressedUpdates</code> and <code>gg.handler.name.compressedUpdatesfor</code>, so that the handler expects either compressed or full image updates.</p>
<p>The default value, <code>true</code>, means that the Cassandra Handler expects compressed updates. Prepared statements are not be used for updates and primary key updates cause the handler to abend.</p>
<p>Setting the value to <code>false</code> means that prepared statements are used for updates and primary key updates can be processed. When the source trail file does not contain full image data, it is dangerous and can lead to corrupted data. This is because columns for which the data is missing are considered null and the null value is pushed to Cassandra. If you have doubts about whether the source trail files contains compressed or full image data, then you should set <code>gg.handler.name.compressedUpdates</code> to <code>true</code>.</p>
<p>In addition, CLOB and BLOB data types do not propagate LOB data in updates unless the LOB column value changed. So if the source tables contain LOB data, then you should set <code>gg.handler.name.compressedUpdates</code> to <code>true</code>.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-0CEE65D5-346F-431A-AA42-31E0AADDB00D"></a>
<h3 id="GADBD-GUID-0CEE65D5-346F-431A-AA42-31E0AADDB00D" class="sect3"><span class="enumeration_section">6.2.6</span> Primary Key Updates</h3>
<div>
<div class="section">
<p class="subhead3">Primary Key Updates</p>
<p>Primary key values for a row in Cassandra are immutable. An update operation that changes any primary key value for a Cassandra row must be treated as a delete and insert. The Cassandra Handler can process update operations that result in the change of a primary key in Cassandra only as a delete and insert. To successfully process this operation, the source trail file <span class="italic">must</span> contain the complete before and after change data images for all columns. The <code>gg.handler.name.compressed</code> configuration property of the Cassandra Handler must be set to <code>false</code> for primary key updates to be successfully processed.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-C3AC0152-35C2-4E58-BDB1-7E3F6CAA655C"></a>
<h2 id="GADBD-GUID-C3AC0152-35C2-4E58-BDB1-7E3F6CAA655C" class="sect2"><span class="enumeration_section">6.3</span> Setting Up and Running the Cassandra Handler</h2>
<div>
<div class="section">You must configure the following:
<p><span class="bold">Get the Driver Libraries</span></p>
<p>The Datastax Java Driver for Cassandra does not ship with Oracle GoldenGate for Big Data. The recommended version of the Datastax Java Driver for Cassandra is 3.1 and you download it at:</p>
<p><a href="https://github.com/datastax/java-driver" target="_blank">https://github.com/datastax/java-driver</a></p>
<p><span class="bold">Set the Classpath</span></p>
<div class="p">You must configure the <code>gg.classpath</code> configuration property in the Java Adapter properties file to specify the JARs for the Datastax Java Driver for Cassandra.
<pre dir="ltr">
gg.classpath={<span class="italic">download_dir</span>}/cassandra-java-driver-3.1.0/*:{<span class="italic">download_dir</span>}/cassandra-java-driver-3.1.0/lib/*
</pre></div>
<p>Instructions for configuring the Cassandra Handler components and running the handler are described in the following sections.</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-D6B85915-635C-4265-806F-C6E733F4713B">Cassandra Handler Configuration</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-F66D0F36-2CB1-476B-88E1-D74125A84D3A">Sample Configuration</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-0FC24DE6-0564-428A-AB5D-202A9DF220E7">Security</a></strong><br /></li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-D6B85915-635C-4265-806F-C6E733F4713B"></a>
<h3 id="GADBD-GUID-D6B85915-635C-4265-806F-C6E733F4713B" class="sect3"><span class="enumeration_section">6.3.1</span> Cassandra Handler Configuration</h3>
<div>
<div class="section">
<p>The following are the configurable values for the Cassandra Handler. These properties are located in the Java Adapter properties file (not in the Replicat properties file).</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-D6B85915-635C-4265-806F-C6E733F4713B__GUID-2F0D04A3-FC62-428E-A3AC-44349A09933F">
<p class="titleintable">Table 6-1 Cassandra Handler Configuration Properties</p>
<table class="cellalignment52" title="Cassandra Handler Configuration Properties" summary="Two column table describing the Cassandra Handler Configuration">
<thead align="left">
<tr>
<th class="cellalignment55" id="d16937e696">Properties</th>
<th class="cellalignment56" id="d16937e699">Required/ Optional</th>
<th class="cellalignment57" id="d16937e702">Legal Values</th>
<th class="cellalignment58" id="d16937e705">Default</th>
<th class="cellalignment59" id="d16937e708">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment55" id="d16937e713" headers="d16937e696">
<p><code>gg.handlerlist</code></p>
</td>
<td class="cellalignment56" headers="d16937e713 d16937e699">
<p>Required</p>
</td>
<td class="cellalignment57" headers="d16937e713 d16937e702">
<p>Any string</p>
</td>
<td class="cellalignment58" headers="d16937e713 d16937e705">
<p>None</p>
</td>
<td class="cellalignment59" headers="d16937e713 d16937e708">
<p>Provides a name for the Cassandra Handler. The Cassandra Handler name is then becomes part of the property names listed in this table.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d16937e730" headers="d16937e696">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>type=cassandra</code></p>
</td>
<td class="cellalignment56" headers="d16937e730 d16937e699">
<p>Required</p>
</td>
<td class="cellalignment57" headers="d16937e730 d16937e702">
<p><code>cassandra</code></p>
</td>
<td class="cellalignment58" headers="d16937e730 d16937e705">
<p>None</p>
</td>
<td class="cellalignment59" headers="d16937e730 d16937e708">
<p>Selects the Cassandra Handler for streaming change data capture into Cassandra.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d16937e753" headers="d16937e696">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>mode</code></p>
</td>
<td class="cellalignment56" headers="d16937e753 d16937e699">
<p>Optional</p>
</td>
<td class="cellalignment57" headers="d16937e753 d16937e702">
<p><code>op</code> | <code>tx</code></p>
</td>
<td class="cellalignment58" headers="d16937e753 d16937e705">
<p><code>op</code></p>
</td>
<td class="cellalignment59" headers="d16937e753 d16937e708">
<p>The default is recommended. In <code>op</code> mode, operations are processed as received. In <code>tx</code> mode, operations are cached and processed at transaction commit. The <code>tx</code>mode is slower and creates a larger memory footprint.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d16937e789" headers="d16937e696">
<p><code>gg.handler.</code><span class="italic"><code>name</code></span><code>.contactPoints=</code></p>
</td>
<td class="cellalignment56" headers="d16937e789 d16937e699">
<p>Optional</p>
</td>
<td class="cellalignment57" headers="d16937e789 d16937e702">
<p>A comma separated list of host names that the Cassandra Handler will connect to.</p>
</td>
<td class="cellalignment58" headers="d16937e789 d16937e705">
<p><code>localhost</code></p>
</td>
<td class="cellalignment59" headers="d16937e789 d16937e708">
<p>A comma separated list of the Cassandra host machines for the driver to establish an initial connection to the Cassandra cluster. This configuration property does <span class="italic">not</span> need to include all the machines enlisted in the Cassandra cluster. By connecting to a single machine, the driver can learn about other machines in the Cassandra cluster and establish connections to those machines as required.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d16937e815" headers="d16937e696">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>username</code></p>
</td>
<td class="cellalignment56" headers="d16937e815 d16937e699">
<p>Optional</p>
</td>
<td class="cellalignment57" headers="d16937e815 d16937e702">
<p>A legal username string.</p>
</td>
<td class="cellalignment58" headers="d16937e815 d16937e705">
<p>None</p>
</td>
<td class="cellalignment59" headers="d16937e815 d16937e708">
<p>A username for the connection to Cassandra. It is required if Cassandra is configured to require credentials.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d16937e837" headers="d16937e696">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>password</code></p>
</td>
<td class="cellalignment56" headers="d16937e837 d16937e699">
<p>Optional</p>
</td>
<td class="cellalignment57" headers="d16937e837 d16937e702">
<p>A legal password string.</p>
</td>
<td class="cellalignment58" headers="d16937e837 d16937e705">
<p>None</p>
</td>
<td class="cellalignment59" headers="d16937e837 d16937e708">
<p>A password for the connection to Cassandra. It is required if Cassandra is configured to require credentials.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d16937e859" headers="d16937e696">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>compressedUpdates</code></p>
</td>
<td class="cellalignment56" headers="d16937e859 d16937e699">
<p>Optional</p>
</td>
<td class="cellalignment57" headers="d16937e859 d16937e702">
<p><code>true</code> | <code>false</code></p>
</td>
<td class="cellalignment58" headers="d16937e859 d16937e705">
<p><code>true</code></p>
</td>
<td class="cellalignment59" headers="d16937e859 d16937e708">
<p>Sets the Cassandra Handler whether to or not to expect full image updates from the source trail file. Set to <code>true</code> means that updates in the source trail file only contain column data for the primary keys and for columns that changed. The Cassandra Handler executes updates as simple statements updating only the columns that changed.</p>
<p>Setting it to <code>false</code> means that updates in the source trail file contain column data for primary keys and all columns regardless of whether the column value has changed. The Cassandra Handler is able to use prepared statements for updates, which can provide better performance for streaming data to Cassandra.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d16937e894" headers="d16937e696">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>ddlHandling</code></p>
</td>
<td class="cellalignment56" headers="d16937e894 d16937e699">
<p>Optional</p>
</td>
<td class="cellalignment57" headers="d16937e894 d16937e702">
<p><code>CREATE</code> | <code>ADD</code> | <code>DROP</code> in any combination with values delimited by a comma</p>
</td>
<td class="cellalignment58" headers="d16937e894 d16937e705">
<p>None</p>
</td>
<td class="cellalignment59" headers="d16937e894 d16937e708">
<p>Configures the Cassandra Handler for the DDL functionality to provide. Options include <code>CREATE</code>, <code>ADD</code>, and <code>DROP</code>. These options can be set in any combination delimited by commas.</p>
<p>When <code>CREATE</code> is enabled the Cassandra Handler creates tables in Cassandra if a corresponding table does not exist.</p>
<p>When <code>ADD</code> is enabled the Cassandra Handler adds columns that exist in the source table definition that do <span class="italic">not</span> exist in the corresponding Cassandra table definition.</p>
<p>When <code>DROP</code> is enable the handler drops columns that exist in the Cassandra table definition that do <span class="italic">not</span> exist in the corresponding source table definition.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d16937e954" headers="d16937e696">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>cassandraMode</code></p>
</td>
<td class="cellalignment56" headers="d16937e954 d16937e699">
<p>Optional</p>
</td>
<td class="cellalignment57" headers="d16937e954 d16937e702">
<p><code>async</code> | <code>sync</code></p>
</td>
<td class="cellalignment58" headers="d16937e954 d16937e705">
<p><code>async</code></p>
</td>
<td class="cellalignment59" headers="d16937e954 d16937e708">
<p>Sets the interaction between the Cassandra Handler and Cassandra. Set to <code>async</code> for asynchronous interaction. Operations are sent to Cassandra asynchronously and then flushed at transaction commit to ensure durability. Asynchronous will provide better performance.</p>
<p>Set to <code>sync</code> for synchronous interaction. Operations are sent to Cassandra synchronously.</p>
</td>
</tr>
<tr>
<td class="cellalignment55" id="d16937e989" headers="d16937e696">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>consistencyLevel</code></p>
</td>
<td class="cellalignment56" headers="d16937e989 d16937e699">
<p>Optional</p>
</td>
<td class="cellalignment57" headers="d16937e989 d16937e702">
<p><code>ALL</code> | <code>ANY</code> | <code>EACH_QUORUM</code> | <code>LOCAL_ONE</code> | <code>LOCAL_QUORUM</code> | <code>ONE</code> | <code>QUORUM</code> | <code>THREE</code> | <code>TWO</code></p>
</td>
<td class="cellalignment58" headers="d16937e989 d16937e705">
<p>The Cassandra default.</p>
</td>
<td class="cellalignment59" headers="d16937e989 d16937e708">
<p>Sets the consistency level for operations with Cassandra. It configures the criteria that must be met for storage on the Cassandra cluster when an operation is executed. Lower levels of consistency can provide better performance while higher levels of consistency are safer.</p>
<p>You can review details about the write consistency levels for Cassandra at: <a href="https://docs.datastax.com/en/cassandra/3.x/cassandra/dml/dmlConfigConsistency.html" target="_blank">https://docs.datastax.com/en/cassandra/3.x/cassandra/dml/dmlConfigConsistency.html</a></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<div class="props_rev_3"><a id="GUID-F66D0F36-2CB1-476B-88E1-D74125A84D3A"></a>
<h3 id="GADBD-GUID-F66D0F36-2CB1-476B-88E1-D74125A84D3A" class="sect3"><span class="enumeration_section">6.3.2</span> Sample Configuration</h3>
<div>
<p>The following is sample configuration for the Cassandra Handler from the Java Adapter properties file:</p>
<pre dir="ltr">
gg.handlerlist=cassandra 

#The handler properties 
gg.handler.cassandra.type=cassandra 
gg.handler.cassandra.mode=op 
gg.handler.cassandra.contactPoints=localhost 
gg.handler.cassandra.ddlHandling=CREATE,ADD,DROP 
gg.handler.cassandra.compressedUpdates=true 
gg.handler.cassandra.cassandraMode=async 
gg.handler.cassandra.consistencyLevel=ONE
</pre></div>
</div>
<div class="props_rev_3"><a id="GUID-0FC24DE6-0564-428A-AB5D-202A9DF220E7"></a>
<h3 id="GADBD-GUID-0FC24DE6-0564-428A-AB5D-202A9DF220E7" class="sect3"><span class="enumeration_section">6.3.3</span> Security</h3>
<div>
<div class="section">
<p>The Cassandra Handler connection to the Cassandra Cluster can be secured using user name and password credentials. The user name and password credentials are configured as part of the Cassandra Handler configuration in the Adapter properties file, see <a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-D6B85915-635C-4265-806F-C6E733F4713B">Cassandra Handler Configuration</a>.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-1B7ED49F-16B7-4B38-82EB-AFEC99C06BB8"></a>
<h2 id="GADBD-GUID-1B7ED49F-16B7-4B38-82EB-AFEC99C06BB8" class="sect2"><span class="enumeration_section">6.4</span> Automated DDL Handling</h2>
<div>
<div class="section">
<p>When started, the Cassandra Handler performs the table check and reconciliation process the first time an operation for a source table is encountered. Additionally, a DDL event or a metadata change event causes the table definition in the Cassandra Handler to be marked as dirty so the next time an operation for the table is encountered the handler repeats the table check and reconciliation process as described in the following section.</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-14CCA88D-71BA-484D-9776-FB0F398B3635">Table Check and Reconciliation Process</a></strong><br /></li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-14CCA88D-71BA-484D-9776-FB0F398B3635"></a>
<h3 id="GADBD-GUID-14CCA88D-71BA-484D-9776-FB0F398B3635" class="sect3"><span class="enumeration_section">6.4.1</span> Table Check and Reconciliation Process</h3>
<div>
<div class="section">
<p>The Cassandra Handler first interrogates the target Cassandra database to see if the target Cassandra keyspace exists. If the target Cassandra keyspace does not exist, then the Cassandra Handler abends. Keyspaces must be created by the user. The log file should contain the error of the exact keyspace name the Cassandra Handler is expecting.</p>
<p>Next, the Cassandra Handler interrogates the target Cassandra database for the table definition. If the table does not exist, the Cassandra Handler will do one of two things. If <code>gg.handler.name.ddlHandling</code> includes <code>CREATE</code>, then a table is created in Cassandra; otherwise the process abends. A message is logged that shows you the table that does not exist in Cassandra.</p>
<p>If the table exists in Cassandra, then the Cassandra Handler performs a reconciliation between the table definition from the source trail file and the table definition in Cassandra. This reconciliation process searches for columns that exist in the source table definition and not in the corresponding Cassandra table definition. If it locates columns fitting this criteria and the <code>gg.handler.name.ddlHandling</code> property includes <code>ADD</code>, then the Cassandra Handler alters the target table in Cassandra adding the new columns; otherwise it ignores these columns.</p>
<p>Next, the reconciliation process search for columns that exist in the target Cassandra table though do not exist in the source table definition. If the locates columns fitting this criteria and the <code>gg.handler.name.ddlHandling</code> property includes <code>DROP</code> then the Cassandra Handler alters the target table in Cassandra to drop these columns; otherwise those columns are ignored.</p>
<p>Finally, the prepared statements are built.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-F4363382-DDC4-45A4-831E-1C8A202A8F82"></a>
<h2 id="GADBD-GUID-F4363382-DDC4-45A4-831E-1C8A202A8F82" class="sect2"><span class="enumeration_section">6.5</span> Performance Considerations</h2>
<div>
<div class="section">
<p>Configuring the Cassandra Handler for <code>async</code> mode will provide better performance than <code>sync</code> mode. The Replicat property <code>GROUPTRANSOPS</code> should be set to the default of a 1000.</p>
<p>Setting of the consistency level directly affects performance. The higher the consistency level, the more work must occur on the Cassandra cluster before the transmission of a given operation can be considered complete. You should select the minimum consistency level that still satisfies the requirements of your use case. Consistency level information is found at:</p>
<p><a href="https://docs.datastax.com/en/cassandra/3.x/cassandra/dml/dmlConfigConsistency.html" target="_blank">https://docs.datastax.com/en/cassandra/3.x/cassandra/dml/dmlConfigConsistency.html</a></p>
<p>The Cassandra Handler can work in either operation (<code>op</code>) or transaction (<code>tx</code>) mode. For the best performance operation mode is recommended:</p>
<pre dir="ltr">
gg.handler.name.mode=op
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-6A7D086D-84DD-4653-AED8-93411B301673"></a>
<h2 id="GADBD-GUID-6A7D086D-84DD-4653-AED8-93411B301673" class="sect2"><span class="enumeration_section">6.6</span> Additional Considerations</h2>
<div>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Cassandra database requires at least one primary key and the value for any primary key cannot be null. Automated table creation fails for source tables that do not have a primary key.</p>
</li>
<li>
<p>When <code>gg.handler.name.compressedUpdates=false</code> is set it means that the Cassandra Handler expects to update full before and after images of the data. Using this property setting with a source trail file with partial image updates results in null values being updated for columns for which the data is missing. This configuration is incorrect and update operations pollute the target data with null values in columns that did not change.</p>
</li>
<li>
<p>The Cassandra Handler does <span class="italic">not</span> process DDL from the source database even if the source database provides DDL. Instead it performs a reconciliation process between the source table definition and the target Cassandra table definition. A DDL statement executed at the source database changing a column name appears to the Cassandra Handler the same as if a column was dropped from the source table and a new column was added to the source table. This behavior is dependent on how the <code>gg.handler.name.ddlHandling</code> property is configured:</p>
<div class="tblformal" id="GUID-6A7D086D-84DD-4653-AED8-93411B301673__GUID-CD7D5479-28B0-4B50-814C-F94C77192030">
<table class="cellalignment60" summary="Two column table describing DDL processing.">
<thead align="left">
<tr>
<th class="cellalignment54" id="d16937e1241">gg.handler.name.ddlHandling Configuration</th>
<th class="cellalignment54" id="d16937e1246">Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment54" id="d16937e1251" headers="d16937e1241">
<p>Not configured for <code>ADD</code> or <code>DROP</code></p>
</td>
<td class="cellalignment54" headers="d16937e1251 d16937e1246">
<p>Old column name and data maintained in Cassandra. New column is not created in Cassandra so no data is replicated for the new column name from the DDL change forward.</p>
</td>
</tr>
<tr>
<td class="cellalignment54" id="d16937e1263" headers="d16937e1241">
<p>Configured for <code>ADD</code> only</p>
</td>
<td class="cellalignment54" headers="d16937e1263 d16937e1246">
<p>Old column name and data maintained in Cassandra. New column iscreated in Cassandra and data replicated for the new column name from the DDL change forward. Column mismatch of where the data is located before and after the DDL change.</p>
</td>
</tr>
<tr>
<td class="cellalignment54" id="d16937e1273" headers="d16937e1241">
<p>Configured for <code>DROP</code> only</p>
</td>
<td class="cellalignment54" headers="d16937e1273 d16937e1246">
<p>Old column name and data dropped in Cassandra. New column is not created in Cassandra so no data replicated for the new column name.</p>
</td>
</tr>
<tr>
<td class="cellalignment54" id="d16937e1283" headers="d16937e1241">
<p>Configured for <code>ADD</code> and <code>DROP</code></p>
</td>
<td class="cellalignment54" headers="d16937e1283 d16937e1246">
<p>Old column name and data dropped in Cassandra. New column is created in Cassandra and data replicated for the new column name from the DDL change forward.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-39AB73AD-2BB6-4825-8CF3-B3D24EF168F7"></a>
<h2 id="GADBD-GUID-39AB73AD-2BB6-4825-8CF3-B3D24EF168F7" class="sect2"><span class="enumeration_section">6.7</span> Troubleshooting</h2>
<div>
<div class="section">
<p>This section contains information to help you troubleshoot various issues. Review the following topics for additional help:</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-3EE9BB54-1DBD-46D3-9E30-42320C885059">Java Classpath</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-1FEF5187-E8DF-48C4-935D-0EFB321DDBDD">Logging</a></strong><br /></li>
<li class="ulchildlink"><strong><a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-9E1A7E82-47E6-475B-887A-B8FE3A511389">Write Timeout Exception</a></strong><br /></li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-3EE9BB54-1DBD-46D3-9E30-42320C885059"></a>
<h3 id="GADBD-GUID-3EE9BB54-1DBD-46D3-9E30-42320C885059" class="sect3"><span class="enumeration_section">6.7.1</span> Java Classpath</h3>
<div>
<div class="section">
<p>The most common initial error is an incorrect classpath to include all the required client libraries and creates a <code>ClassNotFound</code> exception in the log file. You can troubleshoot by setting the Java Adapter logging to <code>DEBUG</code>, and then rerun the process. At the debug level, the logging includes information of which JARs were added to the classpath from the <code>gg.classpath</code> configuration variable. The <code>gg.classpath</code> variable supports the wildcard (<code>*</code>) character to select all JARs in a configured directory. For example, <code>/usr/cassandra/cassandra-java-driver-3.1.0/*:/usr/cassandra/cassandra-java-driver-3.1.0/lib/*</code>.</p>
<p>For more information about setting the classpath, see <a href="GUID-EE8CD5B5-8749-4906-B50C-EE33E36AC984.htm#GUID-C3AC0152-35C2-4E58-BDB1-7E3F6CAA655C">Setting Up and Running the Cassandra Handler</a>and <a href="GUID-5CBDA0B6-A058-45FC-B35C-0BEE0264E3D0.htm#GUID-5CBDA0B6-A058-45FC-B35C-0BEE0264E3D0">Cassandra Handler Client Dependencies</a>.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-1FEF5187-E8DF-48C4-935D-0EFB321DDBDD"></a>
<h3 id="GADBD-GUID-1FEF5187-E8DF-48C4-935D-0EFB321DDBDD" class="sect3"><span class="enumeration_section">6.7.2</span> Logging</h3>
<div>
<div class="section">
<div class="p">The Cassandra Handler logs the state of its configuration to the Java log file. This is helpful because you can review the configuration values for the Cassandra Handler. An sample of the logging of the state of the configuration follows:
<pre dir="ltr">
**** Begin Cassandra Handler - Configuration Summary **** 
  Mode of operation is set to op. 
  The Cassandra cluster contact point(s) is [localhost]. 
  The handler has been configured for GoldenGate compressed updates (partial image updates). 
  Sending data to Cassandra in [ASYNC] mode. 
  The Cassandra consistency level has been set to [ONE]. 
  Cassandra Handler DDL handling: 
    The handler will create tables in Cassandra if they do not exist. 
    The handler will add columns to Cassandra tables for columns in the source metadata that do not exist in Cassandra. 
    The handler will drop columns in Cassandra tables for columns that do not exist in the source metadata. 
**** End Cassandra Handler - Configuration Summary ****
</pre></div>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-9E1A7E82-47E6-475B-887A-B8FE3A511389"></a>
<h3 id="GADBD-GUID-9E1A7E82-47E6-475B-887A-B8FE3A511389" class="sect3"><span class="enumeration_section">6.7.3</span> Write Timeout Exception</h3>
<div>
<div class="section">
<p>When running the Cassandra handler, you may experience a <code>com.datastax.driver.core.exceptions.WriteTimeoutException</code> exception that causes the Replicat process to abend. It is likely to occur under some or all of the following conditions.</p>
<ul style="list-style-type: disc;">
<li>
<p>The Cassandra Handler is processing large numbers of operations putting the Cassandra cluster under a significant processing load.</p>
</li>
<li>
<p><code>GROUPTRANSOPS</code> is configured higher than the 1000 default.</p>
</li>
<li>
<p>The Cassandra Handler is configured in asynchronous mode.</p>
</li>
<li>
<p>The Cassandra Handler is configured for a consistency level higher than <code>ONE</code>.</p>
</li>
</ul>
<p>The problem is that the Cassandra Handler is streaming data faster than the Cassandra cluster can process it. The write latency in the Cassandra cluster then finally exceeds the write request timeout period, which in turn results in the exception.</p>
<p>The following are potential solutions:</p>
<ul style="list-style-type: disc;">
<li>
<p>Increase the write request timeout period. This is controlled with the <code>write_request_timeout_in_ms</code> property in Cassandra and is located in the <code>cassandra.yaml</code> file in the <code><span class="codeinlineitalic">cassandra_install</span>/conf</code> directory. The default is 2000 (2 seconds). You can increase this value to move past the error, and then restart the Cassandra node or nodes for the change to take affect.</p>
</li>
<li>
<p>It is considered a good practice to also decrease the <code>GROUPTRANSOPS</code> configuration value of the Replicat process if this error occurs. Typically, decreasing the <code>GROUPTRANSOPS</code> configuration decreases the size of transactions processed and reduces the likelihood that the Cassandra Handler can overtax the Cassandra cluster.</p>
</li>
<li>
<p>The consistency level of the Cassandra Handler can be reduced, which in turn reduces the amount of work the Cassandra cluster has to complete for an operation to be considered as written.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment40">
<tr>
<td class="cellalignment47">
<table class="cellalignment51">
<tr>
<td class="cellalignment44"><a href="GUID-2561CA12-9BAC-454B-A2E3-2D36C5C60EE5.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment44"><a href="GUID-99985BA8-1EC6-4507-A3E1-56CE42F8C23E.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2015, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment49">
<table class="cellalignment43">
<tr>
<td class="cellalignment44"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment44"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment44"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment44"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
