<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>ADD SCHEMATRANDATA</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2018-07-19T03:21:52Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Reference for Oracle GoldenGate for Windows and UNIX" />
<meta name="dcterms.identifier" content="E66350-08" />
<meta name="dcterms.isVersionOf" content="GWURF" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2013, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="set-nameccsid.htm" title="Previous" type="text/html" />
<link rel="Next" href="add-trandata.htm" title="Next" type="text/html" />
<link rel="alternate" href="GWURF.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41"></a> <span id="PAGE" style="display:none;">77/459</span> <!-- End Header -->
<a id="GWURF967"></a><a id="GWURF968"></a><a id="GWURF969"></a><a id="GWURF266"></a><a id="GWURF267"></a><a id="GWURF265"></a>
<h1 id="GWURF-GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41" class="sect1"><span class="enumeration_section">1.69</span> ADD SCHEMATRANDATA</h1>
<div>
<div class="section">
<p>Valid for Oracle. Use <code class="codeph">ADD SCHEMATRANDATA</code> to enable schema-level supplemental logging for a table. <code class="codeph">ADD SCHEMATRANDATA</code> acts on all of the current and future tables in a given schema to automatically log a superset of available keys that Oracle GoldenGate needs for row identification.</p>
<p><code class="codeph">ADD SCHEMATRANDATA</code> is valid for both integrated and classic capture and does the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Enables Oracle supplemental logging for new tables created with a <code class="codeph">CREATE TABLE</code>.</p>
</li>
<li>
<p>Updates supplemental logging for tables affected by an <code class="codeph">ALTER TABLE</code> to add or drop columns.</p>
</li>
<li>
<p>Updates supplemental logging for tables that are renamed.</p>
</li>
<li>
<p>Updates supplemental logging for tables for which unique or primary keys are added or dropped.</p>
</li>
</ul>
<p>By default, <code class="codeph">ADD SCHEMATRANDATA</code> logs the key columns of a table in the following order of priority:</p>
<ol>
<li>
<p>Primary key</p>
</li>
<li>
<p>In the absence of a primary key, all of the unique keys of the table, including those that are disabled, unusable or invisible. Unique keys that contain ADT member columns are also logged. Only unique keys on virtual columns (function-based indexes) are not logged.</p>
</li>
<li>
<p>If none of the preceding exists, all scalar columns of the table are logged. (System-generated row-OIDs are always logged.)</p>
</li>
</ol>
<p><code class="codeph">ADD SCHEMATRANDATA</code> also supports the conditional or unconditional logging requirements for using integrated Replicat.</p>
<div class="infobox-note" id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-39D50998-B2B7-4DE5-B6F5-6B9545F72A9C">
<p class="notep1">Note:</p>
<p>Apply Oracle Patch 10423000 to the source database if the Oracle version is earlier than 11.2.0.2.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">When to Use <code class="codeph">ADD SCHEMATRANDATA</code></p>
</div>
<!-- class="section" -->
<div class="section">
<p><code class="codeph">ADD SCHEMATRANDATA</code> must be used in the following cases:</p>
<ul style="list-style-type: disc;">
<li>
<p>For all tables that are part of an Extract group that is to be configured for integrated capture. <code class="codeph">ADD SCHEMATRANDATA</code> ensures that the correct key is logged by logging all of the keys.</p>
</li>
<li>
<p>For all source tables that will be processed in an integrated Replicat group. Options are provided that enable the logging of the primary, unique, and foreign keys to support the computation of dependencies among relational tables being processed through different apply servers.</p>
</li>
<li>
<p>When DDL replication is active and DML is concurrent with DDL that creates new tables or alters key columns. It best handles scenarios where DML can be applied to objects very shortly after DDL is issued on them. <code class="codeph">ADD SCHEMATRANDATA</code> causes the appropriate key values to be logged in the redo log atomically with each DDL operation, thus ensuring metadata continuity for the DML when it is captured from the log, despite any lag in Extract processing.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Database-level Logging Requirements for Using <code class="codeph">ADD SCHEMATRANDATA</code></p>
</div>
<!-- class="section" -->
<div class="section">
<p>Oracle strongly encourages putting the source database into forced logging mode and enabling minimal supplemental logging at the database level when using Oracle GoldenGate. This adds row chaining information, if any exists, to the redo log for update operations. See <a class="olink GIORA364" target="_blank" href="../GIORA/preparing-database-oracle-goldengate.htm#GIORA364"><span class="italic"><span id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GIORA"><cite>Installing and Configuring Oracle GoldenGate for Oracle Database</cite></span></span></a> for more information about configuring logging to support Oracle GoldenGate.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Additional Considerations for Using <code class="codeph">ADD SCHEMATRANDATA</code></p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Before using <code class="codeph">ADD SCHEMATRANDATA</code>, issue the <code class="codeph">DBLOGIN</code> command. The user who issues the command must be granted the Oracle Streams administrator privilege.</p>
<pre dir="ltr">
SQL&gt; exec dbms_streams_auth.grant_admin_privilege('<span class="italic">user</span>')
</pre></li>
<li>
<p><code class="codeph">ADD SCHEMATRANDATA</code> can be used instead of the <code class="codeph">ADD TRANDATA</code> command when DDL replication is not enabled. Note, however, that if a table has no primary key but has multiple unique keys, <code class="codeph">ADD SCHEMATRANDATA</code> causes the database to log all of the unique keys. In such cases, <code class="codeph">ADD SCHEMATRANDATA</code> causes the database to log more redo data than does <code class="codeph">ADD TRANDATA</code>. To avoid the extra logging, designate one of the unique keys as a primary key, if possible.</p>
</li>
<li>
<p>For tables with a primary key, with a single unique key, or without a key, <code class="codeph">ADD SCHEMATRANDATA</code> adds no additional logging overhead, as compared to <code class="codeph">ADD TRANDATA</code>. For more information, see <a href="add-trandata.htm#GUID-D3FD004B-81E4-4185-92D3-812834A5DEFC">ADD TRANDATA</a>.</p>
</li>
<li>
<p>If you must log additional, non-key columns of a specific table (or tables) for use by Oracle GoldenGate, such as those needed for <code class="codeph">FILTER</code> statements and <code class="codeph">KEYCOLS</code> clauses in the <code class="codeph">TABLE</code> and <code class="codeph">MAP</code> parameters, issue an <code class="codeph">ADD TRANDATA</code> command for those columns. That command has a <code class="codeph">COLS</code> option to issue table-level supplemental logging for the columns, and it can be used in conjunction with <code class="codeph">ADD SCHEMATRANDATA</code>.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Syntax</p>
<pre dir="ltr">
ADD SCHEMATRANDATA schema {
[ALLOWNONVALIDATEDKEYS] 
[NOSCHEDULINGCOLS | ALLCOLS]}
[NOVALIDATE]
[PREPARECSN  {WAIT | LOCK | NOWAIT | NONE}]
</pre>
<dl>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-67087BFC-2F1E-4B61-81A5-D455D4646F3E"><!-- --></a><span class="italic"><code class="codeph">schema</code></span></dt>
<dd>
<p>The schema for which you want the supplementary key information to be logged. Do not use a wildcard. To issue <code class="codeph">ADD SCHEMATRANDATA</code> for schemas in more than one pluggable database of a multitenant container database, log in to each pluggable database separately with <code class="codeph">DBLOGIN</code> and then issue <code class="codeph">ADD SCHEMATRANDATA</code>. See <a href="dblogin.htm#GUID-2674DB7E-C765-4BDD-BDA7-5B7E5226A9A9">DBLOGIN</a> for more information.</p>
</dd>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-66921E4E-2313-45E0-AC8C-F68B41C9FAD8"><!-- --></a><code class="codeph">ALLOWNONVALIDATEDKEYS</code></dt>
<dd>
<p>This option is not valid for Oracle 11.2.0.3 or 12.1.0.1. It includes <code class="codeph">NON VALIDATED</code> and <code class="codeph">NOT VALID</code> primary keys in the supplemental logging. These keys override the normal key selection criteria that is used by Oracle GoldenGate. If the <code class="codeph">GLOBALS</code> parameter <code class="codeph">ALLOWNONVALIDATEDKEYS</code> is being used, <code class="codeph">ADD SCHEMATRANDATA</code> runs with <code class="codeph">ALLOWNONVALIDATEDKEYS</code> whether or not it is specified. By default <code class="codeph">NON VALIDATED</code> and <code class="codeph">NOT VALID</code> primary keys are not logged. For more information, see the <code class="codeph">GLOBALS</code> <a href="allownonvalidatedkeys.htm#GUID-CAB72815-CB7F-4F42-9959-81424DB12AB0">ALLOWNONVALIDATEDKEYS</a> parameter.</p>
</dd>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-B9D44757-D557-4149-B538-7B421995D6F3"><!-- --></a><code class="codeph">NOSCHEDULINGCOLS | ALLCOLS</code></dt>
<dd>
<p>These options control supplemental logging for an Oracle target database. You can use these options together though the latter option is used. For example, with the <code class="codeph">ADD SCHEMATRANDATA oggadm_ext ALLCOL NOSCHEDULINGCOLS</code> command the <code class="codeph">NOSCHEDULINGCOLS</code> option would be used.</p>
<dl>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-33F0FBBE-538F-4BCD-B128-70FBB9D65967"><!-- --></a><code class="codeph">NOSCHEDULINGCOLS</code></dt>
<dd>
<p>Disables the logging of scheduling columns. By default, <code class="codeph">ADD SCHEMATRANDATA</code> enables the unconditional logging of the primary key and the conditional supplemental logging of all unique key(s) and foreign key(s) of all current and future tables in the given schema. Unconditional logging forces the primary key values to the log whether or not the key was changed in the current operation. Conditional logging logs all of the column values of a foreign or unique key if at least one of them was changed in the current operation. The integrated Replicat primary key, unique keys, and foreign keys must all be available to the inbound server to compute dependencies. For more information about integrated Replicat, see <a class="olink GIORA218" target="_blank" href="../GIORA/choosing-capture-and-apply-modes.htm#GIORA218"><span class="italic"><span><cite>Installing and Configuring Oracle GoldenGate for Oracle Database</cite></span></span></a>.</p>
</dd>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-EB8A7D21-DED3-499E-914B-73FC29FC72F4"><!-- --></a><code class="codeph">ALLCOLS</code></dt>
<dd>
<p>Enables the unconditional supplemental logging of all supported key and non-key columns for all current and future tables in the given schema. This option enables the logging of the keys required to compute dependencies, plus columns that are required for filtering, conflict resolution, or other purposes. Columns like LOB, LONG, and ADT are not included.</p>
</dd>
</dl>
</dd>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-F5C6FFDE-9E7F-499B-9B0B-BFD8CADA744C"><!-- --></a><code class="codeph">NOVALIDATE</code></dt>
<dd>
<p>Valid for all databases supported by <code class="codeph">ADD SCHEMATRANDATA</code>.</p>
<p>Suppresses additional information about the table being handled being processed by <code class="codeph">ADD SCHEMATRANDATA</code>. By default, this option is enabled. The additional information processing creates a lapse time on command response so this option can be used to increase response time.</p>
</dd>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-064B93AB-F0BA-4A54-AAAA-B43ABC3865D9"><!-- --></a><code class="codeph">PREPARECSN {WAIT | LOCK | NOWAIT | NONE}</code></dt>
<dd>
<p>Valid for Oracle for both DML and DDL. Automatically prepares the tables at the source so the Oracle data pump Export dump file will includes Instantiation CSNs. Replicat uses the per table instantiation CSN set by the Oracle data pump (on import) to filter out trail records. On the target, the data pump import populates the system tables and views with instantiation SCNs using the <code class="codeph">DBOPTIONS ENABLE_INSTANTIATION_FILTERING</code> parameter to enable table-level instantiation filtering.</p>
<dl>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-8129A504-276C-4400-9F9E-E1EFF5393A90"><!-- --></a><code class="codeph">WAIT</code></dt>
<dd>
<p>Wait for any in-flight transactions and prepare table instantiation.</p>
</dd>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-49EC4C23-CFF1-4633-B50B-4B64BFC6AEFB"><!-- --></a><code class="codeph">LOCK</code></dt>
<dd>
<p>Put a lock on the table (to prepare for table instantiation).</p>
</dd>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-1A833723-8AA7-4051-8C4E-D92A6D9F5B16"><!-- --></a><code class="codeph">NOWAIT</code></dt>
<dd>
<p>Default behavior, preparing for instantiation is done immediately.</p>
</dd>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-D05A0C84-35C3-4072-83FA-ECEC6407B6C4"><!-- --></a><code class="codeph">NONE</code></dt>
<dd>
<p>No instantiation preparation occurs.</p>
</dd>
</dl>
</dd>
</dl>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Example</p>
<dl>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-3855F5B5-2B01-44BB-A769-A47748ADD4E6"><!-- --></a>Example 1&nbsp;&nbsp;&nbsp;</dt>
<dd>
<p>The following enables supplemental logging for the schema <code class="codeph">scott</code>.</p>
<pre dir="ltr">
ADD SCHEMATRANDATA scott
</pre></dd>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-882C02BE-549B-49F7-97F9-C8103EC48744"><!-- --></a>Example 2&nbsp;&nbsp;&nbsp;</dt>
<dd>
<p>The following example logs all supported key and non-key columns for all current and future tables in the schema named <code class="codeph">scott</code>.</p>
<pre dir="ltr">
ADD SCHEMATRANDATA scott ALLCOLS
</pre></dd>
<dt class="dlterm"><a id="GUID-5DA7C3DC-5D87-4A8B-AD23-6EF587A5CF41__GUID-C9930BB5-C20A-48C5-965E-AA8BC7C617B9"><!-- --></a>Example 3&nbsp;&nbsp;&nbsp;</dt>
<dd>
<p>The following example suppress additional table information processing.</p>
<pre dir="ltr">
ADD SCHEMATRANDATA acct.emp* NOVALIDATE
</pre></dd>
</dl>
<pre dir="ltr">
</pre></div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment453">
<tr>
<td class="cellalignment460">
<table class="cellalignment458">
<tr>
<td class="cellalignment457"><a href="set-nameccsid.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment457"><a href="add-trandata.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2013, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment462">
<table class="cellalignment456">
<tr>
<td class="cellalignment457"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment457"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
