<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Preparing Tables for Processing</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2018-07-19T04:12:29Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Installing and Configuring Oracle GoldenGate for MySQL" />
<meta name="dcterms.identifier" content="E67826-03" />
<meta name="dcterms.isVersionOf" content="GIMYS" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2013, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="other-oracle-goldengate-parameters-mysql.htm" title="Previous" type="text/html" />
<link rel="Next" href="positioning-extract-specific-start-point.htm" title="Next" type="text/html" />
<link rel="alternate" href="GIMYS.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-0E7117AD-C8BF-4079-ABC9-993D72E0CBB8"></a> <span id="PAGE" style="display:none;">28/39</span> <!-- End Header -->
<a id="GIMYS160"></a>
<h1 id="GIMYS-GUID-0E7117AD-C8BF-4079-ABC9-993D72E0CBB8" class="sect1"><span class="enumeration_section">3.7</span> Preparing Tables for Processing</h1>
<div id="THISSECTIONDESCRIBESHOWTOPREPARETHE-33C06DF3">
<div class="section">
<p>This section describes how to prepare the tables for processing. Table preparation requires these tasks:</p>
</div>
<!-- class="section" --></div>
<a id="GIMYS161"></a>
<div class="sect2"><a id="GUID-CF6F5B5E-759C-43B1-9247-B084319D4D05"></a>
<h2 id="GIMYS-GUID-CF6F5B5E-759C-43B1-9247-B084319D4D05" class="sect2"><span class="enumeration_section">3.7.1</span> Assigning Row Identifiers</h2>
<div id="ORACLEGOLDENGATEREQUIRESSOMEFORMOFU-33C0B5F7">
<p>Oracle GoldenGate requires some form of unique row identifier on the source and target tables to locate the correct target rows for replicated updates and deletes.</p>
</div>
<a id="GIMYS162"></a>
<div class="sect3"><a id="GUID-AA8A8B3E-9C7D-4781-A40B-82D7A3DF3573"></a>
<h3 id="GIMYS-GUID-AA8A8B3E-9C7D-4781-A40B-82D7A3DF3573" class="sect3"><span class="enumeration_section">3.7.1.1</span> How Oracle GoldenGate Determines the Kind of Row Identifier to Use</h3>
<div id="UNLESSAKEYCOLSCLAUSEISUSEDINTHETABL-33C15942">
<p>Unless a <code class="codeph">KEYCOLS</code> clause is used in the <code class="codeph">TABLE</code> or <code class="codeph">MAP</code> statement, Oracle GoldenGate selects a row identifier to use in the following order of priority:</p>
<ol>
<li>
<p>Primary key</p>
</li>
<li>
<p>First unique key alphanumerically that does not contain a timestamp or non-materialized computed column</p>
</li>
<li>
<p>If none of the preceding key types exist (even though there might be other types of keys defined on the table) Oracle GoldenGate constructs a pseudo key of all columns that the database allows to be used in a unique key, excluding those that are not supported by Oracle GoldenGate in a key or those that are excluded from the Oracle GoldenGate configuration.</p>
<div class="infobox-note" id="GUID-AA8A8B3E-9C7D-4781-A40B-82D7A3DF3573__GUID-DF895B94-F42B-403D-95E9-C65DDC34F3A7">
<p class="notep1">Note:</p>
<p>If there are other, non-usable keys on a table or if there are no keys at all on the table, Oracle GoldenGate logs an appropriate message to the report file. Constructing a key from all of the columns impedes the performance of Oracle GoldenGate on the source system. On the target, this key causes Replicat to use a larger, less efficient <code class="codeph">WHERE</code> clause.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="GIMYS163"></a>
<div class="sect3"><a id="GUID-667C6155-BA67-43DD-AE4E-CD8A3E6941B6"></a>
<h3 id="GIMYS-GUID-667C6155-BA67-43DD-AE4E-CD8A3E6941B6" class="sect3"><span class="enumeration_section">3.7.1.2</span> Tables with a Primary Key Derived from a Unique Index</h3>
<div id="INTHEABSENCEOFAPRIMARYKEYONATABLEMY-33C1ADF7">
<p>In the absence of a primary key on a table, MySQL will promote a unique index to primary key if the indexed column is <code class="codeph">NOT NULL</code>. If there are more than one of these not-null indexes, the first one that was created becomes the primary key. To avoid Replicat errors, create these indexes in the same order on the source and target tables.</p>
<p>For example, assume that source and target tables named <code class="codeph">ggvam.emp</code> each have columns named first, middle, and last, and all are defined as <code class="codeph">NOT NULL</code>. If you create unique indexes in the following order, Oracle GoldenGate will abend on the target because the table definitions do not match.</p>
<p>Source:</p>
<pre dir="ltr">
mysql&gt; create unique index uq1 on ggvam.emp(first); 
mysql&gt; create unique index uq2 on ggvam.emp(middle); 
mysql&gt; create unique index uq3 on ggvam.emp(last); 
</pre>
<p>Target:</p>
<pre dir="ltr">
mysql&gt; create unique index uq1 on ggvam.emp(last); 
mysql&gt; create unique index uq2 on ggvam.emp(first); 
mysql&gt; create unique index uq3 on ggvam.emp(middle); 
</pre>
<p>The result of this sequence is that MySQL promotes the index on the source "first" column to primary key, and it promotes the index on the target "last" column to primary key. Oracle GoldenGate will select the primary keys as identifiers when it builds its metadata record, and the metadata will not match. To avoid this error, decide which column you want to promote to primary key, and create that index first on the source and target.</p>
</div>
</div>
<a id="GIMYS164"></a>
<div class="sect3"><a id="GUID-97373FE6-2466-460E-9463-513D228A9F0D"></a>
<h3 id="GIMYS-GUID-97373FE6-2466-460E-9463-513D228A9F0D" class="sect3"><span class="enumeration_section">3.7.1.3</span> How to Specify Your Own Key for Oracle GoldenGate to Use</h3>
<div id="IFATABLEDOESNOTHAVEONEOFTHEPRECEDIN-33C210C0">
<p>If a table does not have one of the preceding types of row identifiers, or if you prefer those identifiers not to be used, you can define a substitute key if the table has columns that always contain unique values. You define this substitute key by including a <code class="codeph">KEYCOLS</code> clause within the Extract <code class="codeph">TABLE</code> parameter and the Replicat <code class="codeph">MAP</code> parameter. The specified key will override any existing primary or unique key that Oracle GoldenGate finds.</p>
</div>
</div>
</div>
<a id="GIMYS165"></a>
<div class="sect2"><a id="GUID-CDD5A55A-539A-40EB-8E4B-0CBF8FC1BBCE"></a>
<h2 id="GIMYS-GUID-CDD5A55A-539A-40EB-8E4B-0CBF8FC1BBCE" class="sect2"><span class="enumeration_section">3.7.2</span> Limiting Row Changes in Tables That Do Not Have a Key</h2>
<div id="IFATARGETTABLEDOESNOTHAVEAPRIMARYKE-33C10163">
<p>If a target table does not have a primary key or a unique key, duplicate rows can exist. In this case, Oracle GoldenGate could update or delete too many target rows, causing the source and target data to go out of synchronization without error messages to alert you. To limit the number of rows that are updated, use the <code class="codeph">DBOPTIONS</code> parameter with the <code class="codeph">LIMITROWS</code> option in the Replicat parameter file. <code class="codeph">LIMITROWS</code> can increase the performance of Oracle GoldenGate on the target system because only one row is processed.</p>
</div>
</div>
<a id="GIMYS166"></a>
<div class="sect2"><a id="GUID-08B8C84B-6406-4509-9441-634D52C26794"></a>
<h2 id="GIMYS-GUID-08B8C84B-6406-4509-9441-634D52C26794" class="sect2"><span class="enumeration_section">3.7.3</span> Disabling Triggers and Cascade Constraints</h2>
<div id="DISABLETRIGGERSCASCADEDELETECONSTRA-33C270A4">
<p>Disable triggers, cascade delete constraints, and cascade update constraints on the target tables, or alter them to ignore changes made by the Oracle GoldenGate database user. Oracle GoldenGate replicates DML that results from a trigger or cascade constraint. If the same trigger or constraint gets activated on the target table, it becomes redundant because of the replicated version, and the database returns an error. Consider the following example, where the source tables are <code class="codeph">emp_src</code> and <code class="codeph">salary_src</code> and the target tables are <code class="codeph">emp_targ</code> and <code class="codeph">salary_targ</code>.</p>
<ol>
<li>
<p>A delete is issued for <code class="codeph">emp_src</code>.</p>
</li>
<li>
<p>It cascades a delete to <code class="codeph">salary_src</code>.</p>
</li>
<li>
<p>Oracle GoldenGate sends both deletes to the target.</p>
</li>
<li>
<p>The parent delete arrives first and is applied to <code class="codeph">emp_targ</code>.</p>
</li>
<li>
<p>The parent delete cascades a delete to <code class="codeph">salary_targ</code>.</p>
</li>
<li>
<p>The cascaded delete from <code class="codeph">salary_src</code> is applied to <code class="codeph">salary_targ</code>.</p>
</li>
<li>
<p>The row cannot be located because it was already deleted in step 5.</p>
</li>
</ol>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment226">
<tr>
<td class="cellalignment233">
<table class="cellalignment231">
<tr>
<td class="cellalignment230"><a href="other-oracle-goldengate-parameters-mysql.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment230"><a href="positioning-extract-specific-start-point.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2013, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment235">
<table class="cellalignment229">
<tr>
<td class="cellalignment230"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment230"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
