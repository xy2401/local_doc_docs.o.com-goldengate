<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Managing the DDL Replication Environment</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="description" content="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects." />
<meta name="dcterms.created" content="2018-07-19T06:26:07Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Installing and Configuring Oracle GoldenGate for Oracle Database" />
<meta name="dcterms.identifier" content="E66365-07" />
<meta name="dcterms.isVersionOf" content="GIORA" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2010, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="instantiating-oracle-goldengate-replication.htm" title="Previous" type="text/html" />
<link rel="Next" href="uninstalling-oracle-goldengate.htm" title="Next" type="text/html" />
<link rel="alternate" href="GIORA.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-686B15D8-4578-4071-B4D8-7A46295F2D39"></a> <span id="PAGE" style="display:none;">23/31</span> <!-- End Header -->
<a id="GIORA575"></a><a id="GIORA452"></a>
<h1 id="GIORA-GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" class="sect1"><span class="enumeration_chapter">16</span> Managing the DDL Replication Environment</h1>
<div>
<div><span>This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See <span><a href="installing-trigger-based-ddl-capture.htm#GUID-DFEC1E9D-92C2-475C-BD0C-E83087C0C775" title="This appendix contains instructions for installing the objects that support the trigger-based method of Oracle GoldenGate DDL support.">Installing Trigger-Based DDL Capture</a></span> for more information about the DDL objects.</span></div>
<p>For instructions on configuring Oracle GoldenGate DDL support, see <a href="configuring-ddl-support.htm#GUID-0A230601-A447-499C-B31F-C9431E1FF034" title="This chapter contains information to help you understand and configure DDL support in Oracle GoldenGate.">Configuring DDL Support</a>.</p>
<div class="infobox-note" id="GUID-686B15D8-4578-4071-B4D8-7A46295F2D39__GUID-A31EEB2A-332F-4AB6-A604-BEA3A319B1B3">
<p class="notep1">Note:</p>
<p>This chapter is only relevant for classic capture mode or integrated capture mode in which trigger-based DDL capture is being used.</p>
</div>
<p><span class="bold">Topics:</span></p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-34B178D8-B017-4C7D-B957-DD62DEDC5114">Disabling DDL Processing Temporarily</a><br /></li>
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-14FF46A1-F919-4885-8239-0ACC697E5744">Enabling and Disabling the DDL Trigger</a><br /></li>
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-5E171E3A-0F3D-43B9-A9A1-657B1CA1E454">Maintaining the DDL Marker Table</a><br /></li>
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-0EFDF082-52B0-45AE-9244-8145A19DD594">Deleting the DDL Marker Table</a><br /></li>
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-CBB235AE-0DDD-4712-ADCF-B890BBA16B1A">Maintaining the DDL History Table</a><br /></li>
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-696050C4-38F6-4CB8-9218-7E277FDA99D3">Deleting the DDL History Table</a><br /></li>
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-FED8990E-A273-4F92-803E-E16F62124B7C">Purging the DDL Trace File</a><br /></li>
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-53F02315-54AB-45D3-86B1-BBDAA7AC2741">Applying Database Patches and Upgrades when DDL Support is Enabled</a><br /></li>
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-1424E974-C477-4BFD-9568-D6541D8058A8">Applying Oracle GoldenGate Patches and Upgrades when DDL support is Enabled</a><br /></li>
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-923297A6-3DF8-4FF5-BB0D-BFCC35142552">Restoring an Existing DDL Environment to a Clean State</a><br /></li>
<li class="ulchildlink"><a href="managing-ddl-replication-environment.htm#GUID-7E073A83-039B-4C0E-93DD-6CCFB1D1C3DD">Removing the DDL Objects from the System</a><br /></li>
</ul>
</div>
<a id="GIORA951"></a>
<div class="props_rev_3"><a id="GUID-34B178D8-B017-4C7D-B957-DD62DEDC5114"></a>
<h2 id="GIORA-GUID-34B178D8-B017-4C7D-B957-DD62DEDC5114" class="sect2"><span class="enumeration_section">16.1</span> Disabling DDL Processing Temporarily</h2>
<div>
<div class="section">
<p>You must disable DDL activities before performing an instantiation or other tasks, if directed. You can resume DDL processing after the task is finished.</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Disable user DDL operations on the source database.</span></li>
<li><span>If there are previous DDL replication processes that are still active, make certain that the last executed DDL operation was applied to the target before stopping those processes, so that the load data is applied to objects that have the correct metadata.</span></li>
<li><span>Comment out the <code class="codeph">DDL</code> parameter in the Extract and Replicat parameter files that you configured for the new Oracle GoldenGate environment. Comment out any other parameters that support DDL.</span></li>
<li><span>Disable the Oracle GoldenGate DDL trigger, if one is in use. See <a href="managing-ddl-replication-environment.htm#GUID-14FF46A1-F919-4885-8239-0ACC697E5744">Enabling and Disabling the DDL Trigger</a>.</span></li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA453"></a>
<div class="props_rev_3"><a id="GUID-14FF46A1-F919-4885-8239-0ACC697E5744"></a>
<h2 id="GIORA-GUID-14FF46A1-F919-4885-8239-0ACC697E5744" class="sect2"><span class="enumeration_section">16.2</span> Enabling and Disabling the DDL Trigger</h2>
<div>
<div class="section">
<p>You can enable and disable the trigger that captures DDL operations without making any configuration changes within Oracle GoldenGate. The following scripts control the DDL trigger.</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">ddl_disable</code>: Disables the trigger. No further DDL operations are captured or replicated after you disable the trigger.</p>
</li>
<li>
<p><code class="codeph">ddl_enable</code>: Enables the trigger. When you enable the trigger, Oracle GoldenGate starts capturing current DDL changes, but does not capture DDL that was generated while the trigger was disabled.</p>
</li>
</ul>
<p>Before running these scripts, disable all sessions that ever issued DDL, including those of the Oracle GoldenGate processes, SQL*Plus, business applications, and any other software that uses Oracle. Otherwise the database might generate an ORA-04021 error. Do not use these scripts if you intend to maintain consistent DDL on the source and target systems.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA454"></a>
<div class="props_rev_3"><a id="GUID-5E171E3A-0F3D-43B9-A9A1-657B1CA1E454"></a>
<h2 id="GIORA-GUID-5E171E3A-0F3D-43B9-A9A1-657B1CA1E454" class="sect2"><span class="enumeration_section">16.3</span> Maintaining the DDL Marker Table</h2>
<div>
<div class="section">
<p>You can purge rows from the marker table at any time. It does not keep DDL history. To purge the marker table, use the Manager parameter <code class="codeph">PURGEMARKERHISTORY</code>. Manager gets the name of the marker table from one of the following:</p>
<ol>
<li>
<p>The name given with the <code class="codeph">MARKERTABLE</code> parameter in the <code class="codeph">GLOBALS</code> file, if specified.</p>
</li>
<li>
<p>The default name of <code class="codeph">GGS_MARKER</code>.</p>
</li>
</ol>
<p><code class="codeph">PURGEMARKERHISTORY</code> provides options to specify maximum and minimum lengths of time to keep a row, based on the last modification date. For more information, see <a class="olink GWURF596" target="_blank" href="../GWURF/purgemarkerhistory.htm#GWURF596"><span class="italic"><span id="GUID-5E171E3A-0F3D-43B9-A9A1-657B1CA1E454__GWURF"><cite>Reference for Oracle GoldenGate for Windows and UNIX</cite></span></span></a>.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA455"></a>
<div class="props_rev_3"><a id="GUID-0EFDF082-52B0-45AE-9244-8145A19DD594"></a>
<h2 id="GIORA-GUID-0EFDF082-52B0-45AE-9244-8145A19DD594" class="sect2"><span class="enumeration_section">16.4</span> Deleting the DDL Marker Table</h2>
<div>
<div class="section">
<p>Do not delete the DDL marker table unless you want to discontinue synchronizing DDL. The marker table and the DDL trigger are interdependent. An attempt to drop the marker table fails if the DDL trigger is enabled. This is a safety measure to prevent the trigger from becoming invalid and missing DDL operations. If you remove the marker table, the following error is generated:</p>
<pre dir="ltr">
ORA-04098: trigger 'SYS.GGS_DDL_TRIGGER_BEFORE' is invalid and failed re-validation
</pre>
<p>The proper way to remove an Oracle GoldenGate DDL object depends on your plans for the rest of the DDL environment. To choose the correct procedure, see one of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="managing-ddl-replication-environment.htm#GUID-923297A6-3DF8-4FF5-BB0D-BFCC35142552">Restoring an Existing DDL Environment to a Clean State</a></p>
</li>
<li>
<p><a href="managing-ddl-replication-environment.htm#GUID-7E073A83-039B-4C0E-93DD-6CCFB1D1C3DD">Removing the DDL Objects from the System</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA456"></a>
<div class="props_rev_3"><a id="GUID-CBB235AE-0DDD-4712-ADCF-B890BBA16B1A"></a>
<h2 id="GIORA-GUID-CBB235AE-0DDD-4712-ADCF-B890BBA16B1A" class="sect2"><span class="enumeration_section">16.5</span> Maintaining the DDL History Table</h2>
<div>
<div class="section">
<p>You can purge the DDL history table to control its size, but do so carefully. The DDL history table maintains the integrity of the DDL synchronization environment. Purges to this table cannot be recovered through the Oracle GoldenGate interface.</p>
<ol>
<li>
<p>To prevent any possibility of DDL history loss, make regular full backups of the history table.</p>
</li>
<li>
<p>To ensure that purged DDL can be recovered, enable Oracle Flashback for the history table. Set the flashback retention time well past the point where it could be needed. For example, if your full backups are at most one week old, retain two weeks of flashback. Oracle GoldenGate can be positioned backward into the flashback for reprocessing.</p>
</li>
<li>
<p>If possible, purge the DDL history table manually to ensure that essential rows are not purged accidentally. If you require an automated purging mechanism, use the <code class="codeph">PURGEDDLHISTORY</code> parameter in the Manager parameter file. You can specify maximum and minimum lengths of time to keep a row. For more information, see <a class="olink GWURF596" target="_blank" href="../GWURF/purgemarkerhistory.htm#GWURF596"><span class="italic"><span id="GUID-CBB235AE-0DDD-4712-ADCF-B890BBA16B1A__GWURF"><cite>Reference for Oracle GoldenGate for Windows and UNIX</cite></span></span></a>.</p>
</li>
</ol>
<div class="infobox-note" id="GUID-CBB235AE-0DDD-4712-ADCF-B890BBA16B1A__GUID-43E9CE96-2980-4FD0-99A7-15AAC531EF54">
<p class="notep1">Note:</p>
<p>Temporary tables created by Oracle GoldenGate to increase performance might be purged at the same time as the DDL history table, according to the same rules. The names of these tables are derived from the name of the history table, and their purging is reported in the Manager report file. This is normal behavior.</p>
</div>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA457"></a>
<div class="props_rev_3"><a id="GUID-696050C4-38F6-4CB8-9218-7E277FDA99D3"></a>
<h2 id="GIORA-GUID-696050C4-38F6-4CB8-9218-7E277FDA99D3" class="sect2"><span class="enumeration_section">16.6</span> Deleting the DDL History Table</h2>
<div>
<div class="section">
<p>Do not delete the DDL history table unless you want to discontinue synchronizing DDL. The history table contains a record of DDL operations that were issued. Once an Extract switches from using the DDL trigger to not using the trigger, as when source database redo compatibility is advanced to 11.2.0.4 or greater, these objects can be deleted though <span class="italic">not immediately</span>. It is imperative that all mining of the redo generated before the compatibility change be complete and that this redo not need to be mined again.</p>
<p>The history table and the DDL trigger are interdependent. An attempt to drop the history table fails if the DDL trigger is enabled. This is a safety measure to prevent the trigger from becoming invalid and missing DDL operations. If you remove the history table, the following error is generated:</p>
<pre dir="ltr">
ORA-04098: trigger 'SYS.GGS_DDL_TRIGGER_BEFORE' is invalid and failed re-validation
</pre>
<p>The proper way to remove an Oracle GoldenGate DDL object depends on your plans for the rest of the DDL environment. To choose the correct procedure, see one of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="managing-ddl-replication-environment.htm#GUID-923297A6-3DF8-4FF5-BB0D-BFCC35142552">Restoring an Existing DDL Environment to a Clean State</a></p>
</li>
<li>
<p><a href="managing-ddl-replication-environment.htm#GUID-7E073A83-039B-4C0E-93DD-6CCFB1D1C3DD">Removing the DDL Objects from the System</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA458"></a>
<div class="props_rev_3"><a id="GUID-FED8990E-A273-4F92-803E-E16F62124B7C"></a>
<h2 id="GIORA-GUID-FED8990E-A273-4F92-803E-E16F62124B7C" class="sect2"><span class="enumeration_section">16.7</span> Purging the DDL Trace File</h2>
<div>
<div class="section">
<p>To prevent the DDL trace file from consuming excessive disk space, run the <code class="codeph">ddl_cleartrace</code> script on a regular basis. This script deletes the trace file, but Oracle GoldenGate will create it again.</p>
<p>The default name of the DDL trace file is <code class="codeph">ggs_ddl_trace.log</code>. It is in the <code class="codeph">USER_DUMP_DEST</code> directory of Oracle. The <code class="codeph">ddl_cleartrace</code> script is in the Oracle GoldenGate directory.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA459"></a>
<div class="props_rev_3"><a id="GUID-53F02315-54AB-45D3-86B1-BBDAA7AC2741"></a>
<h2 id="GIORA-GUID-53F02315-54AB-45D3-86B1-BBDAA7AC2741" class="sect2"><span class="enumeration_section">16.8</span> Applying Database Patches and Upgrades when DDL Support is Enabled</h2>
<div>
<div class="section">
<p>Database patches and upgrades usually invalidate the Oracle GoldenGate DDL trigger and other Oracle GoldenGate DDL objects. Before applying a database patch, do the following.</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Log in to SQL*Plus as a user that has <code class="codeph">SYSDBA</code> privileges.</span></li>
<li><span>Disable the Oracle GoldenGate DDL trigger by running the <code class="codeph">ddl_disable</code> script in SQL*Plus.</span></li>
<li><span>Apply the patch.</span></li>
<li><span>Enable the DDL trigger by running the <code class="codeph">ddl_enable</code> script in SQL*Plus.</span></li>
</ol>
<div class="section">
<div class="infobox-note" id="GUID-53F02315-54AB-45D3-86B1-BBDAA7AC2741__GUID-9741EDC6-B923-4108-8AE7-6329D3F13119">
<p class="notep1">Note:</p>
<p>Database upgrades and patches generally operate on Oracle objects. Because Oracle GoldenGate filters out those objects automatically, DDL from those procedures is not replicated when replication starts again.</p>
</div>
<p>To avoid recompile errors after the patch or upgrade, which are caused if the trigger is not disabled before the procedure, consider adding calls to <code class="codeph">@ddl_disable</code> and <code class="codeph">@ddl_enable</code> at the appropriate locations within your scripts.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA460"></a>
<div class="props_rev_3"><a id="GUID-1424E974-C477-4BFD-9568-D6541D8058A8"></a>
<h2 id="GIORA-GUID-1424E974-C477-4BFD-9568-D6541D8058A8" class="sect2"><span class="enumeration_section">16.9</span> Applying Oracle GoldenGate Patches and Upgrades when DDL support is Enabled</h2>
<div>
<div class="section">
<p>This section explains how to apply Oracle GoldenGate patches and upgrades when DDL support is enabled.</p>
<div class="infobox-note" id="GUID-1424E974-C477-4BFD-9568-D6541D8058A8__GUID-66FA4FFB-E962-44C5-8E0D-B14361800465">
<p class="notep1">Note:</p>
<p>If the release notes or upgrade documentation for your Oracle GoldenGate release contain instructions similar to those provided in this section, follow those instructions instead the ones in this section. Do not use this procedure for an upgrade from an Oracle GoldenGate version that does not support DDL statements that are larger than 30K (pre-version 10.4). To upgrade in that case, follow the instructions in <a href="managing-ddl-replication-environment.htm#GUID-923297A6-3DF8-4FF5-BB0D-BFCC35142552">Restoring an Existing DDL Environment to a Clean State</a>.</p>
</div>
<p>Use the following steps to apply a patch or upgrade to the DDL objects. This procedure may or may not preserve the current DDL synchronization configuration, depending on whether the new build requires a clean installation.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Run GGSCI. Keep the session open for the duration of this procedure.</span></li>
<li class="stepexpand"><span>Stop Extract to stop DDL capture.</span>
<div>
<pre dir="ltr">
STOP EXTRACT <span class="italic">group</span>
</pre></div>
</li>
<li class="stepexpand"><span>Stop Replicat to stop DDL replication.</span>
<div>
<pre dir="ltr">
STOP REPLICAT <span class="italic">group</span>
</pre></div>
</li>
<li class="stepexpand"><span>Download or extract the patch or upgrade files according to the instructions provided by Oracle GoldenGate.</span></li>
<li class="stepexpand"><span>Change directories to the Oracle GoldenGate installation directory.</span></li>
<li class="stepexpand"><span>Log in to SQL*Plus as a user that has <code class="codeph">SYSDBA</code> privileges.</span></li>
<li class="stepexpand"><span>Disconnect all sessions that ever issued DDL, including those of Oracle GoldenGate processes, SQL*Plus, business applications, and any other software that uses Oracle. Otherwise the database might generate an ORA-04021 error.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">ddl_disable</code> script to disable the DDL trigger.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">ddl_setup</code> script. You are prompted for the name of the Oracle GoldenGate DDL schema. If you changed the schema name, use the new one.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">ddl_enable.sql</code> script to enable the DDL trigger.</span></li>
<li class="stepexpand"><span>In GGSCI, start Extract to resume DDL capture.</span>
<div>
<pre dir="ltr">
START EXTRACT <span class="italic">group</span>
</pre></div>
</li>
<li class="stepexpand"><span>Start Replicat to start DDL replication.</span>
<div>
<pre dir="ltr">
START REPLICAT <span class="italic">group</span>
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA461"></a>
<div class="props_rev_3"><a id="GUID-923297A6-3DF8-4FF5-BB0D-BFCC35142552"></a>
<h2 id="GIORA-GUID-923297A6-3DF8-4FF5-BB0D-BFCC35142552" class="sect2"><span class="enumeration_section">16.10</span> Restoring an Existing DDL Environment to a Clean State</h2>
<div>
<div class="section">
<p>Follow these steps to completely remove, and then reinstall, the Oracle GoldenGate DDL objects. This procedure creates a new DDL environment and removes any current DDL history.</p>
<div class="infobox-note" id="GUID-923297A6-3DF8-4FF5-BB0D-BFCC35142552__GUID-9E0432D9-1DFE-4644-81A9-A80DEE1072AD">
<p class="notep1">Note:</p>
<p>Due to object interdependencies, all objects must be removed and reinstalled in this procedure.</p>
</div>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>If you are performing this procedure in conjunction with the installation of a new Oracle GoldenGate version, download and install the Oracle GoldenGate files, and create or update process groups and parameter files as necessary.</span></li>
<li class="stepexpand"><span>(Optional) To preserve the continuity of source and target structures, stop DDL activities and then make certain that Replicat finished processing all of the DDL and DML data in the trail. To determine when Replicat is finished, issue the following command until you see a message that there is no more data to process.</span>
<div>
<pre dir="ltr">
INFO REPLICAT <span class="italic">group</span>
</pre>
<div class="infobox-note" id="GUID-923297A6-3DF8-4FF5-BB0D-BFCC35142552__GUID-FB5345EF-D057-47B4-8665-1C1B3BEB4B0C">
<p class="notep1">Note:</p>
<p>Instead of using <code class="codeph">INFO REPLICAT</code>, you can use the <code class="codeph">EVENTACTIONS</code> option of <code class="codeph">TABLE</code> and <code class="codeph">MAP</code> to stop the Extract and Replicat processes after the DDL and DML has been processed.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Run GGSCI.</span></li>
<li class="stepexpand"><span>Stop Extract to stop DDL capture.</span>
<div>
<pre dir="ltr">
STOP EXTRACT <span class="italic">group</span>
</pre></div>
</li>
<li class="stepexpand"><span>Stop Replicat to stop DDL replication.</span>
<div>
<pre dir="ltr">
STOP REPLICAT <span class="italic">group</span>
</pre></div>
</li>
<li class="stepexpand"><span>Change directories to the Oracle GoldenGate installation directory.</span></li>
<li class="stepexpand"><span>Log in to SQL*Plus as a user that has <code class="codeph">SYSDBA</code> privileges.</span></li>
<li class="stepexpand"><span>Disconnect all sessions that ever issued DDL, including those of Oracle GoldenGate processes, SQL*Plus, business applications, and any other software that uses Oracle. Otherwise the database might generate an ORA-04021 error.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">ddl_disable</code> script to disable the DDL trigger.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">ddl_remove</code> script to remove the Oracle GoldenGate DDL trigger, the DDL history and marker tables, and other associated objects. This script produces a <code class="codeph">ddl_remove_spool.txt</code> file that logs the script output and a <code class="codeph">ddl_remove_set.txt</code> file that logs environment settings in case they are needed for debugging.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">marker_remove</code> script to remove the Oracle GoldenGate marker support system. This script produces a <code class="codeph">marker_remove_spool.txt</code> file that logs the script output and a <code class="codeph">marker_remove_set.txt</code> file that logs environment settings in case they are needed for debugging.</span></li>
<li class="stepexpand"><span>If you are changing the DDL schema for this installation, grant the following permission to the Oracle GoldenGate schema.</span>
<div>
<pre dir="ltr">
GRANT EXECUTE ON utl_file TO <span class="italic">schema</span>;
</pre></div>
</li>
<li class="stepexpand"><span>If you are changing the DDL schema for this installation, the schema's default tablespace must be dedicated to that schema; do not allow any other schema to share it. <code class="codeph">AUTOEXTEND</code> must be set to <code class="codeph">ON</code> for this tablespace, and the tablespace must be sized to accommodate the growth of the <code class="codeph">GGS_DDL_HIST</code> and <code class="codeph">GGS_MARKER</code> tables. The <code class="codeph">GGS_DDL_HIST</code> table, in particular, will grow in proportion to overall DDL activity.</span>
<div>
<div class="infobox-note" id="GUID-923297A6-3DF8-4FF5-BB0D-BFCC35142552__GUID-7ADF71AD-2F2E-48C2-9D6E-0ADFE732B03C">
<p class="notep1">Note:</p>
<p>If the DDL tablespace fills up, Extract stops capturing DDL. To cause user DDL activity to fail when that happens, edit the <code class="codeph">params.sql</code> script and set the <code class="codeph">ddl_fire_error_in_trigger</code> parameter to <code class="codeph">TRUE</code>. Stopping user DDL gives you time to extend the tablespace size and prevent the loss of DDL capture. Managing tablespace sizing this way, however, requires frequent monitoring of the business applications and Extract to avoid business disruptions. Instead, Oracle recommends that you size the tablespace appropriately and set <code class="codeph">AUTOEXTEND</code> to <code class="codeph">ON</code> so that the tablespace does not fill up.</p>
</div>
<div class="infoboxnotewarn" id="GUID-923297A6-3DF8-4FF5-BB0D-BFCC35142552__GUID-5C773A27-3F8E-4081-914E-14900EAE01D7">
<p class="notep1">WARNING:</p>
<p>Do not edit any other parameters in <code class="codeph">params.sql</code> except if you need to follow documented instructions to change certain object names.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>If you are changing the DDL schema for this installation, edit the <code class="codeph">GLOBALS</code> file and specify the new schema name with the following parameter.</span>
<div>
<pre dir="ltr">
GGSCHEMA <span class="italic">schema_name</span>
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">marker_setup</code> script to reinstall the Oracle GoldenGate marker support system. You are prompted for the name of the Oracle GoldenGate schema.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">ddl_setup</code> script. You are prompted for the name of the Oracle GoldenGate DDL schema.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">role_setup</code> script to recreate the Oracle GoldenGate DDL role.</span></li>
<li class="stepexpand"><span>Grant the role to all Oracle GoldenGate users under which the following Oracle GoldenGate processes run: Extract, Replicat, GGSCI, and Manager. You might need to make multiple grants if the processes have different user names.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">ddl_enable.sql</code> script to enable the DDL trigger.</span></li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA462"></a>
<div class="props_rev_3"><a id="GUID-7E073A83-039B-4C0E-93DD-6CCFB1D1C3DD"></a>
<h2 id="GIORA-GUID-7E073A83-039B-4C0E-93DD-6CCFB1D1C3DD" class="sect2"><span class="enumeration_section">16.11</span> Removing the DDL Objects from the System</h2>
<div>
<div class="section">
<p>This procedure removes the DDL environment and removes the history that maintains continuity between source and target DDL operations.</p>
<div class="infobox-note" id="GUID-7E073A83-039B-4C0E-93DD-6CCFB1D1C3DD__GUID-D60353DB-32DB-401E-8F05-A47CA765A86A">
<p class="notep1">Note:</p>
<p>Due to object interdependencies, all objects must be removed.</p>
</div>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Run GGSCI.</span></li>
<li class="stepexpand"><span>Stop Extract to stop DDL capture.</span>
<div>
<pre dir="ltr">
STOP EXTRACT <span class="italic">group</span>
</pre></div>
</li>
<li class="stepexpand"><span>Stop Replicat to stop DDL replication.</span>
<div>
<pre dir="ltr">
STOP REPLICAT <span class="italic">group</span>
</pre></div>
</li>
<li class="stepexpand"><span>Change directories to the Oracle GoldenGate installation directory.</span></li>
<li class="stepexpand"><span>Run SQL*Plus and log in as a user that has <code class="codeph">SYSDBA</code> privileges.</span></li>
<li class="stepexpand"><span>Disconnect all sessions that ever issued DDL, including those of Oracle GoldenGate processes, SQL*Plus, business applications, and any other software that uses Oracle. Otherwise the database might generate an ORA-04021 error.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">ddl_disable</code> script to disable the DDL trigger.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">ddl_remove</code> script to remove the Oracle GoldenGate DDL trigger, the DDL history and marker tables, and the associated objects. This script produces a <code class="codeph">ddl_remove_spool.txt</code> file that logs the script output and a <code class="codeph">ddl_remove_set.txt</code> file that logs current user environment settings in case they are needed for debugging.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">marker_remove</code> script to remove the Oracle GoldenGate marker support system. This script produces a <code class="codeph">marker_remove_spool.txt</code> file that logs the script output and a <code class="codeph">marker_remove_set.txt</code> file that logs environment settings in case they are needed for debugging.</span></li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="managing-ddl-replication-environment.htm#GUID-686B15D8-4578-4071-B4D8-7A46295F2D39" title="This chapter contains instructions for making changes to the database environment or the Oracle GoldenGate environment when the Oracle GoldenGate DDL trigger is being used to support DDL replication. See Installing Trigger-Based DDL Capture for more information about the DDL objects.">Managing the DDL Replication Environment</a></p>
</div>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment377">
<tr>
<td class="cellalignment396">
<table class="cellalignment382">
<tr>
<td class="cellalignment381"><a href="instantiating-oracle-goldengate-replication.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment381"><a href="uninstalling-oracle-goldengate.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2010, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment398">
<table class="cellalignment380">
<tr>
<td class="cellalignment381"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment381"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
