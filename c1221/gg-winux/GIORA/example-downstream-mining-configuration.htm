<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Example Downstream Mining Configuration</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="description" content="This appendix contains examples for preparing a downstream Oracle mining database to support Extract in integrated capture mode." />
<meta name="dcterms.created" content="2018-07-19T06:26:07Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Installing and Configuring Oracle GoldenGate for Oracle Database" />
<meta name="dcterms.identifier" content="E66365-07" />
<meta name="dcterms.isVersionOf" content="GIORA" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2010, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="configuring-downstream-mining-database.htm" title="Previous" type="text/html" />
<link rel="Next" href="installing-trigger-based-ddl-capture.htm" title="Next" type="text/html" />
<link rel="alternate" href="GIORA.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-6F63B00B-9675-43FC-8841-1FB430E3BA21"></a> <span id="PAGE" style="display:none;">27/31</span> <!-- End Header -->
<a id="GIORA581"></a><a id="GIORA487"></a>
<h1 id="GIORA-GUID-6F63B00B-9675-43FC-8841-1FB430E3BA21" class="sect1"><span class="enumeration_chapter">C</span> Example Downstream Mining Configuration</h1>
<div>
<div><span>This appendix contains examples for preparing a downstream Oracle mining database to support Extract in integrated capture mode.</span></div>
<p>Configuring a downstream mining database, see <a href="configuring-downstream-mining-database.htm#GUID-C239668C-8E88-4840-96B0-467C3CF630C2" title="This appendix contains instructions for preparing a downstream Oracle mining database to support Extract in integrated capture mode.">Configuring a Downstream Mining Database</a>.</p>
<p><span class="bold">Topics:</span></p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-91A783B1-2EBF-49EB-98F7-5EB77404EC32">Example 1: Capturing from One Source Database in Real-time Mode</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-BD408E8D-952A-4446-A6C5-1EC279FA82CE">Example 2: Capturing from Multiple Sources in Archive-log-only Mode</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-CFE66D1B-A010-44A7-94FB-0CC70CEBB8D1">Example 3: Capturing from Multiple Sources with Mixed Real-time and Archive-log-only Mode</a><br /></li>
</ul>
</div>
<a id="GIORA488"></a>
<div class="props_rev_3"><a id="GUID-91A783B1-2EBF-49EB-98F7-5EB77404EC32"></a>
<h2 id="GIORA-GUID-91A783B1-2EBF-49EB-98F7-5EB77404EC32" class="sect2"><span class="enumeration_section">C.1</span> Example 1: Capturing from One Source Database in Real-time Mode</h2>
<div>
<div class="section">
<div class="infobox-note" id="GUID-91A783B1-2EBF-49EB-98F7-5EB77404EC32__GUID-9C09CF5B-E714-4A85-A4FB-9A096B443B65">
<p class="notep1">Note:</p>
<p>This example assumes that you created the necessary standby redo log files as shown in <a href="configuring-downstream-mining-database.htm#GUID-C239668C-8E88-4840-96B0-467C3CF630C2" title="This appendix contains instructions for preparing a downstream Oracle mining database to support Extract in integrated capture mode.">Configuring a Downstream Mining Database</a>.</p>
</div>
<p>This example captures changes from source database DBMS1 by deploying an integrated capture session at a downstream mining database DBMSCAP. This assumes that the following users exist:</p>
<ul style="list-style-type: disc;">
<li>
<p>User GGADM1 in DBMS1 whose credentials Extract will use to fetch data and metadata from DBMS1. This user has the alias of <code class="codeph">ggadm1</code> in the Oracle GoldenGate credential store and logs in as <code class="codeph">ggadm1@dbms1</code>. It is assumed that the <code class="codeph">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at the source database.</p>
</li>
<li>
<p>User GGADMCAP in DBMSCAP whose credentials Extract will use to retrieve logical change records from the logmining server at the downstream mining database DBMSCAP. This user has the alias of <code class="codeph">ggadmcap</code> in the Oracle GoldenGate credential store and logs in as <code class="codeph">ggadmcap@dbmscap</code>. It is assumed that the <code class="codeph">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at the mining database.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-8F76B366-25B8-4DDE-8143-3AABF437F2B6">Prepare the Mining Database to Archive its Local Redo</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-E5453C0C-E3A0-4BEE-90BA-7910B2247C60">Prepare the Mining Database to Archive Redo Received in Standby Redo Logs from the Source Database</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-F2B5798D-3078-47DA-BE8B-5A10BE4D4BCF">Prepare the Source Database to Send Redo to the Mining Database</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-955F95B8-2E0C-414F-ACE8-7DBD04B5D37F">Set up Integrated Capture (ext1) on DBMSCAP</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-6F63B00B-9675-43FC-8841-1FB430E3BA21" title="This appendix contains examples for preparing a downstream Oracle mining database to support Extract in integrated capture mode.">Example Downstream Mining Configuration</a></p>
</div>
</div>
</div>
<a id="GIORA489"></a>
<div class="props_rev_3"><a id="GUID-8F76B366-25B8-4DDE-8143-3AABF437F2B6"></a>
<h3 id="GIORA-GUID-8F76B366-25B8-4DDE-8143-3AABF437F2B6" class="sect3"><span class="enumeration_section">C.1.1</span> Prepare the Mining Database to Archive its Local Redo</h3>
<div>
<div class="section">
<p>To prepare the mining database to archive its local redo:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>The downstream mining database must be in archive log mode. You can do this by issuing the following DDL.</span>
<div>
<pre dir="ltr">
STARTUP MOUNT;
ALTER DATABASE ARCHIVELOG;
ALTER DATABASE OPEN;
</pre></div>
</li>
<li class="stepexpand"><span>At the downstream mining database, set <code class="codeph">log_archive_dest_1</code> to archive local redo.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SETLOG_ARCHIVE_DEST_1='LOCATION=/home/arc_dest/localVALID_FOR=(ONLINE_LOGFILE, PRIMARY_ROLE)'
</pre></div>
</li>
<li class="stepexpand"><span>Enable <code class="codeph">log_archive_dest_1</code>.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_1=ENABLE 
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-91A783B1-2EBF-49EB-98F7-5EB77404EC32">Example 1: Capturing from One Source Database in Real-time Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA490"></a>
<div class="props_rev_3"><a id="GUID-E5453C0C-E3A0-4BEE-90BA-7910B2247C60"></a>
<h3 id="GIORA-GUID-E5453C0C-E3A0-4BEE-90BA-7910B2247C60" class="sect3"><span class="enumeration_section">C.1.2</span> Prepare the Mining Database to Archive Redo Received in Standby Redo Logs from the Source Database</h3>
<div>
<div class="section">
<p>To prepare the mining database to archive the redo received in standby redo logs from the source database:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>At the downstream mining database, set <code class="codeph">log_archive_dest_2</code> as shown in the following example.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET
LOG_ARCHIVE_DEST_2='LOCATION=/home/arc_dest/srl_dbms1
VALID_FOR=(STANDBY_LOGFILE,PRIMARY_ROLE)'
</pre></div>
</li>
<li class="stepexpand"><span>Enable <code class="codeph">log_archive_dest_2</code> as shown in the following example.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE
</pre></div>
</li>
<li class="stepexpand"><span>Set <code class="codeph">DG_CONFIG</code> at the downstream mining database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1,dbmscap)'
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-91A783B1-2EBF-49EB-98F7-5EB77404EC32">Example 1: Capturing from One Source Database in Real-time Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA491"></a>
<div class="props_rev_3"><a id="GUID-F2B5798D-3078-47DA-BE8B-5A10BE4D4BCF"></a>
<h3 id="GIORA-GUID-F2B5798D-3078-47DA-BE8B-5A10BE4D4BCF" class="sect3"><span class="enumeration_section">C.1.3</span> Prepare the Source Database to Send Redo to the Mining Database</h3>
<div>
<div class="section">
<p>To prepare the source database to send redo to the mining database:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Make sure that the source database is running with the required compatibility.</span>
<div>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME            VALUE
---------       ---------------------
compatible      11.1.0.7.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</div>
</li>
<li class="stepexpand"><span>Set <code class="codeph">DG_CONFIG</code> at the source database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1,dbmscap)';
</pre></div>
</li>
<li class="stepexpand"><span>Set up redo transport at the source database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER 
VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></div>
</li>
<li class="stepexpand"><span>Enable the downstream destination.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-91A783B1-2EBF-49EB-98F7-5EB77404EC32">Example 1: Capturing from One Source Database in Real-time Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA492"></a>
<div class="props_rev_3"><a id="GUID-955F95B8-2E0C-414F-ACE8-7DBD04B5D37F"></a>
<h3 id="GIORA-GUID-955F95B8-2E0C-414F-ACE8-7DBD04B5D37F" class="sect3"><span class="enumeration_section">C.1.4</span> Set up Integrated Capture (ext1) on DBMSCAP</h3>
<div>
<div class="section">
<p>To set up integrated capture (ext1) on DBMSCAP:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Register Extract with the downstream mining database. In the credential store, the alias name of <code class="codeph">ggadm1</code> is linked to a user connect string of <code class="codeph">ggadm1@dbms1</code>. The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERIDALIAS ggadm1
GGSCI&gt; MININGDBLOGIN USERIDALIAS ggadmcap
GGSCI&gt; REGISTER EXTRACT ext1 DATABASE
</pre></div>
</li>
<li class="stepexpand"><span>Create Extract at the downstream mining database.</span>
<div>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext1 INTEGRATED TRANLOG BEGIN NOW
</pre></div>
</li>
<li class="stepexpand"><span>Edit Extract parameter file <code class="codeph">ext1.prm</code>. The following lines must be present to take advantage of real-time capture. In the credential store, the alias name of <code class="codeph">ggadm1</code> is linked to a user connect string of <code class="codeph">ggadm1@dbms1</code>. The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
USERIDALIAS ggadm1
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine Y)
</pre></div>
</li>
<li class="stepexpand"><span>Start Extract.</span>
<div>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext1
</pre></div>
</li>
</ol>
<div class="section">
<div class="infobox-note" id="GUID-955F95B8-2E0C-414F-ACE8-7DBD04B5D37F__GUID-79853B5E-EF14-4077-9ECB-176B0DFFB077">
<p class="notep1">Note:</p>
<p>You can create multiple Extracts running in real-time integrated capture mode in the downstream mining database, as long as they all are capturing data from the same source database, such as capturing changes for database DBMS1 in the preceding example.</p>
</div>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-91A783B1-2EBF-49EB-98F7-5EB77404EC32">Example 1: Capturing from One Source Database in Real-time Mode</a></p>
</div>
</div>
</div>
</div>
</div>
<a id="GIORA493"></a>
<div class="props_rev_3"><a id="GUID-BD408E8D-952A-4446-A6C5-1EC279FA82CE"></a>
<h2 id="GIORA-GUID-BD408E8D-952A-4446-A6C5-1EC279FA82CE" class="sect2"><span class="enumeration_section">C.2</span> Example 2: Capturing from Multiple Sources in Archive-log-only Mode</h2>
<div>
<div class="section">
<p>The following example captures changes from database DBMS1 and DBMS2 by deploying an integrated capture session at a downstream mining database DBMSCAP. It assumes the following users:</p>
<ul style="list-style-type: disc;">
<li>
<p>User GGADM1 in DBMS1 whose credentials Extract will use to fetch data and metadata from DBMS1. It is assumed that the <code class="codeph">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at DBMS1.</p>
</li>
<li>
<p>User GGADM2 in DBMS2 whose credentials Extract will use to fetch data and metadata from DBMS2. It is assumed that the <code class="codeph">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at DBMS2.</p>
</li>
<li>
<p>User GGADMCAP in DBMSCAP whose credentials Extract will use to retrieve logical change records from the logmining server at the downstream mining database. It is assumed that the <code class="codeph">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at the downstream mining database DBMSCAP.</p>
</li>
</ul>
<p>This procedure also assumes that the downstream mining database is configured in archive log mode.</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-236F6364-27B5-4BA6-BAFF-244E5E146118">Prepare the Mining Database to Archive its Local Redo</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-9AC1C985-ED5D-4C99-B470-2426D27A0693">Prepare the Mining Database to Archive Redo from the Source Database</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-968E25BC-2B44-48EA-AF70-5E2372C2C353">Prepare the First Source Database to Send Redo to the Mining Database</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-DA47CA5D-2FDF-4E12-8E10-6F57B3C0AADF">Prepare the Second Source Database to Send Redo to the Mining Database</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-34FD51F0-32D9-44E9-B784-ABB9D8020685">Set up Extracts at the Downstream Mining Database</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-6F63B00B-9675-43FC-8841-1FB430E3BA21" title="This appendix contains examples for preparing a downstream Oracle mining database to support Extract in integrated capture mode.">Example Downstream Mining Configuration</a></p>
</div>
</div>
</div>
<a id="GIORA494"></a>
<div class="props_rev_3"><a id="GUID-236F6364-27B5-4BA6-BAFF-244E5E146118"></a>
<h3 id="GIORA-GUID-236F6364-27B5-4BA6-BAFF-244E5E146118" class="sect3"><span class="enumeration_section">C.2.1</span> Prepare the Mining Database to Archive its Local Redo</h3>
<div>
<div class="section">
<p>To prepare the mining database to archive its local redo:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>The downstream mining database must be in archive log mode. You can do this by issuing the following DDL.</span>
<div>
<pre dir="ltr">
       STARTUP MOUNT;
        ALTER DATABASE ARCHIVELOG;
        ALTER DATABASE OPEN;
</pre></div>
</li>
<li class="stepexpand"><span>At the downstream mining database, set <code class="codeph">log_archive_dest_1</code> to archive local redo.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET
LOG_ARCHIVE_DEST_1='LOCATION=/home/arc_dest/local
VALID_FOR=(ONLINE_LOGFILE, PRIMARY_ROLE)'
</pre></div>
</li>
<li class="stepexpand"><span>Enable <code class="codeph">log_archive_dest_1</code>.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_1=ENABLE 
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-BD408E8D-952A-4446-A6C5-1EC279FA82CE">Example 2: Capturing from Multiple Sources in Archive-log-only Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA495"></a>
<div class="props_rev_3"><a id="GUID-9AC1C985-ED5D-4C99-B470-2426D27A0693"></a>
<h3 id="GIORA-GUID-9AC1C985-ED5D-4C99-B470-2426D27A0693" class="sect3"><span class="enumeration_section">C.2.2</span> Prepare the Mining Database to Archive Redo from the Source Database</h3>
<div>
<div class="section">
<p>Set <code class="codeph">DG_CONFIG</code> at the downstream mining database.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1,dbms2, dbmscap)'
</pre></div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-BD408E8D-952A-4446-A6C5-1EC279FA82CE">Example 2: Capturing from Multiple Sources in Archive-log-only Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA496"></a>
<div class="props_rev_3"><a id="GUID-968E25BC-2B44-48EA-AF70-5E2372C2C353"></a>
<h3 id="GIORA-GUID-968E25BC-2B44-48EA-AF70-5E2372C2C353" class="sect3"><span class="enumeration_section">C.2.3</span> Prepare the First Source Database to Send Redo to the Mining Database</h3>
<div>
<div class="section">
<p>To prepare the first source database to send redo to the mining database:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Make certain that DBMS1 source database is running with the required compatibility.</span>
<div>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME            VALUE
---------       ---------------------
compatible      11.1.0.7.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</div>
</li>
<li class="stepexpand"><span>Set <code class="codeph">DG_CONFIG</code> at DBMS1 source database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1, dbmscap)'; 
</pre></div>
</li>
<li class="stepexpand"><span>Set up redo transport at DBMS1 source database. The <code class="codeph">TEMPLATE</code> clause is mandatory if you want to send redo data directly to foreign archived logs at the downstream mining database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER
TEMPLATE='/usr/orcl/arc_dest/dbms1/dbms1_arch_%t_%s_%r.log VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></div>
</li>
<li class="stepexpand"><span>Enable the downstream destination.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-BD408E8D-952A-4446-A6C5-1EC279FA82CE">Example 2: Capturing from Multiple Sources in Archive-log-only Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA497"></a>
<div class="props_rev_3"><a id="GUID-DA47CA5D-2FDF-4E12-8E10-6F57B3C0AADF"></a>
<h3 id="GIORA-GUID-DA47CA5D-2FDF-4E12-8E10-6F57B3C0AADF" class="sect3"><span class="enumeration_section">C.2.4</span> Prepare the Second Source Database to Send Redo to the Mining Database</h3>
<div>
<div class="section">
<p>To prepare the second source database to send redo to the mining database:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Make sure that DBMS2 source database is running with the required compatibility.</span>
<div>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME            VALUE
---------      ---------------------
compatible     11.1.0.0.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</div>
</li>
<li class="stepexpand"><span>Set <code class="codeph">DG_CONFIG</code> at DBMS2 source database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms2, dbmscap)'; 
</pre></div>
</li>
<li class="stepexpand"><span>Set up redo transport at DBMS2 source database. The <code class="codeph">TEMPLATE</code> clause is mandatory if you want to send redo data directly to foreign archived logs at the downstream mining database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER
TEMPLATE='/usr/orcl/arc_dest/dbms2/dbms2_arch_%t_%s_%r.log VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></div>
</li>
<li class="stepexpand"><span>Enable the downstream destination.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-BD408E8D-952A-4446-A6C5-1EC279FA82CE">Example 2: Capturing from Multiple Sources in Archive-log-only Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA498"></a>
<div class="props_rev_3"><a id="GUID-34FD51F0-32D9-44E9-B784-ABB9D8020685"></a>
<h3 id="GIORA-GUID-34FD51F0-32D9-44E9-B784-ABB9D8020685" class="sect3"><span class="enumeration_section">C.2.5</span> Set up Extracts at the Downstream Mining Database</h3>
<div>
<div class="section">
<p>The following steps set up Extract at the downstream database to capture from the archived logs sent by DBMS1 and DBMS2.</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-1F774975-1A20-4E30-BD38-8186C4C97759">Set up Extract (ext1) to Capture Changes from Archived Logs Sent by DBMS1</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-65221381-FE19-4CCC-839D-74BCE234E57A">Set up Extract (ext2) to Capture Changes from Archived Logs Sent by DBMS2</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-BD408E8D-952A-4446-A6C5-1EC279FA82CE">Example 2: Capturing from Multiple Sources in Archive-log-only Mode</a></p>
</div>
</div>
</div>
<a id="GIORA499"></a>
<div class="props_rev_3"><a id="GUID-1F774975-1A20-4E30-BD38-8186C4C97759"></a>
<h4 id="GIORA-GUID-1F774975-1A20-4E30-BD38-8186C4C97759" class="sect4"><span class="enumeration_section">C.2.5.1</span> Set up Extract (ext1) to Capture Changes from Archived Logs Sent by DBMS1</h4>
<div>
<div class="section">
<p>Perform the following steps on the DBMSCAP downstream mining database.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Register Extract with DBMSCAP for the DBMS1 source database. In the credential store, the alias name of <code class="codeph">ggadm1</code> is linked to a user connect string of <code class="codeph">ggadm1@dbms1</code>. The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERIDALIAS ggadm1
GGSCI&gt; MININGDBLOGIN USERIDALIAS ggadmcap
GGSCI&gt; REGISTER EXTRACT ext1 DATABASE
</pre></div>
</li>
<li class="stepexpand"><span>Add Extract at the mining database DBMSCAP.</span>
<div>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext1 INTEGRATED TRANLOG BEGIN NOW
</pre></div>
</li>
<li class="stepexpand"><span>Edit the Extract parameter file <code class="codeph">ext1.prm</code>. In the credential store, the alias name of <code class="codeph">ggadm1</code> is linked to a user connect string of <code class="codeph">ggadm1@dbms1</code>. The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
USERIDALIAS ggadm1
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine N)
</pre></div>
</li>
<li class="stepexpand"><span>Start Extract.</span>
<div>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext1
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-34FD51F0-32D9-44E9-B784-ABB9D8020685">Set up Extracts at the Downstream Mining Database</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA500"></a>
<div class="props_rev_3"><a id="GUID-65221381-FE19-4CCC-839D-74BCE234E57A"></a>
<h4 id="GIORA-GUID-65221381-FE19-4CCC-839D-74BCE234E57A" class="sect4"><span class="enumeration_section">C.2.5.2</span> Set up Extract (ext2) to Capture Changes from Archived Logs Sent by DBMS2</h4>
<div>
<div class="section">
<p>Perform the following steps on the downstream DBMSCAP mining database.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Register Extract with the mining database for source database DBMS2. In the credential store, the alias name of <code class="codeph">ggadm2</code> is linked to a user connect string of <code class="codeph">ggadm2@dbms2</code>.The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERIDALIAS ggadm2
GGSCI&gt; MININGDBLOGIN USERIDALIAS ggadmcap
GGSCI&gt; REGISTER EXTRACT ext2 DATABASE
</pre></div>
</li>
<li class="stepexpand"><span>Create Extract at the mining database.</span>
<div>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext2 INTEGRATED TRANLOG, BEGIN NOW
</pre></div>
</li>
<li class="stepexpand"><span>Edit the Extract parameter file <code class="codeph">ext2.prm</code>. In the credential store, the alias name of <code class="codeph">ggadm2</code> is linked to a user connect string of <code class="codeph">ggadm2@dbms2</code>. The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
USERIDALIAS ggadm2
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine N)
</pre></div>
</li>
<li class="stepexpand"><span>Start Extract.</span>
<div>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext2
</pre>
<div class="infobox-note" id="GUID-65221381-FE19-4CCC-839D-74BCE234E57A__GUID-9D9EF921-56A6-43F8-8C15-F40A0923698C">
<p class="notep1">Note:</p>
<p>You can create multiple Extracts capturing data from the same source database while running in archive-log-only mode in the downstream mining database. In the case of these examples, you can create other Extracts capturing changes for database DBMS1 and DBMS2 at the downstream mining database.</p>
</div>
</div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-34FD51F0-32D9-44E9-B784-ABB9D8020685">Set up Extracts at the Downstream Mining Database</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<a id="GIORA501"></a>
<div class="props_rev_3"><a id="GUID-CFE66D1B-A010-44A7-94FB-0CC70CEBB8D1"></a>
<h2 id="GIORA-GUID-CFE66D1B-A010-44A7-94FB-0CC70CEBB8D1" class="sect2"><span class="enumeration_section">C.3</span> Example 3: Capturing from Multiple Sources with Mixed Real-time and Archive-log-only Mode</h2>
<div>
<div class="section">
<div class="infobox-note" id="GUID-CFE66D1B-A010-44A7-94FB-0CC70CEBB8D1__GUID-FF0EAAA4-7645-4A63-BB15-4D7228104370">
<p class="notep1">Note:</p>
<p>This example assumes that you created the necessary standby redo log files as shown in <a href="configuring-downstream-mining-database.htm#GUID-C239668C-8E88-4840-96B0-467C3CF630C2" title="This appendix contains instructions for preparing a downstream Oracle mining database to support Extract in integrated capture mode.">Configuring a Downstream Mining Database</a>.</p>
</div>
<p>The following example captures changes from database DBMS1, DBMS2 and DBMS3 by deploying an integrated capture session at a downstream mining database DBMSCAP. It assumes the following users:</p>
<ul style="list-style-type: disc;">
<li>
<p>User GGADM1 in DBMS1 whose credentials Extract will use to fetch data and metadata from DBMS1. It is assumed that the <code class="codeph">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at DBMS1.</p>
</li>
<li>
<p>User GGADM2 in DBMS2 whose credentials Extract will use to fetch data and metadata from DBMS2. It is assumed that the <code class="codeph">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at DBMS2.</p>
</li>
<li>
<p>User GGADM3 in DBMS3 whose credentials Extract will use to fetch data and metadata from DBMS3. It is assumed that the <code class="codeph">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at DBMS3.</p>
</li>
<li>
<p>User GGADMCAP in DBMSCAP whose credentials Extract will use to retrieve logical change records from the logmining server at the downstream mining database. It is assumed that the <code class="codeph">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at the downstream mining database DBMSCAP.</p>
</li>
</ul>
<p>This procedure also assumes that the downstream mining database is configured in archive log mode.</p>
<p>In this example, the redo sent by DBMS3 will be mined in real time mode, whereas the redo data sent from DBMS1 and DBMS2 will be mined in archive-log-only mode.</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-05A8F6DD-C039-44EC-AC30-3D18174B469E">Prepare the Mining Database to Archive its Local Redo</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-AD59E098-F2D1-4C9F-915B-4BE4363EA8BB">Prepare the Mining Database to Accept Redo from the Source Databases</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-22ED70EB-6236-4D7F-A96A-0002EB405C32">Prepare the First Source Database to Send Redo to the Mining Database</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-A9CD4A80-0E00-49EE-AF00-D2D78E826187">Prepare the Second Source Database to Send Redo to the Mining Database</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-EB2B15CA-3C96-487E-AF6B-94D9E1D94A6C">Prepare the Third Source Database to Send Redo to the Mining Database</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-7A6171B3-F11A-4DFC-BF9A-0BD7B358AF87">Set up Extracts at Downstream Mining Database</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-6F63B00B-9675-43FC-8841-1FB430E3BA21" title="This appendix contains examples for preparing a downstream Oracle mining database to support Extract in integrated capture mode.">Example Downstream Mining Configuration</a></p>
</div>
</div>
</div>
<a id="GIORA502"></a>
<div class="props_rev_3"><a id="GUID-05A8F6DD-C039-44EC-AC30-3D18174B469E"></a>
<h3 id="GIORA-GUID-05A8F6DD-C039-44EC-AC30-3D18174B469E" class="sect3"><span class="enumeration_section">C.3.1</span> Prepare the Mining Database to Archive its Local Redo</h3>
<div>
<div class="section">
<p>To prepare the mining database to archive its local redo:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>The downstream mining database must be in archive log mode. You can do this by issuing the following DDL.</span>
<div>
<pre dir="ltr">
        STARTUP MOUNT;
        ALTER DATABASE ARCHIVELOG;
        ALTER DATABASE OPEN;
</pre></div>
</li>
<li class="stepexpand"><span>At the downstream mining database, set <code class="codeph">log_archive_dest_1</code> to archive local redo.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET
LOG_ARCHIVE_DEST_1='LOCATION=/home/arc_dest/local
VALID_FOR=(ONLINE_LOGFILE, PRIMARY_ROLE)'
</pre></div>
</li>
<li class="stepexpand"><span>Enable <code class="codeph">log_archive_dest_1</code>.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_1=ENABLE 
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-CFE66D1B-A010-44A7-94FB-0CC70CEBB8D1">Example 3: Capturing from Multiple Sources with Mixed Real-time and Archive-log-only Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA503"></a>
<div class="props_rev_3"><a id="GUID-AD59E098-F2D1-4C9F-915B-4BE4363EA8BB"></a>
<h3 id="GIORA-GUID-AD59E098-F2D1-4C9F-915B-4BE4363EA8BB" class="sect3"><span class="enumeration_section">C.3.2</span> Prepare the Mining Database to Accept Redo from the Source Databases</h3>
<div>
<div class="section">
<p>Because redo data is being accepted in the standby redo logs of the downstream mining database, the appropriate number of correctly sized standby redo logs must exist. If you did not configure the standby logs, see <a href="configuring-downstream-mining-database.htm#GUID-C239668C-8E88-4840-96B0-467C3CF630C2" title="This appendix contains instructions for preparing a downstream Oracle mining database to support Extract in integrated capture mode.">Configuring a Downstream Mining Database</a>.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>At the downstream mining database, set the second archive log destination in the <code class="codeph">LOG_ARCHIVE_DEST_n</code> initialization parameter as shown in the following example. This is needed to handle archive standby redo logs.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET
LOG_ARCHIVE_DEST_2='LOCATION=/home/arc_dest/srl_dbms3
VALID_FOR=(STANDBY_LOGFILE,PRIMARY_ROLE)'
</pre></div>
</li>
<li class="stepexpand"><span>Enable the <code class="codeph">LOG_ARCHIVE_DEST_STATE_2</code> initialization parameter that corresponds with the <code class="codeph">LOG_ARCHIVE_DEST_2</code> parameter as shown in the following example.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE 
</pre></div>
</li>
<li class="stepexpand"><span>Set <code class="codeph">DG_CONFIG</code> at the downstream mining database to accept redo data from all of the source databases.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1, dbms2, dbms3, dbmscap)' 
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-CFE66D1B-A010-44A7-94FB-0CC70CEBB8D1">Example 3: Capturing from Multiple Sources with Mixed Real-time and Archive-log-only Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA504"></a>
<div class="props_rev_3"><a id="GUID-22ED70EB-6236-4D7F-A96A-0002EB405C32"></a>
<h3 id="GIORA-GUID-22ED70EB-6236-4D7F-A96A-0002EB405C32" class="sect3"><span class="enumeration_section">C.3.3</span> Prepare the First Source Database to Send Redo to the Mining Database</h3>
<div>
<div class="section">
<p>To prepare the first source database to send redo to the mining database:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Make certain that DBMS1 source database is running with the required compatibility.</span>
<div>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME            VALUE
---------       ---------------------
compatible      11.1.0.0.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</div>
</li>
<li class="stepexpand"><span>Set <code class="codeph">DG_CONFIG</code> at DBMS1 source database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1, dbmscap)'; 
</pre></div>
</li>
<li class="stepexpand"><span>Set up redo transport at DBMS1 source database. The <code class="codeph">TEMPLATE</code> clause is mandatory if you want to send redo data directly to foreign archived logs at the downstream mining database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER
TEMPLATE='/usr/orcl/arc_dest/dbms1/dbms1_arch_%t_%s_%r.log VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></div>
</li>
<li class="stepexpand"><span>Enable the downstream destination.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-CFE66D1B-A010-44A7-94FB-0CC70CEBB8D1">Example 3: Capturing from Multiple Sources with Mixed Real-time and Archive-log-only Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA505"></a>
<div class="props_rev_3"><a id="GUID-A9CD4A80-0E00-49EE-AF00-D2D78E826187"></a>
<h3 id="GIORA-GUID-A9CD4A80-0E00-49EE-AF00-D2D78E826187" class="sect3"><span class="enumeration_section">C.3.4</span> Prepare the Second Source Database to Send Redo to the Mining Database</h3>
<div>
<div class="section">
<p>To prepare the second source database to send redo to the mining database:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Make sure that DBMS2 source database is running with the required compatibility.</span>
<div>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME                    VALUE
---------               ---------------------
compatible              11.1.0.0.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</div>
</li>
<li class="stepexpand"><span>Set <code class="codeph">DG_CONFIG</code> at DBMS2 source database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms2, dbmscap)'; 
</pre></div>
</li>
<li class="stepexpand"><span>Set up redo transport at DBMS2 source database. The <code class="codeph">TEMPLATE</code> clause is mandatory if you want to send redo data directly to foreign archived logs at the downstream mining database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER
TEMPLATE='/usr/orcl/arc_dest/dbms2/dbms2_arch_%t_%s_%r.log VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></div>
</li>
<li class="stepexpand"><span>Enable the downstream destination.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-CFE66D1B-A010-44A7-94FB-0CC70CEBB8D1">Example 3: Capturing from Multiple Sources with Mixed Real-time and Archive-log-only Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA506"></a>
<div class="props_rev_3"><a id="GUID-EB2B15CA-3C96-487E-AF6B-94D9E1D94A6C"></a>
<h3 id="GIORA-GUID-EB2B15CA-3C96-487E-AF6B-94D9E1D94A6C" class="sect3"><span class="enumeration_section">C.3.5</span> Prepare the Third Source Database to Send Redo to the Mining Database</h3>
<div>
<div class="section">
<p>To prepare the third source database to send redo to the mining database:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Make sure that DBMS3 source database is running with the required compatibility.</span>
<div>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME                    VALUE
---------               ---------------------
compatible              11.1.0.0.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</div>
</li>
<li class="stepexpand"><span>Set <code class="codeph">DG_CONFIG</code> at DBMS3 source database.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms3, dbmscap)'; 
</pre></div>
</li>
<li class="stepexpand"><span>Set up redo transport at DBMS3 source database. Because DBMS3 is the source that will send its online redo logs to the standby redo logs at the downstream mining database, do not specify a <code class="codeph">TEMPLATE</code> clause.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER
VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></div>
</li>
<li class="stepexpand"><span>Enable the downstream destination.</span>
<div>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-CFE66D1B-A010-44A7-94FB-0CC70CEBB8D1">Example 3: Capturing from Multiple Sources with Mixed Real-time and Archive-log-only Mode</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA507"></a>
<div class="props_rev_3"><a id="GUID-7A6171B3-F11A-4DFC-BF9A-0BD7B358AF87"></a>
<h3 id="GIORA-GUID-7A6171B3-F11A-4DFC-BF9A-0BD7B358AF87" class="sect3"><span class="enumeration_section">C.3.6</span> Set up Extracts at Downstream Mining Database</h3>
<div>
<div class="section">
<p>These steps set up Extract at the downstream database to capture from the archived logs sent by DBMS1 and DBMS2.</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-E264E366-9629-4CDE-8369-1D309D721633">Set up Extract (ext1) to Capture Changes from Archived Logs Sent by DBMS1</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-E3FBB1B5-085F-403A-8274-BBFAB30973F5">Set up Extract (ext2) to Capture Changes from Archived Logs Sent by DBMS2</a><br /></li>
<li class="ulchildlink"><a href="example-downstream-mining-configuration.htm#GUID-FF0A0402-43C9-4D14-9315-BED3CC6B2493">Set up Extract (ext3) to Capture Changes in Real-time Mode from Online Logs Sent&nbsp;by&nbsp;DBMS3</a><br /></li>
</ul>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-CFE66D1B-A010-44A7-94FB-0CC70CEBB8D1">Example 3: Capturing from Multiple Sources with Mixed Real-time and Archive-log-only Mode</a></p>
</div>
</div>
</div>
<a id="GIORA508"></a>
<div class="props_rev_3"><a id="GUID-E264E366-9629-4CDE-8369-1D309D721633"></a>
<h4 id="GIORA-GUID-E264E366-9629-4CDE-8369-1D309D721633" class="sect4"><span class="enumeration_section">C.3.6.1</span> Set up Extract (ext1) to Capture Changes from Archived Logs Sent by DBMS1</h4>
<div>
<div class="section">
<p>Perform the following steps on the DBMSCAP downstream mining database.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Register Extract with DBMSCAP for the DBMS1 source database. In the credential store, the alias name of <code class="codeph">ggadm1</code> is linked to a user connect string of <code class="codeph">ggadm1@dbms1</code>.The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERIDALIAS ggadm1
GGSCI&gt; MININGDBLOGIN USERIDALIAS ggadmcap
GGSCI&gt; REGISTER EXTRACT ext1 DATABASE
</pre></div>
</li>
<li class="stepexpand"><span>Add Extract at the mining database DBMSCAP.</span>
<div>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext1 INTEGRATED TRANLOG BEGIN NOW
</pre></div>
</li>
<li class="stepexpand"><span>Edit the Extract parameter file <code class="codeph">ext1.prm</code>. In the credential store, the alias name of <code class="codeph">ggadm1</code> is linked to a user connect string of <code class="codeph">ggadm1@dbms1</code>. The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
USERIDALIAS ggadm1
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine N)
</pre></div>
</li>
<li class="stepexpand"><span>Start Extract.</span>
<div>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext1
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-7A6171B3-F11A-4DFC-BF9A-0BD7B358AF87">Set up Extracts at Downstream Mining Database</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA509"></a>
<div class="props_rev_3"><a id="GUID-E3FBB1B5-085F-403A-8274-BBFAB30973F5"></a>
<h4 id="GIORA-GUID-E3FBB1B5-085F-403A-8274-BBFAB30973F5" class="sect4"><span class="enumeration_section">C.3.6.2</span> Set up Extract (ext2) to Capture Changes from Archived Logs Sent by DBMS2</h4>
<div>
<div class="section">
<p>Perform the following steps on the DBMSCAP downstream mining database.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Register Extract with the mining database for source database DBMS2. In the credential store, the alias name of <code class="codeph">ggadm2</code> is linked to a user connect string of <code class="codeph">ggadm2@dbms2</code>.The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERIDALIAS ggadm2
GGSCI&gt; MININGDBLOGIN USERIDALIAS ggadmcap
GGSCI&gt; REGISTER EXTRACT ext2 DATABASE
</pre></div>
</li>
<li class="stepexpand"><span>Create Extract at the mining database.</span>
<div>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext2 INTEGRATED TRANLOG, BEGIN NOW
</pre></div>
</li>
<li class="stepexpand"><span>Edit the Extract parameter file <code class="codeph">ext2.prm</code>. In the credential store, the alias name of <code class="codeph">ggadm2</code> is linked to a user connect string of <code class="codeph">ggadm2@dbms2</code>.The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
USERIDALIAS ggadm2
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine N)
</pre></div>
</li>
<li class="stepexpand"><span>Start Extract.</span>
<div>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext2
</pre></div>
</li>
</ol>
</div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-7A6171B3-F11A-4DFC-BF9A-0BD7B358AF87">Set up Extracts at Downstream Mining Database</a></p>
</div>
</div>
</div>
</div>
<a id="GIORA510"></a>
<div class="props_rev_3"><a id="GUID-FF0A0402-43C9-4D14-9315-BED3CC6B2493"></a>
<h4 id="GIORA-GUID-FF0A0402-43C9-4D14-9315-BED3CC6B2493" class="sect4"><span class="enumeration_section">C.3.6.3</span> Set up Extract (ext3) to Capture Changes in Real-time Mode from Online Logs Sent&nbsp;by&nbsp;DBMS3</h4>
<div>
<div class="section">
<p>Perform the following steps on the DBMSCAP downstream mining database.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Register Extract with the mining database for source database DBMS3. In the credential store, the alias name of <code class="codeph">ggadm3</code> is linked to a user connect string of <code class="codeph">ggadm3@dbms3</code>.The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERID ggadm3
GGSCI&gt; MININGDBLOGIN USERID ggadmcap
GGSCI&gt; REGISTER EXTRACT ext3 DATABASE
</pre></div>
</li>
<li class="stepexpand"><span>Create Extract at the mining database.</span>
<div>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext3 INTEGRATED TRANLOG, BEGIN NOW
</pre></div>
</li>
<li class="stepexpand"><span>Edit the Extract parameter file <code class="codeph">ext3.prm</code>. To enable real-time mining, you must specify <code class="codeph">downstream_real_time_mine</code>. In the credential store, the alias name of <code class="codeph">ggadm3</code> is linked to a user connect string of <code class="codeph">ggadm3@dbms3</code>.The alias name of <code class="codeph">ggadmcap</code> is linked to a user connect string of <code class="codeph">ggadmcap@dbmscap</code>.</span>
<div>
<pre dir="ltr">
USERIDALIAS ggadm3
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine Y)
</pre></div>
</li>
<li class="stepexpand"><span>Start Extract.</span>
<div>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext3
</pre></div>
</li>
</ol>
<div class="section">
<div class="infobox-note" id="GUID-FF0A0402-43C9-4D14-9315-BED3CC6B2493__GUID-09B227D7-EE82-4F20-AA1F-3A003F256511">
<p class="notep1">Note:</p>
<p>You can create multiple Extracts running in real-time integrated capture mode in the downstream mining database, as long as they all are capturing data from the same source database, such as all capturing for database DBMS3 in the preceding example.</p>
</div>
</div>
<!-- class="section" --></div>
<div>
<div class="familylinks">
<div class="parentlink">
<p><strong>Parent topic:</strong> <a href="example-downstream-mining-configuration.htm#GUID-7A6171B3-F11A-4DFC-BF9A-0BD7B358AF87">Set up Extracts at Downstream Mining Database</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment377">
<tr>
<td class="cellalignment396">
<table class="cellalignment382">
<tr>
<td class="cellalignment381"><a href="configuring-downstream-mining-database.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment381"><a href="installing-trigger-based-ddl-capture.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2010, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment398">
<table class="cellalignment380">
<tr>
<td class="cellalignment381"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment381"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
