<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml/DTD/xhtml1-transitional.dtd">
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>3 Preparing the Sybase System for Oracle GoldenGate</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1037" />
<meta name="description" content="This chapter contains guidelines for preparing the database and the system to support Oracle GoldenGate." />
<meta name="dcterms.created" content="2015-01-21T16:9:56Z" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Oracle&reg; GoldenGate Installing and Configuring Oracle GoldenGate for Sybase" />
<meta name="dcterms.identifier" content="E29287-03" />
<meta name="dcterms.isVersionOf" content="GISYB" />
<link rel="Start" href="../../index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="ogg_wu_install_syb.htm" title="Previous" type="text/html" />
<link rel="Next" href="ogg_wu_uninstall_syb.htm" title="Next" type="text/html" />
<link rel="alternate" href="../GISYB.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="../GISYB.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="../GISYB.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Skip Headers</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns"><div id="BREADCRUMBS"><a href="http://docs.oracle.com">Home</a> / <a href="../../index.html">Middleware</a> / <a href="../index.html">Oracle GoldenGate for Windows and UNIX</a>
</div>

<span id="PAGE" style="display:none;">6/8</span>
<!-- End Header -->
<div id="GISYB166" class="chapter"><a id="sthref32"></a>
<h1 class="chapter"><span class="secnum">3</span> Preparing the Sybase System for Oracle GoldenGate</h1>
<p><a id="GISYB208"></a>This chapter contains guidelines for preparing the database and the system to support Oracle GoldenGate.</p>
<p>This chapter contains the following sections:</p>
<ul>
<li>
<p><a href="#BGBHHDIE">Section 3.1, "Preparing Tables for Processing"</a></p>
</li>
<li>
<p><a href="#BGBJAEIG">Section 3.2, "Preparing the Transaction Logs"</a></p>
</li>
</ul>
<a id="BGBHHDIE"></a>
<div id="GISYB167" class="sect1">
<h2 class="sect1"><span class="secnum">3.1</span> Preparing Tables for Processing</h2>
<p>The following table attributes must be addressed in an Oracle GoldenGate environment.</p>
<ul>
<li>
<p><a href="#BGBCBJCE">Disabling Triggers and Cascade Constraints</a></p>
</li>
<li>
<p><a href="#BGBHCJAI">Assigning Row Identifiers</a></p>
</li>
<li>
<p><a href="#BGBFJBIC">Limiting Row Changes in Tables that do not Have a Key</a></p>
</li>
<li>
<p><a href="#BGBFFAEI">Replicating Encrypted Data</a></p>
</li>
</ul>
<a id="BGBCBJCE"></a>
<div id="GISYB168" class="sect2">
<h3 class="sect2"><span class="secnum">3.1.1</span> Disabling Triggers and Cascade Constraints</h3>
<p>Disable triggers, cascade delete constraints, and cascade update constraints on target Sybase tables, or alter them to ignore changes made by the Oracle GoldenGate database user. Oracle GoldenGate replicates DML that results from a trigger or cascade constraint. If the same trigger or constraint gets activated on the target table, it becomes redundant because of the replicated version, and the database returns an error. Consider the following example, where the source tables are <code dir="ltr">emp_src</code> and <code dir="ltr">salary_src</code> and the target tables are <code dir="ltr">emp_targ</code> and <code dir="ltr">salary_targ</code>.</p>
<ol>
<li>
<p>A delete is issued for <code dir="ltr">emp_src</code>.</p>
</li>
<li>
<p>It cascades a delete to <code dir="ltr">salary_src</code>.</p>
</li>
<li>
<p>Oracle GoldenGate sends both deletes to the target.</p>
</li>
<li>
<p>The parent delete arrives first and is applied to <code dir="ltr">emp_targ</code>.</p>
</li>
<li>
<p>The parent delete cascades a delete to <code dir="ltr">salary_targ</code>.</p>
</li>
<li>
<p>The cascaded delete from <code dir="ltr">salary_src</code> is applied to <code dir="ltr">salary_targ</code><span class="italic">.</span></p>
</li>
<li>
<p>The row cannot be located because it was already deleted in step 5.</p>
</li>
</ol>
<p>To configure Replicat to disable target triggers at the start of its database session, take the following steps:</p>
<ol>
<li>
<p>Assign the Replicat user the replication role.</p>
</li>
<li>
<p>Add the following parameter statement to the root level of the Replicat parameter file.</p>
<pre dir="ltr">
SQLEXEC "set triggers off"
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BGBHCJAI"></a>
<div id="GISYB169" class="sect2">
<h3 class="sect2"><span class="secnum">3.1.2</span> Assigning Row Identifiers</h3>
<p>Oracle GoldenGate requires some form of unique row identifier on source and target tables to locate the correct target rows for replicated updates and deletes.</p>
<div id="GISYB170" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref33"></a>
<h4 class="sect3"><span class="secnum">3.1.2.1</span> How Oracle GoldenGate Determines the Kind of Row Identifier to Use</h4>
<p>Unless a <code dir="ltr">KEYCOLS</code> clause is used in the <code dir="ltr">TABLE</code> or <code dir="ltr">MAP</code> statement, Oracle GoldenGate selects a row identifier to use in the following order of priority:</p>
<ol>
<li>
<p>Primary key.</p>
</li>
<li>
<p>First unique key alphanumerically with no computed columns, no function-based columns, and no nullable columns.</p>
</li>
<li>
<p>First unique key alphanumerically with no computed or function-based columns, but can include nullable columns.</p>
</li>
<li>
<p>If none of the preceding key types exist (even though there might be other types of keys defined on the table) GoldenGate constructs a pseudo key of all columns that the database allows to be used in a unique key, excluding computed columns, function-based columns, and any columns that are explicitly excluded from the GoldenGate configuration.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
If there are other, non-usable keys on a table or if there are no keys at all on the table, Oracle GoldenGate logs an appropriate message to the report file. Constructing a key from all of the columns impedes the performance of Oracle GoldenGate on the source system. On the target, this key causes Replicat to use a larger, less efficient <code dir="ltr">WHERE</code> clause.</div>
<p>Oracle GoldenGate does not support a primary or unique key in which a column name contains an embedded comma, such as the following:</p>
<pre dir="ltr">
CREATE TABLE Tab ... PRIMARY KEY ("col1, Id", col2)
</pre>
<p>In this case "<code dir="ltr">col1, ID</code> " is the first primary key column and <code dir="ltr">col2</code> is the second primary key column.</p>
</div>
<!-- class="sect3" -->
<div id="GISYB171" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref34"></a>
<h4 class="sect3"><span class="secnum">3.1.2.2</span> Using KEYCOLS to Specify a Custom Key</h4>
<p>If a table does not have one of the preceding types of row identifiers, or if you prefer those identifiers not to be used, you can define a substitute key if the table has columns that always contain unique values. You define this substitute key by including a <code dir="ltr">KEYCOLS</code> clause within the Extract <code dir="ltr">TABLE</code> parameter and the Replicat <code dir="ltr">MAP</code> parameter. Oracle GoldenGate uses the specified key in place of any existing primary or unique key that it finds. For more information, see <a class="olink GWURF" href="../../gg-winux/GWURF/toc.htm"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BGBFJBIC"></a>
<div id="GISYB172" class="sect2">
<h3 class="sect2"><span class="secnum">3.1.3</span> Limiting Row Changes in Tables that do not Have a Key</h3>
<p>If a target table has no primary key or unique key, duplicate rows can exist. It is possible for Oracle GoldenGate to update or delete too many rows in the target table, causing the source and target data to go out of synchronization without error messages to alert you. To limit the number of rows that are updated, use the <code dir="ltr">DBOPTIONS</code> parameter with the <code dir="ltr">LIMITROWS</code> option in the Replicat parameter file. <code dir="ltr">LIMITROWS</code> can increase the performance of Oracle GoldenGate on the target system because only one row is processed.</p>
</div>
<!-- class="sect2" -->
<a id="BGBFFAEI"></a>
<div id="GISYB173" class="sect2">
<h3 class="sect2"><span class="secnum">3.1.4</span> Replicating Encrypted Data</h3>
<p>Oracle GoldenGate supports columns that are encrypted with a system-encrypted password, but not columns that are encrypted with a user-defined password. Check the tables from which you want to capture data against the following Oracle GoldenGate limitations:</p>
<ul>
<li>
<p>The table that contains the encrypted columns must have a primary or unique key.</p>
</li>
<li>
<p>Columns that use encryption cannot be part of the primary key.</p>
</li>
</ul>
<p>Encrypted columns are encrypted in the data files and in the log, so Extract must be configured to fetch the clear-text values from the database. To trigger this fetch, use the <code dir="ltr">FETCHCOLS</code> and <code dir="ltr">FETCHMODCOLS[EXCEPT]</code> options of the Extract <code dir="ltr">TABLE</code> parameter. <code dir="ltr">FETCHCOLS</code> forces a fetch of values that are not in the log, and <code dir="ltr">FETCHMODCOLS</code> or <code dir="ltr">FETCHMODCOLS[EXCEPT]</code> forces a fetch of values that are in the logs. Used together, these parameters ensure that the encrypted columns are always fetched from the database.</p>
<p>The following is an example of how to configure Extract to support the encryption. In this example, the encrypted column is <code dir="ltr">cardnum</code>.</p>
<pre dir="ltr">
TABLE ab.payments, FETCHCOLS (cardnum), FETCHMODCOLS (cardnum);
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BGBJAEIG"></a>
<div id="GISYB174" class="sect1">
<h2 class="sect1"><span class="secnum">3.2</span> Preparing the Transaction Logs</h2>
<p>To capture DML operations, Oracle GoldenGate reads the online logs. To ensure the continuity and integrity of Oracle GoldenGate processing, the logs must be configured as directed in the following sections:</p>
<p><a href="#BGBIFEJD">Section 3.2.1, "Enabling Transaction Logging"</a></p>
<p><a href="#BGBEDGIC">Section 3.2.2, "Sizing and Retaining the Logs"</a></p>
<p><a href="#BGBFEAHF">Section 3.2.3, "Initializing the Secondary Truncation Point"</a></p>
<a id="BGBIFEJD"></a>
<div id="GISYB175" class="sect2">
<h3 class="sect2"><span class="secnum">3.2.1</span> Enabling Transaction Logging</h3>
<p>Use the <code dir="ltr">ADD TRANDATA</code> command to mark each source table for replication. This command uses the Sybase <code dir="ltr">sp_setreptable</code> and <code dir="ltr">sp_setrepcol</code> system procedures. <code dir="ltr">ADD TRANDATA</code> is the recommended way to mark the tables, instead of using those procedures through the database interface, but the owner or the system administrator can use them if needed. For more information, see the Sybase documentation.</p>
<p class="subhead2"><a id="GISYB176"></a>To mark tables for replication with ADD TRANDATA:</p>
<ol>
<li>
<p>On the source system, run GGSCI from the Oracle GoldenGate directory.</p>
</li>
<li>
<p>Log into the database from GGSCI.</p>
<pre dir="ltr">
DBLOGIN SOURCEDB <span class="codeinlineitalic">database</span> USERID <span class="codeinlineitalic">user</span> PASSWORD <span class="codeinlineitalic">xxx</span>
</pre>
<p><span class="bold">Where:</span></p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">database</span></code> is the name of the database.</p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">user</span></code> is the database owner or the system administrator. You will be prompted for the password. This command has encryption options for the password. For more information, see <a class="olink GWURF" href="../../gg-winux/GWURF/toc.htm"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">xxx</span></code> is the password for the associated <span class="italic">user</span>.</p>
</li>
</ul>
</li>
<li>
<p>Issue the <code dir="ltr">ADD TRANDATA</code> command for each table to be marked.</p>
<pre dir="ltr">
ADD TRANDATA SCHEMA.TABLE LOBSNEVER | LOBSALWAYS | LOBSALWAYSNOINDEX | LOBSIFCHANGED
</pre>
<p><span class="bold">Where:</span></p>
<ul>
<li>
<p><code dir="ltr">LOBSNEVER | LOBSALWAYS | LOBSALWAYSNOINDEX | LOBSIFCHANGED</code> control whether LOB data is never propagated, only propagated if changed (the default), or always propagated. The <code dir="ltr">ADD TRANDATA</code> command will overwrite the LOB replication setting that is currently set for the table.</p>
</li>
</ul>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
Some <code dir="ltr">ADD TRANDATA</code> options enable the <code dir="ltr">ALWAYS_REPLICATE</code> option of <code dir="ltr">sp_setrepcol</code>. If a <code dir="ltr">LOB</code> column contains a <code dir="ltr">NULL</code> value, and then another column in the table gets updated (but not the <code dir="ltr">LOB</code>), that <code dir="ltr">LOB</code> will not be captured even though <code dir="ltr">ALWAYS_REPLICATE</code> is enabled.</div>
</div>
<!-- class="sect2" -->
<a id="BGBEDGIC"></a>
<div id="GISYB177" class="sect2">
<h3 class="sect2"><span class="secnum">3.2.2</span> Sizing and Retaining the Logs</h3>
<p>Retain enough log data on the source system so that Extract can start again from its checkpoints after you stop it or there is an unplanned outage. Extract must have access to the log that contains the start of the oldest uncommitted unit of work, and all logs thereafter. To determine where the Extract checkpoints are, use the <code dir="ltr">INFO EXTRACT</code> command. For more information about <code dir="ltr">INFO EXTRACT</code>, see <a class="olink GWURF" href="../../gg-winux/GWURF/toc.htm"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a> .</p>
<p>If data that Extract needs during processing is not retained, either in online or backup logs, one of the following corrective actions might be required:</p>
<ul>
<li>
<p>You might need to alter Extract to capture from a later point in time for which log data is available (and accept possible data loss on the target).</p>
</li>
<li>
<p>You might need to resynchronize the source and target tables, and then start the Oracle GoldenGate environment over again.</p>
</li>
</ul>
<p>Make certain not to use backup or archive options that cause old archive files to be overwritten by new backups on the source system. New backups should be separate files with different names from older ones. This ensures that if Extract looks for a particular log, it will still exist, and it also ensures that the data is available in case it is needed for a support case.</p>
</div>
<!-- class="sect2" -->
<a id="BGBFEAHF"></a>
<div id="GISYB178" class="sect2">
<h3 class="sect2"><span class="secnum">3.2.3</span> Initializing the Secondary Truncation Point</h3>
<p>Establish a secondary log truncation point on the source system prior to running the Oracle GoldenGate Extract process. Extract uses the secondary truncation point to identify data that remains to be processed.</p>
<p>To initialize the secondary truncation point, log on to the database as a user with <code dir="ltr">sa_role</code> privileges and then issue the following command:</p>
<pre dir="ltr">
dbcc settrunc( 'ltm', valid )
</pre>
<p>By default, Extract will manage the secondary truncation point once it is established. Do not permit Extract to be stopped any longer than necessary; otherwise the log could eventually fill up and the database will halt. The only way to resolve this problem is to disable the secondary truncation point and manage it outside of Oracle GoldenGate, and then purge the transaction log. Data not yet processed by Extract will be lost, and you will have to resynchronize the source and target data.</p>
<p>To control how the secondary truncation point is managed, use the <code dir="ltr">TRANLOGOPTIONS</code> parameter. For more information, see <a class="olink GWURF" href="../../gg-winux/GWURF/toc.htm"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment218">
<tr>
<td class="cellalignment227"><table class="cellalignment223">
<tr>
<td class="cellalignment222"><a href="ogg_wu_install_syb.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>

<td class="cellalignment222"><a href="ogg_wu_uninstall_syb.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table></td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2013, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment230">
<table class="cellalignment221">
<tr>
<td class="cellalignment222"><a href="../../index.html"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment222"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment222"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
