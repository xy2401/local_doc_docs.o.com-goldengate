<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml/DTD/xhtml1-transitional.dtd">
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>3 Preparing the System for Oracle GoldenGate</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1056" />
<meta name="description" content="This chapter contains instructions for preparing your system for running Oracle GoldenGate. It is comprised of the following sections:" />
<meta name="dcterms.created" content="2015-05-21T8:58:2Z" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Oracle&reg; GoldenGate Installing and Configuring Oracle GoldenGate for MySQL" />
<meta name="dcterms.identifier" content="E29286-04" />
<meta name="dcterms.isVersionOf" content="GIMYS" />
<link rel="Start" href="../../index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="install.htm" title="Previous" type="text/html" />
<link rel="Next" href="uninstalling.htm" title="Next" type="text/html" />
<link rel="alternate" href="../GIMYS.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="../GIMYS.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="../GIMYS.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Skip Headers</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns"><div id="BREADCRUMBS"><a href="http://docs.oracle.com">Home</a> / <a href="../../index.html">Middleware</a> / <a href="../index.html">Oracle GoldenGate for Windows and UNIX</a>
</div>

<span id="PAGE" style="display:none;">6/8</span>
<!-- End Header -->
<div id="GIMYS152" class="chapter"><a id="CJHFGHGI"></a>
<h1 class="chapter"><span class="secnum">3</span> Preparing the System for Oracle GoldenGate</h1>
<p><a id="GIMYS187"></a>This chapter contains instructions for preparing your system for running Oracle GoldenGate. It is comprised of the following sections:</p>
<ul>
<li>
<p><a href="#CJHIDEED">Section 3.1, "Ensuring Data Availability"</a></p>
</li>
<li>
<p><a href="#CJHEJBJF">Section 3.2, "Setting Logging Parameters"</a></p>
</li>
<li>
<p><a href="#CJHGCAJA">Section 3.3, "Adding Host Names"</a></p>
</li>
<li>
<p><a href="#CJHBDCHE">Section 3.4, "Setting the Session Character Set"</a></p>
</li>
<li>
<p><a href="#CJHFFHBA">Section 3.5, "Configuring Bi-Directional Replication"</a></p>
</li>
<li>
<p><a href="#CJHHFFHD">Section 3.6, "Other Oracle GoldenGate Parameters for MySQL"</a></p>
</li>
<li>
<p><a href="#CJHHDBAJ">Section 3.7, "Preparing Tables for Processing"</a></p>
</li>
<li>
<p><a href="#CJHBIBFF">Section 3.8, "Positioning Extract to a Specific Start Point"</a></p>
</li>
<li>
<p><a href="#CJHHHHDC">Section 3.9, "Changing the Log-Bin Location"</a></p>
</li>
</ul>
<a id="CJHIDEED"></a>
<div id="GIMYS153" class="sect1">
<h2 class="sect1"><span class="secnum">3.1</span> Ensuring Data Availability</h2>
<p>Retain enough binary log data so that if you stop Extract or there is an unplanned outage, Extract can start again from its checkpoints. Extract must have access to the binary log that contains the start of the oldest uncommitted unit of work, and all binary logs thereafter. The recommended retention period is at least 24 hours worth of transaction data, including both active and archived information. You might need to do some testing to determine the best retention time given your data volume and business requirements.</p>
<p>If data that Extract needs during processing was not retained, either in active or backup logs, one of the following corrective actions might be required:</p>
<ul>
<li>
<p>Alter Extract to capture from a later point in time for which binary log data is available (and accept possible data loss on the target).</p>
</li>
<li>
<p>Resynchronize the source and target tables, and then start the Oracle GoldenGate environment over again.</p>
</li>
</ul>
<p>To determine where the Extract checkpoints are, use the <code dir="ltr">INFO EXTRACT</code> command. For more information, see <a class="olink GWURF" href="../../gg-winux/GWURF/toc.htm"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</div>
<!-- class="sect1" -->
<a id="CJHEJBJF"></a>
<div id="GIMYS154" class="sect1">
<h2 class="sect1"><span class="secnum">3.2</span> Setting Logging Parameters</h2>
<p>To capture from the MySQL transaction logs, the Oracle GoldenGate Extract process must be able to find the index file. index file in turn contains the paths of all binary log files. Extract checks the following parameter settings to get this index file path:</p>
<ol>
<li>
<p>Extract <code dir="ltr">TRANLOGOPTIONS</code> parameter with the <code dir="ltr">ALTLOGDEST</code> option: If this parameter specifies a location for the log index file, Extract accepts this location over any default that is specified in the MySQL Server configuration file. When <code dir="ltr">ALTLOGDEST</code> is used, the binary log index file must also be stored in the specified directory. This parameter should be used if the MySQL configuration file does not specify the full index file path name, specifies an incorrect location, or if there are multiple installations of MySQL on the same machine</p>
<p>To specify the index file path with <code dir="ltr">TRANLOGICOPTIONS</code> with <code dir="ltr">ALTLOGDEST</code>, use the following command format on Windows:</p>
<pre dir="ltr">
TRANLOGOPTIONS ALTLOGDEST "C:\\Program Files\\MySQL\\logs\\binlog.index"
</pre>
<p>On Linux, use this format:</p>
<pre dir="ltr">
TRANLOGOPTIONS ALTLOGDEST "/mnt/rdbms/mysql/data/logs/binlog.index" 
</pre></li>
<li>
<p>The MySQL Server configuration file: The configuration file stores default startup options for the MySQL server and clients. On Windows, the name of the configuration file is <code dir="ltr">my.ini</code>. On other platforms, it is <code dir="ltr">my.cnf</code>. In the absence of <code dir="ltr">TRANLOGOPTIONS</code> with <code dir="ltr">ALTLOGDEST</code>, Extract gets information about the location of the log files from the configuration file; however, even with <code dir="ltr">ALTLOGDEST</code>, certain parameters are important for Extract and must be set correctly:</p>
<ul>
<li>
<p><code dir="ltr">log-bin</code>: This parameter is used to enable binary logging. This parameter also specifies the location of the binary log index file and is a required parameter for Oracle GoldenGate, even if <code dir="ltr">ALTLOGDEST</code> is used. If log-bin is not specified, binary logging will be disabled and Extract returns an error.</p>
</li>
<li>
<p><code dir="ltr">log-bin-index</code>: This parameter specifies the location of the binary log index. If it is not used, Extract assumes that the index file is in the same location as the log files. If this parameter is used and specifies a different directory from the one that contains the binary logs, the binary logs must not be moved once Extract is started.</p>
</li>
<li>
<p><code dir="ltr">max_binlog_size</code>: This parameter specifies the size, in bytes, of the binary log file.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The server creates a new binary log file automatically when the size of the current log reaches the <code dir="ltr">max_binlog_size</code> value, unless it must finish recording a transaction before rolling over to a new file.</div>
</li>
<li>
<p><code dir="ltr">binlog_format</code>: This parameter sets the format of the logs. It must be set to the value of <code dir="ltr">ROW</code>, which directs the database to log DML statements in binary format. Any other log format (<code dir="ltr">MIXED</code> or <code dir="ltr">STATEMENT</code>) causes Extract to abend.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
MySQL binary logging does not allow logging to be enabled or disabled for specific tables. It applies globally to all tables in the database.</div>
</li>
</ul>
<p>To locate the configuration file, Extract checks the <code dir="ltr">MYSQL_HOME</code> environment variable: If <code dir="ltr">MYSQL_HOME</code> is set, Extract uses the configuration file in the specified directory. If <code dir="ltr">MYSQL_HOME</code> is not set, Extract queries the <code dir="ltr">information_schema.global_variables</code> table to determine the MySQL installation directory. If a configuration file exists in that directory, Extract uses it.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CJHGCAJA"></a>
<div id="GIMYS155" class="sect1">
<h2 class="sect1"><span class="secnum">3.3</span> Adding Host Names</h2>
<p>Oracle GoldenGate gets the name of the database it is supposed to connect to from the <code dir="ltr">SOURCEDB</code> parameter. A successful connection depends on the localhost entry being properly configured in the system host file. To avoid issues that arise from improper local host configuration, you can use <code dir="ltr">SOURCEDB</code> in the following format:</p>
<p><code dir="ltr">SOURCEDB</code> <code dir="ltr"><span class="codeinlineitalic">database_name</span></code><code dir="ltr">@</code><code dir="ltr"><span class="codeinlineitalic">host_name</span></code></p>
<p>Where: <code dir="ltr"><span class="codeinlineitalic">database_name</span></code> is the name of the MySQL instance, and <code dir="ltr"><span class="codeinlineitalic">host_name</span></code> is the name or IP address of the local host. If using an unqualified host name, that name must be properly configured in the DNS database. Otherwise, use the fully qualified host name, for example <code dir="ltr">myhost.company.com</code>.</p>
</div>
<!-- class="sect1" -->
<a id="CJHBDCHE"></a>
<div id="GIMYS156" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">3.4</span> Setting the Session Character Set</h2>
<p>The Extract and Replicat processes use a session character set when connecting to the database. For MySQL, the session character set is taken from the <code dir="ltr">SESSIONCHARSET</code> option of <code dir="ltr">SOURCEDB</code> and <code dir="ltr">TARGETDB</code>. Make certain you specify a session character set in one of these ways when you configure Oracle GoldenGate.</p>
</div>
<!-- class="sect1" -->
<a id="CJHFFHBA"></a>
<div id="GIMYS157" class="sect1">
<h2 class="sect1"><span class="secnum">3.5</span> Configuring Bi-Directional Replication</h2>
<p>In a bi-directional configuration, there are Extract and Replicat processes on both the source and target systems to support the replication of transactional changes on each system to the other system. To support this configuration, each Extract must be able to filter the transactions applied by the local Replicat, so that they are not recaptured and sent back to their source in a continuous loop. Additionally, <code dir="ltr">AUTO_INCREMENT</code> columns must be set so that there is no conflict between the values on each system.</p>
<ol>
<li>
<p>Configure Oracle GoldenGate for high availability or active-active replication according to the instructions in the <a class="olink GWUAD" href="../../gg-winux/GWUAD/toc.htm"><span class="italic">Administering Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</li>
<li>
<p>To filter out Replicat operations in a bi-directional configuration so that the applied operations are not captured and looped back to the source again, take the following steps on each MySQL database:</p>
<ul>
<li>
<p>Configure each Replicat process to use a checkpoint table. Replicat writes a checkpoint to this table at the end of each transaction. You can use one global checkpoint table or one per Replicat process. See <a class="olink GWUAD" href="../../gg-winux/GWUAD/toc.htm"><span class="italic">Administering Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</li>
<li>
<p>Specify the name of the checkpoint table with the <code dir="ltr">FILTERTABLE</code> option of the <code dir="ltr">TRANLOGOPTIONS</code> parameter in the Extract parameter file. The Extract process will ignore transactions that end with an operation to the specified table, which should only be those of Replicat.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Although optional for other supported databases as a means of enhancing recovery, the use of a checkpoint table is required for MySQL when using bi-directional replication (and likewise, will enhance recovery).</div>
</li>
</ul>
</li>
<li>
<p>Edit the MySQL server configuration file to set the <code dir="ltr">auto_increment_increment</code> and <code dir="ltr">auto_increment_offset</code> parameters to avoid discrepancies that could be caused by the bi-directional operations. The following illustrates these parameters, assuming two servers: <span class="bold">ServerA</span> and <span class="bold">ServerB</span>.</p>
<p><span class="bold">ServerA</span>:</p>
<pre dir="ltr">
auto-increment-increment = 2
auto-increment-offset = 1
</pre>
<p><span class="bold">ServerB</span>:</p>
<pre dir="ltr">
auto-increment-increment = 2
auto-increment-offset = 2
</pre></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CJHHFFHD"></a>
<div id="GIMYS158" class="sect1">
<h2 class="sect1"><span class="secnum">3.6</span> Other Oracle GoldenGate Parameters for MySQL</h2>
<p>The following parameters may be of use in MySQL installations, and might be required if non-default settings are used for the MySQL database. Other Oracle GoldenGate parameters will be required in addition to these, depending on your intended business use and configuration.</p>
<div id="GIMYS159" class="tblhruleformal"><p class="titleintable"><a id="sthref27"></a><a id="sthref28"></a>Table 3-1 Other Parameters for Oracle GoldenGate for MySQL</p>
<table class="cellalignment216" title="Other Parameters for Oracle GoldenGate for MySQL " summary="This table describes other Oracle GoldenGate parameters for MySQL.">
<thead>
<tr class="cellalignment205">
<th class="cellalignment217" id="r1c1-t5">Parameter</th>
<th class="cellalignment217" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment205">
<td class="cellalignment211" id="r2c1-t5" headers="r1c1-t5">
<p><code dir="ltr">DBOPTIONS</code> with <code dir="ltr">CONNECTIONPORT</code> <code dir="ltr"><span class="codeinlineitalic">port_number</span></code></p>
</td>
<td class="cellalignment211" headers="r2c1-t5 r1c2-t5">
<p>Required to specify to the VAM the TCP/IP connection port number of the MySQL instance to which an Oracle GoldenGate process must connect if MySQL is not running on the default of 3306.</p>
<pre dir="ltr">
DBOPTIONS CONNECTIONPORT 3307 
</pre></td>
</tr>
<tr class="cellalignment205">
<td class="cellalignment211" id="r3c1-t5" headers="r1c1-t5">
<p><code dir="ltr">DBOPTIONS</code> with <code dir="ltr">HOST</code> <code dir="ltr"><span class="codeinlineitalic">host_id</span></code></p>
</td>
<td class="cellalignment211" headers="r3c1-t5 r1c2-t5">
<p>Specifies the DNS name or IP address of the system hosting MySQL to which Replicat must connect.</p>
</td>
</tr>
<tr class="cellalignment205">
<td class="cellalignment211" id="r4c1-t5" headers="r1c1-t5">
<p><code dir="ltr">DBOPTIONS</code> with <code dir="ltr">ALLOWLOBDATATRUNCATE</code></p>
</td>
<td class="cellalignment211" headers="r4c1-t5 r1c2-t5">
<p>Prevents Replicat from abending when replicated LOB data is too large for a target MySQL <code dir="ltr">CHAR</code>, <code dir="ltr">VARCHAR</code>, <code dir="ltr">BINARY</code> or <code dir="ltr">VARBINARY</code> column.</p>
</td>
</tr>
<tr class="cellalignment205">
<td class="cellalignment211" id="r5c1-t5" headers="r1c1-t5">
<p><code dir="ltr">SOURCEDB with USERID</code> and <code dir="ltr">PASSWORD</code></p>
</td>
<td class="cellalignment211" headers="r5c1-t5 r1c2-t5">
<p>Specifies database connection information consisting of the database, user name and password to use by an Oracle GoldenGate process that connects to a MySQL database. If MySQL is not running on the default port of 3306, you must specify a complete connection string that includes the port number: <code dir="ltr">SOURCEDB</code> <code dir="ltr"><span class="codeinlineitalic">dbname@hostname:port</span></code>, <code dir="ltr">USERID</code> <code dir="ltr"><span class="codeinlineitalic">user</span></code>, <code dir="ltr">PASSWORD</code> <code dir="ltr"><span class="codeinlineitalic">password</span></code>.Example:</p>
<p><code dir="ltr">SOURCEDB mydb@mymachine:3307, USERID myuser, PASSWORD mypassword</code></p>
<p>If you are not running the MySQL database on port 3306, you must also specify the connection port of the MySQL database in the <code dir="ltr">DBLOGIN</code> command when issuing commands that affect the database through GGSCI:</p>
<pre dir="ltr">
DBLOGIN SOURCEDB <span class="italic">dbname</span>@<span class="italic">hostname</span>:<span class="italic">port</span>, USERID <span class="italic">user</span>, PASSWORD <span class="italic">password</span>
</pre>
<p>For example:</p>
<pre dir="ltr">
GGSCI&gt; DBLOGIN SOURCEDB mydb@mymachine:3307, USERID myuser, PASSWORD mypassword 
</pre></td>
</tr>
<tr class="cellalignment205">
<td class="cellalignment211" id="r6c1-t5" headers="r1c1-t5">
<p><code dir="ltr">SQLEXEC</code></p>
</td>
<td class="cellalignment211" headers="r6c1-t5 r1c2-t5">
<p>To enable Replicat to bypass the MySQL connection timeout, configure the following command in a <code dir="ltr">SQLEXEC</code> statement in the Replicat parameter file.</p>
<p><code dir="ltr">SQLEXEC "select CURRENT_TIME();" EVERY</code> <code dir="ltr"><span class="codeinlineitalic">n</span></code> <code dir="ltr">MINUTES</code></p>
<p><span class="bold">Where</span>: <code dir="ltr"><span class="codeinlineitalic">n</span></code> is the maximum interval after which you want Replicat to reconnect. The recommended connection timeouts are 2147483 seconds (25 days) for Windows and 31536000 seconds (365 days) for UNIX and Linux.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p>For more information about Oracle GoldenGate parameters, see <a class="olink GWURF" href="../../gg-winux/GWURF/toc.htm"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>.</p>
<p>For more information about how to configure Oracle GoldenGate to meet your business needs, see <a class="olink GWUAD" href="../../gg-winux/GWUAD/toc.htm"><span class="italic">Administering Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</div>
<!-- class="sect1" -->
<a id="CJHHDBAJ"></a>
<div id="GIMYS160" class="sect1">
<h2 class="sect1"><span class="secnum">3.7</span> Preparing Tables for Processing</h2>
<p>This section describes how to prepare the tables for processing. Table preparation requires these tasks:</p>
<ul>
<li>
<p><a href="#CJHBBJIH">Assigning Row Identifiers</a></p>
</li>
<li>
<p><a href="#CJHDADCH">Limiting Row Changes in Tables That Do Not Have a Key</a></p>
</li>
<li>
<p><a href="#CJHCCDDC">Disabling Triggers and Cascade Constraints</a></p>
</li>
</ul>
<a id="CJHBBJIH"></a>
<div id="GIMYS161" class="sect2">
<h3 class="sect2"><span class="secnum">3.7.1</span> Assigning Row Identifiers</h3>
<p>Oracle GoldenGate requires some form of unique row identifier on the source and target tables to locate the correct target rows for replicated updates and deletes.</p>
<div id="GIMYS162" class="sect3"><a id="sthref29"></a>
<h4 class="sect3"><span class="secnum">3.7.1.1</span> How Oracle GoldenGate Determines the Kind of Row Identifier to Use</h4>
<p>Unless a <code dir="ltr">KEYCOLS</code> clause is used in the <code dir="ltr">TABLE</code> or <code dir="ltr">MAP</code> statement, Oracle GoldenGate selects a row identifier to use in the following order of priority:</p>
<ol>
<li>
<p>Primary key</p>
</li>
<li>
<p>First unique key alphanumerically that does not contain a timestamp or non-materialized computed column</p>
</li>
<li>
<p>If none of the preceding key types exist (even though there might be other types of keys defined on the table) Oracle GoldenGate constructs a pseudo key of all columns that the database allows to be used in a unique key, excluding those that are not supported by Oracle GoldenGate in a key or those that are excluded from the Oracle GoldenGate configuration.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If there are other, non-usable keys on a table or if there are no keys at all on the table, Oracle GoldenGate logs an appropriate message to the report file. Constructing a key from all of the columns impedes the performance of Oracle GoldenGate on the source system. On the target, this key causes Replicat to use a larger, less efficient <code dir="ltr">WHERE</code> clause.</div>
</li>
</ol>
</div>
<!-- class="sect3" -->
<div id="GIMYS163" class="sect3"><a id="sthref30"></a>
<h4 class="sect3"><span class="secnum">3.7.1.2</span> Tables with a Primary Key Derived from a Unique Index</h4>
<p>In the absence of a primary key on a table, MySQL will promote a unique index to primary key if the indexed column is <code dir="ltr">NOT NULL</code>. If there are more than one of these not-null indexes, the first one that was created becomes the primary key. To avoid Replicat errors, create these indexes in the same order on the source and target tables.</p>
<p>For example, assume that source and target tables named <code dir="ltr">ggvam.emp</code> each have columns named first, middle, and last, and all are defined as <code dir="ltr">NOT NULL</code>. If you create unique indexes in the following order, Oracle GoldenGate will abend on the target because the table definitions do not match.</p>
<p>Source:</p>
<pre dir="ltr">
mysql&gt; create unique index uq1 on ggvam.emp(first); 
mysql&gt; create unique index uq2 on ggvam.emp(middle); 
mysql&gt; create unique index uq3 on ggvam.emp(last); 
</pre>
<p>Target:</p>
<pre dir="ltr">
mysql&gt; create unique index uq1 on ggvam.emp(last); 
mysql&gt; create unique index uq2 on ggvam.emp(first); 
mysql&gt; create unique index uq3 on ggvam.emp(middle); 
</pre>
<p>The result of this sequence is that MySQL promotes the index on the source "first" column to primary key, and it promotes the index on the target "last" column to primary key. Oracle GoldenGate will select the primary keys as identifiers when it builds its metadata record, and the metadata will not match. To avoid this error, decide which column you want to promote to primary key, and create that index first on the source and target.</p>
</div>
<!-- class="sect3" -->
<div id="GIMYS164" class="sect3"><a id="sthref31"></a>
<h4 class="sect3"><span class="secnum">3.7.1.3</span> How to Specify Your Own Key for Oracle GoldenGate to Use</h4>
<p>If a table does not have one of the preceding types of row identifiers, or if you prefer those identifiers not to be used, you can define a substitute key if the table has columns that always contain unique values. You define this substitute key by including a <code dir="ltr">KEYCOLS</code> clause within the Extract <code dir="ltr">TABLE</code> parameter and the Replicat <code dir="ltr">MAP</code> parameter. The specified key will override any existing primary or unique key that Oracle GoldenGate finds.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CJHDADCH"></a>
<div id="GIMYS165" class="sect2">
<h3 class="sect2"><span class="secnum">3.7.2</span> Limiting Row Changes in Tables That Do Not Have a Key</h3>
<p>If a target table does not have a primary key or a unique key, duplicate rows can exist. In this case, Oracle GoldenGate could update or delete too many target rows, causing the source and target data to go out of synchronization without error messages to alert you. To limit the number of rows that are updated, use the <code dir="ltr">DBOPTIONS</code> parameter with the <code dir="ltr">LIMITROWS</code> option in the Replicat parameter file. <code dir="ltr">LIMITROWS</code> can increase the performance of Oracle GoldenGate on the target system because only one row is processed.</p>
</div>
<!-- class="sect2" -->
<a id="CJHCCDDC"></a>
<div id="GIMYS166" class="sect2">
<h3 class="sect2"><span class="secnum">3.7.3</span> Disabling Triggers and Cascade Constraints</h3>
<p>Disable triggers, cascade delete constraints, and cascade update constraints on the target tables, or alter them to ignore changes made by the Oracle GoldenGate database user. Oracle GoldenGate replicates DML that results from a trigger or cascade constraint. If the same trigger or constraint gets activated on the target table, it becomes redundant because of the replicated version, and the database returns an error. Consider the following example, where the source tables are <code dir="ltr">emp_src</code> and <code dir="ltr">salary_src</code> and the target tables are <code dir="ltr">emp_targ</code> and <code dir="ltr">salary_targ</code>.</p>
<ol>
<li>
<p>A delete is issued for <code dir="ltr">emp_src</code>.</p>
</li>
<li>
<p>It cascades a delete to <code dir="ltr">salary_src</code>.</p>
</li>
<li>
<p>Oracle GoldenGate sends both deletes to the target.</p>
</li>
<li>
<p>The parent delete arrives first and is applied to <code dir="ltr">emp_targ</code>.</p>
</li>
<li>
<p>The parent delete cascades a delete to <code dir="ltr">salary_targ</code>.</p>
</li>
<li>
<p>The cascaded delete from <code dir="ltr">salary_src</code> is applied to <code dir="ltr">salary_targ</code>.</p>
</li>
<li>
<p>The row cannot be located because it was already deleted in step 5.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CJHBIBFF"></a>
<div id="GIMYS167" class="sect1">
<h2 class="sect1"><span class="secnum">3.8</span> Positioning Extract to a Specific Start Point</h2>
<p>You can position the <code dir="ltr">ADD EXTRACT</code> and <code dir="ltr">ALTER EXTRACT</code> commands to a specific start point in the transaction logs with the following command.</p>
<p><code dir="ltr">{ADD | ALTER EXTRACT}</code> <code dir="ltr"><span class="codeinlineitalic">group</span></code><code dir="ltr">, VAM, LOGNUM</code> <code dir="ltr"><span class="codeinlineitalic">log_num</span></code><code dir="ltr">, LOGPOS</code> <code dir="ltr"><span class="codeinlineitalic">log_pos</span></code></p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">group</span></code> is the name of the Oracle GoldenGate Extract group for which the start position is required.</p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">log_num</span></code> is the log file number. For example, if the required log file name is <code dir="ltr">test.000034</code>, this value is 34. Extract will search for this log file.</p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">log_pos</span></code> is an <span class="italic">event offset</span> value within the log file that identifies a specific transaction record. Event offset values are stored in the header section of a log record.</p>
</li>
</ul>
<p>In MySQL logs, an event offset value can be unique only within a given binary file. The combination of the position value and a log number will uniquely identify a transaction record. Transactional records available after this position within the specified log will be captured by Extract.</p>
</div>
<!-- class="sect1" -->
<a id="CJHHHHDC"></a>
<div id="GIMYS168" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">3.9</span> Changing the Log-Bin Location</h2>
<p>Modifying the binary log location by using the <code dir="ltr">log-bin</code> variable in the MYSQL configuration file might result in two different path entries inside the index file, which could result in errors. To avoid any potential errors, change the log-bin location by doing the following:</p>
<ol>
<li>
<p>Stop any new DML operations.</p>
</li>
<li>
<p>Let the extract finish processing all of the existing binary logs. You can verify this by noting when the checkpoint position reaches the offset of the last log.</p>
</li>
<li>
<p>After Extract finishes processing the data, stop the Extract group and, if necessary, back up the binary logs.</p>
</li>
<li>
<p>Stop the MySQL database.</p>
</li>
<li>
<p>Modify the <code dir="ltr">log-bin</code> path for the new location.</p>
</li>
<li>
<p>Start the MySQL database.</p>
</li>
<li>
<p>To clean the old log name entries from index file, use <code dir="ltr">flush master</code> or <code dir="ltr">flush logs</code> (based on your MySQL version).</p>
</li>
<li>
<p>Start Extract.</p>
</li>
</ol>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment204">
<tr>
<td class="cellalignment211"><table class="cellalignment215">
<tr>
<td class="cellalignment208"><a href="install.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>

<td class="cellalignment208"><a href="uninstalling.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table></td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2013, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment213">
<table class="cellalignment214">
<tr>
<td class="cellalignment208"><a href="../../index.html"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment208"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment208"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
