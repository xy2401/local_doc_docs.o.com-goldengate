<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml/DTD/xhtml1-transitional.dtd">
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>C Example Downstream Mining Configuration</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1056" />
<meta name="description" content="This appendix contains examples for preparing a downstream Oracle mining database to support Extract in integrated capture mode." />
<meta name="dcterms.created" content="2015-06-05T14:9:49Z" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Oracle&reg; GoldenGate Installing and Configuring Oracle GoldenGate for Oracle Database" />
<meta name="dcterms.identifier" content="E29644-07" />
<meta name="dcterms.isVersionOf" content="GIORA" />
<link rel="Start" href="../../index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="ic_deploy.htm" title="Previous" type="text/html" />
<link rel="Next" href="ddl_install.htm" title="Next" type="text/html" />
<link rel="alternate" href="../GIORA.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="../GIORA.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="../GIORA.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Skip Headers</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns"><div id="BREADCRUMBS"><a href="http://docs.oracle.com">Home</a> / <a href="../../index.html">Middleware</a> / <a href="../index.html">Oracle GoldenGate for Windows and UNIX</a>
</div>

<span id="PAGE" style="display:none;">23/27</span>
<!-- End Header -->
<div id="GIORA487" class="appendix"><a id="BABHBCCF2"></a>
<h1 class="appendix"><span class="secnum">C</span> Example Downstream Mining Configuration</h1>
<p><a id="GIORA581"></a>This appendix contains examples for preparing a downstream Oracle mining database to support Extract in integrated capture mode.</p>
<p>This appendix includes the following sections:</p>
<ul>
<li>
<p><a href="#A1357509">Example 1: Capturing from One Source Database in Real-time Mode</a></p>
</li>
<li>
<p><a href="#A1460080">Example 2: Capturing from Multiple Sources in Archive-log-only Mode</a></p>
</li>
<li>
<p><a href="#A1492752">Example 3: Capturing from Multiple Sources with Mixed Real-time and Archive-log-only Mode</a></p>
</li>
</ul>
<p>For more information about configuring a downstream mining database, see <a href="ic_deploy.htm#BABHBCCF">Appendix B, "Configuring a Downstream Mining Database"</a>.</p>
<a id="A1357509"></a>
<div id="GIORA488" class="sect1">
<h2 class="sect1"><span class="secnum">C.1</span> Example 1: Capturing from One Source Database in Real-time Mode</h2>
<div class="infobox-note">
<p class="notep1">Note:</p>
This example assumes that you created the necessary standby redo log files as shown in <a href="ic_deploy.htm#BABHBCCF">Appendix B, "Configuring a Downstream Mining Database"</a>.</div>
<p>This example captures changes from source database DBMS1 by deploying an integrated capture session at a downstream mining database DBMSCAP. This assumes that the following users exist:</p>
<ul>
<li>
<p>User GGADM1 in DBMS1 whose credentials Extract will use to fetch data and metadata from DBMS1. This user has the alias of <code dir="ltr">ggadm1</code> in the Oracle GoldenGate credential store and logs in as <code dir="ltr">ggadm1@dbms1</code>. It is assumed that the <code dir="ltr">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at the source database.</p>
</li>
<li>
<p>User GGADMCAP in DBMSCAP whose credentials Extract will use to retrieve logical change records from the logmining server at the downstream mining database DBMSCAP. This user has the alias of <code dir="ltr">ggadmcap</code> in the Oracle GoldenGate credential store and logs in as <code dir="ltr">ggadmcap@dbmscap</code>. It is assumed that the <code dir="ltr">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at the mining database.</p>
</li>
</ul>
<div id="GIORA489" class="sect2"><a id="sthref202"></a>
<h3 class="sect2"><span class="secnum">C.1.1</span> Prepare the Mining Database to Archive its Local Redo</h3>
<p>To prepare the mining database to archive its local redo:</p>
<ol>
<li>
<p>The downstream mining database must be in archive log mode. You can do this by issuing the following DDL.</p>
<pre dir="ltr">
STARTUP MOUNT;
ALTER DATABASE ARCHIVELOG;
ALTER DATABASE OPEN;
</pre></li>
<li>
<p>At the downstream mining database, set <code dir="ltr">log_archive_dest_1</code> to archive local redo.</p>
<pre dir="ltr">
ALTER SYSTEM SETLOG_ARCHIVE_DEST_1='LOCATION=/home/arc_dest/localVALID_FOR=(ONLINE_LOGFILE, PRIMARY_ROLE)'
</pre></li>
<li>
<p>Enable <code dir="ltr">log_archive_dest_1</code>.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_1=ENABLE 
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA490" class="sect2"><a id="sthref203"></a>
<h3 class="sect2"><span class="secnum">C.1.2</span> Prepare the Mining Database to Archive Redo Received in Standby Redo Logs<br />
from the Source Database</h3>
<p>To prepare the mining database to archive the redo received in standby redo logs from the source database:</p>
<ol>
<li>
<p>At the downstream mining database, set <code dir="ltr">log_archive_dest_2</code> as shown in the following example.</p>
<pre dir="ltr">
ALTER SYSTEM SET
LOG_ARCHIVE_DEST_2='LOCATION=/home/arc_dest/srl_dbms1
VALID_FOR=(STANDBY_LOGFILE,PRIMARY_ROLE)'
</pre></li>
<li>
<p>Enable <code dir="ltr">log_archive_dest_2</code> as shown in the following example.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE
</pre></li>
<li>
<p>Set <code dir="ltr">DG_CONFIG</code> at the downstream mining database.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1,dbmscap)'
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA491" class="sect2"><a id="sthref204"></a>
<h3 class="sect2"><span class="secnum">C.1.3</span> Prepare the Source Database to Send Redo to the Mining Database</h3>
<p>To prepare the source database to send redo to the mining database:</p>
<ol>
<li>
<p>Make sure that the source database is running with the required compatibility.</p>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME            VALUE
---------       ---------------------
compatible      11.1.0.7.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</li>
<li>
<p>Set <code dir="ltr">DG_CONFIG</code> at the source database.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1,dbmscap)';
</pre></li>
<li>
<p>Set up redo transport at the source database.</p>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER 
VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></li>
<li>
<p>Enable the downstream destination.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA492" class="sect2"><a id="sthref205"></a>
<h3 class="sect2"><span class="secnum">C.1.4</span> Set up Integrated Capture (ext1) on DBMSCAP</h3>
<p>To set up integrated capture (ext1) on DBMSCAP:</p>
<ol>
<li>
<p>Register Extract with the downstream mining database. In the credential store, the alias name of <code dir="ltr">ggadm1</code> is linked to a user connect string of <code dir="ltr">ggadm1@dbms1</code>. The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERIDALIAS ggadm1
GGSCI&gt; MININGDBLOGIN USERIDALIAS ggadmcap
GGSCI&gt; REGISTER EXTRACT ext1 DATABASE
</pre></li>
<li>
<p>Create Extract at the downstream mining database.</p>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext1 INTEGRATED TRANLOG BEGIN NOW
</pre></li>
<li>
<p>Edit Extract parameter file <code dir="ltr">ext1.prm</code>. The following lines must be present to take advantage of real-time capture. In the credential store, the alias name of <code dir="ltr">ggadm1</code> is linked to a user connect string of <code dir="ltr">ggadm1@dbms1</code>. The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
USERIDALIAS ggadm1
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine Y)
</pre></li>
<li>
<p>Start Extract.</p>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext1
</pre></li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can create multiple Extracts running in real-time integrated capture mode in the downstream mining database, as long as they all are capturing data from the same source database, such as capturing changes for database DBMS1 in the preceding example.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="A1460080"></a>
<div id="GIORA493" class="sect1">
<h2 class="sect1"><span class="secnum">C.2</span> Example 2: Capturing from Multiple Sources in Archive-log-only Mode</h2>
<p>The following example captures changes from database DBMS1 and DBMS2 by deploying an integrated capture session at a downstream mining database DBMSCAP. It assumes the following users:</p>
<ul>
<li>
<p>User GGADM1 in DBMS1 whose credentials Extract will use to fetch data and metadata from DBMS1. It is assumed that the <code dir="ltr">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at DBMS1.</p>
</li>
<li>
<p>User GGADM2 in DBMS2 whose credentials Extract will use to fetch data and metadata from DBMS2. It is assumed that the <code dir="ltr">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at DBMS2.</p>
</li>
<li>
<p>User GGADMCAP in DBMSCAP whose credentials Extract will use to retrieve logical change records from the logmining server at the downstream mining database. It is assumed that the <code dir="ltr">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at the downstream mining database DBMSCAP.</p>
</li>
</ul>
<p>This procedure also assumes that the downstream mining database is configured in archive log mode.</p>
<div id="GIORA494" class="sect2"><a id="sthref206"></a>
<h3 class="sect2"><span class="secnum">C.2.1</span> Prepare the Mining Database to Archive its Local Redo</h3>
<p>To prepare the mining database to archive its local redo:</p>
<ol>
<li>
<p>The downstream mining database must be in archive log mode. You can do this by issuing the following DDL.</p>
<pre dir="ltr">
        STARTUP MOUNT;
        ALTER DATABASE ARCHIVELOG;
        ALTER DATABASE OPEN;
</pre></li>
<li>
<p>At the downstream mining database, set <code dir="ltr">log_archive_dest_1</code> to archive local redo.</p>
<pre dir="ltr">
ALTER SYSTEM SET
LOG_ARCHIVE_DEST_1='LOCATION=/home/arc_dest/local
VALID_FOR=(ONLINE_LOGFILE, PRIMARY_ROLE)'
</pre></li>
<li>
<p>Enable <code dir="ltr">log_archive_dest_1</code>.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_1=ENABLE 
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA495" class="sect2"><a id="sthref207"></a>
<h3 class="sect2"><span class="secnum">C.2.2</span> Prepare the Mining Database to Archive Redo from the Source Database</h3>
<p>Set <code dir="ltr">DG_CONFIG</code> at the downstream mining database.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1,dbms2, dbmscap)'
</pre></div>
<!-- class="sect2" -->
<div id="GIORA496" class="sect2"><a id="sthref208"></a>
<h3 class="sect2"><span class="secnum">C.2.3</span> Prepare the First Source Database to Send Redo to the Mining Database</h3>
<p>To prepare the first source database to send redo to the mining database:</p>
<ol>
<li>
<p>Make certain that DBMS1 source database is running with the required compatibility.</p>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME            VALUE
---------       ---------------------
compatible      11.1.0.7.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</li>
<li>
<p>Set <code dir="ltr">DG_CONFIG</code> at DBMS1 source database.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1, dbmscap)'; 
</pre></li>
<li>
<p>Set up redo transport at DBMS1 source database. The <code dir="ltr">TEMPLATE</code> clause is mandatory if you want to send redo data directly to foreign archived logs at the downstream mining database.</p>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER
TEMPLATE='/usr/orcl/arc_dest/dbms1/dbms1_arch_%t_%s_%r.log VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></li>
<li>
<p>Enable the downstream destination.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA497" class="sect2"><a id="sthref209"></a>
<h3 class="sect2"><span class="secnum">C.2.4</span> Prepare the Second Source Database to Send Redo to the Mining Database</h3>
<p>To prepare the second source database to send redo to the mining database:</p>
<ol>
<li>
<p>Make sure that DBMS2 source database is running with the required compatibility.</p>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME            VALUE
---------      ---------------------
compatible     11.1.0.0.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</li>
<li>
<p>Set <code dir="ltr">DG_CONFIG</code> at DBMS2 source database.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms2, dbmscap)'; 
</pre></li>
<li>
<p>Set up redo transport at DBMS2 source database. The <code dir="ltr">TEMPLATE</code> clause is mandatory if you want to send redo data directly to foreign archived logs at the downstream mining database.</p>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER
TEMPLATE='/usr/orcl/arc_dest/dbms2/dbms2_arch_%t_%s_%r.log VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></li>
<li>
<p>Enable the downstream destination.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA498" class="sect2"><a id="sthref210"></a>
<h3 class="sect2"><span class="secnum">C.2.5</span> Set up Extracts at the Downstream Mining Database</h3>
<p>The following steps set up Extract at the downstream database to capture from the archived logs sent by DBMS1 and DBMS2.</p>
<div id="GIORA499" class="sect3"><a id="sthref211"></a>
<h4 class="sect3"><span class="secnum">C.2.5.1</span> Set up Extract (ext1) to Capture Changes from Archived Logs Sent by DBMS1</h4>
<p>Perform the following steps on the DBMSCAP downstream mining database.</p>
<ol>
<li>
<p>Register Extract with DBMSCAP for the DBMS1 source database. In the credential store, the alias name of <code dir="ltr">ggadm1</code> is linked to a user connect string of <code dir="ltr">ggadm1@dbms1</code>. The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERIDALIAS ggadm1
GGSCI&gt; MININGDBLOGIN USERIDALIAS ggadmcap
GGSCI&gt; REGISTER EXTRACT ext1 DATABASE
</pre></li>
<li>
<p>Add Extract at the mining database DBMSCAP.</p>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext1 INTEGRATED TRANLOG BEGIN NOW
</pre></li>
<li>
<p>Edit the Extract parameter file <code dir="ltr">ext1.prm</code>. In the credential store, the alias name of <code dir="ltr">ggadm1</code> is linked to a user connect string of <code dir="ltr">ggadm1@dbms1</code>. The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
USERIDALIAS ggadm1
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine N)
</pre></li>
<li>
<p>Start Extract.</p>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext1
</pre></li>
</ol>
</div>
<!-- class="sect3" -->
<div id="GIORA500" class="sect3"><a id="sthref212"></a>
<h4 class="sect3"><span class="secnum">C.2.5.2</span> Set up Extract (ext2) to Capture Changes from Archived Logs Sent by DBMS2</h4>
<p>Perform the following steps on the downstream DBMSCAP mining database.</p>
<ol>
<li>
<p>Register Extract with the mining database for source database DBMS2. In the credential store, the alias name of <code dir="ltr">ggadm2</code> is linked to a user connect string of <code dir="ltr">ggadm2@dbms2</code>.The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERIDALIAS ggadm2
GGSCI&gt; MININGDBLOGIN USERIDALIAS ggadmcap
GGSCI&gt; REGISTER EXTRACT ext2 DATABASE
</pre></li>
<li>
<p>Create Extract at the mining database.</p>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext2 INTEGRATED TRANLOG, BEGIN NOW
</pre></li>
<li>
<p>Edit the Extract parameter file <code dir="ltr">ext2.prm</code>. In the credential store, the alias name of <code dir="ltr">ggadm2</code> is linked to a user connect string of <code dir="ltr">ggadm2@dbms2</code>. The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
USERIDALIAS ggadm2
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine N)
</pre></li>
<li>
<p>Start Extract.</p>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext2
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can create multiple Extracts capturing data from the same source database while running in archive-log-only mode in the downstream mining database. In the case of these examples, you can create other Extracts capturing changes for database DBMS1 and DBMS2 at the downstream mining database.</div>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="A1492752"></a>
<div id="GIORA501" class="sect1">
<h2 class="sect1"><span class="secnum">C.3</span> Example 3: Capturing from Multiple Sources with Mixed Real-time and Archive-log-only Mode</h2>
<div class="infobox-note">
<p class="notep1">Note:</p>
This example assumes that you created the necessary standby redo log files as shown in <a href="ic_deploy.htm#BABHBCCF">Appendix B, "Configuring a Downstream Mining Database"</a>.</div>
<p>The following example captures changes from database DBMS1, DBMS2 and DBMS3 by deploying an integrated capture session at a downstream mining database DBMSCAP. It assumes the following users:</p>
<ul>
<li>
<p>User GGADM1 in DBMS1 whose credentials Extract will use to fetch data and metadata from DBMS1. It is assumed that the <code dir="ltr">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at DBMS1.</p>
</li>
<li>
<p>User GGADM2 in DBMS2 whose credentials Extract will use to fetch data and metadata from DBMS2. It is assumed that the <code dir="ltr">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at DBMS2.</p>
</li>
<li>
<p>User GGADM3 in DBMS3 whose credentials Extract will use to fetch data and metadata from DBMS3. It is assumed that the <code dir="ltr">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at DBMS3.</p>
</li>
<li>
<p>User GGADMCAP in DBMSCAP whose credentials Extract will use to retrieve logical change records from the logmining server at the downstream mining database. It is assumed that the <code dir="ltr">DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE()</code> procedure was called to grant appropriate privileges to this user at the downstream mining database DBMSCAP.</p>
</li>
</ul>
<p>This procedure also assumes that the downstream mining database is configured in archive log mode.</p>
<p>In this example, the redo sent by DBMS3 will be mined in real time mode, whereas the redo data sent from DBMS1 and DBMS2 will be mined in archive-log-only mode.</p>
<div id="GIORA502" class="sect2"><a id="sthref213"></a>
<h3 class="sect2"><span class="secnum">C.3.1</span> Prepare the Mining Database to Archive its Local Redo</h3>
<p>To prepare the mining database to archive its local redo:</p>
<ol>
<li>
<p>The downstream mining database must be in archive log mode. You can do this by issuing the following DDL.</p>
<pre dir="ltr">
        STARTUP MOUNT;
        ALTER DATABASE ARCHIVELOG;
        ALTER DATABASE OPEN;
</pre></li>
<li>
<p>At the downstream mining database, set <code dir="ltr">log_archive_dest_1</code> to archive local redo.</p>
<pre dir="ltr">
ALTER SYSTEM SET
LOG_ARCHIVE_DEST_1='LOCATION=/home/arc_dest/local
VALID_FOR=(ONLINE_LOGFILE, PRIMARY_ROLE)'
</pre></li>
<li>
<p>Enable <code dir="ltr">log_archive_dest_1</code>.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_1=ENABLE 
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA503" class="sect2"><a id="sthref214"></a>
<h3 class="sect2"><span class="secnum">C.3.2</span> Prepare the Mining Database to Accept Redo from the Source Databases</h3>
<p>Because redo data is being accepted in the standby redo logs of the downstream mining database, the appropriate number of correctly sized standby redo logs must exist. If you did not configure the standby logs, see <a href="ic_deploy.htm#BABHBCCF">Appendix B, "Configuring a Downstream Mining Database"</a>.</p>
<ol>
<li>
<p>At the downstream mining database, set the second archive log destination in the <code dir="ltr">LOG_ARCHIVE_DEST_n</code> initialization parameter as shown in the following example. This is needed to handle archive standby redo logs.</p>
<pre dir="ltr">
ALTER SYSTEM SET
LOG_ARCHIVE_DEST_2='LOCATION=/home/arc_dest/srl_dbms3
VALID_FOR=(STANDBY_LOGFILE,PRIMARY_ROLE)'
</pre></li>
<li>
<p>Enable the <code dir="ltr">LOG_ARCHIVE_DEST_STATE_2</code> initialization parameter that corresponds with the <code dir="ltr">LOG_ARCHIVE_DEST_2</code> parameter as shown in the following example.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE 
</pre></li>
<li>
<p>Set <code dir="ltr">DG_CONFIG</code> at the downstream mining database to accept redo data from all of the source databases.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1, dbms2, dbms3, dbmscap)' 
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA504" class="sect2"><a id="sthref215"></a>
<h3 class="sect2"><span class="secnum">C.3.3</span> Prepare the First Source Database to Send Redo to the Mining Database</h3>
<p>To prepare the first source database to send redo to the mining database:</p>
<ol>
<li>
<p>Make certain that DBMS1 source database is running with the required compatibility.</p>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME            VALUE
---------       ---------------------
compatible      11.1.0.0.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</li>
<li>
<p>Set <code dir="ltr">DG_CONFIG</code> at DBMS1 source database.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms1, dbmscap)'; 
</pre></li>
<li>
<p>Set up redo transport at DBMS1 source database. The <code dir="ltr">TEMPLATE</code> clause is mandatory if you want to send redo data directly to foreign archived logs at the downstream mining database.</p>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER
TEMPLATE='/usr/orcl/arc_dest/dbms1/dbms1_arch_%t_%s_%r.log VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></li>
<li>
<p>Enable the downstream destination.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA505" class="sect2"><a id="sthref216"></a>
<h3 class="sect2"><span class="secnum">C.3.4</span> Prepare the Second Source Database to Send Redo to the Mining Database</h3>
<p>To prepare the second source database to send redo to the mining database:</p>
<ol>
<li>
<p>Make sure that DBMS2 source database is running with the required compatibility.</p>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME                    VALUE
---------               ---------------------
compatible              11.1.0.0.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</li>
<li>
<p>Set <code dir="ltr">DG_CONFIG</code> at DBMS2 source database.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms2, dbmscap)'; 
</pre></li>
<li>
<p>Set up redo transport at DBMS2 source database. The <code dir="ltr">TEMPLATE</code> clause is mandatory if you want to send redo data directly to foreign archived logs at the downstream mining database.</p>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER
TEMPLATE='/usr/orcl/arc_dest/dbms2/dbms2_arch_%t_%s_%r.log VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></li>
<li>
<p>Enable the downstream destination.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA506" class="sect2"><a id="sthref217"></a>
<h3 class="sect2"><span class="secnum">C.3.5</span> Prepare the Third Source Database to Send Redo to the Mining Database</h3>
<p>To prepare the third source database to send redo to the mining database:</p>
<ol>
<li>
<p>Make sure that DBMS3 source database is running with the required compatibility.</p>
<pre dir="ltr">
select name, value from v$parameter where name = 'compatible';

NAME                    VALUE
---------               ---------------------
compatible              11.1.0.0.0
</pre>
<p>The minimum compatibility setting required from integrated capture is 11.1.0.0.0.</p>
</li>
<li>
<p>Set <code dir="ltr">DG_CONFIG</code> at DBMS3 source database.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_CONFIG='DG_CONFIG=(dbms3, dbmscap)'; 
</pre></li>
<li>
<p>Set up redo transport at DBMS3 source database. Because DBMS3 is the source that will send its online redo logs to the standby redo logs at the downstream mining database, do not specify a <code dir="ltr">TEMPLATE</code> clause.</p>
<pre dir="ltr">
ALTER SYSTEM
SET LOG_ARCHIVE_DEST_2='SERVICE=DBMSCAP.EXAMPLE.COM ASYNC OPTIONAL NOREGISTER
VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)DB_UNIQUE_NAME=dbmscap';
</pre></li>
<li>
<p>Enable the downstream destination.</p>
<pre dir="ltr">
ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE;
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA507" class="sect2"><a id="sthref218"></a>
<h3 class="sect2"><span class="secnum">C.3.6</span> Set up Extracts at Downstream Mining Database</h3>
<p>These steps set up Extract at the downstream database to capture from the archived logs sent by DBMS1 and DBMS2.</p>
<div id="GIORA508" class="sect3"><a id="sthref219"></a>
<h4 class="sect3"><span class="secnum">C.3.6.1</span> Set up Extract (ext1) to Capture Changes from Archived Logs Sent by DBMS1</h4>
<p>Perform the following steps on the DBMSCAP downstream mining database.</p>
<ol>
<li>
<p>Register Extract with DBMSCAP for the DBMS1 source database. In the credential store, the alias name of <code dir="ltr">ggadm1</code> is linked to a user connect string of <code dir="ltr">ggadm1@dbms1</code>.The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERIDALIAS ggadm1
GGSCI&gt; MININGDBLOGIN USERIDALIAS ggadmcap
GGSCI&gt; REGISTER EXTRACT ext1 DATABASE
</pre></li>
<li>
<p>Add Extract at the mining database DBMSCAP.</p>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext1 INTEGRATED TRANLOG BEGIN NOW
</pre></li>
<li>
<p>Edit the Extract parameter file <code dir="ltr">ext1.prm</code>. In the credential store, the alias name of <code dir="ltr">ggadm1</code> is linked to a user connect string of <code dir="ltr">ggadm1@dbms1</code>. The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
USERIDALIAS ggadm1
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine N)
</pre></li>
<li>
<p>Start Extract.</p>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext1
</pre></li>
</ol>
</div>
<!-- class="sect3" -->
<div id="GIORA509" class="sect3"><a id="sthref220"></a>
<h4 class="sect3"><span class="secnum">C.3.6.2</span> Set up Extract (ext2) to Capture Changes from Archived Logs Sent by DBMS2</h4>
<p>Perform the following steps on the DBMSCAP downstream mining database.</p>
<ol>
<li>
<p>Register Extract with the mining database for source database DBMS2. In the credential store, the alias name of <code dir="ltr">ggadm2</code> is linked to a user connect string of <code dir="ltr">ggadm2@dbms2</code>.The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERIDALIAS ggadm2
GGSCI&gt; MININGDBLOGIN USERIDALIAS ggadmcap
GGSCI&gt; REGISTER EXTRACT ext2 DATABASE
</pre></li>
<li>
<p>Create Extract at the mining database.</p>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext2 INTEGRATED TRANLOG, BEGIN NOW
</pre></li>
<li>
<p>Edit the Extract parameter file <code dir="ltr">ext2.prm</code>. In the credential store, the alias name of <code dir="ltr">ggadm2</code> is linked to a user connect string of <code dir="ltr">ggadm2@dbms2</code>.The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
USERIDALIAS ggadm2
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine N)
</pre></li>
<li>
<p>Start Extract.</p>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext2
</pre></li>
</ol>
</div>
<!-- class="sect3" -->
<div id="GIORA510" class="sect3"><a id="sthref221"></a>
<h4 class="sect3"><span class="secnum">C.3.6.3</span> Set up Extract (ext3) to Capture Changes in Real-time Mode from<br />
Online Logs Sent&nbsp;by&nbsp;DBMS3</h4>
<p>Perform the following steps on the DBMSCAP downstream mining database.</p>
<ol>
<li>
<p>Register Extract with the mining database for source database DBMS3. In the credential store, the alias name of <code dir="ltr">ggadm3</code> is linked to a user connect string of <code dir="ltr">ggadm3@dbms3</code>.The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
GGSCI&gt; DBLOGIN USERID ggadm3
GGSCI&gt; MININGDBLOGIN USERID ggadmcap
GGSCI&gt; REGISTER EXTRACT ext3 DATABASE
</pre></li>
<li>
<p>Create Extract at the mining database.</p>
<pre dir="ltr">
GGSCI&gt; ADD EXTRACT ext3 INTEGRATED TRANLOG, BEGIN NOW
</pre></li>
<li>
<p>Edit the Extract parameter file <code dir="ltr">ext3.prm</code>. To enable real-time mining, you must specify <code dir="ltr">downstream_real_time_mine</code>. In the credential store, the alias name of <code dir="ltr">ggadm3</code> is linked to a user connect string of <code dir="ltr">ggadm3@dbms3</code>.The alias name of <code dir="ltr">ggadmcap</code> is linked to a user connect string of <code dir="ltr">ggadmcap@dbmscap</code>.</p>
<pre dir="ltr">
USERIDALIAS ggadm3
TRANLOGOPTIONS MININGUSERALIAS ggadmcap
TRANLOGOPTIONS INTEGRATEDPARAMS (downstream_real_time_mine Y)
</pre></li>
<li>
<p>Start Extract.</p>
<pre dir="ltr">
GGSCI&gt; START EXTRACT ext3
</pre></li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can create multiple Extracts running in real-time integrated capture mode in the downstream mining database, as long as they all are capturing data from the same source database, such as all capturing for database DBMS3 in the preceding example.</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment233">
<tr>
<td class="cellalignment240"><table class="cellalignment238">
<tr>
<td class="cellalignment237"><a href="ic_deploy.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>

<td class="cellalignment237"><a href="ddl_install.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table></td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2010, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment242">
<table class="cellalignment236">
<tr>
<td class="cellalignment237"><a href="../../index.html"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment237"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment237"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
