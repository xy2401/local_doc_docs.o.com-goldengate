<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml/DTD/xhtml1-transitional.dtd">
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>11 Additional Configuration Steps for Using Classic Capture</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1056" />
<meta name="description" content="This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in classic capture mode." />
<meta name="dcterms.created" content="2015-06-05T14:9:49Z" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Oracle&reg; GoldenGate Installing and Configuring Oracle GoldenGate for Oracle Database" />
<meta name="dcterms.identifier" content="E29644-07" />
<meta name="dcterms.isVersionOf" content="GIORA" />
<link rel="Start" href="../../index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="additional_config.htm" title="Previous" type="text/html" />
<link rel="Next" href="nonint_replicat.htm" title="Next" type="text/html" />
<link rel="alternate" href="../GIORA.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="../GIORA.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="../GIORA.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Skip Headers</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns"><div id="BREADCRUMBS"><a href="http://docs.oracle.com">Home</a> / <a href="../../index.html">Middleware</a> / <a href="../index.html">Oracle GoldenGate for Windows and UNIX</a>
</div>

<span id="PAGE" style="display:none;">14/27</span>
<!-- End Header -->
<script  >
<!-- // <![CDATA[
window.name='classic_capture'
// ]]> -->
</script> <script  >
// <![CDATA[
function footdisplay(footnum,footnote) {
    var msg = window.open('', 'NewWindow' + footnum,
        'directories=no,height=120,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');

    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>');
    msg.document.write('Footnote ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('');
    msg.document.write('<style> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><h1>Footnote ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/body><\/html>');
    msg.document.close();
    msg.focus();
}
// ]]>
</script> <noscript>
<p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
</noscript>
<div id="GIORA250" class="chapter"><a id="CHDHHEHA"></a>
<h1 class="chapter"><span class="secnum">11</span> Additional Configuration Steps for Using Classic Capture</h1>
<p><a id="GIORA563"></a>This chapter contains additional configuration and preparation requirements that are specific only to Extract when operating in <span class="italic">classic capture</span> mode.</p>
<p>This chapter includes the following sections:</p>
<ul>
<li>
<p><a href="#BABFABDH">Configuring Oracle TDE Data in Classic Capture Mode</a></p>
</li>
<li>
<p><a href="#A1698220">Using Classic Capture in an Oracle RAC Environment</a></p>
</li>
<li>
<p><a href="#CHDCFGDA">Mining ASM-stored Logs in Classic Capture Mode</a></p>
</li>
<li>
<p><a href="#BABEDGCE">Ensuring Data Availability for Classic Capture</a></p>
</li>
<li>
<p><a href="#A1740233">Configuring Classic Capture in Archived Log Only Mode</a></p>
</li>
<li>
<p><a href="#A4948274">Configuring Classic Capture in Oracle Active Data Guard Only Mode</a></p>
</li>
<li>
<p><a href="#A1743274">Avoiding Log-read Bottlenecks in Classic Capture</a></p>
</li>
</ul>
<p>These requirements supplement the basic configuration requirements documented in:</p>
<p><a href="config_capt_classic.htm#BABBGIEB">Chapter 8, "Configuring Capture in Classic Mode"</a></p>
<a id="BABFABDH"></a>
<div id="GIORA251" class="sect1">
<h2 class="sect1"><span class="secnum">11.1</span> Configuring Oracle TDE Data in Classic Capture Mode</h2>
<p>The following special configuration steps are required to support TDE when Extract is in classic capture mode. This section <span class="italic">does not</span> apply to Extract in integrated capture mode.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When in integrated mode, Extract leverages the database logmining server and supports TDE column encryption and TDE tablespace encryption without special setup requirements or parameter settings. For more information about integrated capture, see <a href="process_mode.htm#CACCDCEA">Chapter 5, "Choosing Capture and Apply Modes"</a>.</div>
<div id="GIORA252" class="sect2"><a id="sthref98"></a>
<h3 class="sect2"><span class="secnum">11.1.1</span> Overview of TDE Support in Classic Capture Mode</h3>
<p>TDE support when Extract is in classic capture mode requires the exchange of two kinds of keys:</p>
<ul>
<li>
<p>The <span class="italic">encrypted key</span> can be a table key (column-level encryption), an encrypted redo log key (tablespace-level encryption), or both. This key is shared between the Oracle database and Extract.</p>
</li>
<li>
<p>The <span class="italic">decryption key</span> is named <code dir="ltr">ORACLEGG</code> and its password is known as the <span class="italic">shared secret</span>. This key is stored securely in the Oracle and Oracle GoldenGate domains. Only a party that has possession of the shared secret can decrypt the table and redo log keys.</p>
</li>
</ul>
<p>The encrypted keys are delivered to the Extract process by means of built-in PL/SQL code. Extract uses the shared secret to decrypt the data. Extract never handles the wallet master key itself, nor is it aware of the master key password. Those remain within the Oracle database security framework.</p>
<p>Extract never writes the decrypted data to any file other than a trail file, not even a discard file (specified with the <code dir="ltr">DISCARDFILE</code> parameter). The word "<code dir="ltr">ENCRYPTED</code>" will be written to any discard file that is in use.</p>
<p>The impact of this feature on Oracle GoldenGate performance should mirror that of the impact of decryption on database performance. Other than a slight increase in Extract startup time, there should be a minimal affect on performance from replicating TDE data.</p>
</div>
<!-- class="sect2" -->
<div id="GIORA253" class="sect2"><a id="sthref99"></a>
<h3 class="sect2"><span class="secnum">11.1.2</span> Requirements for Capturing TDE in Classic Capture Mode</h3>
<p>The following are requirements for Extract to support TDE capture:</p>
<ul>
<li>
<p>To maintain high security standards, the Oracle GoldenGate Extract process should run as part of the <code dir="ltr">oracle</code> user (the user that runs the Oracle database). That way, the keys are protected in memory by the same privileges as the <code dir="ltr">oracle</code> user.</p>
</li>
<li>
<p>The Extract process must run on the same machine as the database installation.</p>
</li>
<li>
<p>Even if using TDE with a Hardware Security Module, you must use a software wallet. Instructions are provided in <a href="#BABFAJBB">Section 11.1.4.3, "Oracle Security Officer Tasks"</a> in the configuration steps for moving from an HSM-only to an HSM-plus-wallet configuration and configuring the <code dir="ltr">sqlnet.ora</code> file correctly.</p>
</li>
<li>
<p>Whenever the source database is upgraded, you must rekey the master key.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<div id="GIORA254" class="sect2"><a id="sthref100"></a>
<h3 class="sect2"><span class="secnum">11.1.3</span> Required Database Patches for TDE Support</h3>
<p>To support TDE on Oracle 11.2.0.2, refer to article 1557031.1 on the My Oracle Support website (<a href="https://support.oracle.com"><code dir="ltr">https://support.oracle.com"&gt;&gt;https://support.oracle.com</code>).</a></p>
</div>
<!-- class="sect2" -->
<div id="GIORA255" class="sect2"><a id="sthref101"></a>
<h3 class="sect2"><span class="secnum">11.1.4</span> Configuring Classic Capture for TDE Support</h3>
<p>The following outlines the steps that the Oracle Security Officer and the Oracle GoldenGate Administrator take to establish communication between the Oracle server and the Extract process.</p>
<div id="GIORA256" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref102"></a>
<h4 class="sect3"><span class="secnum">11.1.4.1</span> Agree on a Shared Secret that Meets Oracle Standards</h4>
<p>Agree on a <span class="italic">shared secret</span> password that meets or exceeds Oracle password standards. This password must not be known by anyone else. For guidelines on creating secure passwords, see <a class="olink DBSEG" href="http://www.oracle.com/pls/topic/lookup?ctx=gg1212&amp;id=DBSEG"><span class="italic">Oracle Database Security Guide</span></a>.</p>
</div>
<!-- class="sect3" -->
<div id="GIORA257" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref103"></a>
<h4 class="sect3"><span class="secnum">11.1.4.2</span> Oracle DBA Tasks</h4>
<ol>
<li>
<p>Log in to SQL*Plus as a user with the <code dir="ltr">SYSDBA</code> system privilege. For example:</p>
<pre dir="ltr">
sqlplus sys/as sysdba
Connected.
Enter password: <span class="codeinlineitalic">password</span>
</pre></li>
<li>
<p>Run the <code dir="ltr">prvtclkm.plb</code> file that is installed in the Oracle <code dir="ltr">admin</code> directory. The <code dir="ltr">prvtclkm.plb</code> file creates the <code dir="ltr">DBMS_INTERNAL_CLKM</code> PL/SQL package, which enables Oracle GoldenGate to extract encrypted data from an Oracle database.</p>
<pre dir="ltr">
@?/app/oracle/product/orcl111/rdbms/admin/prvtclkm.plb
</pre></li>
<li>
<p>Grant <code dir="ltr">EXEC</code> privilege on <code dir="ltr">DBMS_INTERNAL_CLKM</code> PL/SQL package to the Extract database user.</p>
<pre dir="ltr">
GRANT EXECUTE ON DBMS_INTERNAL_CLKM TO <span class="codeinlineitalic">psmith</span>;
</pre></li>
<li>
<p>Exit SQL*Plus.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="BABFAJBB"></a>
<div id="GIORA258" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.1.4.3</span> Oracle Security Officer Tasks</h4>
<ol>
<li>
<p>Oracle GoldenGate requires the use of a software wallet even with HSM. If you are currently using HSM-only mode, move to HSM-plus-wallet mode by taking the following steps:</p>
<ol>
<li>
<p>Change the <code dir="ltr">sqlnet.ora</code> file configuration as shown in the following example, where the wallet directory can be any location on disk that is accessible (rwx) by the owner of the Oracle database. This example shows a best-practice location, where <code dir="ltr">my_db</code> is the <code dir="ltr">$ORACLE_SID</code>.</p>
<pre dir="ltr">
ENCRYPTION_WALLET_LOCATION=
 (SOURCE=(METHOD=HSM)(METHOD_DATA=
   (DIRECTORY=/etc/oracle/wallets/my_db)))
</pre></li>
<li>
<p>Log in to <code dir="ltr">orapki</code> (or Wallet Manager) as the owner of the Oracle database, and create an auto-login wallet in the location that you specified in the <code dir="ltr">sqlnet.ora</code> file. When prompted for the wallet password, specify the <span class="bold">same password as the HSM password (or HSM Connect String)</span>. These two passwords must be identical.</p>
<pre dir="ltr">
cd /etc/oracle/wallets/my_db
orapki wallet create -wallet . -auto_login[_local] 
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The Oracle database owner must have full operating system privileges on the wallet.</div>
</li>
<li>
<p>Add the following entry to the empty wallet to enable an 'auto-open' HSM:</p>
<pre dir="ltr">
mkstore -wrl . -createEntry ORACLE.TDE.HSM.AUTOLOGIN <span class="codeinlineitalic">non-empty-string</span> 
</pre></li>
</ol>
</li>
<li>
<p>Create an entry named <code dir="ltr">ORACLEGG</code> in the wallet. <code dir="ltr"><span class="codeinlinebold">ORACLEGG</span></code> <span class="bold">must be the name of this key.</span> The password for this key must be the agreed-upon shared secret, but do not enter this password on the command line. Instead, wait to be prompted.</p>
<pre dir="ltr">
mkstore -wrl ./ -createEntry ORACLE.SECURITY.CL.ENCRYPTION.ORACLEGG
Oracle Secret Store Tool : Version 11.2.0.3.0 - Production
Copyright (c) 2004, 2011, Oracle and/or its affiliates. All rights reserved.
Your secret/Password is missing in the command line
Enter your secret/Password: <span class="codeinlineitalic">sharedsecret</span>
Re-enter your secret/Password: <span class="codeinlineitalic">sharedsecret</span>
Enter wallet password: <span class="codeinlineitalic">hsm/wallet_password</span>
</pre></li>
<li>
<p>Verify the <code dir="ltr">ORACLEGG</code> entry.</p>
<pre dir="ltr">
mkstore -wrl . -list
Oracle Secret Store Tool : Version 11.2.0.3.0 - Production
Copyright (c) 2004, 2011, Oracle and/or its affiliates. All rights reserved.
Enter wallet password: <span class="codeinlineitalic">hsm/wallet_password</span>
Oracle Secret Store entries:
ORACLE.SECURITY.CL.ENCRYPTION.ORACLEGG
</pre></li>
<li>
<p>Log in to SQL*Plus as a user with the <code dir="ltr">SYSDBA</code> system privilege.</p>
</li>
<li>
<p>Close and then re-open the wallet.</p>
<pre dir="ltr">
SQL&gt; alter system set encryption wallet close identified by "<span class="codeinlineitalic">hsm/wallet_password</span>";
System altered.
SQL&gt; alter system set encryption wallet open identified by "<span class="codeinlineitalic">hsm/wallet_password</span>";
System altered.
</pre>
<p>This inserts the password into the auto-open wallet, so that no password is required to access encrypted data with the TDE master encryption key stored in HSM.</p>
</li>
<li>
<p>Switch log files.</p>
<pre dir="ltr">
alter system switch logfile;
System altered.
</pre></li>
<li>
<p>If this is an Oracle RAC environment and you are using copies of the wallet on each node, make the copies now and then reopen each wallet.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle recommends using one wallet in a shared location, with synchronized access among all Oracle RAC nodes.</div>
</div>
<!-- class="sect3" -->
<div id="GIORA259" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref104"></a>
<h4 class="sect3"><span class="secnum">11.1.4.4</span> Oracle GoldenGate Administrator Tasks</h4>
<ol>
<li>
<p>Run GGSCI.</p>
</li>
<li>
<p>Issue the <code dir="ltr">ENCRYPT PASSWORD</code> command to encrypt the shared secret so that it is obfuscated within the Extract parameter file. <span class="italic">This is a security requirement</span>.</p>
<pre dir="ltr">
ENCRYPT PASSWORD <span class="codeinlineitalic">sharedsecret</span> {AES128 | AES192 | AES256} ENCRYPTKEY <span class="codeinlineitalic">keyname</span>
</pre>
<p><span class="bold">Where:</span></p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">sharedsecret</span></code> is the clear-text shared secret. This value is case-sensitive.</p>
</li>
<li>
<p><code dir="ltr">{AES128 | AES192 | AES256}</code> specifies Advanced Encryption Standard (AES) encryption. Specify one of the values, which represents the desired key length.</p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">keyname</span></code> is the logical name of the encryption key in the <code dir="ltr">ENCKEYS</code> lookup file. Oracle GoldenGate uses this key to look up the actual key in the <code dir="ltr">ENCKEYS</code> file. To create a key and <code dir="ltr">ENCKEYS</code> file, see <a class="olink GWUAD" href="../../gg-winux/GWUAD/toc.htm"><span class="italic">Administering Oracle GoldenGate for Windows and UNIX</span></a>.</p>
<p>Example:</p>
<pre dir="ltr">
ENCRYPT PASSWORD sharedsecret AES256 ENCRYPTKEY <span class="codeinlineitalic">mykey1</span>
</pre></li>
</ul>
</li>
<li>
<p>In the Extract parameter file, use the <code dir="ltr">DBOPTIONS</code> parameter with the <code dir="ltr">DECRYPTPASSWORD</code> option. As input, supply the encrypted shared secret and the decryption key.</p>
<pre dir="ltr">
DBOPTIONS DECRYPTPASSWORD <span class="codeinlineitalic">sharedsecret</span> {AES128 | AES192 | AES256} ENCRYPTKEY <span class="codeinlineitalic">keyname</span>
</pre>
<p><span class="bold">Where:</span></p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">sharedsecret</span></code> is the encrypted shared secret.</p>
</li>
<li>
<p><code dir="ltr">{AES128 | AES192 | AES256}</code> must be same value that was used for <code dir="ltr">ENCRYPT PASSWORD</code>.</p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">keyname</span></code> is the logical name of the encryption key in the <code dir="ltr">ENCKEYS</code> lookup file.</p>
<p>Example:</p>
<pre dir="ltr">
DBOPTIONS DECRYPTPASSWORD AACAAAAAAAAAAAIALCKDZIRHOJBHOJUH AES256 ENCRYPTKEY mykey1
</pre></li>
</ul>
</li>
<li>
<p>Log in to SQL*Plus as a user with the <code dir="ltr">SYSDBA</code> system privilege.</p>
</li>
<li>
<p>Close and then re-open the wallet.</p>
<pre dir="ltr">
SQL&gt; alter system set encryption wallet close identified by "<span class="codeinlineitalic">hsm/wallet_password</span>";
System altered.
SQL&gt; alter system set encryption wallet open identified by "<span class="codeinlineitalic">hsm/wallet_password</span>";
System altered.
</pre></li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<div id="GIORA260" class="sect2"><a id="sthref105"></a>
<h3 class="sect2"><span class="secnum">11.1.5</span> Recommendations for Maintaining Data Security after Decryption</h3>
<p>Extract decrypts the TDE data and writes it to the trail as clear text. To maintain data security throughout the path to the target database, it is recommended that you also deploy Oracle GoldenGate security features to:</p>
<ul>
<li>
<p>encrypt the data in the trails</p>
</li>
<li>
<p>encrypt the data in transit across TCP/IP</p>
</li>
</ul>
<p>For more information, see <a class="olink GWUAD354" href="../../gg-winux/GWUAD/wu_security.htm#GWUAD354"><span class="italic">Administering Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</div>
<!-- class="sect2" -->
<div id="GIORA261" class="sect2"><a id="sthref106"></a>
<h3 class="sect2"><span class="secnum">11.1.6</span> Performing DDL while TDE Capture is Active</h3>
<p>If DDL will ever be performed on a table that has column-level encryption, or if table keys will ever be re-keyed, you must either quiesce the table while the DDL is performed or enable Oracle GoldenGate DDL support. It is more practical to have the DDL environment active so that it is ready, because a re-key usually is a response to a security violation and must be performed immediately. To install the Oracle GoldenGate DDL environment, see <a href="ddl_install.htm#CHDDIBBE">Appendix D, "Installing Trigger-Based DDL Capture"</a>. To configure Oracle GoldenGate DDL support, see <a href="ddl.htm#CHDHJEDE">Chapter 13, "Configuring DDL Support"</a>. For tablespace-level encryption, the Oracle GoldenGate DDL support is not required.</p>
</div>
<!-- class="sect2" -->
<div id="GIORA989" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref107"></a>
<h3 class="sect2"><span class="secnum">11.1.7</span> Rekeying after a Database Upgrade</h3>
<p>Whenever the source database is upgraded and Oracle GoldenGate is capturing TDE data, you must rekey the master key, and then restart the database and Extract. The commands to rekey the master key are:</p>
<pre dir="ltr">
alter system set encryption key identified by "mykey";
</pre></div>
<!-- class="sect2" -->
<div id="GIORA262" class="sect2"><a id="sthref108"></a>
<h3 class="sect2"><span class="secnum">11.1.8</span> Updating the Oracle Shared Secret in the Parameter File</h3>
<p>Use this procedure to update and encrypt the TDE shared secret within the Extract parameter file.</p>
<ol>
<li>
<p>Run GGSCI.</p>
</li>
<li>
<p>Stop the Extract process.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Modify the <code dir="ltr">ORACLEGG</code> entry in the Oracle wallet. <code dir="ltr">ORACLEGG</code> must remain the name of the key. For instructions, see <a class="olink ASOAG" href="http://www.oracle.com/pls/topic/lookup?ctx=gg1212&amp;id=ASOAG"><span class="italic">Oracle Database Advanced Security Guide</span></a>.</p>
</li>
<li>
<p>Issue the <code dir="ltr">ENCRYPT PASSWORD</code> command to encrypt the new shared secret.</p>
<pre dir="ltr">
ENCRYPT PASSWORD <span class="codeinlineitalic">sharedsecret</span> {AES128 | AES192 | AES256} ENCRYPTKEY <span class="codeinlineitalic">keyname</span>
</pre>
<p><span class="bold">Where:</span></p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">sharedsecret</span></code> is the clear-text shared secret. This value is case-sensitive.</p>
</li>
<li>
<p><code dir="ltr">{AES128 | AES192 | AES256}</code> specifies Advanced Encryption Standard (AES) encryption. Specify one of the values, which represents the desired key length.</p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">keyname</span></code> is the logical name of the encryption key in the <code dir="ltr">ENCKEYS</code> lookup file.</p>
<p>Example:</p>
<pre dir="ltr">
ENCRYPT PASSWORD sharedsecret AES256 ENCRYPTKEY <span class="codeinlineitalic">mykey1</span>
</pre></li>
</ul>
</li>
<li>
<p>In the Extract parameter file, use the <code dir="ltr">DBOPTIONS</code> parameter with the <code dir="ltr">DECRYPTPASSWORD</code> option. As input, supply the encrypted shared secret and the Oracle GoldenGate-generated or user-defined decryption key.</p>
<pre dir="ltr">
DBOPTIONS DECRYPTPASSWORD <span class="codeinlineitalic">sharedsecret</span> {AES128 | AES192 | AES256} ENCRYPTKEY <span class="codeinlineitalic">keyname</span>
</pre>
<p><span class="bold">Where:</span></p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">sharedsecret</span></code> is the encrypted shared secret.</p>
</li>
<li>
<p><code dir="ltr">{AES128 | AES192 | AES256}</code> must be same value that was used for <code dir="ltr">ENCRYPT PASSWORD</code>.</p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">keyname</span></code> is the logical name of the encryption key in the <code dir="ltr">ENCKEYS</code> lookup file.</p>
<p>Example:</p>
<pre dir="ltr">
DBOPTIONS DECRYPTPASSWORD AACAAAAAAAAAAAIALCKDZIRHOJBHOJUH AES256 ENCRYPTKEY mykey1
</pre></li>
</ul>
</li>
<li>
<p>Log in to SQL*Plus as a user with the <code dir="ltr">SYSDBA</code> system privilege.</p>
</li>
<li>
<p>Close and then re-open the wallet.</p>
<pre dir="ltr">
SQL&gt; alter system set encryption wallet close identified by "<span class="codeinlineitalic">hsm/wallet_password</span>";
System altered.
SQL&gt; alter system set encryption wallet open identified by "<span class="codeinlineitalic">hsm/wallet_password</span>";
System altered.
</pre></li>
<li>
<p>Start Extract.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="A1698220"></a>
<div id="GIORA263" class="sect1">
<h2 class="sect1"><span class="secnum">11.2</span> Using Classic Capture in an Oracle RAC Environment</h2>
<p>The following general guidelines apply to Oracle RAC when Extract is operating in classic capture mode.</p>
<ul>
<li>
<p>During operations, if the primary database instance against which Oracle GoldenGate is running stops or fails for any reason, Extract abends. To resume processing, you can restart the instance or mount the Oracle GoldenGate binaries to another node where the database is running and then restart the Oracle GoldenGate processes. Stop the Manager process on the original node before starting Oracle GoldenGate processes from another node.</p>
</li>
<li>
<p>Whenever the number of redo threads changes, the Extract group must be dropped and re-created. For the recommended procedure, see <a class="olink GWUAD" href="../../gg-winux/GWUAD/toc.htm"><span class="italic">Administering Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</li>
<li>
<p>Extract ensures that transactions are written to the trail file in commit order, regardless of the RAC instance where the transaction originated. When Extract is capturing in archived-log-only mode, where one or more RAC instances may be idle, you may need to perform archive log switching on the idle nodes to ensure that operations from the active instances are recorded in the trail file in a timely manner. You can instruct the Oracle RDBMS to do this log archiving automatically at a preset interval by setting the <code dir="ltr">archive_lag_target</code> parameter. For example, to ensure that logs are archived every fifteen minutes, regardless of activity, you can issue the following command in all instances of the RAC system:</p>
<pre dir="ltr">
SQL&gt; alter system set archive_lag_target 900
</pre></li>
<li>
<p>To process the last transaction in a RAC cluster before shutting down Extract, insert a dummy record into a source table that Oracle GoldenGate is replicating, and then switch log files on all nodes. This updates the Extract checkpoint and confirms that all available archive logs can be read. It also confirms that all transactions in those archive logs are captured and written to the trail in the correct order.</p>
</li>
</ul>
<p>The following table shows some Oracle GoldenGate parameters that are of specific benefit in Oracle RAC.</p>
<div id="GIORA264" class="tblhruleformalwide"><p class="titleintable"><a id="sthref109"></a><a id="sthref110"></a>Table 11-1 Classic Extract Parameters for Oracle RAC</p>
<table class="cellalignment245" title="Classic Extract Parameters for Oracle RAC" summary="This chapter describes the Oracle GoldenGate parameters for Oracle RAC.">
<thead>
<tr class="cellalignment234">
<th class="cellalignment246" id="r1c1-t5">Parameter</th>
<th class="cellalignment246" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment234">
<td class="cellalignment240" id="r2c1-t5" headers="r1c1-t5">
<p><code dir="ltr">THREADOPTIONS</code> parameter with the <code dir="ltr">INQUEUESIZE</code> and <code dir="ltr">OUTQUEUESIZE</code> options</p>
</td>
<td class="cellalignment240" headers="r2c1-t5 r1c2-t5">
<p>Sets the amount of data that Extract queues in memory before sending it to the target system. Tuning these parameters might increase Extract performance on Oracle RAC.</p>
</td>
</tr>
<tr class="cellalignment234">
<td class="cellalignment240" id="r3c1-t5" headers="r1c1-t5">
<p><code dir="ltr">TRANLOGOPTIONS</code> parameter with the <code dir="ltr">PURGEORPHANEDTRANSACTIONS | NOPURGEORPHANEDTRANSACTIONS</code> and <code dir="ltr">TRANSCLEANUPFREQUENCY</code> options</p>
</td>
<td class="cellalignment240" headers="r3c1-t5 r1c2-t5">
<p>Controls how Extract handles orphaned transactions, which can occur when a node fails during a transaction and Extract cannot capture the rollback. Although the database performs the rollback on the failover node, the transaction would otherwise remain in the Extract transaction list indefinitely and prevent further checkpointing for the Extract thread that was processing the transaction. By default, Oracle GoldenGate purges these transactions from its list after they are confirmed as orphaned. This functionality can also be controlled on demand with the <code dir="ltr">SEND EXTRACT</code> command in GGSCI.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformalwide" --></div>
<!-- class="sect1" -->
<a id="CHDCFGDA"></a>
<div id="GIORA265" class="sect1">
<h2 class="sect1"><span class="secnum">11.3</span> Mining ASM-stored Logs in Classic Capture Mode</h2>
<p>This topic covers additional configuration requirements that apply when Oracle GoldenGate mines transaction logs that are stored in Oracle Automatic Storage Management (ASM).</p>
<a id="CHDEBDIA"></a>
<div id="GIORA266" class="sect2">
<h3 class="sect2"><span class="secnum">11.3.1</span> Accessing the Transaction Logs in ASM</h3>
<p>Extract must be configured to read logs that are stored in ASM. Depending on the database version, the following options are available:</p>
<a id="BABCFIBB"></a>
<div id="GIORA267" class="sect3">
<h4 class="sect3"><span class="secnum">11.3.1.1</span> Reading Transaction Logs Through the RDBMS</h4>
<p>Use the <code dir="ltr">TRANLOGOPTIONS</code> parameter with the <code dir="ltr">DBLOGREADER</code> option in the Extract parameter file if the RDBMS is Oracle 11.1.0.7 or Oracle 11.2.0.2 or later 11g R2 versions.</p>
<p>An API is available in those releases (but not in Oracle 11g R1 versions) that uses the database server to access the redo and archive logs. When used, this API enables Extract to use a read buffer size of up to 4 MB in size. A larger buffer may improve the performance of Extract when redo rate is high. You can use the <code dir="ltr">DBLOGREADERBUFSIZE</code> option of <code dir="ltr">TRANLOGOPTIONS</code> to specify a buffer size.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<code dir="ltr">DBLOGREADER</code> also can be used when the redo and archive logs are on regular disk or on a raw device.</div>
<p>When using <code dir="ltr">DBLOGREADER</code> and using Oracle Data Vault, grant the <code dir="ltr">DV_GOLDENGATE_REDO_ACCESS</code> Role to the Extract database user in addition to the privileges that are listed in <a href="user_assignment.htm#BABHFBDB">Chapter 4, "Establishing Oracle GoldenGate Credentials."</a></p>
</div>
<!-- class="sect3" -->
<div id="GIORA268" class="sect3"><a id="sthref111"></a>
<h4 class="sect3"><span class="secnum">11.3.1.2</span> ASM Direct Connection</h4>
<p>If the RDBMS version is not one of those listed in <a href="#BABCFIBB">Section 11.3.1.1, "Reading Transaction Logs Through the RDBMS"</a>, do the following:</p>
<ol>
<li>
<p>Create a user for the Extract process to access the ASM instance directly. Assign this user <code dir="ltr">SYS</code> or <code dir="ltr">SYSDBA</code> privileges in the ASM instance. Oracle GoldenGate does not support using operating-system authentication for the ASM user. See <a href="#BABIHGEH">Table 11-2</a> for additional details.</p>
<div id="GIORA269" class="tblhruleformal"><p class="titleintable"><a id="sthref112"></a><a id="BABIHGEH"></a>Table 11-2 Extract Database Privileges &mdash; ASM Instance</p>
<table class="cellalignment245" title="Extract Database Privileges &mdash; ASM Instance" summary="This table lists the Extract database privileges &mdash; ASM instance. It gives the ASM password configuration and the permitted user.">
<thead>
<tr class="cellalignment234">
<th class="cellalignment246" id="r1c1-t7">ASM password configuration<a id="sthref113" href="#sthref113" onclick='footdisplay(1,"To view how the current ASM password file is configured, log on to the ASM instance and issue the following command in SQL*Plus:\u003cbr /\u003e\u003ccode dir=\"ltr\"\u003eSQL\u003e SELECT name, value FROM v$parameter\u003c/code\u003e \u003cbr /\u003e\u003ccode dir=\"ltr\"\u003eWHERE name = \x27remote_login_passwordfile\x27;\u003c/code\u003e")'><sup class="tablefootnote">Foot&nbsp;1&nbsp;</sup></a></th>
<th class="cellalignment246" id="r1c2-t7">Permitted user</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment234">
<td class="cellalignment240" id="r2c1-t7" headers="r1c1-t7">
<p>ASM instance and the database share a password file</p>
</td>
<td class="cellalignment240" headers="r2c1-t7 r1c2-t7">
<p>You can use the Oracle GoldenGate source database user if you grant that user <code dir="ltr">SYSDBA</code>, or you can use any other database user that has <code dir="ltr">SYSDBA</code> privileges.</p>
</td>
</tr>
<tr class="cellalignment234">
<td class="cellalignment240" id="r3c1-t7" headers="r1c1-t7">
<p>ASM instance and the source database have separate password files</p>
</td>
<td class="cellalignment240" headers="r3c1-t7 r1c2-t7">
<p>You can overwrite the ASM password file with the source database password file, understanding that this procedure changes the <code dir="ltr">SYS</code> password in the ASM instance to the value that is contained in the database password file, and it also grants ASM access to the other users in the database password file. Save a copy of the ASM file before overwriting it.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1&nbsp;</sup>To view how the current ASM password file is configured, log on to the ASM instance and issue the following command in SQL*Plus:<br />
<code dir="ltr">SQL&gt; SELECT name, value FROM v$parameter</code><br />
<code dir="ltr">WHERE name = 'remote_login_passwordfile';</code></p>
</li>
<li>
<p>Add the ASM user credentials to the Oracle GoldenGate credential store by issuing the <code dir="ltr">ALTER CREDENTIALSTORE</code> command. See <a class="olink GWURF895" href="../../gg-winux/GWURF/ggsci_commands.htm#GWURF895"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a> for usage instructions and syntax.</p>
</li>
<li>
<p>Specify the ASM login alias in the Extract parameter file by including the <code dir="ltr">TRANLOGOPTIONS</code> parameter with the <code dir="ltr">ASMUSERALIAS</code> option. For more information about <code dir="ltr">TRANLOGOPTIONS</code>, see <a class="olink GWURF712" href="../../gg-winux/GWURF/gg_parameters174.htm#GWURF712"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<div id="GIORA270" class="sect2"><a id="sthref114"></a>
<h3 class="sect2"><span class="secnum">11.3.2</span> Ensuring ASM Connectivity</h3>
<p>To ensure that the Oracle GoldenGate Extract process can connect to an ASM instance, list the ASM instance in the <code dir="ltr">tnsnames.ora</code> file. The recommended method for connecting to an ASM instance when Oracle GoldenGate is running on the database host machine is to use a bequeath (BEQ) protocol. The BEQ protocol does not require a listener. If you prefer to use the TCP/IP protocol, verify that the Oracle listener is listening for new connections to the ASM instance. The <code dir="ltr">listener.ora</code> file must contain an entry similar to the following.</p>
<pre dir="ltr">
SID_LIST_LISTENER_ASM =
  (SID_LIST =
    (SID_DESC =
      (GLOBAL_DBNAME = ASM)
      (ORACLE_HOME = /u01/app/grid)
    (SID_NAME = +ASM1)
  )
)
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
A BEQ connection does not work when using a remote Extract configuration. Use <code dir="ltr">TNSNAMES</code> with the TCP/IP protocol.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABEDGCE"></a>
<div id="GIORA271" class="sect1">
<h2 class="sect1"><span class="secnum">11.4</span> Ensuring Data Availability for Classic Capture</h2>
<p>To ensure the continuity and integrity of capture processing when Extract operates in classic capture mode, enable archive logging. The archive logs provide a secondary data source should the online logs recycle before Extract is finished with them. The archive logs for open transactions must be retained on the system in case Extract needs to recapture data from them to perform a recovery.</p>
<div class="infoboxnotewarn">
<p class="notep1">WARNING:</p>
<p class="warnsp">If you cannot enable archive logging, there is a high risk that you will need to completely resynchronize the source and target objects and reinstantiate replication should there be a failure that causes an Extract outage while transactions are still active. If you must operate this way, configure the online logs according to the following guidelines to retain enough data for Extract to capture what it needs before the online logs recycle. Allow for Extract backlogs caused by network outages and other external factors, as well as long-running transactions.</p>
</div>
<p>In a RAC configuration, Extract must have access to the online and archived logs for all nodes in the cluster, including the one where Oracle GoldenGate is installed.</p>
<a id="BABICIDE"></a>
<div id="GIORA272" class="sect2">
<h3 class="sect2"><span class="secnum">11.4.1</span> Log Retention Requirements per Extract Recovery Mode</h3>
<p>The following summarizes the different recovery modes that Extract might use and their log-retention requirements:</p>
<ul>
<li>
<p>By default, the Bounded Recovery mode is in effect, and Extract requires access to the logs only as far back as twice the Bounded Recovery interval that is set with the <code dir="ltr">BR</code> parameter. This interval is an integral multiple of the standard Extract checkpoint interval, as controlled by the <code dir="ltr">CHECKPOINTSECS</code> parameter. These two parameters control the Oracle GoldenGate Bounded Recovery feature, which ensures that Extract can recover in-memory captured data after a failure, no matter how old the oldest open transaction was at the time of failure. For more information about Bounded Recovery, see <a class="olink GWURF410" href="../../gg-winux/GWURF/gg_parameters015.htm#GWURF410"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</li>
<li>
<p>In the unlikely event that the Bounded Recovery mechanism fails when Extract attempts a recovery, Extract reverts to normal recovery mode and must have access to the archived log that contains the beginning of the oldest open transaction in memory at the time of failure and all logs thereafter.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CHDHBEGA"></a>
<div id="GIORA273" class="sect2">
<h3 class="sect2"><span class="secnum">11.4.2</span> Log Retention Options</h3>
<p>Depending on the version of Oracle, there are different options for ensuring that the required logs are retained on the system.</p>
<div id="GIORA274" class="sect3"><a id="sthref115"></a>
<h4 class="sect3"><span class="secnum">11.4.2.1</span> Oracle Enterprise Edition 11g and Later</h4>
<p>For these versions, Extract can be configured to work with Oracle Recovery Manager (RMAN) to retain the logs that Extract needs for recovery. You enable this feature when you issue the <code dir="ltr">REGISTER EXTRACT</code> command. See <a href="processes_creating.htm#BABDJFFC">Chapter 14, "Creating Process Groups"</a> for more information. To use this feature, the Extract database user must have the following privileges, in addition to the basic privileges listed in <a href="user_assignment.htm#BABHFBDB">Chapter 4, "Establishing Oracle GoldenGate Credentials"</a>.</p>
<div id="GIORA275" class="tblhruleformalwide"><p class="titleintable"><a id="sthref116"></a><a id="BABEJGHB"></a>Table 11-3 Extract Database Privileges &mdash;Log Retention</p>
<table class="cellalignment245" title="Extract Database Privileges &mdash;Log Retention" summary="This table lists the Extract database privileges &mdash;Log retention in Oracle EE 10.2 and later.">
<thead>
<tr class="cellalignment234">
<th class="cellalignment246" id="r1c1-t10">Oracle EE version</th>
<th class="cellalignment246" id="r1c2-t10">Privileges</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment234">
<td class="cellalignment240" id="r2c1-t10" headers="r1c1-t10">
<p>11.1 and 11.2.0.1</p>
</td>
<td class="cellalignment240" headers="r2c1-t10 r1c2-t10">
<ol>
<li>
<p>Run package to grant Oracle GoldenGate admin privilege.</p>
<pre dir="ltr">
exec dbms_streams_auth.grant_admin_privilege('<span class="codeinlineitalic">user</span>')
</pre></li>
<li>
<p>Grant the '<code dir="ltr">become user</code>' privilege.</p>
<pre dir="ltr">
grant become user to <span class="codeinlineitalic">user</span>;
</pre></li>
</ol>
</td>
</tr>
<tr class="cellalignment234">
<td class="cellalignment240" id="r3c1-t10" headers="r1c1-t10">
<p>11.2.0.3 and later</p>
</td>
<td class="cellalignment240" headers="r3c1-t10 r1c2-t10">
<p>Run package to grant Oracle GoldenGate admin privilege.</p>
<pre dir="ltr">
exec dbms_goldengate_auth.grant_admin_privilege('<span class="codeinlineitalic">user</span>')
</pre></td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformalwide" -->
<p>When log retention is enabled, Extract retains enough logs to perform a Bounded Recovery, but you can configure Extract to retain enough logs through RMAN for a normal recovery by using the <code dir="ltr">TRANLOGOPTIONS</code> parameter with the <code dir="ltr">LOGRETENTION</code> option set to <code dir="ltr">SR</code>. There also is an option to disable the use of RMAN log retention. Review the options of <code dir="ltr">LOGRETENTION</code> in the <span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span> before you configure Extract. If you set <code dir="ltr">LOGRETENTION</code> to <code dir="ltr">DISABLED</code>, see <a href="#BABCEGBC">Section 11.4.3, "Determining How Much Data to Retain,"</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
To support RMAN log retention on Oracle RAC for Oracle versions prior to 11.2.0.3, you must download and install the database patch that is provided in BUGFIX 11879974 before you add the Extract groups.</div>
<p>The RMAN log retention feature creates an underlying (but non-functioning) Oracle Streams Capture process for each Extract group. The name of the Capture is based on the name of the associated Extract group. The log retention feature can operate concurrently with other local Oracle Streams installations. When you create an Extract group, the logs are retained from the current database SCN.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the storage area is full, RMAN purges the archive logs even when needed by Extract. This limitation exists so that the requirements of Extract (and other Oracle replication components) do not interfere with the availability of redo to the database.</div>
</div>
<!-- class="sect3" -->
<div id="GIORA276" class="sect3"><a id="sthref117"></a>
<h4 class="sect3"><span class="secnum">11.4.2.2</span> All Other Oracle Versions</h4>
<p>For versions of Oracle other than Enterprise Edition, you must manage the log retention process with your preferred administrative tools. Follow the directions in <a href="#BABCEGBC">Section 11.4.3, "Determining How Much Data to Retain"</a>.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABCEGBC"></a>
<div id="GIORA277" class="sect2">
<h3 class="sect2"><span class="secnum">11.4.3</span> Determining How Much Data to Retain</h3>
<p>When managing log retention, try to ensure rapid access to the logs that Extract would require to perform a normal recovery (not a Bounded Recovery). See <a href="#BABICIDE">Section 11.4.1, "Log Retention Requirements per Extract Recovery Mode"</a>. If you must move the archives off the database system, the <code dir="ltr">TRANLOGOPTIONS</code> parameter provides a way to specify an alternate location. See <a href="#BABBFFJB">Section 11.4.5, "Specifying the Archive Location"</a>.</p>
<p>The recommended retention period is at least 24 hours worth of transaction data, including both online and archived logs. To determine the oldest log that Extract might need at any given point, issue the <code dir="ltr">SEND EXTRACT</code> command with the <code dir="ltr">SHOWTRANS</code> option. You might need to do some testing to determine the best retention time given your data volume and business requirements.</p>
<p>If data that Extract needs during processing was not retained, either in online or archived logs, one of the following corrective actions might be required:</p>
<ul>
<li>
<p>Alter Extract to capture from a later point in time for which log data is available (and accept possible data loss on the target).</p>
</li>
<li>
<p>Resynchronize the source and target data, and then start the Oracle GoldenGate environment over again.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<div id="GIORA278" class="sect2"><a id="sthref118"></a>
<h3 class="sect2"><span class="secnum">11.4.4</span> Purging Log Archives</h3>
<p>Make certain not to use backup or archive options that cause old archive files to be overwritten by new backups. Ideally, new backups should be separate files with different names from older ones. This ensures that if Extract looks for a particular log, it will still exist, and it also ensures that the data is available in case it is needed for a support case.</p>
</div>
<!-- class="sect2" -->
<a id="BABBFFJB"></a>
<div id="GIORA279" class="sect2">
<h3 class="sect2"><span class="secnum">11.4.5</span> Specifying the Archive Location</h3>
<p>If the archived logs reside somewhere other than the Oracle default directory, specify that directory with the <code dir="ltr">ALTARCHIVELOGDEST</code> option of the <code dir="ltr">TRANLOGOPTIONS</code> parameter in the Extract parameter file.</p>
<p>You might also need to use the <code dir="ltr">ALTARCHIVEDLOGFORMAT</code> option of <code dir="ltr">TRANLOGOPTIONS</code> if the format that is specified with the Oracle parameter <code dir="ltr">LOG_ARCHIVE_FORMAT</code> contains sub-directories. <code dir="ltr">ALTARCHIVEDLOGFORMAT</code> specifies an alternate format that removes the sub-directory from the path. For example, <code dir="ltr">%T/log_%t_%s_%r.arc</code> would be changed to <code dir="ltr">log_%t_%s_%r.arc</code>. As an alternative to using <code dir="ltr">ALTARCHIVEDLOGFORMAT</code>, you can create the sub-directory manually, and then move the log files to it.</p>
</div>
<!-- class="sect2" -->
<div id="GIORA280" class="sect2"><a id="sthref119"></a>
<h3 class="sect2"><span class="secnum">11.4.6</span> Mounting Logs That are Stored on Other Platforms</h3>
<p>If the online and archived redo logs are stored on a different platform from the one that Extract is built for, do the following:</p>
<ul>
<li>
<p>NFS-mount the archive files.</p>
</li>
<li>
<p>Map the file structure to the structure of the source system by using the <code dir="ltr">LOGSOURCE</code> and <code dir="ltr">PATHMAP</code> options of the Extract parameter <code dir="ltr">TRANLOGOPTIONS</code>. For more information, see <a class="olink GWURF712" href="../../gg-winux/GWURF/gg_parameters174.htm#GWURF712"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="A1740233"></a>
<div id="GIORA281" class="sect1">
<h2 class="sect1"><span class="secnum">11.5</span> Configuring Classic Capture in Archived Log Only Mode</h2>
<p>You can configure Extract to read exclusively from the archived logs. This is known as <span class="italic">Archived Log Only</span> (ALO) mode. In this mode, Extract reads exclusively from archived logs that are stored in a specified location. ALO mode enables Extract to use production logs that are shipped to a secondary database (such as a standby) as the data source. The online logs are not used at all. Oracle GoldenGate connects to the secondary database to get metadata and other required data as needed. As an alternative, ALO mode is supported on the production system.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
ALO mode is not compatible with Extract operating in integrated capture mode.</div>
<div id="GIORA282" class="sect2"><a id="sthref120"></a>
<h3 class="sect2"><span class="secnum">11.5.1</span> Limitations and Requirements for Using ALO Mode</h3>
<p>Observe the following limitations and requirements when using Extract in ALO mode.</p>
<ul>
<li>
<p>Log resets (<code dir="ltr">RESETLOG</code>) cannot be done on the source database after the standby database is created.</p>
</li>
<li>
<p>ALO cannot be used on a standby database if the production system is Oracle RAC and the standby database is non-RAC. In addition to both systems being Oracle RAC, the number of nodes on each system must be identical.</p>
</li>
<li>
<p>ALO on Oracle RAC requires a dedicated connection to the source server. If that connection is lost, Oracle GoldenGate processing will stop.</p>
</li>
<li>
<p>It is a best practice to use separate archive log directories when using Oracle GoldenGate for Oracle RAC in ALO mode. This will avoid any possibility of the same file name showing up twice, which could result in Extract returning an "out of order scn" error.</p>
</li>
<li>
<p>The <code dir="ltr">LOGRETENTION</code> parameter defaults to <code dir="ltr">DISABLED</code> when Extract is in ALO mode. You can override this with a specific <code dir="ltr">LOGRETENTION</code> setting, if needed.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<div id="GIORA283" class="sect2"><a id="sthref121"></a>
<h3 class="sect2"><span class="secnum">11.5.2</span> Configuring Extract for ALO mode</h3>
<p>To configure Extract for ALO mode, follow these steps as part of the overall process for configuring Oracle GoldenGate, as documented in <a href="config_capt_classic.htm#BABBGIEB">Chapter 8, "Configuring Capture in Classic Mode"</a>.</p>
<ol>
<li>
<p>Enable supplemental logging at the table level and the database level for the tables in the source database. (See <a href="setup.htm#BABFJCCC">Section 3.2, "Configuring Logging Properties"</a>.)</p>
</li>
<li>
<p>When Oracle GoldenGate is running on a different server from the source database, make certain that SQL*Net is configured properly to connect to a remote server, such as providing the correct entries in a <code dir="ltr">TNSNAMES</code> file. Extract must have permission to maintain a SQL*Net connection to the source database.</p>
</li>
<li>
<p>Use a SQL*Net connect string for the name of the user in the credential store that is assigned to the process. Specify the alias of this user in the following:</p>
<ul>
<li>
<p>The <code dir="ltr">USERIDALIAS</code> parameter in the parameter file of every Oracle GoldenGate process that connects to that database.</p>
</li>
<li>
<p>The <code dir="ltr">USERIDALIAS</code> portion of the <code dir="ltr">DBLOGIN</code> command in GGSCI.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you have a standby server that is local to the server that Oracle GoldenGate is running on, you do not need to use a connect string for the user specified in <code dir="ltr">USERIDALIAS</code>. You can just supply the user login name.</div>
<p>See <a class="olink GWUAD354" href="../../gg-winux/GWUAD/wu_security.htm#GWUAD354"><span class="italic">Administering Oracle GoldenGate for Windows and UNIX</span></a> for more information about using a credential store.</p>
</li>
<li>
<p>Use the Extract parameter <code dir="ltr">TRANLOGOPTIONS</code> with the <code dir="ltr">ARCHIVEDLOGONLY</code> option. This option forces Extract to operate in ALO mode against a primary or logical standby database, as determined by a value of <code dir="ltr">PRIMARY</code> or <code dir="ltr">LOGICAL</code> <code dir="ltr">STANDBY</code> in the <code dir="ltr">db_role</code> column of the <code dir="ltr">v$database</code> view. The default is to read the online logs. <code dir="ltr">TRANLOGOPTIONS</code> with <code dir="ltr">ARCHIVEDLOGONLY</code> is not needed if using ALO mode against a physical standby database, as determined by a value of <code dir="ltr">PHYSICAL</code> <code dir="ltr">STANDBY</code> in the <code dir="ltr">db_role</code> column of <code dir="ltr">v$database</code>. Extract automatically operates in ALO mode if it detects that the database is a physical standby.</p>
</li>
<li>
<p>Other <code dir="ltr">TRANLOGOPTIONS</code> options might be required for your environment. For example, depending on the copy program that you use, you might need to use the <code dir="ltr">COMPLETEARCHIVEDLOGONLY</code> option to prevent Extract errors.</p>
</li>
<li>
<p>Use the <code dir="ltr">MAP</code> parameter for Extract to map the table names to the source object IDs. For more information, see <a class="olink GWURF546" href="../../gg-winux/GWURF/gg_parameters160.htm#GWURF546"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>.</p>
</li>
<li>
<p>Add the Extract group by issuing the <code dir="ltr">ADD EXTRACT</code> command with a timestamp as the <code dir="ltr">BEGIN</code> option, or by using <code dir="ltr">ADD EXTRACT</code> with the <code dir="ltr">SEQNO</code> and <code dir="ltr">RBA</code> options. It is best to give Extract a known start point at which to begin extracting data, rather than by using the <code dir="ltr">NOW</code> argument. The start time of <code dir="ltr">NOW</code> corresponds to the time of the current <span class="italic">online</span> redo log, but an ALO Extract cannot read the online logs, so it must wait for that log to be archived when Oracle switches logs. The timing of the switch depends on the size of the redo logs and the volume of database activity, so there might be a lag between when you start Extract and when data starts being captured. This can happen in both regular and RAC database configurations.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="A4948274"></a>
<div id="GIORA997" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">11.6</span> Configuring Classic Capture in Oracle Active Data Guard Only Mode</h2>
<p>You can configure classic Extract to access both redo data and metadata in real-time to successfully replicate source database activities using Oracle Active Data Guard. This is known as <span class="italic">Active Data Guard</span> (ADG) mode. ADG mode enables Extract to use production logs that are shipped to a standby database as the data source. The online logs are not used as all. Oracle GoldenGate connects to the standby database to get metadata and other required data as needed.</p>
<p>This mode is useful in load sensitive environments where ADG is already in place or can be implemented. It can also be used as cost effective method to implement high availability using the ADG Broker role planned (switchover) and failover (unplanned) changes. In an ADG configuration, switchover and failover are considered <span class="italic">roles</span>. When either of the operations occur, it is considered a <span class="italic">role change</span>. For more information, see <a class="olink SBYDB" href="http://www.oracle.com/pls/topic/lookup?ctx=gg1212&amp;id=SBYDB"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> and <a class="olink DGBKR" href="http://www.oracle.com/pls/topic/lookup?ctx=gg1212&amp;id=DGBKR"><span class="italic">Oracle Data Guard Broker</span></a>.</p>
<div id="GIORA998" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref122"></a>
<h3 class="sect2"><span class="secnum">11.6.1</span> Limitations and Requirements for Using ADG Mode</h3>
<p>Observe the following limitations and requirements when using Extract in ADG mode.</p>
<ul>
<li>
<p>Extract in ADG mode will only apply redo data that has been applied to the standby database by the apply process. If Extract runs ahead of the standby database, it will wait for the standby database to catch up.</p>
</li>
<li>
<p>You must explicitly specify ADG mode in your classic Extract parameter file to run extract on the standby database.</p>
</li>
<li>
<p>You must specify the database user and password to connect to the ADG system because fetch and other metadata resolution occurs in the database.</p>
</li>
<li>
<p>The number of redo threads in the standby logs in the standby database must match the number of nodes from the primary database.</p>
</li>
<li>
<p>No new RAC instance can be added to the primary database after classic Extract has been created on the standby database. If you do add new instances, the redo data from the new thread will not be captured by classic Extract.</p>
</li>
<li>
<p>Archived logs and standby redo logs accessed from the standby database will be an exact duplicate of the primary database. The size and the contents will match, including redo data, transactional data, and supplemental data. This is guaranteed by a properly configured ADG deployment.</p>
</li>
<li>
<p>ADG role changes are infrequent and require user intervention in both cases.</p>
</li>
<li>
<p>With a switchover, there will be an indicator in the redo log file header (end of the redo log or EOR marker) to indicate end of log stream so that classic Extract on the standby can complete the RAC coordination successfully and ship all of the committed transactions to the trail file.</p>
</li>
<li>
<p>With a failover, a new incarnation is created on both the primary and the standby databases with a new incarnation ID, <code dir="ltr">RESETLOG</code> sequence number, and SCN value.</p>
</li>
<li>
<p>You must connect to the primary database from GGSCI to add <code dir="ltr">TRANDATA</code> or <code dir="ltr">SCHEMATRANDATA</code> because this is done on the primary database.</p>
</li>
<li>
<p>DDL triggers cannot be used on the standby database, in order to support DDL replication (except <code dir="ltr">ADDTRANDATA</code>). You must install the Oracle GoldenGate DDL package on the primary database.</p>
</li>
<li>
<p>DDL <code dir="ltr">ADDTRANDATA</code> is not supported in ADG mode; you must use <code dir="ltr">ADDSCHEMATRANDATA</code> for DDL replication.</p>
</li>
<li>
<p>When adding extract on the standby database, you must specify the starting position using a specific SCN value, timestamp, or log position. Relative timestamp values, such as <code dir="ltr">NOW</code>, become ambiguous and may lead to data inconsistency.</p>
</li>
<li>
<p>When adding extract on the standby database, you must specify the number of threads that will include all of the relevant threads from the primary database.</p>
</li>
<li>
<p>During or after failover or switchover, no thread can be added or dropped from either primary or standby databases.</p>
</li>
<li>
<p>Classic Extract will only use one intervening <code dir="ltr">RESETLOG</code> operation.</p>
</li>
<li>
<p>If you do not want to relocate your Oracle GoldenGate installation, then you must position it in a shared space where the Oracle GoldenGate installation directory can be accessed from both the primary and standby databases.</p>
</li>
<li>
<p>If you are moving capture off of an ADG standby database to a primary database, then you must point your net alias to the primary database and you must remove the <code dir="ltr">TRANLOG</code> options.</p>
</li>
<li>
<p>Only Oracle Database releases that are running with compatibility setting of 10.2 or higher (10g Release 2) are supported.</p>
</li>
<li>
<p>Classic Extract cannot use the <code dir="ltr">DBLOGREADER</code> option. Use <code dir="ltr">ASMUSER</code> (there is approximately a 20gb/hr read limit) or move the online and archive logs outside of the Application Security Manager on both the primary and the standby databases.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<div id="GIORA999" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref123"></a>
<h3 class="sect2"><span class="secnum">11.6.2</span> Configuring Extract for ADG Mode</h3>
<p>To configure Extract for ADG mode, follow these steps as part of the overall process for configuring Oracle GoldenGate, as documented in <a href="config_capt_classic.htm#BABBGIEB">Chapter 8, "Configuring Capture in Classic Mode."</a></p>
<ol>
<li>
<p>Enable supplemental logging at the table level and the database level for the tables in the <span class="italic">primary</span> database using the <code dir="ltr">ADD SCHEMATRANDATA</code> parameter. If necessary, create a DDL capture. (See <a href="setup.htm#BABFJCCC">Section 3.2, "Configuring Logging Properties"</a>.)</p>
</li>
<li>
<p>When Oracle GoldenGate is running on a different server from the source database, make certain that SQL*Net is configured properly to connect to a remote server, such as providing the correct entries in a <code dir="ltr">TNSNAMES</code> file. Extract must have permission to maintain a SQL*Net connection to the source database.</p>
</li>
<li>
<p>On the <span class="italic">standby</span> database, use the Extract parameter <code dir="ltr">TRANLOGOPTIONS</code> with the <code dir="ltr">MINEFROMACTIVEDG</code> option. This option forces Extract to operate in ADG mode against a standby database, as determined by a value of <code dir="ltr">PRIMARY</code> or <code dir="ltr">LOGICAL</code> <code dir="ltr">STANDBY</code> in the <code dir="ltr">db_role</code> column of the <code dir="ltr">v$database</code> view.</p>
<p>Other <code dir="ltr">TRANLOGOPTIONS</code> options might be required for your environment. For example, depending on the copy program that you use, you might need to use the <code dir="ltr">COMPLETEARCHIVEDLOGONLY</code> option to prevent Extract errors.</p>
</li>
<li>
<p>On the <span class="italic">standby</span> database, add the Extract group by issuing the <code dir="ltr">ADD EXTRACT</code> command specifying the number of threads active on the <span class="italic">primary</span> database at the given SCN. The timing of the switch depends on the size of the redo logs and the volume of database activity, so there might be a limited lag between when you start Extract and when data starts being captured. This can happen in both regular and RAC database configurations.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA1000" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref124"></a>
<h3 class="sect2"><span class="secnum">11.6.3</span> Migrating Classic Extract To and From an ADG Database</h3>
<p>You must have your parameter files, checkpoint files, bounded recovery files, and trail files are stored in shared storage or copied to the ADG database before attempting to migrate a classic Extract to or from an ADG database. Additionally, you must ensure that there has not been any intervening role change or Extract will be mining the same branch of redo.</p>
<p>Use the following steps to move to an ADG database:</p>
<ol>
<li>
<p>Edit the parameter file <code dir="ltr">ext1.prm</code> to add the following parameters:</p>
<pre dir="ltr">
DBLOGIN USERID <span class="italic">userid</span>@ADG PASSWORD <span class="italic">password</span>
TRANLOGOPTIONS MINEFROMACTIVEDG
</pre></li>
<li>
<p>Start Extract by issuing the <code dir="ltr">START EXTRACT ext1</code> command.</p>
</li>
</ol>
<p>Use the following steps to move from an ADG database:</p>
<ol>
<li>
<p>Edit the parameter file <code dir="ltr">ext1.prm</code> to remove the following parameters:</p>
<pre dir="ltr">
DBLOGIN USERID <span class="italic">userid</span>@ADG PASSWORD <span class="italic">password</span>
TRANLOGOPTIONS MINEFROMACTIVEDG
</pre></li>
<li>
<p>Start Extract by issuing the <code dir="ltr">START EXTRACT ext1</code> command.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div id="GIORA1001" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref125"></a>
<h3 class="sect2"><span class="secnum">11.6.4</span> Handling Role Changes In an ADG Configuration</h3>
<p>In a role change involving a standby database, all sessions in the primary and the standby database are first disconnected including the connections used by Extract. Then both databases are shut down, then the original primary is mounted as a standby database, and the original standby is opened as the primary database.</p>
<p>The procedure for a role change is determined by the initial deployment of Classic Extract and the deployment relation that you want, database or role. The following table outlines the four possible role changes and is predicated on an ADG configuration comprised of two databases, prisys and stansys. The prisys system contains the primary database and the stansys system contains the standby database; prisys has two redo threads active, whereas stansys has four redo threads active.</p>
<div class="inftblinformal">
<table class="cellalignment245" summary="adg table">
<thead>
<tr class="cellalignment234">
<th class="cellalignment246" id="r1c1-t15">Initial Deployment Primary (prisys)</th>
<th class="cellalignment246" id="r1c2-t15">Initial Deployment ADG (stansys)</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment234">
<td class="cellalignment240" id="r2c1-t15" headers="r1c1-t15 r1c2-t15" colspan="2"><span class="bold">Original Deployment:</span></td>
</tr>
<tr class="cellalignment234">
<td class="cellalignment240" id="r3c1-t15" headers="r1c1-t15">
<pre dir="ltr">
ext1.prm
DBLOGIN USERID <span class="italic">userid</span>@prisys, PASSWORD <span class="italic">password</span>
</pre></td>
<td class="cellalignment240" headers="r3c1-t15 r1c2-t15">
<pre dir="ltr">
ext1.prm
DBLOGIN USERID <span class="italic">userid</span>@stansys, PASSWORD <span class="italic">password</span>
TRANLOGOPTIONS MINEFROMACTIVEDG
</pre></td>
</tr>
<tr class="cellalignment234">
<td class="cellalignment240" id="r4c1-t15" headers="r1c1-t15 r1c2-t15" colspan="2"><span class="bold">Database Related:</span></td>
</tr>
<tr class="cellalignment234">
<td class="cellalignment240" id="r5c1-t15" headers="r1c1-t15"><span class="underline">After Role Transition: Classic Extract to ADG</span>
<ol>
<li>
<p>Edit the <code dir="ltr">ext1.prm</code> file to add:</p>
<p><code dir="ltr">TRANLOGOPTIONS MINEFROMACTIVEDG</code></p>
</li>
<li>
<p>If a failover, add <code dir="ltr">TRANLOGOPTIONS USEPREVRESETLOGSID</code>.</p>
</li>
<li>
<p>Start Extract:</p>
<p><code dir="ltr">START EXTRACT ext1</code></p>
<p>Extract will abend once it reaches the role transition point, then it does an internal <code dir="ltr">BR_RESET</code> and moves both the I/O checkpoint and current checkpoint to SCN <span class="italic">s</span>.</p>
</li>
<li>
<p>If failover, edit the parameter file again and remove:</p>
<p><code dir="ltr">TRANLOGOPTIONS USEPREVRESETLOGSID</code></p>
</li>
<li>
<p>Execute <code dir="ltr">ALTER EXTRACT ext1 SCN</code> <code dir="ltr">#</code>, where <code dir="ltr"><span class="codeinlineitalic">#</span></code> is the SCN value from role switch message.</p>
</li>
<li>
<p>Based on the thread counts, do one of the following:</p>
<p>If the thread counts are same between the databases, then execute the <code dir="ltr">START EXTRACT ext1;</code> command.</p>
<p>or</p>
<p>If thread counts are different between the databases, then execute the following commands:</p>
<p><code dir="ltr">DROP EXTRACT ext1</code></p>
<p><code dir="ltr">ADD EXTRACT ext1 THREADS t BEGIN SCN s</code></p>
<p><code dir="ltr">START EXTRACT ext1</code></p>
</li>
</ol>
</td>
<td class="cellalignment240" headers="r5c1-t15 r1c2-t15"><span class="underline">After Role Transition: ADG to classic Extract</span>
<ol>
<li>
<p>Edit <code dir="ltr">ext1.prm</code> and remove:</p>
<p><code dir="ltr">TRANLOGOPTIONS MINEFROMACTIVEDG</code></p>
</li>
<li>
<p>If a failover, add <code dir="ltr">TRANLOGOPTIONS USEPREVRESETLOGSID</code>.</p>
</li>
<li>
<p>Start Extract:</p>
<p><code dir="ltr">START EXTRACT ext1</code></p>
<p>Extract will abend once it reaches the role transition point, then it does an internal <code dir="ltr">BR_RESET</code> and moves both the I/O checkpoint and current checkpoint to SCN <span class="italic">s</span>.</p>
</li>
<li>
<p>If failover, edit the parameter file again and remove:</p>
<p><code dir="ltr">TRANLOGOPTIONS USEPREVRESETLOGSID</code></p>
</li>
<li>
<p>Execute <code dir="ltr">ALTER EXTRACT ext1 SCN</code> <code dir="ltr"><span class="codeinlineitalic">#</span></code>, where <code dir="ltr"><span class="codeinlineitalic">#</span></code> is the SCN value from role switch message.</p>
</li>
<li>
<p>Based on the thread counts, do one of the following:</p>
<p>If the thread counts are same between the databases, then execute the <code dir="ltr">START EXTRACT ext1;</code> command.</p>
<p>or</p>
<p>If thread counts are different between the databases, then execute the following commands:</p>
<p><code dir="ltr">DROP EXTRACT ext1</code></p>
<p><code dir="ltr">ADD EXTRACT ext1 THREADS t BEGIN SCN s</code></p>
<p><code dir="ltr">START EXTRACT ext1</code></p>
</li>
</ol>
</td>
</tr>
<tr class="cellalignment234">
<td class="cellalignment240" id="r6c1-t15" headers="r1c1-t15 r1c2-t15" colspan="2"><span class="bold">Role Related:</span></td>
</tr>
<tr class="cellalignment234">
<td class="cellalignment240" id="r7c1-t15" headers="r1c1-t15"><span class="underline">After Role Transition: Classic Extract to classic Extract</span>
<ol>
<li>
<p>Edit <code dir="ltr">ext1.prm</code> to change the database system to the standby system:</p>
<p><code dir="ltr">DBLOGIN USERID userid@stansys, PASSWORD</code> <code dir="ltr"><span class="codeinlineitalic">password</span></code></p>
</li>
<li>
<p>If a failover, add <code dir="ltr">TRANLOGOPTIONS USEPREVRESETLOGSID</code>.</p>
</li>
<li>
<p>Start Extract:</p>
<p><code dir="ltr">START EXTRACT ext1</code></p>
<p>Extract will abend once it reaches the role transition point, then it does an internal <code dir="ltr">BR_RESET</code> and moves both the I/O checkpoint and current checkpoint to SCN s.</p>
</li>
<li>
<p>If failover, edit the parameter file again and remove:</p>
<p><code dir="ltr">TRANLOGOPTIONS USEPREVRESETLOGSID</code></p>
</li>
<li>
<p>Execute <code dir="ltr">ALTER EXTRACT ext1 SCN</code> <code dir="ltr"><span class="codeinlineitalic">#</span></code>, where<code dir="ltr"><span class="codeinlineitalic">#</span></code> is the SCN value from role switch message.</p>
</li>
<li>
<p>Based on the thread counts, do one of the following:</p>
<p>If the thread counts are same between the databases, then execute the <code dir="ltr">START EXTRACT ext1;</code> command.</p>
<p>or</p>
<p>If thread counts are different between the databases, then execute the following commands:</p>
<p><code dir="ltr">DROP EXTRACT ext1</code></p>
<p><code dir="ltr">ADD EXTRACT ext1 THREADS t BEGIN SCN s</code></p>
<p><code dir="ltr">START EXTRACT ext1</code></p>
</li>
</ol>
</td>
<td class="cellalignment240" headers="r7c1-t15 r1c2-t15"><span class="underline">After Role Transition: ADG to ADG</span>
<ol>
<li>
<p>Edit <code dir="ltr">ext1.prm</code> to change the database system to the primary system:</p>
<p><code dir="ltr">DBLOGIN USERID userid@prisys, PASSWORD</code> <code dir="ltr"><span class="codeinlineitalic">password</span></code></p>
</li>
<li>
<p>If a failover, add <code dir="ltr">TRANLOGOPTIONS USEPREVRESETLOGSID</code>.</p>
</li>
<li>
<p>Start Extract:</p>
<p><code dir="ltr">START EXTRACT ext1</code></p>
<p>Extract will abend once it reaches the role transition point, then it does an internal <code dir="ltr">BR_RESET</code> and moves both the I/O checkpoint and current checkpoint to SCN <span class="italic">s</span>.</p>
</li>
<li>
<p>If failover, edit the parameter file again and remove:</p>
<p><code dir="ltr">TRANLOGOPTIONS USEPREVRESETLOGSID</code></p>
</li>
<li>
<p>Execute <code dir="ltr">ALTER EXTRACT ext1 SCN</code> <code dir="ltr"><span class="codeinlineitalic">#</span></code>, where<code dir="ltr"><span class="codeinlineitalic">#</span></code> is the SCN value from role switch message.</p>
</li>
<li>
<p>Based on the thread counts, do one of the following:</p>
<p>If the thread counts are same between the databases, then execute the <code dir="ltr">START EXTRACT ext1;</code> command.</p>
<p>or</p>
<p>If thread counts are different between the databases, then execute the following commands:</p>
<p><code dir="ltr">DROP EXTRACT ext1</code></p>
<p><code dir="ltr">ADD EXTRACT ext1 THREADS t BEGIN SCN s</code></p>
<p><code dir="ltr">START EXTRACT ext1</code></p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="A1743274"></a>
<div id="GIORA284" class="sect1">
<h2 class="sect1"><span class="secnum">11.7</span> Avoiding Log-read Bottlenecks in Classic Capture</h2>
<p>When Oracle GoldenGate captures data from the redo logs, I/O bottlenecks can occur because Extract is reading the same files that are being written by the database logging mechanism. Performance degradation increases with the number of Extract processes that read the same logs. You can:</p>
<ul>
<li>
<p>Try using faster drives and a faster controller. Both Extract and the database logging mechanism will be faster on a faster I/O system.</p>
</li>
<li>
<p>Store the logs on RAID 0+1. Avoid RAID 5, which performs checksums on every block written and is not a good choice for high levels of continuous I/O.</p>
</li>
</ul>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment233">
<tr>
<td class="cellalignment240"><table class="cellalignment238">
<tr>
<td class="cellalignment237"><a href="additional_config.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>

<td class="cellalignment237"><a href="nonint_replicat.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table></td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2010, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment242">
<table class="cellalignment236">
<tr>
<td class="cellalignment237"><a href="../../index.html"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment237"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment237"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
</body>
</html>
