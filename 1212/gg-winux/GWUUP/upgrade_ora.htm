<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml/DTD/xhtml1-transitional.dtd">
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>2 Upgrading to Version 12.1.2 for Oracle Database</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1056" />
<meta name="description" content="These instructions are for upgrading Oracle GoldenGate to version 12c for an Oracle Database." />
<meta name="dcterms.created" content="2015-06-19T7:59:8Z" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Oracle&reg; GoldenGate Upgrading Oracle GoldenGate for Windows and UNIX" />
<meta name="dcterms.identifier" content="E40011-05" />
<meta name="dcterms.isVersionOf" content="GWUUP" />
<link rel="Start" href="../../index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="upgrade.htm" title="Previous" type="text/html" />
<link rel="Next" href="upgrade_other.htm" title="Next" type="text/html" />
<link rel="alternate" href="../GWUUP.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="../GWUUP.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="../GWUUP.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Skip Headers</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns"><div id="BREADCRUMBS"><a href="http://docs.oracle.com">Home</a> / <a href="../../index.html">Middleware</a> / <a href="../index.html">Oracle GoldenGate for Windows and UNIX</a>
</div>

<span id="PAGE" style="display:none;">5/7</span>
<!-- End Header -->
<script  >
<!-- // <![CDATA[
window.name='upgrade_ora'
// ]]> -->
</script> <script  >
// <![CDATA[
function footdisplay(footnum,footnote) {
    var msg = window.open('', 'NewWindow' + footnum,
        'directories=no,height=120,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');

    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>');
    msg.document.write('Footnote ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('');
    msg.document.write('<style> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><h1>Footnote ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/body><\/html>');
    msg.document.close();
    msg.focus();
}
// ]]>
</script> <noscript>
<p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
</noscript>
<div id="GWUUP119" class="chapter"><a id="sthref11"></a>
<h1 class="chapter"><span class="secnum">2</span> Upgrading to Version 12.1.2 for Oracle Database</h1>
<p><a id="GWUUP120"></a>These instructions are for upgrading Oracle GoldenGate to version 12<span class="italic">c</span> for an Oracle Database.</p>
<p>This chapter includes the following sections:</p>
<ul>
<li>
<p><a href="#CACGEGCC">Overview of the Upgrade Procedure for Oracle Database</a></p>
</li>
<li>
<p><a href="#CACHCEFG">Upgrading a Configuration that Includes DDL Support</a></p>
</li>
<li>
<p><a href="#A1973223">Understanding the Scope of the Upgrade Procedure</a></p>
</li>
<li>
<p><a href="#A1977697">Downloading Oracle GoldenGate</a></p>
</li>
<li>
<p><a href="#CFHIJCCI">Preparing to Patch</a></p>
</li>
<li>
<p><a href="#CFHIGEAC">Installing the Patch</a></p>
</li>
<li>
<p><a href="#A1974289">Performing the Upgrade to Version 12.1.2 for Oracle Database</a></p>
</li>
</ul>
<a id="CACGEGCC"></a>
<div id="GWUUP121" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">2.1</span> Overview of the Upgrade Procedure for Oracle Database</h2>
<p>The upgrade instructions perform a minimal upgrade that deploys only the updated core functionality, without implementing any of the major new 12.1.2 features at this time, such as integrated Replicat, updated globalization support, new SQL-92 defaults, and enhanced security features. It is best practice to perform a minimal upgrade first, so that you can trouble shoot more easily in the event that any problems arise. Once you know your environment is upgraded successfully, you can implement the new functionality.</p>
<p>The upgrade instructions also take into consideration the steps to take if you are upgrading the source or target database at the same time that you are upgrading Oracle GoldenGate. Taken into account are the following pre-upgrade requirements:</p>
<ul>
<li>
<p>Allow the Oracle GoldenGate processes to finish processing all current DML and DDL data in the Oracle GoldenGate trails.</p>
</li>
<li>
<p>Disable the DDL trigger.</p>
</li>
<li>
<p>Upgrade the databases before upgrading Oracle GoldenGate.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CACHCEFG"></a>
<div id="GWUUP122" class="sect1">
<h2 class="sect1"><span class="secnum">2.2</span> Upgrading a Configuration that Includes DDL Support</h2>
<p>This section contains considerations and steps you should take when DDL support is active in the current Oracle GoldenGate environment. DDL support in Oracle GoldenGate v12 offers two options:</p>
<ul>
<li>
<p>Integrated mode in version 12c of Oracle GoldenGate supports two DDL capture methods:</p>
<ul>
<li>
<p>If the source database is Oracle 11.2.0.4 or later, DDL capture support is integrated into the database logmining server and does not require the use of the Oracle GoldenGate DDL trigger and supporting objects, as long as the database <code dir="ltr">COMPATIBLE</code> parameter is set to 11.2.0.4 or higher.</p>
</li>
<li>
<p>If the source database is earlier than Oracle 11.2.0.4, the Oracle GoldenGate trigger and supporting DDL objects must be used when Extract is in integrated mode.</p>
</li>
</ul>
</li>
<li>
<p>Classic capture requires the use of the Oracle GoldenGate DDL trigger and supporting objects regardless of the Oracle version of the source database.</p>
</li>
</ul>
<p><a href="#CIAEDJBG">Table 2-1</a> shows possible DDL upgrade paths and guidelines.</p>
<div id="GWUUP123" class="tblhruleformalwide"><p class="titleintable"><a id="sthref12"></a><a id="CIAEDJBG"></a>Table 2-1 Possible Upgrade Paths to 12c and Requirements for DDL Support</p>
<table class="cellalignment133" title="Possible Upgrade Paths to 12c and Requirements for DDL Support" summary="This table shows the possible upgrade paths and requirements for DDL support. It has separate columns for upgrading to classic capture using trigger method and to integrated capture, no trigger.">
<thead>
<tr class="cellalignment122">
<th class="cellalignment134" id="r1c1-t2">Upgrade from:</th>
<th class="cellalignment134" id="r1c2-t2">To: Classic capture 12c using trigger method</th>
<th class="cellalignment134" id="r1c3-t2">To: Integrated capture 12c, no trigger<a id="sthref13" href="#sthref13" onclick='footdisplay(1,"An upgrade of the database to 11.2.0.4 or 12.1 automatically takes a data dictionary snapshot in the redo stream as part of the patch set upgrade.")'><sup class="tablefootnote">Foot&nbsp;1&nbsp;</sup></a></th>
</tr>
</thead>
<tbody>
<tr class="cellalignment122">
<td class="cellalignment128" id="r2c1-t2" headers="r1c1-t2">
<p>Classic capture using trigger method (all 11.2.1 database versions)</p>
</td>
<td class="cellalignment128" headers="r2c1-t2 r1c2-t2">
<p>Cannot be used for a container database.</p>
<p>Upgrade Oracle GoldenGate per these upgrade instructions.</p>
</td>
<td class="cellalignment128" headers="r2c1-t2 r1c3-t2">
<p>Can be used for a container database.</p>
<ol>
<li>
<p>Source database must be 11.2.0.4 or higher.</p>
</li>
<li>
<p>Source database <code dir="ltr">COMPATIBLE</code> setting must be 11.2.0.4 or higher.</p>
</li>
<li>
<p>Upgrade Oracle GoldenGate per these upgrade instructions.</p>
</li>
</ol>
</td>
</tr>
<tr class="cellalignment122">
<td class="cellalignment128" id="r3c1-t2" headers="r1c1-t2">
<p>Integrated capture using trigger method (all 11.2.1 database versions)</p>
</td>
<td class="cellalignment128" headers="r3c1-t2 r1c2-t2">
<p>Cannot be used for a container database.</p>
<p>No DDL upgrade path.</p>
</td>
<td class="cellalignment128" headers="r3c1-t2 r1c3-t2">
<p>Can be used for a container database.</p>
<ol>
<li>
<p>Source database must be 11.2.0.4 or higher.</p>
</li>
<li>
<p>Source database <code dir="ltr">COMPATIBLE</code> setting must be 11.2.0.4 or higher.</p>
</li>
<li>
<p>Upgrade Oracle GoldenGate per these upgrade instructions.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformalwide" -->
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1&nbsp;</sup>An upgrade of the database to 11.2.0.4 or 12.1 automatically takes a data dictionary snapshot in the redo stream as part of the patch set upgrade.</p>
</div>
<!-- class="sect1" -->
<a id="A1973223"></a>
<div id="GWUUP124" class="sect1">
<h2 class="sect1"><span class="secnum">2.3</span> Understanding the Scope of the Upgrade Procedure</h2>
<p>Before performing the upgrade, review the following information about upgrading Extract and Replicat. Even though you may only be upgrading Extract or Replicat, rather than both, all processes are involved in the upgrade. All processes must be stopped in the correct order for the upgrade, regardless of which component you upgrade, and the trails must be processed until empty.</p>
<div id="GWUUP125" class="sect2"><a id="sthref14"></a>
<h3 class="sect2"><span class="secnum">2.3.1</span> Extract Upgrade Considerations</h3>
<p>Most of these instructions pertain to the Extract portion of the upgrade. If you are using trigger-based DDL support, you must rebuild the DDL objects, even if you plan to use the new triggerless DDL support in integrated capture. After the upgrade, when Oracle GoldenGate is running successfully again, you can follow the steps in this documentation to remove the trigger and DDL objects. See <a href="#CACHCEFG">Section 2.2, "Upgrading a Configuration that Includes DDL Support"</a> for DDL upgrade considerations.</p>
<p>If you are upgrading multiple Extract processes that operate in a consolidation configuration (many sources to one target), follow these steps fully to upgrade one Extract at a time.</p>
<p>If you are using integrated capture, you will need to roll over the local and remote trails at the appropriate point in the upgrade steps. The 11.2.1 integrated Extract (version 1) captures <code dir="ltr">TIMESTAMP WITH LOCAL TIME ZONE</code> data as UTC, but the 12.1.2 integrated Extract (version 2) captures it as the local time of the database time zone.</p>
</div>
<!-- class="sect2" -->
<div id="GWUUP126" class="sect2"><a id="sthref15"></a>
<h3 class="sect2"><span class="secnum">2.3.2</span> Replicat Upgrade Considerations</h3>
<p>All Replicat installations should be upgraded at the same time. It is critical to ensure that all trails leading to all Replicat groups on all target systems are processed until empty, according to the upgrade instructions.</p>
<div class="infoboxnotewarn">
<p class="notep1">Caution:</p>
The hash calculation used by the @RANGE function to partition data among Replicat processes has been changed. This change is transparent, and no re-partitioning of rows in the parameter files is required, so long as the upgrade is performed as directed in these instructions. To ensure data continuity, make certain to allow all Replicat processes on all systems to finish processing all of the data in their trails before stopping those processes, according to the upgrade instructions. Note that if the Replicat processes are not upgraded all at the same time, or the trails are not cleaned out prior to the upgrade, rows may shift partitions as a result of the new hash method, which may result in collision errors.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="A1977697"></a>
<div id="GWUUP127" class="sect1">
<h2 class="sect1"><span class="secnum">2.4</span> Downloading Oracle GoldenGate</h2>
<p>Download the appropriate Oracle GoldenGate build to each system that will be part of the Oracle GoldenGate configuration.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you have not upgraded to Oracle GoldenGate release 12.1.2.1.0 or greater, you must do so using the following steps.
<p>Once you have successfully upgraded, you use the same steps to apply any OPatches.</p>
</div>
<ol>
<li>
<p>Using a browser, navigate to <code dir="ltr"><a href="http://support.oracle.com">http://support.oracle.com</a><a href=""></a></code>.</p>
</li>
<li>
<p>Log in with your Oracle ID and password.</p>
</li>
<li>
<p>Select the <span class="gui-object-action">Patches and Upgrades</span> tab.</p>
</li>
<li>
<p>On the Search tab, click <span class="gui-object-action">Product or Family</span>.</p>
</li>
<li>
<p>In the <code dir="ltr">Product</code> field, type <span class="bold">Oracle GoldenGate</span>.</p>
</li>
<li>
<p>From the Release drop-down list, select the release version that you want to download.</p>
</li>
<li>
<p>Make certain that <span class="gui-object-action">Platform</span> is displayed as the default in the next field, and then select the platform from the drop-down list.</p>
</li>
<li>
<p>Leave the last field blank.</p>
</li>
<li>
<p>Click <span class="gui-object-action">Search</span>.</p>
</li>
<li>
<p>In the Patch Advanced Search Results list, select the patch that best meets your search criteria, making certain that the Oracle GoldenGate patch that you select corresponds to the version of the database that will be used.</p>
<p>When you select the build, a dialog box pops up under the build description, and then you are advanced to the download page.</p>
</li>
<li>
<p>Click the Patch file name link for each patch that you want to download. The File Download dialog box appears.</p>
</li>
<li>
<p>Select either <span class="bold">Open with</span> or <span class="bold">Save File</span>:</p>
<div class="inftblhruleinformal">
<table class="cellalignment133" summary="This is a two-column decision table that lists system behavior based on the option you decide to use.">
<thead>
<tr class="cellalignment122">
<th class="cellalignment134" id="r1c1-t5">To...</th>
<th class="cellalignment134" id="r1c2-t5">Select...</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment122">
<td class="cellalignment128" id="r2c1-t5" headers="r1c1-t5">Extract the patch immediately</td>
<td class="cellalignment128" headers="r2c1-t5 r1c2-t5"><span class="bold">Open with</span>, then select the desired file extraction utility and extract the files to a location on your file system.</td>
</tr>
<tr class="cellalignment122">
<td class="cellalignment128" id="r3c1-t5" headers="r1c1-t5">Save the patch for later extraction</td>
<td class="cellalignment128" headers="r3c1-t5 r1c2-t5">Select <span class="bold">Save file</span>, then save to a directory on your file system.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblhruleinformal" --></li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
Before installing the software, see <a class="olink ggwurelnotes" href="http://www.oracle.com/pls/topic/lookup?ctx=gg1212&amp;id=ggwurelnotes"><span class="italic">Release Notes for Oracle GoldenGate for Windows and UNIX</span></a> for any new features, parameter changes, upgrade requirements, or bug fixes that affect your current configuration. Review the readme file for known issues.</div>
</div>
<!-- class="sect1" -->
<a id="CFHIJCCI"></a>
<div id="GWUUP142" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">2.5</span> Preparing to Patch</h2>
<p>Once the patch is downloaded, you need to prepare your environment before you can install it (you need to meet these prerequisites prior to deinstalling, too). To do so, ensure that your system meets the following requirements:</p>
<ol>
<li>
<p>Ensure that the Oracle GoldenGate version on which you are installing the patch or from which you are rolling back the patch is Oracle GoldenGate release 12.1.2 for Oracle.</p>
</li>
<li>
<p>Use the latest version of OPatch. If you do not have the latest version, follow the instructions outlined in the My Oracle Support note 224346.1, available at:</p>
<p><a href="https://support.oracle.com/CSP/main/article?cmd=show/&amp;type=NOT/&amp;id=224346.1"><code dir="ltr">https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=224346.1"&gt;&gt;https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=224346.1</code></a></p>
</li>
<li>
<p>Set the <code dir="ltr">ORACLE_HOME</code> environment variable to the Oracle GoldenGate installation directory, which is referred to as <code dir="ltr">ORACLE_HOME</code>.</p>
</li>
<li>
<p>Set the <code dir="ltr">PATH</code> environment variable to include the location of the unzip executable, and the <code dir="ltr">ORACLE_HOME</code> and the <code dir="ltr">ORACLE_HOME/OPatch</code> directories present in the Oracle GoldenGate home.</p>
</li>
<li>
<p>Verify the Oracle Inventory, which OPatch accesses to install the patches. To verify the inventory, run the following command:</p>
<pre dir="ltr">
$ opatch lsinventory
</pre>
<p>If the command displays any errors, contact Oracle Support and resolve the issue.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CFHIGEAC"></a>
<div id="GWUUP143" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">2.6</span> Installing the Patch</h2>
<p>To install the patch, use this procedure:</p>
<ol>
<li id="CFHHBJHC">
<p>Maintain a location for storing the contents of the patch ZIP file. In the rest of the document, this location (absolute path) is referred to as <code dir="ltr">PATCH_TOP_DIR</code>.</p>
</li>
<li>
<p>Extract the contents of the patch ZIP file to the location you created in step <a href="#CFHHBJHC">1</a>.</p>
<p>For example:</p>
<pre dir="ltr">
$ PATCH_TOP_DIR p14309369_112101_Solaris86-64.zip
</pre></li>
<li>
<p>Stop Oracle GoldenGate by doing the following:</p>
<ol>
<li>
<p>Run GGSCI.</p>
</li>
<li>
<p>Stop Manager by running the command:</p>
<pre dir="ltr">
STOP MANAGER
</pre></li>
<li>
<p>Stop all Oracle GoldenGate processes by running the command:</p>
<pre dir="ltr">
STOP ER *
</pre></li>
</ol>
</li>
<li>
<p>Navigate to the <code dir="ltr">PATCH_TOP_DIR</code>/<span class="italic">Patch_number</span> directory:</p>
<pre dir="ltr">
        $ cd PATCH_TOP_DIR/<span class="italic">Patch_number</span>
</pre></li>
<li>
<p>Install the patch by running the following command:</p>
<pre dir="ltr">
        $ opatch apply
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
When OPatch starts, it validates the patch and ensures that there are no conflicts with the software already installed in the <code dir="ltr">ORACLE_HOME</code> of the Oracle GoldenGate release. OPatch categorizes conflicts into the following types:
<ul>
<li>
<p><span class="bold">Conflicts with a patch already applied to the ORACLE_HOME.</span> In this case, stop the patch installation and contact Oracle Support Services.</p>
</li>
<li>
<p><span class="bold">Conflicts with a patch already applied to the ORACLE_HOME that is a subset of the patch you are trying to apply.</span> In this case, continue with the patch installation because the new patch contains all the fixes from the existing patch in the ORACLE_HOME. The subset patch will automatically be rolled back prior to the installation of the new patch.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the patch includes new parameters, edit the respective parameter files.</p>
</li>
<li>
<p>Set <code dir="ltr">ORACLE_HOME</code> back to the Oracle database home directory.</p>
</li>
<li>
<p>Start the processes from the Oracle GoldenGate home by doing the following:</p>
<ol>
<li>
<p>Ensure GGSCI is running.</p>
</li>
<li>
<p>Start Manager by running this command:</p>
<pre dir="ltr">
START MANAGER
</pre></li>
<li>
<p>Start all Oracle GoldenGate processes by running this command:</p>
<pre dir="ltr">
START ER *
</pre></li>
</ol>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="A1974289"></a>
<div id="GWUUP128" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">2.7</span> Performing the Upgrade to Version 12.1.2 for Oracle Database</h2>
<p>These instructions contain the procedure for performing the minimal upgrade.</p>
<p>Before proceeding, make certain you have reviewed the following preparation information in this manual:</p>
<ul>
<li>
<p><a href="upgrade.htm#CIACCECB">Section 1, "Overview of Upgrading Oracle GoldenGate"</a></p>
</li>
<li>
<p><a href="#CACGEGCC">Section 2.1, "Overview of the Upgrade Procedure for Oracle Database"</a></p>
</li>
<li>
<p><a href="#CACHCEFG">Section 2.2, "Upgrading a Configuration that Includes DDL Support"</a></p>
</li>
<li>
<p><a href="#A1973223">Section 2.3, "Understanding the Scope of the Upgrade Procedure"</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you are using integrated capture and plan to upgrade from trigger-based DDL capture to new native DDL capture, <span class="bold">do not</span> remove the DDL trigger until prompted. Extract needs to mine DDL to the point where the redo <code dir="ltr">COMPATIBLE</code> level is advanced to 11.2.0.4 (or higher). For example, if Extract is behind by a week when the database is upgraded to 11.2.0.4, Extract does not immediately switch to native DDL capture. It must be allowed to process the pre-11.2.0.4 redo first, then Extract upgrades to native DDL capture automatically.</div>
<ol>
<li>
<p>(Source system) The new Extract might need to start processing from the normal recovery checkpoint, rather than the bounded recovery checkpoint, if the first record of the oldest open transaction at the time that you stop Extract is in a log that is not on the system. Use the following command in GGSCI to determine the oldest archive log that you might need to restore when Extract starts. The <code dir="ltr">Recovery Checkpoint</code> field shows the oldest log needed for recovery.</p>
<p><code dir="ltr">GGSCI&gt; INFO EXTRACT</code> <code dir="ltr"><span class="codeinlineitalic">group</span></code><code dir="ltr">, SHOWCH</code></p>
<p>You have two options:</p>
<ul>
<li>
<p>You can restore the archives back to, and including, the one shown in the recovery checkpoint shown with <code dir="ltr">INFO EXTRACT</code>.</p>
</li>
<li>
<p>You can clear out the long-running transactions that apply to the Extract that you are upgrading. This can be done by skipping the transactions or by forcing them to the trail as committed transactions. Skipping a transaction may cause data loss, and forcing a transaction to the trail may add unwanted data to the trail if the transaction is rolled back. To skip or force a transaction, follow these steps:</p>
<ol>
<li>
<p>View open transactions with the following command in GGSCI. Record the transaction ID of any transaction that you want to clean up.</p>
<p><code dir="ltr">GGSCI&gt; SEND EXTRACT</code> <code dir="ltr"><span class="codeinlineitalic">group</span></code><code dir="ltr">, SHOWTRANS</code></p>
</li>
<li>
<p>Clean up old transactions with the <code dir="ltr">SEND EXTRACT</code> command, using either the <code dir="ltr">SKIPTRANS</code> option to skip a transaction or the <code dir="ltr">FORCETRANS</code> option to force a transaction in its current state to the trail as a committed transaction.</p>
<pre dir="ltr">
GGSCI&gt; SEND EXTRACT <span class="codeinlineitalic">group</span>, {SKIPTRANS | FORCETRANS} <span class="codeinlineitalic">transaction_ID</span> [THREAD <span class="codeinlineitalic">n</span>] [FORCE]
</pre></li>
<li>
<p>After you are finished cleaning up the long-running transactions, force a Bounded Recovery checkpoint.</p>
<p><code dir="ltr">GGSCI&gt; SEND EXTRACT</code> <code dir="ltr"><span class="codeinlineitalic">group</span></code><code dir="ltr">, BR BRCHECKPOINT IMMEDIATE</code></p>
<div class="infobox-note">
<p class="notep1">Note:</p>
A forced checkpoint is necessary because the skipped or forced transaction is not cleaned up from the Bounded Recovery checkpoint and will be shown if <code dir="ltr">SHOWTRANS</code> is issued again. This is a known issue. For more information about <code dir="ltr">SEND EXTRACT</code>, see <a class="olink GWURF163" href="../../gg-winux/GWURF/ggsci_commands014.htm#GWURF163"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>.</div>
</li>
</ol>
</li>
</ul>
</li>
<li>
<p>(Source system) Stop user activity that generates both DDL and DML on objects in the Oracle GoldenGate configuration.</p>
</li>
<li>
<p>After DDL and DML is stopped, run the following query. Record the current SCN from the query result.</p>
<pre dir="ltr">
select current_scn from v$database;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can avoid stopping DML operations when performing the Oracle GoldenGate upgrade, but you should stop DML when there is a requirement to run any SQL, such as DDL or any other upgrade SQL scripts as specified in Step 7, 17, and 19.</div>
</li>
<li>
<p>Record the current SCN from the query result.</p>
</li>
<li>
<p>(Source system, if currently using classic capture) In GGSCI on the source system, issue the <code dir="ltr">SEND EXTRACT</code> command with the <code dir="ltr">LOGEND</code> option until it shows there is no more redo data to capture.</p>
<p>(Source system if using integrated capture) Wait for the Extract recovery checkpoint to progress past the current SCN from the query result. To determine whether Extract is past that SCN in its checkpoints, view the Extract report file.</p>
<p><code dir="ltr">GGSCI&gt; SEND EXTRACT</code> <code dir="ltr"><span class="codeinlineitalic">group</span></code> <code dir="ltr">LOGEND</code></p>
</li>
<li>
<p>(Source system) In GGSCI, stop Extract and data pumps.</p>
<pre dir="ltr">
GGSCI&gt; STOP EXTRACT <span class="italic">group</span>
</pre></li>
<li>
<p>(Source system if not upgrading Target) If you are not upgrading Replicat on the target systems at this time, add the following parameter to the Extract parameter file to specify the version of Oracle GoldenGate that is running on the target. This parameter causes Extract to write a version of the trail that is compatible with the older version of Replicat. Before making the changes to the extract parameter file, please take a backup of the Oracle GoldenGate parameter files on source</p>
<pre dir="ltr">
{EXTTRAIL | RMTTRAIL} <span class="italic">file_name</span> FORMAT RELEASE <span class="italic">major.minor</span>
</pre>
<p>Where <code dir="ltr"><span class="codeinlineitalic">version</span></code> specifies an Oracle GoldenGate release, <code dir="ltr"><span class="codeinlineitalic">version. major</span></code> is the major version number, and <code dir="ltr"><span class="codeinlineitalic">.minor</span></code> is the minor version number. For example, 11.2 or 12.1. Ensure that you include the period in <code dir="ltr"><span class="codeinlineitalic">major.minor</span></code>.</p>
</li>
<li>
<p>(Source system, if currently using trigger-based DDL capture support) Follow these steps:</p>
<ol>
<li>
<p>Run SQL*Plus and log in as a user that has sysdba privileges.</p>
</li>
<li>
<p>Disconnect all sessions that ever issued DDL to avoid an ORA-04021 error. Ensure that no DDL sessions can be started for the duration of this upgrade.</p>
</li>
<li>
<p>From the Oracle GoldenGate directory, run the <code dir="ltr">ddl_disable</code> script to disable the Oracle GoldenGate DDL trigger.</p>
</li>
<li>
<p>Run the <code dir="ltr">ddl_remove</code> script to remove the Oracle GoldenGate DDL trigger and other associated objects and provide the name of the Oracle GoldenGate DDL schema.</p>
<p>A <code dir="ltr">ddl_remove_spool.txt</code> log file is generated that logs the script output and a <code dir="ltr">ddl_remove_set.txt</code> file that logs current user environment settings for use in debugging.</p>
</li>
<li>
<p>Run the <code dir="ltr">marker_remove</code> script to remove the Oracle GoldenGate marker support system and provide the name of the Oracle GoldenGate DDL schema.</p>
<p>A <code dir="ltr">marker_remove_spool.txt</code> file is generated that logs the script output and a <code dir="ltr">marker_remove_set.txt</code> file for use in debugging.</p>
</li>
</ol>
</li>
<li>
<p>(Target systems) In GGSCI on each target system, issue the <code dir="ltr">SEND REPLICAT</code> command with the <code dir="ltr">STATUS</code> option until it shows a status of "<code dir="ltr">At EOF</code>" to indicate that it finished processing all of the data in the trail. This must be done on all target systems until all Replicat processes return "<code dir="ltr">At EOF</code>."</p>
<p><code dir="ltr">GGSCI&gt; SEND REPLICAT</code> <code dir="ltr"><span class="codeinlineitalic">group</span></code> <code dir="ltr">STATUS</code></p>
</li>
<li>
<p>(Target systems) In GGSCI, stop all Replicat processes.</p>
<p><code dir="ltr">GGSCI&gt; STOP REPLICAT</code> <code dir="ltr"><span class="codeinlineitalic">group</span></code></p>
</li>
<li>
<p>(Source and target systems) In GGSCI, stop Manager on the source and target systems.</p>
<p><code dir="ltr">GGSCI&gt; STOP MANAGER</code></p>
</li>
<li>
<p>When updating target systems only, or if updating the target side before the source side, you <span class="italic">must</span> use <code dir="ltr">STOP</code> to stop all data pumps and any primary Extracts that write directly to those targets on any source running on this target. Any static collectors that may have been started that must be stopped, as well. To verify that there are no <code dir="ltr">server</code> processes running, use process checking shell commands, such as <code dir="ltr">ps</code> and <code dir="ltr">grep</code>.</p>
</li>
<li>
<p>(Source and target systems) Back up the current Oracle GoldenGate installation directory on the source and target systems, and any working directories that you have installed on a shared drive in a cluster (if applicable). You do not need to backup up the <code dir="ltr">dirdat</code> folder.</p>
</li>
<li>
<p>If you want to upgrade the source or target database, or both, do so at this time according to the Oracle database upgrade instructions for the new version. Ensure that you start and mount the databases after the upgrade though <span class="italic">do not</span> permit DML or DDL transactions on the objects in the Oracle GoldenGate configuration.</p>
</li>
<li>
<p>(Source and target systems) If you are using an Oracle GoldenGate version prior to 11.2.1, grant write permission to the installation user on the existing Oracle GoldenGate directory.</p>
<p>For example, on UNIX or Linux, run the following command:</p>
<pre dir="ltr">
 $ chmod -R u+w <span class="codeinlineitalic">existing_Oracle_GoldenGate_directory</span>
</pre></li>
<li>
<p>(Source and target systems) Install Oracle GoldenGate version 12.1.2.0 using Oracle Universal Installer (OUI) into your existing Oracle GoldenGate directory on the source and target systems. Ensure that you unselect the <span class="bold">Start Manager</span> option during the OUI installation; otherwise, this may overwrite your existing parameter files. See <a class="olink GIORA977" href="../../gg-winux/GIORA/install.htm#GIORA977"><span class="italic">Installing and Configuring Oracle GoldenGate for Oracle Database</span></a> for instructions.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle recommends that you install with the interactive OUI option for upgrade purposes, rather than use the silent installation.</div>
</li>
<li>
<p>(Target systems, if upgrading Replicat from version 11.2.1.0.0 or earlier) In GGSCI on each target system, issue the following commands to upgrade the Replicat checkpoint tables on those systems. This step updates the table definition to add columns that support the 12<span class="italic">c</span> (12.1.2) release.</p>
<pre dir="ltr">
GGSCI&gt;  DBLOGIN [{SOURCEDB} <span class="italic">data_source</span>]|[, <span class="italic">database@host:port</span>] |{USERID {/ | <span class="italic">user id</span>}[, PASSWORD <span class="italic">password</span>]   [<span class="italic">algorithm</span> ENCRYPTKEY {<span class="italic">keyname</span> | DEFAULT}] |USERIDALIAS <span class="italic">alias</span> [DOMAIN <span class="italic">domain</span>]}

GGSCI&gt; UPGRADE CHECKPOINTTABLE [<span class="italic">owner.table</span>]
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
<code dir="ltr"><span class="codeinlineitalic">owner</span></code>.<code dir="ltr"><span class="codeinlineitalic">table</span></code> can be omitted if the checkpoint table was created with the name listed with <code dir="ltr">CHECKPOINTTABLE</code> in the <code dir="ltr">GLOBALS</code> file.</div>
</li>
<li>
<p>(Source system) On the source system, run the <code dir="ltr">ulg.sql</code> script as <code dir="ltr">sysdba</code>. This script converts the existing supplemental log groups to the new format required by the new release. This step is required even if you plan to use the new triggerless capture method. The script should run without error; if errors occur, contact Oracle Support.</p>
</li>
<li>
<p>(Source and target systems) Updates to the trail version, the checkpoint storage format, and integrated capture require that you perform the following steps:</p>
<ol>
<li>
<p>In GGSCI, alter the primary Extract process and the associated data-pump Extract processes to write to a new trail sequence number. The command should return "<code dir="ltr">Rollover performed</code>."</p>
<p><code dir="ltr">GGSCI&gt; ALTER EXTRACT</code> <code dir="ltr"><span class="codeinlineitalic">group</span></code> <code dir="ltr">ETROLLOVER</code></p>
</li>
<li>
<p>In GGSCI, issue the <code dir="ltr">INFO EXTRACT</code> command with <code dir="ltr">DETAIL</code> for the primary Extract and the data pumps to verify the trail sequence number.</p>
<p><code dir="ltr">GGSCI&gt; INFO EXTRACT</code> <code dir="ltr"><span class="codeinlineitalic">group</span></code><code dir="ltr">, DETAIL</code></p>
</li>
<li>
<p>In GGSCI, reposition the data pumps and the Replicat processes to start at the new trail sequence number.</p>
<p><code dir="ltr">GGSCI&gt; ALTER EXTRACT</code> <code dir="ltr"><span class="codeinlineitalic">pump</span></code>, <code dir="ltr">EXTSEQNO</code> <code dir="ltr"><span class="codeinlineitalic">seqno</span></code>, <code dir="ltr">EXTRBA</code> <code dir="ltr"><span class="codeinlineitalic">RBA</span></code></p>
<p><code dir="ltr">GGSCI&gt; ALTER REPLICAT</code> <code dir="ltr"><span class="codeinlineitalic">group</span></code>, <code dir="ltr">EXTSEQNO</code> <code dir="ltr"><span class="codeinlineitalic">seqno</span></code>, <code dir="ltr">EXTRBA</code> <code dir="ltr"><span class="codeinlineitalic">RBA</span></code></p>
</li>
</ol>
</li>
<li>
<p>(Source system) If you plan to use new trigger-based DDL support for Oracle Database, use the following sub-steps to rebuild the Oracle GoldenGate DDL trigger environment to a clean state:</p>
<ol>
<li>
<p>Run SQL*Plus and log in as a user that has <code dir="ltr">sysdba</code> privileges.</p>
</li>
<li>
<p>Run the <code dir="ltr">marker_setup</code> script to reinstall the Oracle GoldenGate marker support system and provide the name of the Oracle GoldenGate schema.</p>
</li>
<li>
<p>Run the <code dir="ltr">ddl_setup</code> script and provide the name of the Oracle GoldenGate DDL schema.</p>
</li>
<li>
<p>Run the <code dir="ltr">role_setup</code> script to recreate the Oracle GoldenGate DDL role.</p>
</li>
<li>
<p>Grant the role that you created to all Oracle GoldenGate users under which the following Oracle GoldenGate processes run: Extract, Replicat, GGSCI, and Manager. You may need to make multiple grants if the processes have different user names.</p>
</li>
<li>
<p>Run the <code dir="ltr">ddl_enable.sql</code> script to enable the Oracle GoldenGate DDL trigger.</p>
</li>
</ol>
</li>
<li>
<p>You may now restore DDL and DML activity on the source database.</p>
</li>
<li id="CIAFEGJD">
<p>If you made copies of the parameter files to make parameter changes, move the new parameter files into the Oracle GoldenGate directory where the old parameter files were stored then rename them to the same names as the old parameter files. If you are using case-sensitivity support, ensure that you either add <code dir="ltr">NOUSEANSISQLQUOTES</code> to your parameter files, or that you ran the <code dir="ltr">convprm</code> utility to convert the quotes as required. See <a href="upgrade.htm#CACIJHCC">"Upgrade Considerations if Using Character-Set Conversion"</a> for more information.</p>
</li>
<li>
<p>In GGSCI, start the Oracle GoldenGate processes on the source and target systems in the following order.</p>
<pre dir="ltr">
GGSCI&gt; START MANAGER
GGSCI&gt; START EXTRACT <span class="codeinlineitalic">group</span>
GGSCI&gt; START EXTRACT <span class="codeinlineitalic">pump</span>
GGSCI&gt; START REPLICAT <span class="codeinlineitalic">group</span>
</pre>
<p>If you need to restore any log files, Extract will abend with an error that indicates the log to restore. Restore the logs back to, and including that log, and then restart Extract.</p>
</li>
</ol>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment121">
<tr>
<td class="cellalignment128"><table class="cellalignment132">
<tr>
<td class="cellalignment125"><a href="upgrade.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>

<td class="cellalignment125"><a href="upgrade_other.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table></td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2013, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment130">
<table class="cellalignment131">
<tr>
<td class="cellalignment125"><a href="../../index.html"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment125"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment125"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
</body>
</html>
