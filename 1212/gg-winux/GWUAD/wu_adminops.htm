<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml/DTD/xhtml1-transitional.dtd">
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>20 Performing Administrative Operations</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1028" />
<meta name="description" content="This chapter contains instructions for making changes to applications, systems, and Oracle GoldenGate while the replication environment is active and processing data changes." />
<meta name="dcterms.created" content="2014-11-11T22:58:6Z" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Oracle&reg; GoldenGate Administering Oracle GoldenGate for Windows and UNIX" />
<meta name="dcterms.identifier" content="E29388-06" />
<meta name="dcterms.isVersionOf" content="GWUAD" />
<link rel="Start" href="../../index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="wu_performance.htm" title="Previous" type="text/html" />
<link rel="Next" href="wu_backout.htm" title="Next" type="text/html" />
<link rel="alternate" href="../GWUAD.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="../GWUAD.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="../GWUAD.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Skip Headers</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns"><div id="BREADCRUMBS"><a href="http://docs.oracle.com">Home</a> / <a href="../../index.html">Middleware</a> / <a href="../index.html">Oracle GoldenGate for Windows and UNIX</a>
</div>

<span id="PAGE" style="display:none;">23/30</span>
<!-- End Header -->
<div id="GWUAD698" class="chapter"><a id="i1024361"></a>
<h1 class="chapter"><span class="secnum">20</span> Performing Administrative <a id="sthref1081"></a>Operations</h1>
<p><a id="GWUAD699"></a>This chapter contains instructions for making changes to applications, systems, and Oracle GoldenGate while the replication environment is active and processing data changes.</p>
<p>This chapter includes the following sections:</p>
<ul>
<li>
<p><a href="#i1022296">Performing Application Patches</a></p>
</li>
<li>
<p><a href="#i1022376">Initializing the Transaction Logs</a></p>
</li>
<li>
<p><a href="#i998381">Shutting Down the System</a></p>
</li>
<li>
<p><a href="#i1022397">Changing Database Attributes</a></p>
</li>
<li>
<p><a href="#i1008344">Adding Process Groups to an Active Configuration</a></p>
</li>
<li>
<p><a href="#i1022408">Changing the Size of Trail Files</a></p>
</li>
<li>
<p><a href="#A1937431">Switching Extract from Classic Mode to Integrated Mode</a></p>
</li>
<li>
<p><a href="#A1937459">Switching Extract from Integrated Mode to Classic Mode</a></p>
</li>
<li>
<p><a href="#A1930154">Switching Replicat from Nonintegrated Mode to Integrated Mode</a></p>
</li>
<li>
<p><a href="#A1914347">Switching Replicat from Integrated Mode to Nonintegrated Mode</a></p>
</li>
<li>
<p><a href="#A4251422">Switching Replicat to Coordinated Mode</a></p>
</li>
<li>
<p><a href="#A4202693">Administering a Coordinated Replicat Configuration</a></p>
</li>
<li>
<p><a href="#A4215731">Restarting a Primary Extract after System Failure or Corruption</a></p>
</li>
</ul>
<a id="i1022296"></a>
<div id="GWUAD701" class="sect1">
<h2 class="sect1"><span class="secnum">20.1</span> Performing Application <a id="sthref1082"></a>Patches</h2>
<p>Application patches and application upgrades typically perform DDL such as adding new objects or changing existing objects. To apply applications patches or upgrades in an Oracle GoldenGate environment, you can do one of the following:</p>
<ul>
<li>
<p>If Oracle GoldenGate supports DDL replication for your database type, you can use it to replicate the DDL without stopping replication processes. To use this method, the source and target table structures must be identical.</p>
</li>
<li>
<p>You can apply the patch or upgrade manually on both source and target after taking the appropriate steps to ensure replication continuity.</p>
</li>
</ul>
<p class="subhead2"><a id="GWUAD1146"></a>To use Oracle GoldenGate to replicate patch DDL</p>
<ol>
<li>
<p>If you have not already done so, dedicate some time to learn, install, and configure the Oracle GoldenGate DDL support. See the instructions for your database in this documentation. Once the DDL environment is in place, future patches and upgrades will be easier to apply.</p>
</li>
<li>
<p>If the application patch or upgrade adds new objects that you want to include in data replication, make certain that you include them in the <code dir="ltr">DDL</code> parameter statement. To add new objects to your <code dir="ltr">TABLE</code> and <code dir="ltr">MAP</code> statements, see the procedure on <a href="#i1029967">Section 20.4.2, "Adding Tables to the Oracle GoldenGate Configuration"</a>.</p>
</li>
<li>
<p>If the application patch or upgrade installs triggers or cascade constraints, disable those objects on the target to prevent collisions between DML that they execute on the target and the same DDL that is replicated from the source trigger or cascaded operation.</p>
</li>
</ol>
<p class="subhead2"><a id="GWUAD1147"></a>To apply a patch manually on the source and target</p>
<ol>
<li>
<p>Stop access to the source database.</p>
</li>
<li>
<p>Allow Extract to finish capturing the transaction data that remains in the transaction log. To determine when Extract is finished, issue the following command in GGSCI until it returns <code dir="ltr">At EOF.</code></p>
<pre dir="ltr">
SEND EXTRACT <span class="codeinlineitalic">group</span> GETLAG
</pre></li>
<li>
<p>Stop Extract.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Start applying the patch on the source.</p>
</li>
<li>
<p>Wait until the data pump (if used) and Replicat are finished processing the data in their respective trails. To determine when they are finished, use the following commands until they return <code dir="ltr">At EOF</code>.</p>
<pre dir="ltr">
SEND EXTRACT <span class="codeinlineitalic">group</span> GETLAG
SEND REPLICAT <span class="codeinlineitalic">group</span> GETLAG
</pre></li>
<li>
<p>Stop the data pump and Replicat.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
STOP REPLICAT <span class="codeinlineitalic">group</span>
</pre>
<p>At this point, the data in the source and target should be identical, because all of the replicated transactional changes from the source have been applied to the target.</p>
</li>
<li>
<p>Apply the patch on the target.</p>
</li>
<li>
<p>If the patches changed table definitions, run DEFGEN for the source tables to generate updated source definitions, and then replace the old definitions with the new ones in the existing source definitions file on the target system.</p>
</li>
<li>
<p>Start the Oracle GoldenGate processes whenever you are ready to begin capturing user activity again.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="i1022376"></a>
<div id="GWUAD707" class="sect1">
<h2 class="sect1"><span class="secnum">20.2</span> Initializing<a id="sthref1083"></a><a id="sthref1084"></a> the Transaction Logs</h2>
<p>When you initialize a transaction log, you must ensure that all of the data is processed by Oracle GoldenGate first, and then you must delete and re-add the Extract group and its associated trail.</p>
<ol>
<li>
<p>Stop the application from accessing the database. This stops more transaction data from being logged.</p>
</li>
<li>
<p>Run GGSCI and issue the <code dir="ltr">SEND EXTRACT</code> command with the <code dir="ltr">LOGEND</code> option for the primary Extract group. This command queries Extract to determine whether or not Extract is finished processing the records that remain in the transaction log.</p>
<pre dir="ltr">
SEND EXTRACT <span class="codeinlineitalic">group</span> LOGEND
</pre></li>
<li>
<p>Continue issuing the command until it returns a <code dir="ltr">YES</code> status, indicating that there are no more records to process.</p>
</li>
<li>
<p>On the target system, run GGSCI and issue the <code dir="ltr">SEND REPLICAT</code> command with the <code dir="ltr">STATUS</code> option. This command queries Replicat to determine whether or not it is finished processing the data that remains in the trail.</p>
<pre dir="ltr">
SEND REPLICAT <span class="codeinlineitalic">group</span> STATUS
</pre></li>
<li>
<p>Continue issuing the command until it shows 0 records in the current transaction, for example:</p>
<pre dir="ltr">
Sending STATUS request to REPLICAT REPSTAB...
Current status:
  Seqno 0, Rba 9035
  0 records in current transaction.
</pre></li>
<li>
<p>Stop the primary Extract group, the data pump (if used), and the Replicat group.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
STOP EXTRACT <span class="codeinlineitalic">pump_group</span>
STOP REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Delete the Extract, data pump, and Replicat groups.</p>
<pre dir="ltr">
<a id="sthref1085"></a>DELETE EXTRACT <span class="codeinlineitalic">group</span>
<a id="sthref1086"></a>DELETE EXTRACT <span class="codeinlineitalic">pump_group</span>
<a id="sthref1087"></a>DELETE REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Using standard operating system commands, delete the trail files.</p>
</li>
<li>
<p>Stop the database.</p>
</li>
<li>
<p>Initialize and restart the database.</p>
</li>
<li>
<p>Recreate the primary Extract group.</p>
<pre dir="ltr">
ADD EXTRACT <span class="codeinlineitalic">group</span> TRANLOG, BEGIN NOW
</pre></li>
<li>
<p>Recreate the local trail (if used).</p>
<pre dir="ltr">
ADD EXTTRAIL <span class="codeinlineitalic">trail</span>, EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Recreate the data pump (if used).</p>
<pre dir="ltr">
ADD EXTRACT <span class="codeinlineitalic">pump_group</span>, EXTTRAILSOURCE <span class="codeinlineitalic">trail</span>
</pre></li>
<li>
<p>Recreate the remote trail.</p>
<pre dir="ltr">
ADD RMTTRAIL <span class="codeinlineitalic">trail</span>, EXTRACT <span class="codeinlineitalic">pump_group</span>
</pre></li>
<li>
<p>Recreate the Replicat group.</p>
<pre dir="ltr">
ADD REPLICAT <span class="codeinlineitalic">group</span>, EXTTRAIL <span class="codeinlineitalic">trail</span>
</pre></li>
<li>
<p>Start Extract, the data pump (if used), and Replicat.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group </span>
START EXTRACT <span class="codeinlineitalic">pump_group</span>
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="i998381"></a>
<div id="GWUAD708" class="sect1">
<h2 class="sect1"><span class="secnum">20.3</span> Shutting Down the <a id="sthref1088"></a>System</h2>
<p>When shutting down a system for maintenance and other procedures that affect Oracle GoldenGate, follow these steps to make certain that Extract has processed all of the transaction log records. Otherwise, you might lose synchronization data.</p>
<ol>
<li>
<p>Stop all application and database activity that generates transactions that are processed by Oracle GoldenGate.</p>
</li>
<li>
<p>Run GGSCI.</p>
</li>
<li>
<p>In GGSCI, issue the <code dir="ltr">SEND EXTRACT</code> command with the <code dir="ltr"><a id="sthref1089"></a>LOGEND</code> option. This command queries the Extract process to determine whether or not it is finished processing the records in the data source.</p>
<pre dir="ltr">
SEND EXTRACT <span class="codeinlineitalic">group</span> LOGEND
</pre></li>
<li>
<p>Continue issuing the command until it returns a <code dir="ltr">YES</code> status. At that point, all transaction log data has been processed, and you can safely shut down Oracle GoldenGate and the system.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="i1022397"></a>
<div id="GWUAD709" class="sect1">
<h2 class="sect1"><span class="secnum">20.4</span> <a id="sthref1090"></a><a id="sthref1091"></a>Changing <a id="sthref1092"></a>Database Attributes</h2>
<p>This section addresses administrative operations that are performed on database tables and structures.</p>
<p><a href="#CIHCAEGJ">Section 20.4.1, "Changing Database Metadata"</a></p>
<p><a href="#i1029967">Section 20.4.2, "Adding Tables to the Oracle GoldenGate Configuration"</a></p>
<p><a href="#CIHJGHBB">Section 20.4.3, "Coordinating Table Attributes between Source and Target"</a></p>
<p><a href="#i1026053">Section 20.4.4, "Performing an ALTER TABLE to Add a Column on DB2 z/OS Tables"</a></p>
<p><a href="#CIHEGAFH">Section 20.4.5, "Dropping and Recreating a Source Table"</a></p>
<p><a href="#i998443">Section 20.4.6, "Changing the Number of Oracle RAC Threads when Using Classic Capture"</a></p>
<p><a href="#CIHCGJII">Section 20.4.7, "Changing the ORACLE_SID"</a></p>
<p><a href="#i1007749">Section 20.4.8, "Purging Archive Logs"</a></p>
<p><a href="#CIHIBCED">Section 20.4.9, "Reorganizing a DB2 Table (z/OS Platform)"</a></p>
<a id="CIHCAEGJ"></a>
<div id="GWUAD1011" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">20.4.1</span> Changing Database Metadata</h3>
<p>This procedure is required to prevent Replicat errors when changing the following metadata of the source database:</p>
<ul>
<li>
<p>Database character set</p>
</li>
<li>
<p>National character set</p>
</li>
<li>
<p>Locale</p>
</li>
<li>
<p>Timezone</p>
</li>
<li>
<p>Object name case-sensitivity</p>
</li>
</ul>
<p>If these changes are made without performing this procedure, the following error occurs:</p>
<pre dir="ltr">
2013-05-26 20:10:09  ERROR   OGG-05500  Detected database metadata mismatch between current trail file ./dirdat/_p/v1000003 and the previous sequence. *DBTIMEZONE: [GMT]/[UTC]. 
</pre>
<p>This procedure stops Extract, and then creates a new trail file. The new database metadata is included in this new file with the transactions that started after the change.</p>
<ol>
<li>
<p>Stop transaction activity on the source database. Do not make the metadata change to the database yet.</p>
</li>
<li>
<p>In GGSCI on the source system, issue the <code dir="ltr">SEND EXTRACT</code> command with the <code dir="ltr">LOGEND</code> option until it shows there is no more redo data to capture.</p>
<pre dir="ltr">
SEND EXTRACT <span class="codeinlineitalic">group</span> LOGEND
</pre></li>
<li>
<p>Stop Extract.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>On each target system, issue the <code dir="ltr">SEND REPLICAT</code> command with the <code dir="ltr">STATUS</code> option until it shows a status of "<code dir="ltr">At EOF</code>" to indicate that it finished processing all of the data in the trail. This must be done on all target systems until all Replicat processes return "<code dir="ltr">At EOF</code>."</p>
<pre dir="ltr">
SEND REPLICAT <span class="codeinlineitalic">group</span> STATUS
</pre></li>
<li>
<p>Stop the data pumps and Replicat.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
STOP REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Change the database metadata.</p>
</li>
<li>
<p>In in GGSCI on the source system, issue the <code dir="ltr">ALTER EXTRACT</code> command with the <code dir="ltr">ETROLLOVER</code> option for the primary Extract to roll over the local trail to the start of a new file.</p>
<pre dir="ltr">
ALTER EXTRACT <span class="codeinlineitalic">group</span>, ETROLLOVER
</pre></li>
<li>
<p>Issue the <code dir="ltr">ALTER EXTRACT</code> command with the <code dir="ltr">ETROLLOVER</code> option for the data pumps to roll over the remote trail to the start of a new file.</p>
<pre dir="ltr">
ALTER EXTRACT <span class="codeinlineitalic">pump</span>, ETROLLOVER
</pre></li>
<li>
<p>Start Extract.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>In GGSCI, reposition the data pumps and Replicat processes to start at the new trail sequence number.</p>
<pre dir="ltr">
ALTER EXTRACT <span class="codeinlineitalic">pump</span>, EXTSEQNO <span class="codeinlineitalic">seqno</span>, EXTRBA <span class="codeinlineitalic">RBA</span>
ALTER REPLICAT <span class="codeinlineitalic">group</span>, EXTSEQNO <span class="codeinlineitalic">seqno</span>, EXTRBA <span class="codeinlineitalic">RBA</span>
</pre></li>
<li>
<p>Start the data pumps.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Start the Replicat processes.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1029967"></a>
<div id="GWUAD710" class="sect2">
<h3 class="sect2"><span class="secnum">20.4.2</span> <a id="sthref1093"></a><a id="sthref1094"></a><a id="sthref1095"></a><a id="sthref1096"></a>Adding Tables to the Oracle GoldenGate Configuration</h3>
<p>This procedure assumes that the Oracle GoldenGate DDL support feature is not in use, or is not supported for, your database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
For Oracle and Teradata databases, you can enable the DDL support feature of Oracle GoldenGate to automatically capture and apply the DDL that adds new tables, instead of using this procedure. See the appropriate instructions for your database in this documentation.</div>
<p>Review these steps before starting. The process varies slightly, depending on whether or not the new tables satisfy <a id="sthref1097"></a>wildcards in the <code dir="ltr">TABLE</code> parameter, and whether or not names or data definitions must be mapped on the target.</p>
<p class="subhead2"><a id="GWUAD1148"></a>Prerequisites for adding tables to the Oracle GoldenGate configuration</p>
<ul>
<li>
<p>This procedure assumes that the source and target tables are either empty or contain identical (already synchronized) data.</p>
</li>
<li>
<p>You may be using the <code dir="ltr">DBLOGIN</code> and <code dir="ltr">ADD TRANDATA</code> commands. Before starting this procedure, see <a class="olink GWURF110" href="../../gg-winux/GWURF/ggsci_commands.htm#GWURF110"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a> for the proper usage of these commands for your database.</p>
</li>
</ul>
<p class="subhead2"><a id="GWUAD1149"></a>To add a table to the Oracle GoldenGate configuration</p>
<ol>
<li>
<p>Stop user access to the new tables.</p>
</li>
<li>
<p>(<span class="italic">If new tables do not satisfy a wildcard</span>) If you are adding numerous tables that do not satisfy a wildcard, make a copy of the Extract and Replicat parameter files, and then add the new tables with <code dir="ltr">TABLE</code> and <code dir="ltr">MAP</code> statements. If you do not want to work with a copy, then edit the original parameter files after you are prompted to stop each process.</p>
</li>
<li>
<p>(<span class="italic">If new tables satisfy wildcards</span>) In the Extract and Replicat parameter files, make certain the <code dir="ltr"><a id="sthref1098"></a>WILDCARDRESOLVE</code> parameter is not being used, unless it is set to the default of <code dir="ltr">DYNAMIC</code>.</p>
</li>
<li>
<p>(<span class="italic">If new tables do not satisfy a wildcard</span>) If the new tables <span class="italic">do not</span> satisfy a wildcard definition, stop Extract.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Add the new tables to the source and target databases.</p>
</li>
<li>
<p>If required for the source database, issue the <code dir="ltr">ADD TRANDATA</code> command in GGSCI for the new tables. Before using <code dir="ltr">ADD TRANDATA</code>, issue the <code dir="ltr">DBLOGIN</code> command.</p>
</li>
<li>
<p>Depending on whether the source and target definitins are identical or different, use either <code dir="ltr">ASSUMETARGETDEFS</code> or <code dir="ltr">SOURCEDEFS</code> in the Replicat parameter file. If <code dir="ltr">SOURCEDEFS</code> is needed, you can do either of the following:</p>
<ul>
<li>
<p>Run DEFGEN, then copy the new definitions to the source definitions file on the target.</p>
</li>
<li>
<p>If the new tables match a definitions template, specify the template with the <code dir="ltr">DEF</code> option of the <code dir="ltr">MAP</code> parameter. (DEFGEN not needed.)</p>
</li>
</ul>
</li>
<li>
<p>To register the new source definitions or new <code dir="ltr">MAP</code> statements, stop and then start Replicat.</p>
<pre dir="ltr">
STOP REPLICAT <span class="codeinlineitalic">group</span>
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Start Extract, if applicable.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Permit user access to the new tables.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHJGHBB"></a>
<div id="GWUAD711" class="sect2">
<h3 class="sect2"><span class="secnum">20.4.3</span> Coordinating Table Attributes between Source and Target</h3>
<p>Follow this procedure if you are changing an attribute of a source table that is in the Oracle GoldenGate configuration, such as adding or changing columns or partitions, or changing supplemental<a id="sthref1099"></a> logging details (Oracle). It directs you how to make the same change to the target table without incurring replication latency.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
See also <a href="#i1026053">Section 20.4.4, "Performing an ALTER TABLE to Add a Column on DB2 z/OS Tables"</a>.</div>
<div class="infobox-note">
<p class="notep1">Note:</p>
This procedure assumes that the Oracle GoldenGate DDL support feature is not in use, or is not supported for your database. For Oracle and Teradata databases, you can enable the DDL support feature of Oracle GoldenGate to propagate the DDL changes to the target, instead of using this procedure.</div>
<ol>
<li>
<p>On the source and target systems, create a table, to be known as the <span class="italic">marker table</span>, that can be used for the purpose of generating a marker that denotes a stopping point in the transaction log. Just create two simple columns: one as a primary key and the other as a regular column. For example:</p>
<pre dir="ltr">
CREATE TABLE marker
(
id int NOT NULL,
column varchar(25) NOT NULL,
PRIMARY KEY (id)
);
</pre></li>
<li>
<p>Insert a row into the marker table on both the source and target systems.</p>
<pre dir="ltr">
INSERT INTO marker VALUES (1, 1);
COMMIT;
</pre></li>
<li>
<p>On the source system, run GGSCI.</p>
</li>
<li>
<p>Open the Extract parameter file for editing.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Do not use the <code dir="ltr">VIEW PARAMS</code> or <code dir="ltr">EDIT PARAMS</code> command to view or edit an existing parameter file that is in a character set other than that of the local operating system (such as one where the <code dir="ltr">CHARSET</code> option was used to specify a different character set). View the parameter file from outside GGSCI if this is the case; otherwise, the contents may become corrupted..</div>
</li>
<li>
<p>Add the marker table to the Extract parameter file in a <code dir="ltr">TABLE</code> statement.</p>
<pre dir="ltr">
TABLE marker;
</pre></li>
<li>
<p>Save and close the parameter file.</p>
</li>
<li>
<p>Add the marker table to the <code dir="ltr">TABLE</code> statement of the data pump, if one is being used.</p>
</li>
<li>
<p>Stop the Extract and data pump processes, and then restart them immediately to prevent capture lag.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
START EXTRACT <span class="codeinlineitalic">group</span>
STOP EXTRACT <span class="codeinlineitalic">pump_group</span>
START EXTRACT <span class="codeinlineitalic">pump_group</span>
</pre></li>
<li>
<p>On the target system, run GGSCI.</p>
</li>
<li>
<p>Open the Replicat parameter file for editing.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Do not use the <code dir="ltr">VIEW PARAMS</code> or <code dir="ltr">EDIT PARAMS</code> command to view or edit an existing parameter file that is in a character set other than that of the local operating system (such as one where the <code dir="ltr">CHARSET</code> option was used to specify a different character set). View the parameter file from outside GGSCI if this is the case; otherwise, the contents may become corrupted.</div>
</li>
<li>
<p>Add the marker table to the Replicat parameter file in a <code dir="ltr">MAP</code> statement, and use the <code dir="ltr">EVENTACTIONS</code> parameter as shown to stop Replicat and ignore operations on the marker table.</p>
<pre dir="ltr">
MAP marker, TARGET marker, EVENTACTIONS (STOP, IGNORE);
</pre></li>
<li>
<p>Save and close the parameter file.</p>
</li>
<li>
<p>Stop, and then immediately restart, the Replicat process.</p>
<pre dir="ltr">
STOP REPLICAT <span class="codeinlineitalic">group</span>
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>When you are ready to change the table attributes for both source and target tables, stop all user activity on them.</p>
</li>
<li>
<p>On the source system, perform an <code dir="ltr">UPDATE</code> operation to the marker table as the only operation in the transaction.</p>
<pre dir="ltr">
UPDATE marker
SET column=2,
WHERE id=1;
COMMIT;
</pre></li>
<li>
<p>On the target system, issue the following command until it shows that Replicat is stopped as a result of the <code dir="ltr">EVENTACTIONS</code> rule.</p>
<pre dir="ltr">
STATUS REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Perform the DDL on the source and target tables, but do not yet allow user activity.</p>
</li>
<li>
<p>Start Replicat.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Allow user activity on the source and target tables.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1026053"></a>
<div id="GWUAD712" class="sect2">
<h3 class="sect2"><span class="secnum">20.4.4</span> Performing an ALTER TABLE to Add a Column on DB2 z/OS Tables</h3>
<p>To add a fixed length column to a table that is in reordered row format and contains one or more variable length columns, one of the following will be required, depending on whether the table can be quiesced or not.</p>
<p class="subhead2"><a id="GWUAD1150"></a>If the table can be quiesced</p>
<ol>
<li>
<p>Allow Extract to finish capturing transactions that happened prior to the quiesce.</p>
</li>
<li>
<p>Alter the table to add the column.</p>
</li>
<li>
<p>Reorganize the tablespace.</p>
</li>
<li>
<p>Restart Extract.</p>
</li>
<li>
<p>Allow table activity to resume.</p>
</li>
</ol>
<p class="subhead2"><a id="GWUAD1151"></a>If the table cannot be quiesced</p>
<ol>
<li>
<p>Stop Extract.</p>
</li>
<li>
<p>Remove the table from the <code dir="ltr">TABLE</code> statement in the parameter file.</p>
</li>
<li>
<p>Restart Extract.</p>
</li>
<li>
<p>Alter the table to add the column.</p>
</li>
<li>
<p>Reorganize the tablespace.</p>
</li>
<li>
<p>Stop Extract.</p>
</li>
<li>
<p>Add the table back to the <code dir="ltr">TABLE</code> statement.</p>
</li>
<li>
<p>Resynchronize the source and target tables.</p>
</li>
<li>
<p>Start Extract.</p>
</li>
<li>
<p>Allow table activity to resume.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHEGAFH"></a>
<div id="GWUAD713" class="sect2">
<h3 class="sect2"><span class="secnum">20.4.5</span> D<a id="sthref1100"></a>ropping and Recreating a Source Table</h3>
<p>Dropping and recreating a source table requires caution when performed while Oracle GoldenGate is running.</p>
<ol>
<li>
<p>Stop access to the table.</p>
</li>
<li>
<p>Allow Extract to process any remaining changes to that table from the transaction logs. To determine when Extract is finished, use the <code dir="ltr">INFO EXTRACT</code> command in GGSCI.</p>
<pre dir="ltr">
INFO EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Stop Extract.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Drop and recreate the table.</p>
</li>
<li>
<p>If supported for this database, run the <code dir="ltr">ADD TRANDATA</code> command in GGSCI for the table.</p>
</li>
<li>
<p>If the recreate action changed the source table's definitions so that they are different from those of the target, run the DEFGEN utility for the source table to generate source definitions, and then replace the old definitions with the new definitions in the <span class="italic">existing</span> source definitions file on the target system.</p>
</li>
<li>
<p>Permit user access to the table.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i998443"></a>
<div id="GWUAD714" class="sect2">
<h3 class="sect2"><span class="secnum">20.4.6</span> Changing the Number of Oracle RAC <a id="sthref1101"></a><a id="sthref1102"></a>Threads when Using Classic Capture</h3>
<p>Valid for Extract in classic capture mode for Oracle. When Extract operates in classic capture mode,&nbsp;the Extract group must be dropped and re-added any time the number of redo threads in an Oracle RAC cluster changes. To drop and add an Extract group, perform the following steps:</p>
<ol>
<li>
<p>On the source and target systems, run GGSCI.</p>
</li>
<li>
<p>Stop Extract and Replicat.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
STOP REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>On the source system, issue the following command to delete the primary Extract group and the data pump.</p>
<pre dir="ltr">
<a id="sthref1103"></a>DELETE EXTRACT <span class="codeinlineitalic">group</span>
<a id="sthref1104"></a>DELETE EXTRACT <span class="codeinlineitalic">pump_group</span>
</pre></li>
<li>
<p>On the target system, issue the following command to delete the Replicat groups.</p>
<pre dir="ltr">
<a id="sthref1105"></a>DELETE REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Using standard operating system commands, remove the local and remote trail files.</p>
</li>
<li>
<p>Add the primary Extract group again with the same name as before, specifying the new number of RAC threads.</p>
<pre dir="ltr">
ADD EXTRACT <span class="codeinlineitalic">group</span> TRANLOG, THREADS <span class="codeinlineitalic">n</span>, BEGIN NOW
</pre></li>
<li>
<p>Add the local trail again with the same name as before.</p>
<pre dir="ltr">
ADD EXTTRAIL <span class="codeinlineitalic">trail</span>, EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Add the data pump Extract again, with the same name as before.</p>
<pre dir="ltr">
ADD EXTRACT <span class="codeinlineitalic">group</span> EXTTRAILSOURCE <span class="codeinlineitalic">trail</span>, BEGIN NOW
</pre></li>
<li>
<p>Add the remote trail again with the same name as before.</p>
<pre dir="ltr">
ADD RMTTRAIL <span class="codeinlineitalic">trail</span>, EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Add the Replicat group with the same name as before. Leave off any <code dir="ltr">BEGIN</code> options so that processing begins at the start of the trail.</p>
<pre dir="ltr">
ADD REPLICAT <span class="codeinlineitalic">group</span> EXTTRAIL <span class="codeinlineitalic">trail</span>
</pre></li>
<li>
<p>Start all processes, using wildcards as appropriate. If the re-created processes are the only ones in the source and target Oracle GoldenGate instances, you can use <code dir="ltr">START</code> <code dir="ltr">ER *</code> instead of the following commands.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHCGJII"></a>
<div id="GWUAD715" class="sect2">
<h3 class="sect2"><span class="secnum">20.4.7</span> Changing the <a id="sthref1106"></a>ORACLE_SID</h3>
<p>You can change the <code dir="ltr">ORACLE_SID</code> and <code dir="ltr">ORACLE_HOME</code> without having to change environment variables at the operating-system level. Depending on whether the change is for the source or target database, set the following parameters in the Extract or Replicat parameter files. Then, stop and restart Extract or Replicat for the parameters to take effect.</p>
<pre dir="ltr">
SETENV (ORACLE_HOME=<span class="codeinlineitalic">location</span>)
SETENV (ORACLE_SID='<span class="codeinlineitalic">SID</span>')
</pre></div>
<!-- class="sect2" -->
<a id="i1007749"></a>
<div id="GWUAD716" class="sect2">
<h3 class="sect2"><span class="secnum">20.4.8</span> Purging <a id="sthref1107"></a>Archive Logs</h3>
<p>An Oracle archive log can be purged safely once Extract's read and write checkpoints are past the end of that log. Extract does not write a transaction to a trail until it has been committed, so Extract must keep track of all open transactions. To do so, Extract requires access to the archive log where each open transaction started and all archive logs thereafter.</p>
<p>Extract reads the current archive log (the read checkpoint) for new transactions and also has a checkpoint (the recovery checkpoint) in the oldest archive log for which there is an uncommitted transaction.</p>
<p>Use the following command in GGSCI to determine Extract's checkpoint positions.</p>
<pre dir="ltr">
INFO EXTRACT <span class="codeinlineitalic">group</span>, SHOWCH
</pre>
<ul>
<li>
<p>The <code dir="ltr">Input Checkpoint</code> field shows where Extract began processing when it was started.</p>
</li>
<li>
<p>The <code dir="ltr">Recovery Checkpoint</code> field shows the location of the oldest uncommitted transaction.</p>
</li>
<li>
<p>The <code dir="ltr">Next Checkpoint</code> field shows the position in the redo log that Extract is reading.</p>
</li>
<li>
<p>The <code dir="ltr">Output Checkpoint</code> field shows the position where Extract is writing.</p>
</li>
</ul>
<p>You can write a shell script that purges all archive logs no longer needed by Extract by capturing the sequence number listed under the <code dir="ltr">Recovery Checkpoint</code> field. All archive logs prior to that one can be safely deleted.</p>
</div>
<!-- class="sect2" -->
<a id="CIHIBCED"></a>
<div id="GWUAD717" class="sect2">
<h3 class="sect2"><span class="secnum">20.4.9</span> Reorganizing a DB2 <a id="sthref1108"></a>Table (z/OS Platform)</h3>
<p>When using IBM's REORG utility to reorganize a DB2 table that has compressed tablespaces, specify the <code dir="ltr">KEEPDICTIONARY</code> option if the table is being processed by Oracle GoldenGate. This prevents the REORG utility from recreating the compression dictionary, which would cause log data that was written prior to the change not to be decompressed and cause Extract to terminate abnormally. As an alternative, ensure that all of the changes for the table have been extracted by Oracle GoldenGate before doing the reorganization, or else truncate the table.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1008344"></a>
<div id="GWUAD702" class="sect1">
<h2 class="sect1"><span class="secnum">20.5</span> Adding Process <a id="sthref1109"></a><a id="sthref1110"></a><a id="sthref1111"></a>Groups to an Active Configuration</h2>
<p>This section describes how to add process groups.</p>
<div id="GWUAD703" class="sect2"><a id="sthref1112"></a>
<h3 class="sect2"><span class="secnum">20.5.1</span> Before You Start</h3>
<p>These instructions are for adding process groups to a configuration that is already active. The procedures should be performed by someone who has experience with Oracle GoldenGate. They involve stopping processes for a short period of time and reconfiguring parameter files. The person performing them must:</p>
<ul>
<li>
<p>Know the basic components of an Oracle GoldenGate configuration</p>
</li>
<li>
<p>Understand Oracle GoldenGate parameters and commands</p>
</li>
<li>
<p>Have access to GGSCI to create groups and parameter files</p>
</li>
<li>
<p>Know which parameters to use in specific situations</p>
</li>
</ul>
<p>Instructions are provided for:</p>
<ul>
<li>
<p><a href="#i1007660">Adding Another Extract Group to an Active Configuration</a></p>
</li>
<li>
<p><a href="#i1020363">Adding Another Data Pump to an Active Configuration</a></p>
</li>
<li>
<p><a href="#i1007669">Adding Another Replicat Group to an Active Configuration</a></p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i1007660"></a>
<div id="GWUAD704" class="sect2">
<h3 class="sect2"><span class="secnum">20.5.2</span> Adding Another Extract Group to an Active Configuration</h3>
<p>This procedure splits the workload of an existing Extract group into multiple Extract groups. It also provides instructions for including a data pump group (if applicable) and a Replicat group to propagate data that is captured by the new Extract group.</p>
<p>Steps are performed on the source and target systems.</p>
<ol>
<li>
<p>Make certain the archived transaction logs are available in case the online logs recycle before you complete this procedure.</p>
</li>
<li>
<p>Choose a name for the new Extract group.</p>
</li>
<li>
<p>Decide whether or not to use a data pump.</p>
</li>
<li>
<p>On the source system, run GGSCI.</p>
</li>
<li>
<p>Create a parameter file for the new Extract group.</p>
<pre dir="ltr">
EDIT PARAMS <span class="codeinlineitalic">group</span>
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can copy the original parameter file to use for this group, but make certain to change the Extract group name and any other relevant parameters that apply to this new group.</div>
</li>
<li>
<p>In the parameter file, include:</p>
<ul>
<li>
<p><code dir="ltr">EXTRACT</code> parameter that specifies the new group.</p>
</li>
<li>
<p>Appropriate database login parameters.</p>
</li>
<li>
<p>Other appropriate Extract parameters for your configuration.</p>
</li>
<li>
<p><code dir="ltr">EXTTRAIL</code> parameter that points to a local trail (if you will be adding a data pump) <span class="italic">or</span> a <code dir="ltr">RMTTRAIL</code> parameter (if you are not adding a data pump).</p>
</li>
<li>
<p><code dir="ltr">RMTHOST</code> parameter if this Extract will write directly to a remote trail.</p>
</li>
<li>
<p><code dir="ltr">TABLE</code> statement(s) (and <code dir="ltr">TABLEEXCLUDE</code>, if appropriate) for the tables that are to be processed by the new group.</p>
</li>
</ul>
</li>
<li>
<p>Save and close the file.</p>
</li>
<li>
<p>Edit the original Extract parameter file(s) to remove the <code dir="ltr">TABLE</code> statements for the tables that are being moved to the new group or, if using wildcards, add the <code dir="ltr">TABLEEXCLUDE</code> parameter to exclude them from the wildcard specification.</p>
</li>
<li>
<p>(Oracle) If you are using Extract in integrated mode, register the new Extract group with the source database.</p>
<pre dir="ltr">
REGISTER EXTRACT <span class="codeinlineitalic">group</span> DATABASE [CONTAINER (<span class="codeinlineitalic">container</span>[, ...])]
</pre></li>
<li>
<p>Lock the tables that were moved to the new group, and record the timestamp for the point when the locks were applied. For Oracle tables, you can run the following script, which also releases the lock after it is finished.</p>
<pre dir="ltr">
-- temp_lock.sql
-- use this script to temporary lock a table in order to
-- get a timestamp

lock table &amp;schema . &amp;table_name in EXCLUSIVE mode;
SELECT TO_CHAR(sysdate,'MM/DD/YYYY HH24:MI:SS') "Date" FROM dual;
commit;
</pre></li>
<li>
<p>Unlock the table(s) if you did not use the script in the previous step.</p>
</li>
<li>
<p>Stop the old Extract group(s) and any existing data pumps.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Add the new Extract group and configure it to start at the timestamp that you recorded.</p>
<pre dir="ltr">
ADD EXTRACT <span class="codeinlineitalic">group</span>, TRANLOG, BEGIN <span class="codeinlineitalic">YYYY/MM/DD HH:MI:SS:CCCCCC</span>
</pre></li>
<li>
<p>Add a trail for the new Extract group.</p>
<pre dir="ltr">
ADD {EXTTRAIL | RMTTRAIL} <span class="codeinlineitalic">trail</span>, EXTRACT <span class="codeinlineitalic">group</span>
</pre>
<p>Where:</p>
<ul>
<li>
<p><code dir="ltr">EXTTRAIL</code> creates a local trail. Use this option if you will be creating a data pump for use with the new Extract group. Specify the trail that is specified with <code dir="ltr">EXTTRAIL</code> in the parameter file. After creating the trail, go to <a href="#i1022490">Section 20.5.2, "To link a local data pump to the new Extract group"</a>.</p>
</li>
<li>
<p><code dir="ltr">RMTTRAIL</code> creates a remote trail. Use this option if a data pump will not be used. Specify the trail that is specified with <code dir="ltr">RMTTRAIL</code> in the parameter file. After creating the trail, go to <code dir="ltr"><a href="#i1022500">To link a remote Replicat to the new data pump</a><a href=""></a></code>.</p>
</li>
</ul>
<p>You can specify a relative or full path name. Examples:</p>
<pre dir="ltr">
ADD RMTTRAIL dirdat/rt, EXTRACT primary
ADD EXTTRAIL c:\ogg\dirdat\lt, EXTRACT primary
</pre></li>
</ol>
<p class="subhead2"><a id="i1022490"></a><a id="GWUAD1152"></a>To link a local data pump to the new Extract group</p>
<ol>
<li>
<p>On the source system, add the data-pump Extract group using the <code dir="ltr">EXTTRAIL</code> trail as the data source.</p>
<pre dir="ltr">
ADD EXTRACT <span class="codeinlineitalic">pump</span>, EXTTRAILSOURCE <span class="codeinlineitalic">trail</span>
</pre>
<p>For example:</p>
<pre dir="ltr">
ADD EXTRACT pump2, EXTTRAILSOURCE dirdat\lt
</pre></li>
<li>
<p>Create a parameter file for the data pump.</p>
<pre dir="ltr">
EDIT PARAMS <span class="codeinlineitalic">pump</span>
</pre></li>
<li>
<p>In the parameter file, include the appropriate Extract parameters for your configuration, plus:</p>
<ul>
<li>
<p><code dir="ltr">RMTHOST</code> parameter to point to the target system.</p>
</li>
<li>
<p><code dir="ltr">RMTTRAIL</code> parameter to point to a new remote trail (to be specified later).</p>
</li>
<li>
<p><code dir="ltr">TABLE</code> parameter(s) for the tables that are to be processed by this data pump.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the data pump will be pumping data, but not performing filtering, mapping, or conversion, then you can include the <code dir="ltr">PASSTHRU</code> parameter to bypass the overhead of database lookups. You also can omit database authentication parameters.</div>
</li>
</ul>
</li>
<li>
<p>In GGSCI on the source system, add a remote trail for the data-pump. Use the trail name that you specified with <code dir="ltr">RMTTRAIL</code> in the parameter file.</p>
<pre dir="ltr">
ADD RMTTRAIL <span class="codeinlineitalic">trail</span>, EXTRACT <span class="codeinlineitalic">pump</span>
</pre>
<p>For example:</p>
<pre dir="ltr">
ADD RMTTRAIL dirdat/rt, EXTRACT pump2
</pre></li>
<li>
<p>Follow the steps in <a href="#i1022500">To link a remote Replicat to the new data pump</a>.</p>
</li>
</ol>
<p class="subhead2"><a id="i1022500"></a><a id="GWUAD1153"></a>To link a remote Replicat to the new data pump</p>
<ol>
<li>
<p>In GGSCI on the target system, add a Replicat group to read the remote trail. For <code dir="ltr">EXTTRAIL</code>, specify the same trail as in the <code dir="ltr">RMTTRAIL</code> Extract parameter and the <code dir="ltr">ADD RMTTRAIL</code> command.</p>
<pre dir="ltr">
ADD REPLICAT <span class="codeinlineitalic">group</span>, EXTTRAIL <span class="codeinlineitalic">trail</span>
</pre>
<p>For example:</p>
<pre dir="ltr">
ADD REPLICAT rep2, EXTTRAIL /home/ggs/dirdat/rt
</pre></li>
<li>
<p>Create a parameter file for this Replicat group. Use <code dir="ltr">MAP</code> statement(s) to specify the same tables that you specified for the new primary Extract and the data pump (if used).</p>
</li>
<li>
<p>On the source system, start the Extract groups and data pumps.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
START EXTRACT <span class="codeinlineitalic">pump</span>
</pre></li>
<li>
<p>On the target system, start the new Replicat group.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1020363"></a>
<div id="GWUAD705" class="sect2">
<h3 class="sect2"><span class="secnum">20.5.3</span> Adding Another Data Pump to an Active Configuration</h3>
<p>This procedure adds a data-pump Extract group to an active primary Extract group on the source system. It makes these changes:</p>
<ul>
<li>
<p>The primary Extract will write to a local trail.</p>
</li>
<li>
<p>The data pump will write to a new remote trail after the data in the old trail is applied to the target.</p>
</li>
<li>
<p>The old Replicat group will be replaced by a new one.</p>
</li>
</ul>
<p>Steps are performed on the source and target systems.</p>
<a id="i1007535"></a>
<ol>
<li>
<p>On the source system, run GGSCI.</p>
</li>
<li id="i1007537">
<p>Add a local trail, using the name of the primary Extract group for <code dir="ltr"><span class="codeinlineitalic">group</span></code>.</p>
<pre dir="ltr">
ADD EXTTRAIL <span class="codeinlineitalic">trail</span>, EXTRACT <span class="codeinlineitalic">group</span>
</pre>
<p>For example:</p>
<pre dir="ltr">
ADD EXTTRAIL dirdat\lt, EXTRACT primary
</pre></li>
<li>
<p>Open the parameter file of the primary Extract group, and replace the <code dir="ltr">RMTTRAIL</code> parameter with an <code dir="ltr">EXTTRAIL</code> parameter that points to the local trail that you created.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Do not use the <code dir="ltr">VIEW PARAMS</code> or <code dir="ltr">EDIT PARAMS</code> command to view or edit an existing parameter file that is in a character set other than that of the local operating system (such as one where the <code dir="ltr">CHARSET</code> option was used to specify a different character set). View the parameter file from outside GGSCI if this is the case; otherwise, the contents may become corrupted..</div>
<p>Example <code dir="ltr">EXTTRAIL</code> parameter:</p>
<pre dir="ltr">
EXTTRAIL dirdat\lt
</pre></li>
<li>
<p>Remove the <code dir="ltr">RMTHOST</code> parameter.</p>
</li>
<li>
<p>Save and close the file.</p>
</li>
<li id="i1007547">
<p>Add a new data-pump Extract group, using the trail that you specified in step <a href="#i1007537">2</a> as the data source.</p>
<pre dir="ltr">
ADD EXTRACT <span class="codeinlineitalic">group</span>, EXTTRAILSOURCE <span class="codeinlineitalic">trail</span>
</pre>
<p>For example:</p>
<pre dir="ltr">
ADD EXTRACT pump, EXTTRAILSOURCE dirdat\lt
</pre></li>
<li>
<p>Create a parameter file for the new data pump.</p>
<pre dir="ltr">
EDIT PARAMS <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>In the parameter file, include the appropriate Extract parameters for your configuration, plus:</p>
<ul>
<li>
<p><code dir="ltr">TABLE</code> parameter(s) for the tables that are to be processed by this data pump.</p>
</li>
<li>
<p><code dir="ltr">RMTHOST</code> parameter to point to the target system.</p>
</li>
<li>
<p><code dir="ltr">RMTTRAIL</code> parameter to point to a new remote trail (to be created later).</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the data pump will be pumping data, but not performing filtering, mapping, or conversion, you can include the <code dir="ltr">PASSTHRU</code> parameter to bypass the overhead of database lookups. You also can omit database authentication parameters.</div>
</li>
</ul>
</li>
<li>
<p>In GGSCI on the source system, add a remote trail for the data-pump. Use the trail name that is specified with <code dir="ltr">RMTTRAIL</code> in the data pump's parameter file, and specify the group name of the data pump for <code dir="ltr">EXTRACT</code>.</p>
<pre dir="ltr">
ADD RMTTRAIL <span class="codeinlineitalic">trail</span>, EXTRACT <span class="codeinlineitalic">group</span>
</pre>
<p>For example:</p>
<pre dir="ltr">
ADD RMTTRAIL dirdat/rt, EXTRACT pump
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
This command binds a trail name to an Extract group but does not actually create the trail. A trail file is created when processing starts.</div>
</li>
<li>
<p>On the target system, run GGSCI.</p>
</li>
<li>
<p>Add a new Replicat group and link it with the remote trail.</p>
<pre dir="ltr">
ADD REPLICAT <span class="codeinlineitalic">group</span>, EXTTRAIL <span class="codeinlineitalic">trail</span>
</pre>
<p>For example:</p>
<pre dir="ltr">
ADD REPLICAT rep, EXTTRAIL dirdat/rt
</pre></li>
<li>
<p>Create a parameter file for this Replicat group. You can copy the parameter file from the original Replicat group, but make certain to change the <code dir="ltr">REPLICAT</code> parameter to the new group name.</p>
</li>
<li>
<p>On the source system, stop the primary Extract group, then start it again so that the parameter changes you made take effect.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
START EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>On the source system, start the data pump.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>On the target system, issue the <code dir="ltr">LAG REPLICAT</code> command for the old Replicat, and continue issuing it until it reports <code dir="ltr">At EOF, no more records to process.</code></p>
<pre dir="ltr">
LAG REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Stop the old Replicat group.</p>
<pre dir="ltr">
STOP REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>If using a checkpoint table for the old Replicat group, log into the database from GGSCI.</p>
<pre dir="ltr">
DBLOGIN [SOURCEDB <span class="codeinlineitalic">datasource</span>] [{, USERIDALIAS <span class="codeinlineitalic">alias</span> | USERID <span class="codeinlineitalic">user</span> [,<span class="codeinlineitalic">options</span>]]
</pre></li>
<li>
<p>Delete the old Replicat group.</p>
<pre dir="ltr">
DELETE REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Start the new Replicat group.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not delete the old remote trail, just in case it is needed later on for a support case or some other reason. You can move it to another location, if desired.</div>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1007669"></a>
<div id="GWUAD706" class="sect2">
<h3 class="sect2"><span class="secnum">20.5.4</span> Adding <a id="sthref1113"></a><a id="sthref1114"></a>Another Replicat Group to an Active Configuration</h3>
<p>This procedure adds a new Replicat group to an existing Replicat group. The new Replicat reads from the same trail as the original Replicat.</p>
<p>Multiple Replicat groups may be required when Replicat is configured in classic mode, for the purpose of isolating transactions on certain tables or improving performance. Multiple Replicat groups usually are not required if using coordinated Replicat, because you can divide the workload among multiple processing threads within the same Replicat group. See <a href="wu_changesync.htm#i1007379">Section 14.7, "Creating an Online Replicat Group"</a> for more information about Replicat modes.</p>
<p>Steps are performed on the source and target systems.</p>
<ol>
<li>
<p>Choose a name for the new group.</p>
</li>
<li>
<p>On the target system, run GGSCI.</p>
</li>
<li>
<p>Create a parameter file for the new Replicat group.</p>
<pre dir="ltr">
EDIT PARAMS <span class="codeinlineitalic">group</span>
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can copy the original parameter file to use for this group, but make certain to change the Replicat group name and any other relevant parameters that apply to this new group.</div>
</li>
<li>
<p>Add <code dir="ltr">MAP</code> statements (or edit copied ones) to specify the tables that you are adding or moving to this group. If this group will be a coordinated Replicat group, include the appropriate thread specifications.</p>
</li>
<li>
<p>Save and close the parameter file.</p>
</li>
<li>
<p>On the source system, run GGSCI.</p>
</li>
<li>
<p>Stop the Extract group.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>On the target system, edit the old Replicat parameter file to remove <code dir="ltr">MAP</code> statements that specified the tables that you moved to the new Replicat group. Keep only the <code dir="ltr">MAP</code> statements that this Replicat will continue to process.</p>
</li>
<li>
<p>Save and close the file.</p>
</li>
<li>
<p>Issue the <code dir="ltr">INFO REPLICAT</code> command for the old Replicat group, and continue issuing it until it reports <code dir="ltr">At EOF, no more records to process.</code></p>
<pre dir="ltr">
   INFO REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Stop the old Replicat group. If you are stopping a coordinated Replicat, make certain the stop is clean so that all threads stop at the same trail record.</p>
<pre dir="ltr">
STOP REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li id="i1007605">
<p>Add the new Replicat group. For <code dir="ltr">EXTTRAIL</code>, specify the trail that this Replicat group is to read.</p>
<pre dir="ltr">
ADD REPLICAT <span class="codeinlineitalic">group</span>, EXTTRAIL <span class="codeinlineitalic">trail</span>
</pre>
<p>For example:</p>
<pre dir="ltr">
ADD REPLICAT rep, EXTTRAIL dirdat/rt
</pre></li>
<li>
<p>On the source system, start the Extract group.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>On the target system, start the old Replicat group.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Start the new Replicat group.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1022408"></a>
<div id="GWUAD718" class="sect1">
<h2 class="sect1"><span class="secnum">20.6</span> Changing the Size of <a id="sthref1115"></a><a id="sthref1116"></a><a id="sthref1117"></a><a id="sthref1118"></a>Trail Files</h2>
<p>You can change the size of trail files with the <code dir="ltr">MEGABYTES</code> option of either the <code dir="ltr">ALTER EXTTRAIL</code> or <code dir="ltr">ALTER RMTTRAIL</code> command, depending on whether the trail is local or remote. To change the file size, follow this procedure.</p>
<ol>
<li>
<p>Issue one of the following commands, depending on the location of the trail, to view the path name of the trail you want to alter and the name of the associated Extract group. Use a wildcard to view all trails.</p>
<p>(Remote trail)</p>
<pre dir="ltr">
INFO RMTTRAIL *
</pre>
<p>(Local trail)</p>
<pre dir="ltr">
INFO EXTTRAIL *
</pre></li>
<li>
<p>Issue one of the following commands, depending on the location of the trail, to change the file size.</p>
<p>(Remote trail)</p>
<pre dir="ltr">
ALTER RMTTRAIL <span class="codeinlineitalic">trail</span>, EXTRACT <span class="codeinlineitalic">group</span>, MEGABYTES <span class="codeinlineitalic">n</span>
</pre>
<p>(Local trail)</p>
<pre dir="ltr">
ALTER EXTTRAIL <span class="codeinlineitalic">trail</span>, EXTRACT <span class="codeinlineitalic">group</span>, MEGABYTES <span class="codeinlineitalic">n</span>
</pre></li>
<li>
<p>Issue the following command to cause Extract to switch to the next file in the trail.</p>
<pre dir="ltr">
SEND EXTRACT <span class="codeinlineitalic">group</span>, ROLLOVER
</pre></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="A1937431"></a>
<div id="GWUAD1080" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">20.7</span> Switching Extract from Classic Mode to Integrated Mode</h2>
<p>Valid for Oracle only.</p>
<p>This procedure switches an existing Extract group from classic mode to integrated mode. For more information about Extract modes for an Oracle database, see <a class="olink GIORA554" href="../../gg-winux/GIORA/process_mode.htm#GIORA554"><span class="italic">Installing and Configuring Oracle GoldenGate for Oracle Database</span></a>.</p>
<p>To support the transition to integrated mode, the transaction log that contains the start of the oldest open transaction must be available on the source or downstream mining system, depending on where Extract will be running.</p>
<p>To determine the oldest open transaction, issue the <code dir="ltr">SEND EXTRACT</code> command with the <code dir="ltr">SHOWTRANS</code> option. You can use the <code dir="ltr">FORCETRANS</code> or <code dir="ltr">SKIPTRANS</code> options of this command to manage specific open transactions, with the understanding that skipping a transaction may cause data loss and forcing a transaction to commit to the trail may add unwanted data if the transaction is rolled back by the user applications. Review these options in <a class="olink GWURF163" href="../../gg-winux/GWURF/ggsci_commands014.htm#GWURF163"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a> before using them.</p>
<pre dir="ltr">
GGSCI&gt; SEND EXTRACT <span class="codeinlineitalic">group</span>, SHOWTRANS&#65533;
GGSCI&gt; SEND EXTRACT <span class="codeinlineitalic">group</span>, { SKIPTRANS <span class="codeinlineitalic">ID</span> [THREAD <span class="codeinlineitalic">n</span>] [FORCE] |&#65533;
FORCETRANS <span class="codeinlineitalic">ID</span> [THREAD <span class="codeinlineitalic">n</span>] [FORCE] }&#65533;
</pre>
<p class="subhead2"><a id="GWUAD1081"></a>To switch Extract modes</p>
<ol>
<li>
<p>Back up the current Oracle GoldenGate working directories.</p>
</li>
<li>
<p>While the Oracle GoldenGate processes continue to run in their current configuration, so that they keep up with current change activity, copy the Extract parameter file to a new name.</p>
</li>
<li>
<p>Grant the appropriate privileges to the Extract user and perform the required configuration steps to support your business applications in integrated capture mode. See <a class="olink GIORA546" href="../../gg-winux/GIORA/user_assignment.htm#GIORA546"><span class="italic">Installing and Configuring Oracle GoldenGate for Oracle Database</span></a> for information about configuring and running Extract in integrated mode.</p>
</li>
<li>
<p>Log into the mining database with one of the following commands, depending on where the mining database is located.</p>
<pre dir="ltr">
DBLOGIN USERIDALIAS <span class="codeinlineitalic">alias</span>

MININGDBLOGIN USERIDALIAS <span class="codeinlineitalic">alias</span>
</pre>
<p>Where: <code dir="ltr"><span class="codeinlineitalic">alias</span></code> specifies the alias of a user in the credential store who has the privileges granted through the Oracle <code dir="ltr">dbms_goldengate_auth.grant_admin_privilege</code> procedure.</p>
</li>
<li>
<p>Register the Extract group with the mining database. Among other things, this creates the logmining server.</p>
<pre dir="ltr">
REGISTER EXTRACT <span class="codeinlineitalic">group</span> DATABASE
</pre></li>
<li>
<p>Stop the Extract group.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Issue the following command to determine whether the upgrade command can be issued. Transactions that started before the registration command must be written to the trail before you can proceed with the upgrade. You may have to issue this command more than once until it returns a message stating that Extract can be upgraded.</p>
<pre dir="ltr">
INFO EXTRACT <span class="codeinlineitalic">group</span> UPGRADE
</pre></li>
<li>
<p>Switch the Extract group to integrated mode. See Oracle RAC options for this command in <a class="olink GWURF133" href="../../gg-winux/GWURF/ggsci_commands007.htm#GWURF133"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a>, if applicable.</p>
<pre dir="ltr">
ALTER EXTRACT <span class="codeinlineitalic">group</span> UPGRADE INTEGRATED TRANLOG
</pre></li>
<li>
<p>Replace the old parameter file with the new one, keeping the same name.</p>
</li>
<li>
<p>Start the Extract group.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="A1937459"></a>
<div id="GWUAD1082" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">20.8</span> Switching Extract from Integrated Mode to Classic Mode</h2>
<p>Valid for Oracle only.</p>
<p>This procedure switches an existing Extract group from integrated mode to classic mode. For more information about Extract modes for an Oracle database, see <a class="olink GIORA554" href="../../gg-winux/GIORA/process_mode.htm#GIORA554"><span class="italic">Installing and Configuring Oracle GoldenGate for Oracle Database</span></a>.</p>
<p>To support the transition to classic mode, the transaction log that contains the start of the oldest open transaction must be available on the source or downstream mining system. To determine the oldest open transaction, issue the <code dir="ltr">SEND EXTRACT</code> command with the <code dir="ltr">SHOWTRANS</code> option. You can use the <code dir="ltr">FORCETRANS</code> or <code dir="ltr">SKIPTRANS</code> options of this command to manage specific open transactions, with the understanding that skipping a transaction may cause data loss and forcing a transaction to commit to the trail may add unwanted data if the transaction is rolled back by the user applications. Review these options in <a class="olink GWURF163" href="../../gg-winux/GWURF/ggsci_commands014.htm#GWURF163"><span class="italic">Reference for Oracle GoldenGate for Windows and UNIX</span></a> before using them.</p>
<pre dir="ltr">
GGSCI&gt; SEND EXTRACT <span class="codeinlineitalic">group</span>, SHOWTRANS&#65533;
GGSCI&gt; SEND EXTRACT <span class="codeinlineitalic">group</span>, { SKIPTRANS <span class="codeinlineitalic">ID</span> [THREAD <span class="codeinlineitalic">n</span>] [FORCE] |&#65533;
FORCETRANS <span class="codeinlineitalic">ID</span> [THREAD <span class="codeinlineitalic">n</span>] [FORCE] }&#65533;
</pre>
<p class="subhead2"><a id="GWUAD1083"></a>To switch Extract modes</p>
<ol>
<li>
<p>Back up the current Oracle GoldenGate working directories.</p>
</li>
<li>
<p>While the Oracle GoldenGate processes continue to run in their current configuration, so that they keep up with current change activity, copy the Extract parameter file to a new name.</p>
</li>
<li>
<p>Grant the appropriate privileges to the Extract user and perform the required configuration steps to support your business applications in classic capture mode. See <a class="olink GIORA922" href="../../gg-winux/GIORA/config_capt_classic.htm#GIORA922"><span class="italic">Installing and Configuring Oracle GoldenGate for Oracle Database</span></a> for information about configuring and running Extract in classic mode.</p>
</li>
<li>
<p>Stop the Extract group.</p>
<pre dir="ltr">
STOP EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Issue the following command to determine whether the downgrade command can be issued. Transactions that started before the downgrade command is issued must be written to the trail before you can proceed. You may have to issue this command more than once until it returns a message stating that Extract can be downgraded.</p>
<pre dir="ltr">
INFO EXTRACT <span class="codeinlineitalic">group</span> DOWNGRADE
</pre></li>
<li>
<p>Log into the mining database with one of the following commands, depending on where the mining database is located.</p>
<pre dir="ltr">
DBLOGIN USERIDALIAS <span class="codeinlineitalic">alias</span>

MININGDBLOGIN USERIDALIAS <span class="codeinlineitalic">alias</span>
</pre>
<p>Where: <code dir="ltr"><span class="codeinlineitalic">alias</span></code> is the alias of a user in the credential store who has the privileges granted through the Oracle <code dir="ltr">dbms_goldengate_auth.grant_admin_privilege</code> procedure.</p>
</li>
<li>
<p>Switch the Extract group to classic mode.</p>
<pre dir="ltr">
ALTER EXTRACT <span class="codeinlineitalic">group</span> DOWNGRADE INTEGRATED TRANLOG
</pre>
<p>If on a RAC system, then the <code dir="ltr">THREADS</code> option has to be used with the downgrade command to specify the number of RAC threads.</p>
</li>
<li>
<p>Unregister the Extract group from the mining database. Among other things, this removes the logmining server.</p>
<pre dir="ltr">
UNREGISTER EXTRACT <span class="codeinlineitalic">group</span> DATABASE
</pre></li>
<li>
<p>Replace the old parameter file with the new one, keeping the same name.</p>
</li>
<li>
<p>Start the Extract group.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="A1930154"></a>
<div id="GWUAD1084" class="sect1">
<h2 class="sect1"><span class="secnum">20.9</span> Switching Replicat from Nonintegrated Mode to Integrated Mode</h2>
<p>Valid for Oracle only. For more information about Replicat modes for an Oracle database, see <a class="olink GIORA554" href="../../gg-winux/GIORA/process_mode.htm#GIORA554"><span class="italic">Installing and Configuring Oracle GoldenGate for Oracle Database</span></a>.</p>
<p>This procedure switches an existing Replicat group from nonintegrated to integrated mode.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not configure the switch between Replicat modes to occur immediately after Extract recovers from a failure or is repositioned to a different location in the transaction log.</div>
<ol>
<li>
<p>Back up the Oracle GoldenGate working directories.</p>
</li>
<li>
<p>While the Oracle GoldenGate processes continue to run in their current configuration, so that they keep up with current change activity, copy the Replicat parameter file to a new name.</p>
</li>
<li>
<p>Grant the appropriate privileges to the Replicat user and perform the required configuration steps to support your business applications in integrated Replicat mode. See <a class="olink GIORA931" href="../../gg-winux/GIORA/config_apply.htm#GIORA931"><span class="italic">Installing and Configuring Oracle GoldenGate for Oracle Database</span></a> for information about configuring and running Replicat in integrated mode.</p>
</li>
<li>
<p>Run GGSCI.</p>
</li>
<li>
<p>Stop Replicat.</p>
<pre dir="ltr">
STOP REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Log into the target database from GGSCI.</p>
<pre dir="ltr">
DBLOGIN USERIDALIAS <span class="codeinlineitalic">alias</span>
</pre>
<p>Where: <code dir="ltr"><span class="codeinlineitalic">alias</span></code> is the alias of a user in the credential store who has the privileges granted through the Oracle <code dir="ltr">dbms_goldengate_auth.grant_admin_privilege</code> procedure.</p>
</li>
<li>
<p>Alter Replicat to integrated mode.</p>
<pre dir="ltr">
ALTER REPLICAT <span class="codeinlineitalic">group</span>, INTEGRATED
</pre></li>
<li>
<p>Replace the old parameter file with the new one, keeping the same name.</p>
</li>
<li>
<p>Start Replicat.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Verify that Replicat is in integrated mode.</p>
<pre dir="ltr">
INFO REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
<p>When you start Replicat in integrated mode for the first time, the <code dir="ltr">START</code> command registers the Replicat group with the database and starts an inbound server to which Replicat attaches. When you convert a Replicat group to integrated mode, the use of the Oracle GoldenGate checkpoint table is discontinued and recovery information is maintained internally by the inbound server and by the checkpoint file going forward. You can retain the checkpoint table in the event that you decide to switch back to nonintegrated mode.</p>
</div>
<!-- class="sect1" -->
<a id="A1914347"></a>
<div id="GWUAD1085" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">20.10</span> Switching Replicat from Integrated Mode to Nonintegrated Mode</h2>
<p>Valid for Oracle only. For more information about Replicat modes for an Oracle database, see <a class="olink GIORA554" href="../../gg-winux/GIORA/process_mode.htm#GIORA554"><span class="italic">Installing and Configuring Oracle GoldenGate for Oracle Database</span></a>.</p>
<p>You can, at any time, switch Replicat from integrated mode to nonintegrated mode. This switch automatically unregisters the Replicat group from the target database, which removes the inbound server.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not configure the switch between Replicat modes to occur immediately after Extract recovers from a failure or is repositioned to a different location in the transaction log.</div>
<ol>
<li>
<p>Back up the Oracle GoldenGate working directories.</p>
</li>
<li>
<p>While the Oracle GoldenGate processes continue to run in their current configuration, so that they keep up with current change activity, copy the Replicat parameter file to a new name.</p>
</li>
<li>
<p>Grant the appropriate privileges to the Replicat user and perform the required configuration steps to support your business applications in nonintegrated Replicat mode. See <a class="olink GIORA931" href="../../gg-winux/GIORA/config_apply.htm#GIORA931"><span class="italic">Installing and Configuring Oracle GoldenGate for Oracle Database</span></a> for information about configuring and running Replicat in integrated mode.</p>
</li>
<li>
<p>Run GGSCI.</p>
</li>
<li>
<p>Log into the target database from GGSCI.</p>
<pre dir="ltr">
DBLOGIN USERIDALIAS <span class="codeinlineitalic">alias</span>
</pre>
<p>Where: <code dir="ltr"><span class="codeinlineitalic">alias</span></code> is the alias of a user in the credential store who has the privileges granted through the Oracle <code dir="ltr">dbms_goldengate_auth.grant_admin_privilege</code> procedure.</p>
</li>
<li>
<p>Create a checkpoint table in the target database for the nonintegrated Replicat to use to store its recovery checkpoints. If a checkpoint table was previously associated with this Replicat group and still exists, you can omit this step. See <a href="wu_changesync.htm#i1041277">Section 14.3, "Creating a Checkpoint Table"</a> for more information about options for using a checkpoint table.</p>
<pre dir="ltr">
ADD CHECKPOINTTABLE<span class="codeinlineitalic"> [container.]table</span>
</pre></li>
<li>
<p>Stop Replicat.</p>
<pre dir="ltr">
STOP REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Alter Replicat to nonintegrated mode. For the <code dir="ltr">CHECKPOINTTABLE</code> argument, specify the checkpoint table that you created for this Replicat group.</p>
<pre dir="ltr">
ALTER REPLICAT <span class="codeinlineitalic">group</span>, NONINTEGRATED, CHECKPOINTTABLE <span class="codeinlineitalic">[container.]table</span>
</pre></li>
<li>
<p>Replace the old parameter file with the new one, keeping the same name.</p>
</li>
<li>
<p>Start Replicat.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre>
<p>After issuing this command, wait until there is some activity on the source database so that the switchover can be completed. (Replicat waits until its internal high-water mark is exceeded before removing the status of "switching from integrated mode.")</p>
</li>
<li>
<p>Verify that Replicat switched to nonintegrated mode.</p>
<pre dir="ltr">
INFO REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="A4251422"></a>
<div id="GWUAD1086" class="sect1">
<h2 class="sect1"><span class="secnum">20.11</span> Switching Replicat to Coordinated Mode</h2>
<p>Valid for all database types supported by Oracle GoldenGate.</p>
<p>This procedure upgrades a regular Replicat configuration (non-coordinated) to a coordinated configuration. This procedure assumes you are replacing a configuration that partitions data across multiple Extract and Replicat processes with a configuration that uses one Extract and one coordinated Replicat. The coordinated Replicat replaces the need for using multiple Replicat processes. A coordinated Replicat requires only one trail, so there is no need for multiple Extract processes or data pumps.</p>
<p>See <a href="wu_changesync.htm#i999929">Chapter 14, "Configuring Online Change Synchronization"</a> for more information about coordinated Replicat.</p>
<div id="GWUAD1087" class="sect2"><a id="sthref1119"></a>
<h3 class="sect2"><span class="secnum">20.11.1</span> Procedure overview</h3>
<p>This procedure makes use of the <code dir="ltr">EVENTACTIONS</code> parameter with a <code dir="ltr">STOP</code> action, which enables all of the Replicat processes to stop at the same point in the trail. The <code dir="ltr">EVENTACTIONS</code> action is triggered by a transaction that contains an <code dir="ltr">INSERT</code> to a dummy table. The <code dir="ltr">INSERT</code> causes each process to finish processing everything up to, and including, the event transaction and then stop cleanly. An additional event action of <code dir="ltr">IGNORE</code> is specified for Replicat to prevent the multiple Replicat processes from attempting to insert the same record to the target. The result of this procedure is that all processes stop at the same point in the data stream: after completing the <code dir="ltr">INSERT</code> transaction to the dummy table.</p>
<p>After the processes stop, you move all of the <code dir="ltr">TABLE</code> statements to one primary Extract group. You move the same <code dir="ltr">TABLE</code> statements to the data pump that reads the trail of the Extract group that you retained. You move all of the <code dir="ltr">MAP</code> statements to a new coordinated Replicat group that reads the remote trail that is associated with the retained data pump. Once all of the <code dir="ltr">MAP</code> statements are in one parameter file, you edit them to add the thread specifications to support a coordinated Replicat. (This can be done ahead of time.) Then you drop the Replicat group and add it back in coordinated mode with the same name.</p>
</div>
<!-- class="sect2" -->
<div id="GWUAD1088" class="sect2"><a id="sthref1120"></a>
<h3 class="sect2"><span class="secnum">20.11.2</span> Performing the switch to coordinated Replicat</h3>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not create the Replicat group until prompted by these instructions.</div>
<ol>
<li>
<p>Back up the current parameter files of all of the Extract groups, data pumps, and Replicat groups. You will be editing them.</p>
</li>
<li>
<p>Create a working directory outside the Oracle GoldenGate directory. You will use this directory to create and stage new versions of the parameter files. If needed, you can create a working directory on the source and target systems.</p>
</li>
<li>
<p>In the working directory, create a parameter file for a coordinated Replicat. Copy the <code dir="ltr">MAP</code> parameters from the active parameter files of all of the Replicat groups to this parameter file, and then add the thread specifications and any other parameters that support your required coordinated Replicat configuration</p>
</li>
<li>
<p>If using multiple primary Extract groups, select one to keep, and then save a copy of its current parameter file to the working directory.</p>
</li>
<li>
<p>Copy all of the <code dir="ltr">TABLE</code> statements from the other Extract groups to the new parameter file of the primary Extract that you are keeping.</p>
</li>
<li>
<p>In the working directory, save a copy of the parameter file of the data pump that is linked to the primary Extract that you are keeping.</p>
</li>
<li>
<p>Copy all of the <code dir="ltr">TABLE</code> statements from the other data pumps to the copied parameter file of the kept data pump.</p>
</li>
<li>
<p>In the source database, create a simple dummy table on which a simple <code dir="ltr">INSERT</code> statement can be performed. For this procedure, the name <code dir="ltr">schema.event</code> is used.</p>
</li>
<li>
<p>Create the same table on the target system, to avoid the need for additional configuration parameters.</p>
</li>
<li>
<p>Edit the active parameter files (not the copies) of all primary and data-pump Extract groups to add the following <code dir="ltr">EVENTACTIONS</code> parameter to each one. If the data pump is configured with the <code dir="ltr">PASSTHRU</code> parameter for the data tables, add <code dir="ltr">NOPASSTHRU</code> before the <code dir="ltr">TABLE</code> statement that captures the dummy table.</p>
<pre dir="ltr">
NOPASSTHRU
TABLE schema.event, EVENTACTIONS(STOP);
</pre></li>
<li>
<p>Edit the active parameter files (not the copies) of all of the Replicat groups to add the following <code dir="ltr">EVENTACTIONS</code> parameter to each one.</p>
<pre dir="ltr">
MAP schema.event, TARGET schema.event, EVENTACTIONS(IGNORE, STOP);
</pre></li>
<li>
<p>Stop the Oracle GoldenGate processes gracefully in the following order:</p>
<ul>
<li>
<p>Stop all Replicat processes.</p>
</li>
<li>
<p>Stop all data pumps.</p>
</li>
<li>
<p>Stop all Extract processes.</p>
</li>
</ul>
</li>
<li>
<p>Restart the Oracle GoldenGate processes in the following order so that the <code dir="ltr">EVENTACTIONS</code> parameters take effect:</p>
<ul>
<li>
<p>Start all Extract processes.</p>
</li>
<li>
<p>Start all data pumps.</p>
</li>
<li>
<p>Start all Replicat processes.</p>
</li>
</ul>
</li>
<li>
<p>On the source system, issue a transaction on the <code dir="ltr">schema.event</code> table that contains one <code dir="ltr">INSERT</code> statement. Make certain to commit the transaction.</p>
</li>
<li>
<p>In GGSCI, issue the <code dir="ltr">STATUS</code> command for all of the primary Extract and data pump processes on the source system, and issue the same command for all of the Replicat processes on the target system, until the commands show that all of the processes are <code dir="ltr">STOPPED</code>.</p>
<pre dir="ltr">
STATUS EXTRACT *
STATUS REPLICAT *
</pre></li>
<li>
<p>Replace the active parameter files of the primary Extract and data pump that you kept with the new parameter files from the working directory.</p>
</li>
<li>
<p>Delete the unneeded Extract and data pump groups and their parameter files.</p>
</li>
<li>
<p>Log into the target database by using the <code dir="ltr">DBLOGIN</code> command.</p>
</li>
<li>
<p>Delete all of the Replicat groups and their active parameter files.</p>
</li>
<li>
<p>Copy or move the new coordinated Replicat parameter file from the working directory to the Oracle GoldenGate directory.</p>
</li>
<li>
<p>In GGSCI, issue the <code dir="ltr">INFO EXTRACT</code> command for the data pump and make note of its write checkpoint position in the output (remote) trail.</p>
<pre dir="ltr">
INFO EXTRACT <span class="codeinlineitalic">pump</span>, DETAIL
</pre></li>
<li>
<p>Add a new coordinated Replicat group with the following parameters.</p>
<pre dir="ltr">
ADD REPLICAT <span class="codeinlineitalic">group</span>, EXTTRAIL <span class="codeinlineitalic">trail</span>, EXTSEQNO <span class="codeinlineitalic">sequence_number</span>, EXTRBA <span class="codeinlineitalic">rba</span>, COORDINATED MAXTHREADS <span class="codeinlineitalic">number</span>
</pre>
<p>Where:</p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">group</span></code> is the name of the coordinated Replicat group. The name must match that of the new parameter file created for this group.</p>
</li>
<li>
<p><code dir="ltr">EXTTRAIL</code> <code dir="ltr"><span class="codeinlineitalic">trail</span></code> is the name of the trail that the data pump writes to.</p>
</li>
<li>
<p><code dir="ltr">EXTSEQNO</code> <code dir="ltr"><span class="codeinlineitalic">sequence_number</span></code> is the sequence number of the trail as shown in the write checkpoint returned by the <code dir="ltr">INFO EXTRACT</code> that you issued for the data pump.</p>
</li>
<li>
<p><code dir="ltr">EXTRBA</code> <code dir="ltr"><span class="codeinlineitalic">rba</span></code> is the relative byte address in the trail as shown in the write checkpoint returned by <code dir="ltr">INFO EXTRACT</code>. Together, these position Replicat to resume processing at the correct point in the trial.</p>
</li>
<li>
<p><code dir="ltr">MAXTHREADS</code> number specifies the maximum number of threads allowed for this group. This value should be appropriate for the number of threads that are specified in the parameter file.</p>
</li>
</ul>
</li>
<li>
<p>Start the primary Extract group.</p>
</li>
<li>
<p>Start the data pump group.</p>
</li>
<li>
<p>Start the coordinated Replicat group.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="A4202693"></a>
<div id="GWUAD957" class="sect1">
<h2 class="sect1"><span class="secnum">20.12</span> Administering a Coordinated Replicat Configuration</h2>
<p>This section contains instructions for coordinating threads and re-partitioning the workload among new or different threads. A coordinated Replicat should be stopped cleanly with the <code dir="ltr">STOP REPLICAT</code> command before making modifications to the partition specifications in <code dir="ltr">THREAD</code> or <code dir="ltr">THREADRANGE</code> clauses of the <code dir="ltr">MAP</code> statements. A clean stop ensures that all of the threads, which may be at different locations in the trail at any given point, all finish their work and arrive at a common trail location.</p>
<p>At startup, Replicat issues an error and abends if it detects that the last shutdown was not clean and the partitioning in the <code dir="ltr">MAP</code> statements was changed to contain a different number of threads (threads were added or removed). However, if the same threads are kept in the parameter file but simply rearranged among different <code dir="ltr">MAP</code> statements, Replicat issues a warning but does not abend. This can result in missing or duplicate records, because there is no way to ensure continuity of the thread-to-workload allocations from the previous run.</p>
<p>The following is an example of this condition.</p>
<p>Following is the original partitioning scheme:</p>
<pre dir="ltr">
MAP source, target, THREADRANGE(1-5);
MAP source1, target1, THREADRANGE(6-10);
</pre>
<p>The following re-partitioning of the original scheme produces only a warning:</p>
<pre dir="ltr">
MAP source, target, THREADRANGE(1-4);
MAP source1, target1, THREADRANGE(5-10);
</pre>
<p>This section provides instructions for cleanly shutting down Replicat before performing a re-partitioning, as well as instructions for attempting to recover Replicat continuity when a re-partitioning is performed after an unclean shutdown.</p>
<p>The following tasks can be performed for a Replicat group in coordinated mode.</p>
<p><a href="#CIHCJEGH">Section 20.12.1, "Performing a Planned Re-partitioning of the Workload"</a></p>
<p><a href="#CIHCGGAH">Section 20.12.2, "Recovering Replicat after an Unplanned Re-partitioning"</a></p>
<p><a href="#A1045838">Section 20.12.3, "Synchronizing threads after an Unclean Stop"</a></p>
<a id="CIHCJEGH"></a>
<div id="GWUAD958" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">20.12.1</span> Performing a Planned Re-partitioning of the Workload</h3>
<p>A planned re-partitioning is when Replicat is allowed to shut down cleanly before it is started again with a new parameter file that contains updated thread partitioning. A clean shutdown enables all of the threads to arrive at a common checkpoint position in the trail. At that point, the new partitioning scheme can be applied in the next run. If Replicat does not shut down cleanly in this procedure, for example if there is an apply error, use the procedure in <a href="#A1045838">Section 20.12.3</a> to re-synchronize the threads before you re-partition them.</p>
<ol>
<li>
<p>Run GGSCI.</p>
</li>
<li>
<p>Stop Replicat.</p>
<pre dir="ltr">
STOP REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Open the parameter file for editing.</p>
<pre dir="ltr">
EDIT PARAMS <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Make the required changes to the <code dir="ltr">THREAD</code> or <code dir="ltr">THREADRANGE</code> specifications in the <code dir="ltr">MAP</code> statements.</p>
</li>
<li>
<p>Save and close the parameter file.</p>
</li>
<li>
<p>Start Replicat.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHCGGAH"></a>
<div id="GWUAD959" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">20.12.2</span> Recovering Replicat after an Unplanned Re-partitioning</h3>
<p>An <span class="italic">unplanned re-partitioning</span> is when Replicat is not allowed to shut down cleanly before it is started again with a new parameter file that contains updated thread partitioning. In this scenario, some or all of the old threads were not able to finish their work and arrive at a common checkpoint. Upon restart, the coordinator thread attempts to apply the old partitioning scheme, and Replicat abends with an error. You can recover the coordinated Replicat group from this condition in one of the following ways:</p>
<ul>
<li>
<p>Use the auto-saved copy of the parameter file</p>
</li>
<li>
<p>Reprocess from the low watermark with <code dir="ltr">HANDLECOLLISIONS</code></p>
</li>
</ul>
<div id="GWUAD960" class="sect3"><a id="sthref1121"></a>
<h4 class="sect3"><span class="secnum">20.12.2.1</span> Reprocessing from the low watermark with HANDLECOLLISIONS</h4>
<p>In this procedure, you reposition all of the threads to the <span class="italic">low watermark</span> position. This is the earliest checkpoint position performed among all of the threads. To state it another way, the low watermark position is the last record processed by the slowest thread before the unclean stop. When you start Replicat, the threads reprocess the operations that they were processing before Replicat stopped, and the <code dir="ltr">HANDLECOLLISIONS</code> parameter handles any duplicate-record and missing-record errors that occur as the faster threads reprocess operations that they applied before the unclean stop.</p>
<ol>
<li>
<p>Add the <code dir="ltr">HANDLECOLLISIONS</code> parameter to the Replicat parameter file. It is not necessary to use any <code dir="ltr">THREADS</code> options.</p>
</li>
<li>
<p>Issue the <code dir="ltr">INFO REPLICAT</code> command for the Replicat group as a whole (the coordinator thread). Make a record of the RBA of the checkpoint. This is the <span class="italic">low watermark</span> value. This output also shows you the active thread IDs under the <code dir="ltr">Group Name</code> column. Make a record of these, as well.</p>
<pre dir="ltr">
INFO REPLICAT <span class="codeinlineitalic">group</span>

GGSCI (slc03jgo) 3&gt; info ra detailREPLICAT   RA       Last Started 2013-05-01 14:15   Status ABENDEDCOORDINATED          Coordinator                      MAXTHREADS 15Checkpoint Lag       00:00:00 (updated 00:00:07 ago)Process ID           11445Log Read Checkpoint  File ./dirdat/withMaxTransOp/bg000001                     2013-05-02 07:49:45.975662  RBA 44704Lowest Log BSN value: (requires database login)Active Threads: ID  Group Name PID   Status   Lag at Chkpt  Time Since Chkpt1   RA001     11454 ABENDED  00:00:00      00:00:01    2   RA002     11455 ABENDED  00:00:00      00:00:04    3   RA003     11456 ABENDED  00:00:00      00:00:01    5   RA005     11457 ABENDED  00:00:00      00:00:02    6   RA006     11458 ABENDED  00:00:00      00:00:04    7   RA007     11459 ABENDED  00:00:00      00:00:04  
</pre></li>
<li>
<p>Issue the <code dir="ltr">INFO REPLICAT</code> command for each processing thread ID and record the RBA position of each thread. Make a note of the <span class="italic">highest</span> RBA. This is the <span class="italic">high watermark</span> of the Replicat group.</p>
<pre dir="ltr">
INFO REPLICAT <span class="codeinlineitalic">threadID</span>

 info ra002
REPLICAT   RA002    Last Started 2013-05-01 14:15   Status ABENDEDCOORDINATED          Replicat Thread                  Thread 2Checkpoint Lag       00:00:00 (updated 00:00:06 ago)Process ID           11455
Log Read Checkpoint  File ./dirdat/withMaxTransOp/bg000001                     2013-05-02 07:49:15.837271  RBA 45603
</pre></li>
<li>
<p>Issue the <code dir="ltr">ALTER REPLICAT</code> command for the coordinator thread (Replicat as a whole, without any thread ID) and position to the <span class="italic">low watermark</span> RBA that you recorded.</p>
<pre dir="ltr">
ALTER REPLICAT <span class="codeinlineitalic">group</span> EXTRBA <span class="codeinlineitalic">low_watermark_rba</span>
</pre></li>
<li>
<p>Start Replicat.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Issue the basic <code dir="ltr">INFO REPLICAT</code> command until it shows an RBA that is higher than the <span class="italic">high watermark</span> that you recorded. <code dir="ltr">HANDLECOLLISIONS</code> handles any collisions that occur due to previously applied transactions.</p>
<pre dir="ltr">
INFO REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Stop Replicat.</p>
<pre dir="ltr">
STOP REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Remove or comment out the <code dir="ltr">HANDLECOLLISIONS</code> parameter.</p>
</li>
<li>
<p>Start Replicat.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect3" -->
<div id="GWUAD961" class="sect3"><a id="sthref1122"></a>
<h4 class="sect3"><span class="secnum">20.12.2.2</span> Using the auto-saved parameter file</h4>
<p>A copy of the original parameter file is saved whenever the parameter file is edited before shutting down Replicat cleanly. You can revert to this parameter file and then resynchronize the threads so that they all catch up to the thread that had the most recent checkpoint position. Once the threads are synchronized, you can switch to the new parameter file and then start Replicat.</p>
<ol>
<li>
<p>Save the new parameter file to a different name, and then rename the saved original parameter file to the correct name (same as the group name). The saved parameter file has a <code dir="ltr">.backup</code> suffix and is stored in the <code dir="ltr">dirprm</code> subdirectory of the Oracle GoldenGate installation directory.</p>
</li>
<li>
<p>Issue the following command to synchronize the Replicat threads to the maximum checkpoint position. This command automatically starts Replicat and executes the threads until they reach the maximum checkpoint position.</p>
<pre dir="ltr">
SYNCHRONIZE REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Issue the <code dir="ltr">STATUS REPLICAT</code> command until it shows that Replicat stopped cleanly.</p>
<pre dir="ltr">
STATUS REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Save the original parameter file to a different name, and then rename the new parameter file to the group name.</p>
</li>
<li>
<p>Start Replicat.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="A1045838"></a>
<div id="GWUAD962" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">20.12.3</span> Synchronizing threads after an Unclean Stop</h3>
<p>When a Replicat group stops in an unclean manner, not all of the threads will reach a common checkpoint position in the trail. Unclean stops can be caused by issuing <code dir="ltr">STOP REPLICAT</code> with the <code dir="ltr">!</code> option, issuing the <code dir="ltr">KILL REPLICAT</code> command, or by transient errors related to Replicat, the database, or other local processes. You can restore the threads to the same position in the trail after an unclean stop and then start Replicat again from the correct checkpoint position.</p>
<p>In this procedure, the restore position is the <span class="italic">high watermark</span>. This is the most recent checkpoint position performed among all of the threads (the last record processed by the fastest thread before the unclean stop). Before starting Replicat, you can make changes to the parameter file, such as to repartition the workload among different or new threads. The repartitioning takes effect in a seamless manner after you start Replicat, because the threads can start from a synchronized state.</p>
<ol>
<li>
<p>Run GGSCI.</p>
</li>
<li>
<p>Synchronize the Replicat threads to the maximum checkpoint position. Replicat performs the synchronization and then stops.</p>
<pre dir="ltr">
SYNCHRONIZE REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>(Optional) To re-partition the workload among different or new threads, open the parameter file for editing and then make the required changes to the <code dir="ltr">THREAD</code> or <code dir="ltr">THREADRANGE</code> specifications in the <code dir="ltr">MAP</code> statements.</p>
<pre dir="ltr">
EDIT PARAMS <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Save and close the parameter file.</p>
</li>
<li>
<p>Start Replicat.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="A4215731"></a>
<div id="GWUAD980" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">20.13</span> Restarting a Primary Extract after System Failure or Corruption</h2>
<p>This procedure enables Oracle GoldenGate to recover from certain conditions, such as a file system corruption or a system failure, that corrupt the Extract checkpoint file, trail, or both, and which prevent Extract from being able to start. It enables you to establish a safe starting point in the transaction log for the primary Extract after the system has been restored. It also shows you how to reposition downstream data pumps and Replicat to read from the correct Extract write position in the trails, and to filter out any transactions that Replicat already applied to the target.</p>
<div id="GWUAD981" class="sect2"><a id="sthref1123"></a>
<h3 class="sect2"><span class="secnum">20.13.1</span> Details of this procedure</h3>
<p>Extract passes a <span class="italic">log begin sequence number</span>, or <span class="italic">LOGBSN</span>, to the trail files. The BSN is the native database sequence number that identifies the oldest uncommitted transaction that is held in Extract memory. For example, the BSN in an Oracle installation would be the Oracle system change number (SCN). Each trail file contains the lowest <code dir="ltr">LOGBSN</code> value for all of the transactions in that trail file. Once you know the <code dir="ltr">LOGBSN</code> value, you can reposition Extract at the correct read position to ensure that the appropriate transactions are re-generated to the trail and propagated to Replicat.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
In an Oracle RAC environment, the lowest SCN of all of the threads is transmitted to Replicat. Transactions that may already have been committed by Replicat are handled as duplicates at startup. However, any thread that has been idle past a certain threshold will not be considered for the BSN value, to avoid Extract having to read too far back in the log stream when restarted.</div>
<p>The bounded recovery checkpoint is not taken into account when calculating the <code dir="ltr">LOGBSN</code>. The failure that affected the Extract checkpoint file may also involve a loss of the persisted bounded recovery data files and bounded recovery checkpoint information.</p>
</div>
<!-- class="sect2" -->
<div id="GWUAD982" class="sect2"><a id="sthref1124"></a>
<h3 class="sect2"><span class="secnum">20.13.2</span> Performing the Recovery</h3>
<p>Follow these steps in the order shown to recover the Oracle GoldenGate processes.</p>
<ol>
<li>
<p>In GGSCI on the target system, issue the <code dir="ltr">DBLOGIN</code> command.</p>
<pre dir="ltr">
DBLOGIN {USERID <span class="codeinlineitalic">Replicat_user</span> | USERIDALIAS <span class="codeinlineitalic">alias_of_Replicat_user</span>} 
</pre></li>
<li>
<p>On the target, obtain the <code dir="ltr">LOGBSN</code> value by issuing the <code dir="ltr">INFO REPLICAT</code> command with the <code dir="ltr">DETAIL</code> option.</p>
<pre dir="ltr">
INFO REPLICAT group, DETAIL
</pre>
<p>The BSN is included in the output as a line similar to the following:</p>
<pre dir="ltr">
Current Log BSN value: 1151679
</pre></li>
<li>
<p>(Classic capture mode only. Skip if using integrated capture mode.) Query the source database to find the sequence number of the transaction log file that contains the value of the <code dir="ltr">LOGBSN</code> that you identified in the previous step. This example assumes 1855798 is the <code dir="ltr">LOGBSN</code> value and shows that the sequence number of the transaction log that contains that <code dir="ltr">LOGBSN</code> value is 163.</p>
<pre dir="ltr">
SQL&gt; select name, thread#, sequence# from v$archived_log 
where 1855798 between first_change# and next_change#; 

NAME                                  THREAD#    SEQUENCE# 
------------------------------------- ---------- ----------/oracle/dbs/arch1_163_800262442.dbf   1          163 
</pre></li>
<li>
<p>Issue the following commands in GGSCI to reposition the primary Extract to the <code dir="ltr">LOGBSN</code> start position.</p>
<ul>
<li>
<p>(Classic capture mode)</p>
<pre dir="ltr">
ALTER EXTRACT <span class="codeinlineitalic">group</span> EXTSEQNO 163
ALTER EXTRACT <span class="codeinlineitalic">group</span> EXTRBA 0 
ALTER EXTRACT <span class="codeinlineitalic">group</span> ETROLLOVER
</pre></li>
<li>
<p>(Integrated capture mode)</p>
<pre dir="ltr">
ALTER EXTRACT <span class="codeinlineitalic">group</span> SCN 1151679
ALTER EXTRACT <span class="codeinlineitalic">group</span> ETROLLOVER
</pre></li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
There is a limit on how far back Extract can go in the transaction stream, when in integrated mode. If the required SCN is no longer available, the <code dir="ltr">ALTER EXTRACT</code> command fails.</div>
</li>
<li>
<p>Issue the following command in GGSCI to the primary Extract to view the new sequence number of the Extract <code dir="ltr"><span class="codeinlineitalic">Write Checkpoint</span></code>. This command shows the trail and RBA where Extract will begin to write new data. Because a rollover was issued, the start point is at the beginning (RBA 0) of the new trail file, in this example file number 7.</p>
<pre dir="ltr">
INFO EXTRACT <span class="codeinlineitalic">group</span> SHOWCH
Sequence #: 7
RBA: 0 
</pre></li>
<li>
<p>Issue the following command in GGSCI to reposition the downstream data pump and start a new output trail file.</p>
<pre dir="ltr">
ALTER EXTRACT <span class="codeinlineitalic">pump</span> EXTSEQNO 7
ALTER EXTRACT <span class="codeinlineitalic">pump</span> EXTRBA 0
ALTER EXTRACT <span class="codeinlineitalic">pump</span> ETROLLOVER
</pre></li>
<li>
<p>Issue the following command in GGSCI to the data pump Extract to view the new sequence number of the data pump Write Checkpoint, in this example trail number 9.</p>
<pre dir="ltr">
INFO EXTRACT <span class="codeinlineitalic">pump</span> SHOWCH
Sequence #: 9
RBA: 0 
</pre></li>
<li>
<p>Reposition Replicat to start reading the trail at the new Write Checkpoint of the data pump.</p>
<pre dir="ltr">
ALTER REPLICAT <span class="codeinlineitalic">group</span> EXTSEQNO 9
ALTER REPLICAT <span class="codeinlineitalic">group</span> EXTRBA 0
</pre></li>
<li>
<p>Start the primary Extract and the data pump.</p>
<pre dir="ltr">
START EXTRACT <span class="codeinlineitalic">group</span>
START REPLICAT <span class="codeinlineitalic">group</span>
</pre></li>
<li>
<p>Issue the following command in GGSCI to start Replicat. If Replicat is operating in integrated mode (Oracle targets only), omit the <code dir="ltr">FILTERDUPTRANSACTIONS</code> option. Integrated Replicat handles duplicate transactions transparently.</p>
<pre dir="ltr">
START REPLICAT <span class="codeinlineitalic">group</span>[, FILTERDUPTRANSACTIONS]
</pre></li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code dir="ltr">LOGBSN</code> gives you the information needed to set Extract back in time to reprocess transactions. Some filtering by Replicat is necessary because Extract will likely re-generate a small amount of data that was already applied by Replicat. <code dir="ltr">FILTERDUPTRANSACTIONS</code> directs Replicat to find and filter duplicates at the beginning of the run.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment150">
<tr>
<td class="cellalignment157"><table class="cellalignment155">
<tr>
<td class="cellalignment154"><a href="wu_performance.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>

<td class="cellalignment154"><a href="wu_backout.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table></td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2013, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment159">
<table class="cellalignment153">
<tr>
<td class="cellalignment154"><a href="../../index.html"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment154"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment154"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment154"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
