<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Using the Pluggable Formatters</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2016-06-08T07:49:17Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Integrating Oracle GoldenGate for Big Data" />
<meta name="dcterms.identifier" content="E65148-03" />
<meta name="dcterms.isVersionOf" content="GADBD" />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="GUID-2561CA12-9BAC-454B-A2E3-2D36C5C60EE5.htm" title="Previous" type="text/html" />
<link rel="Next" href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm" title="Next" type="text/html" />
<link rel="alternate" href="E65148-03.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="E65148-03.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="E65148-03.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Skip Headers</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr"><a id="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0"></a> <span id="PAGE" style="display:none;">9/15</span> <!-- End Header --><a id="GADBD479"></a>
<h1 id="GADBD-GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0" class="sect1"><span class="enumeration_chapter">6</span> Using the Pluggable Formatters</h1>
<div>
<p>Formatters provide the functionality to convert operations from the Oracle GoldenGate trail file info formatted messages that can then be sent to Big Data targets by one of the Oracle GoldenGate for Big Data Handlers. The Oracle GoldenGate for Big Data release ships with the following five pluggable formatters:</p>
<ul style="list-style-type: disc;">
<li>
<p>Delimited Text</p>
</li>
<li>
<p>JSON</p>
</li>
<li>
<p>XML</p>
</li>
<li>
<p>Avro Row</p>
</li>
<li>
<p>Avro Operation</p>
</li>
</ul>
<p>This chapter contains the following sections:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-7683E975-3283-440D-84B1-973BFE2551E7">Operation versus Row Based Formatting</a></p>
</li>
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-D7986B13-1D90-45FB-A5F8-4CF69EA2EE6C">Delimited Text Formatter</a></p>
</li>
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-5B255190-419E-417C-B09D-4169E09B418E">JSON Formatter</a></p>
</li>
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-3282CC22-92E8-4637-AD8D-E5E3F48BE9F5">Avro Row Formatter</a></p>
</li>
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-D77D819B-FDA2-4348-9899-711B50302F96">Avro Operation Formatter</a></p>
</li>
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-2EBC39AB-CF4E-45DC-AD50-A16465AB534D">XML Formatter</a></p>
</li>
</ul>
</div>
<a id="GADBD480"></a>
<div class="props_rev_3"><a id="GUID-7683E975-3283-440D-84B1-973BFE2551E7"></a>
<h2 id="GADBD-GUID-7683E975-3283-440D-84B1-973BFE2551E7" class="sect2"><span class="enumeration_section">6.1</span> Operation versus Row Based Formatting</h2>
<div>
<div class="section">
<p>The Oracle GoldenGate for Big Data formatters are of two categories, operation based formatters and row based formatters. Operations represent the individual insert, update, and delete events that occur on table data in the source database. Insert operations only provide after change data (or images) since a new row is being added to the source database. Update operations provide both before and after change data which shows how existing row data is modified. Delete operations only provide before change data to provide identification of the row being deleted. The operation based formatters model the operation as it is exists in the source trail file. Operation based formats include fields for the before and after images. The row based formatters model the row data as it exists after the operation data is applied. Row based formatters only contain a single image of the data. The following represents what data is displayed for both the operation and row based formatters.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD481"></a>
<div class="props_rev_3"><a id="GUID-0ADE9CEC-1266-4CAA-BF67-882709AED73D"></a>
<h3 id="GADBD-GUID-0ADE9CEC-1266-4CAA-BF67-882709AED73D" class="sect3"><span class="enumeration_section">6.1.1</span> Operation Formatters</h3>
<div>
<p>The formatters that support operation based formatting are JSON, Avro Operation, and XML. The output of operation based formatters are as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>Insert Operation - Before image data is NULL. After image data is output.</p>
</li>
<li>
<p>Update Operation - Both before and after image data is output.</p>
</li>
<li>
<p>Delete Operation - Before image data is output. After image data is NULL.</p>
</li>
<li>
<p>Truncate Operation - Both before and after image data is NULL.</p>
</li>
</ul>
</div>
</div>
<a id="GADBD482"></a>
<div class="props_rev_3"><a id="GUID-9EEFAE06-4CBE-427A-8C61-2B6964A27391"></a>
<h3 id="GADBD-GUID-9EEFAE06-4CBE-427A-8C61-2B6964A27391" class="sect3"><span class="enumeration_section">6.1.2</span> Row Formatters</h3>
<div>
<p>The formatters that support row based formatting area Delimited Text and Avro Row. Row based formatters output the following information for the following operations.</p>
<ul style="list-style-type: disc;">
<li>
<p>Insert Operation - After image data only.</p>
</li>
<li>
<p>Update Operation - After image data only. Primary key updates are a special case which will be discussed in individual sections for the specific formatters.</p>
</li>
<li>
<p>Delete Operation - Before image data only.</p>
</li>
<li>
<p>Truncate Operation - Table name is provided but both before and after image data are NULL. Truncate table is a DDL operation and it may not support different database implementations. Refer to the Oracle GoldenGate documentation for your database implementation.</p>
</li>
<li>
<p>Table Row or Column Value States</p>
</li>
<li>
<p>In an RDBMS, table data for a specific row and column can only have one of two states. Either the table row/column value has a value or the row/column value is NULL. However when data is transferred to the Oracle GoldenGate trail file by the Oracle GoldenGate capture process, this can expand to three possible states: the table row/column has a value, the row/column value is NULL, or the row/column value is missing.</p>
</li>
<li>
<p>For an insert operation it is reasonable to expect that the after image contains data for all column values whether that column has a value or is NULL. However, the data included for update and delete operations may not always contain complete data for all columns. When replicating data to an RDBMS for an update operation the only data that is required to modify the data in the target database are the primary key values and the values of the columns that changed. Additionally, for a delete operation it is only necessary to have the primary key values to delete the row from the target database. Therefore, even though table row/column values have a value in the source database, the values may be missing in the source trail file. Because it is possible for row/column data in the source trail file to have three states, the Big Data Formatters must also be able to represent data in the three states.</p>
</li>
<li>
<p>What row/column data is available in the Oracle GoldenGate trail file will have an impact on Big Data integrations. It is important for you to understand what data is required. You typically has control on what data is included for operations in the Oracle GoldenGate trail file. For Oracle Databases this is controlled by the supplemental logging level. Refer to the Oracle GoldenGate documentation for your specific source database implementation to understand how to control the row/column values that are included in the Oracle GoldenGate trail file.</p>
</li>
</ul>
</div>
</div>
</div>
<a id="GADBD483"></a>
<div class="props_rev_3"><a id="GUID-D7986B13-1D90-45FB-A5F8-4CF69EA2EE6C"></a>
<h2 id="GADBD-GUID-D7986B13-1D90-45FB-A5F8-4CF69EA2EE6C" class="sect2"><span class="enumeration_section">6.2</span> Delimited Text Formatter</h2>
<div>
<div class="section">
<p>The Delimited Text Formatter is a row based formatter. It formats database operations from the source trail file into a delimited text output. Each insert, update, delete, or truncate operation from the source trail will be formatted into an individual delimited message. Delimited text output will be a fixed number of fields for each table separated by a field delimiter and terminated by a line delimiter. The fields are positionally relevant. Many Big Data analytical tools including Hive work well with HDFS files containing delimited text.</p>
<p>Column values for an operation from the source trail file can have one of three states: column has a value, column value is NULL, or column value is missing. By default the delimited text maps these column value states into the delimited text output as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>Column has a value - The column value is output.</p>
</li>
<li>
<p>Column value is NULL - The default output value is <code>NULL</code>. The output for the case of a NULL column value is configurable.</p>
</li>
<li>
<p>Column value is missing - The default output value is "". The output for the case of a missing column value is configurable.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<a id="GADBD484"></a>
<div class="props_rev_3"><a id="GUID-7C03E28E-E9C6-4E90-BC7E-98D1414B0FD1"></a>
<h3 id="GADBD-GUID-7C03E28E-E9C6-4E90-BC7E-98D1414B0FD1" class="sect3"><span class="enumeration_section">6.2.1</span> Message Formatting Details</h3>
<div>
<div class="section">
<p>The default format for output of data is the following:</p>
<p>First is the row metadata:</p>
<pre dir="ltr">
&lt;OPERATION TYPE&gt;&lt;FIELD DELIMITER&gt;&lt;FULLY QUALIFIED TABLE NAME&gt;&lt;FIELD DELIMITER&gt;&lt;OPERATION TIMESTAMP&gt;&lt;FIELD DELIMITER&gt;&lt;CURRENT TIMESTAMP&gt;&lt;FIELD DELIMITER&gt;&lt;TRAIL POSITION&gt;&lt;FIELD DELIMITER&gt;&lt;TOKENS&gt;&lt;FIELD DELIMITER&gt;
</pre>
<p>Next is the row data:</p>
<pre dir="ltr">
&lt;COLUMN 1 VALUE&gt;&lt;FIELD DELIMITER&gt;&lt;COLUMN N VALUE&gt;&lt;LINE DELIMITER&gt;
</pre>
<p>Optionally, the column name can be included before each column value that changes the output format for the row data:</p>
<p><code>&lt;COLUMN 1 NAME&gt;&lt;FIELD DELIMITER&gt;&lt;COLUMN 1 VALUE&gt;&lt;COLUMN N NAME&gt;&lt;FIELD DELIMITER&gt;&lt;COLUMN N VALUE&gt;&lt;LINE DELIMITER&gt;</code></p>
<p><span class="bold">Operation Type</span> - Operation type is the indicator of the type of database operation from the source trail file. Default values are <code>I</code> for insert, <code>U</code> for update, <code>D</code> for delete, <code>T</code> for truncate. Output of this field is suppressible.</p>
<p><span class="bold">Fully Qualified Table name</span> - The fully qualified table name is the source database table include including the catalog name and schema name. The format of the fully qualified table name is <span class="italic"><code>CATALOG NAME.SCHEMA NAME.TABLE NAME</code></span>. Output of this field is suppressible.</p>
<p><span class="bold">Operation Timestamp</span> - The operation timestamp is the commit record timestamp from the source system. Therefore all operations in a transaction (unbatched transaction) should have the same operation timestamp. This timestamp is fixed, and the operation timestamp will be the same if the trail file is replayed. Output of this field is suppressible.</p>
<p><span class="bold">Current Timestamp</span> - The current timestamp is a timestamp of the current time when delimited text formatter processes the current operation record. This timestamp follows the ISO-8601 format and includes microsecond precision. Replaying the trail file will <span class="italic">not</span> result in the same timestamp for the same operation. Output of this field is suppressible.</p>
<p><span class="bold">Trail Position</span> - This is the concatenated sequence number and RBA number from the source trail file. The trail position provides traceability of the operation back to the source trail file. The sequence number is the source trail file number. The RBA number is the offset in the trail file. Output of this field is suppressible.</p>
<p><span class="bold">Tokens</span> - The tokens are the token key value pairs from the source trail file. The output of this field in the delimited text output is suppressed if the <code>includeTokens</code> configuration property on the corresponding handler is <span class="italic">not</span> explicitly set to <code>true</code>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD485"></a>
<div class="props_rev_3"><a id="GUID-D40692C8-F135-473D-9DD1-F6E979BA4272"></a>
<h3 id="GADBD-GUID-D40692C8-F135-473D-9DD1-F6E979BA4272" class="sect3"><span class="enumeration_section">6.2.2</span> Sample Formatted Messages</h3>
<div>
<div class="section">
<p>The following sections contain sample messages from the Delimited Text Formatter. The default field delimiter has been changed to a pipe ("|") to more clearly display the message.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD486"></a>
<div class="props_rev_3"><a id="GUID-AD8754E0-631B-41AF-9C14-A9E2E47942DE"></a>
<h4 id="GADBD-GUID-AD8754E0-631B-41AF-9C14-A9E2E47942DE" class="sect4"><span class="enumeration_section">6.2.2.1</span> Sample Insert Message</h4>
<div>
<div class="section">
<pre dir="ltr">
I|GG.TCUSTORD|2013-06-02
22:14:36.000000|2015-09-18T13:23:01.612001|00000000000000001444|R=AADPkvAAEAAEqL2A
AA|WILL|1994-09-30:15:33:00|CAR|144|17520.00|3|100
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD487"></a>
<div class="props_rev_3"><a id="GUID-0A2B43C3-5214-4EF6-BEA8-ED808FA6400D"></a>
<h4 id="GADBD-GUID-0A2B43C3-5214-4EF6-BEA8-ED808FA6400D" class="sect4"><span class="enumeration_section">6.2.2.2</span> Sample Update Message</h4>
<div>
<div class="section">
<pre dir="ltr">
U|GG.TCUSTORD|2013-06-02
22:14:41.000000|2015-09-18T13:23:01.987000|00000000000000002891|R=AADPkvAAEAAEqLzA
AA|BILL|1995-12-31:15:00:00|CAR|765|14000.00|3|100
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD488"></a>
<div class="props_rev_3"><a id="GUID-A9C3FDD2-60CF-4E9F-B763-0D179F164BE6"></a>
<h4 id="GADBD-GUID-A9C3FDD2-60CF-4E9F-B763-0D179F164BE6" class="sect4"><span class="enumeration_section">6.2.2.3</span> Sample Delete Message</h4>
<div>
<div class="section">
<pre dir="ltr">
D|GG.TCUSTORD|2013-06-02
22:14:41.000000|2015-09-18T13:23:02.000000|00000000000000004338|L=206080450,6=9.0.
80330,R=AADPkvAAEAAEqLzAAC|DAVE|1993-11-03:07:51:35|PLANE|600|||
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD489"></a>
<div class="props_rev_3"><a id="GUID-12535E15-FB93-4B88-BA99-2F347CDD792F"></a>
<h4 id="GADBD-GUID-12535E15-FB93-4B88-BA99-2F347CDD792F" class="sect4"><span class="enumeration_section">6.2.2.4</span> Sample Truncate Message</h4>
<div>
<div class="section">
<pre dir="ltr">
T|GG.TCUSTORD|2013-06-02
22:14:41.000000|2015-09-18T13:23:02.001000|00000000000000004515|R=AADPkvAAEAAEqL2A
AB|||||||
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="GADBD490"></a>
<div class="props_rev_3"><a id="GUID-863982E2-DCEC-42FB-A94F-76B63D8D071F"></a>
<h3 id="GADBD-GUID-863982E2-DCEC-42FB-A94F-76B63D8D071F" class="sect3"><span class="enumeration_section">6.2.3</span> Common Pitfalls</h3>
<div>
<div class="section">
<p>Care should be exercised when choosing field and line delimiters. It is important to choose delimiter values that will not occur in content of the data.</p>
<p>The Java Adapter configuration functionality will trim out leading or trailing characters that are determined to be whitespace. Wrap the configuration value in a <code>CDATA[]</code> wrapper to preserve the whitespace when configuration values contain leading or trailing characters that are considered whitespace. For example a configuration value of <code>\n</code> should be configured as <code>CDATA[\n]</code>.</p>
<p>You can&nbsp;search column values using regular expressions then replace matches with a specified value. This search and replace functionality can be utilized in conjunction with the Delimited Text Formatter to ensure that there are no collisions between column value contents and field and line delimiters. For more information, see <a href="GUID-A6C0DEC9-480F-4782-BD2A-54FEDDE2FDD9.htm#GUID-8622DB66-C2A2-4700-9CB7-02D891DE66E8">Using Regular Expression Search and Replace</a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD491"></a>
<div class="props_rev_3"><a id="GUID-17311D59-40BF-4E62-B4C4-95148EEA26B2"></a>
<h3 id="GADBD-GUID-17311D59-40BF-4E62-B4C4-95148EEA26B2" class="sect3"><span class="enumeration_section">6.2.4</span> Logging of Output Format Summary</h3>
<div>
<div class="section">
<p>The Java <code>log4j</code> logging will log a summary of the delimited text output format if <code>INFO</code> level logging is enabled. A summary of the delimited fields will be logged for each source table encountered and occurs when the first operation for that table is received by the Delimited Text formatter. You may find this detailed explanation of the fields of the delimited text output useful when performing an initial setup. In the case of the metadata change event, the summary of the delimited fields will be regenerated and logged again at the first operation for that table after the metadata change event.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD493"></a><a id="GADBD492"></a>
<div class="props_rev_3"><a id="GUID-ECCEB29A-9A84-4B0E-B924-D6B08216FC28"></a>
<h3 id="GADBD-GUID-ECCEB29A-9A84-4B0E-B924-D6B08216FC28" class="sect3"><span class="enumeration_section">6.2.5</span> Delimited Text Format Configuration</h3>
<div>
<div class="tblformalwide" id="GUID-ECCEB29A-9A84-4B0E-B924-D6B08216FC28__GUID-193C39F8-5BA1-4550-BC4B-6580EF1F0AB3">
<p class="titleintable">Table 6-1 Configuration Options</p>
<table class="cellalignment152" title="Configuration Options " summary="A five column table explaining the configuration options.">
<thead align="left">
<tr>
<th class="cellalignment151" id="d14700e458">Parameters</th>
<th class="cellalignment151" id="d14700e461">Optional / Required</th>
<th class="cellalignment165" id="d14700e464">Legal Values</th>
<th class="cellalignment169" id="d14700e467">Default</th>
<th class="cellalignment170" id="d14700e470">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment151" id="d14700e475" headers="d14700e458">
<div class="p">
<pre dir="ltr">
gg.handler.<span class="italic">name</span>.format.includeColumnNames
</pre></div>
</td>
<td class="cellalignment151" headers="d14700e475 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e475 d14700e464">
<p><code>true | false</code></p>
</td>
<td class="cellalignment169" headers="d14700e475 d14700e467">
<p><code>false</code></p>
</td>
<td class="cellalignment170" headers="d14700e475 d14700e470">
<p>Controls the output of writing the column names as a delimited field preceding the column value. If true output is like:</p>
<div class="p">
<pre dir="ltr">
COL1_Name|COL1_Value|Col2_Name|Col2_Value
</pre></div>
<p>If the false output is like:</p>
<p><code>COL1_Value|Col2_Value</code></p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e505" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.includeOpTimestamp</code></p>
</td>
<td class="cellalignment151" headers="d14700e505 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e505 d14700e464">
<p><code>true | false</code></p>
</td>
<td class="cellalignment169" headers="d14700e505 d14700e467">
<p><code>true</code></p>
</td>
<td class="cellalignment170" headers="d14700e505 d14700e470">
<p>A <code>false</code> value suppresses the output of the operation timestamp from the source trail file in the output.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e532" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.includeCurrentTimestamp</code></p>
</td>
<td class="cellalignment151" headers="d14700e532 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e532 d14700e464">
<p><code>true | false</code></p>
</td>
<td class="cellalignment169" headers="d14700e532 d14700e467">
<p><code>true</code></p>
</td>
<td class="cellalignment170" headers="d14700e532 d14700e470">
<p>A <code>false</code> value suppresses the output of the current timestamp in the output.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e559" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.includeOpType</code></p>
</td>
<td class="cellalignment151" headers="d14700e559 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e559 d14700e464">
<p><code>true | false</code></p>
</td>
<td class="cellalignment169" headers="d14700e559 d14700e467">
<p><code>true</code></p>
</td>
<td class="cellalignment170" headers="d14700e559 d14700e470">
<p>A <code>false</code> value suppresses the output of the operation type in the output.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e586" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.insertOpKey</code></p>
</td>
<td class="cellalignment151" headers="d14700e586 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e586 d14700e464">
<p>Any string</p>
</td>
<td class="cellalignment169" headers="d14700e586 d14700e467">
<p><code>I</code></p>
</td>
<td class="cellalignment170" headers="d14700e586 d14700e470">
<p>Indicator to be inserted into the output record to indicate an insert operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e609" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.updateOpKey</code></p>
</td>
<td class="cellalignment151" headers="d14700e609 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e609 d14700e464">
<p>Any string</p>
</td>
<td class="cellalignment169" headers="d14700e609 d14700e467">
<p><code>U</code></p>
</td>
<td class="cellalignment170" headers="d14700e609 d14700e470">
<p>Indicator to be inserted into the output record to indicate an update operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e632" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.deleteOpKey</code></p>
</td>
<td class="cellalignment151" headers="d14700e632 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e632 d14700e464">
<p>Any string</p>
</td>
<td class="cellalignment169" headers="d14700e632 d14700e467">
<p><code>D</code></p>
</td>
<td class="cellalignment170" headers="d14700e632 d14700e470">
<p>Indicator to be inserted into the output record to indicate a delete operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e655" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.truncateOpKey</code></p>
</td>
<td class="cellalignment151" headers="d14700e655 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e655 d14700e464">
<p>Any string</p>
</td>
<td class="cellalignment169" headers="d14700e655 d14700e467">
<p><code>T</code></p>
</td>
<td class="cellalignment170" headers="d14700e655 d14700e470">
<p>Indicator to be inserted into the output record to indicate a truncate operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e678" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.encoding</code></p>
</td>
<td class="cellalignment151" headers="d14700e678 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e678 d14700e464">
<p>Any encoding name or alias supported by Java.</p>
</td>
<td class="cellalignment169" headers="d14700e678 d14700e467">
<p>The native system encoding of the machine hosting the Oracle GoldenGate process.</p>
</td>
<td class="cellalignment170" headers="d14700e678 d14700e470">
<p>Determines the encoding of the output delimited text.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e700" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.fieldDelimiter</code></p>
</td>
<td class="cellalignment151" headers="d14700e700 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e700 d14700e464">
<p>Any String</p>
</td>
<td class="cellalignment169" headers="d14700e700 d14700e467">
<p><code>ASCII 001</code> (the default Hive delimiter)</p>
</td>
<td class="cellalignment170" headers="d14700e700 d14700e470">
<p>The delimiter used between delimited fields. This value supports <code>CDATA[]</code> wrapping.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e727" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.lineDelimiter</code></p>
</td>
<td class="cellalignment151" headers="d14700e727 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e727 d14700e464">
<p>Any String</p>
</td>
<td class="cellalignment169" headers="d14700e727 d14700e467">
<p>newline (the default Hive delimiter)</p>
</td>
<td class="cellalignment170" headers="d14700e727 d14700e470">
<p>The delimiter used between records. This value supports <code>CDATA[]</code> wrapping.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e753" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.includeTableName</code></p>
</td>
<td class="cellalignment151" headers="d14700e753 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e753 d14700e464">
<p><code>true | false</code></p>
</td>
<td class="cellalignment169" headers="d14700e753 d14700e467">
<p><code>true</code></p>
</td>
<td class="cellalignment170" headers="d14700e753 d14700e470">
<p>Use <code>false</code> to suppress the output of the table name in the output delimited data.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e780" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.keyValueDelimiter</code></p>
</td>
<td class="cellalignment151" headers="d14700e780 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e780 d14700e464">
<p>Any string</p>
</td>
<td class="cellalignment169" headers="d14700e780 d14700e467">
<p><code>=</code></p>
</td>
<td class="cellalignment170" headers="d14700e780 d14700e470">
<p>Provides a delimiter between keys and values in a map. Key1=value1. Tokens are mapped values. Configuration value supports <code>CDATA[]</code> wrapping.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e806" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.keyValuePairDelimiter</code></p>
</td>
<td class="cellalignment151" headers="d14700e806 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e806 d14700e464">
<p>Any string</p>
</td>
<td class="cellalignment169" headers="d14700e806 d14700e467">
<p><code>,</code></p>
</td>
<td class="cellalignment170" headers="d14700e806 d14700e470">
<p>Provides a delimiter between key value pairs in a map. <code>Key1=Value1</code>,<code>Key2=Value2</code>. Tokens are mapped values. Configuration value supports <code>CDATA[]</code> wrapping.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e838" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.pkUpdateHandling</code></p>
</td>
<td class="cellalignment151" headers="d14700e838 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e838 d14700e464">
<p><code>abend | update | delete-insert</code></p>
</td>
<td class="cellalignment169" headers="d14700e838 d14700e467">
<p><code>abend</code></p>
</td>
<td class="cellalignment170" headers="d14700e838 d14700e470">
<p>Provides configuration for how the formatter should handle update operations that change a primary key. Primary key operations can be problematic for the text formatter and require special consideration by you.</p>
<ul style="list-style-type: disc;">
<li>
<p><code>abend</code> - indicates the process will abend</p>
</li>
<li>
<p><code>update</code> - indicates the process will treat this as a normal update</p>
</li>
<li>
<p><code>delete-insert</code> - indicates the process will treat this as a delete and an insert. Full supplemental logging needs to be enabled for this to work. Without full before and after row images the insert data will be incomplete.</p>
</li>
</ul>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e878" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.nullValueRepresentation</code></p>
</td>
<td class="cellalignment151" headers="d14700e878 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e878 d14700e464">
<p>Any string</p>
</td>
<td class="cellalignment169" headers="d14700e878 d14700e467">
<p>NULL</p>
</td>
<td class="cellalignment170" headers="d14700e878 d14700e470">
<p>Allows you to configure what will be included in the delimited output in the case of a NULL value. Configuration value supports <code>CDATA[]</code> wrapping.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e903" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.missingValueRepresentation</code></p>
</td>
<td class="cellalignment151" headers="d14700e903 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e903 d14700e464">
<p>Any string</p>
</td>
<td class="cellalignment169" headers="d14700e903 d14700e467">
<p><code>""</code> (no value)</p>
</td>
<td class="cellalignment170" headers="d14700e903 d14700e470">
<p>Allows you to configure what will be included in the delimited text output in the case of a missing value. Configuration value supports <code>CDATA[]</code> wrapping.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e930" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.includePosition</code></p>
</td>
<td class="cellalignment151" headers="d14700e930 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e930 d14700e464">
<p><code>true | false</code></p>
</td>
<td class="cellalignment169" headers="d14700e930 d14700e467">
<p><code>true</code></p>
</td>
<td class="cellalignment170" headers="d14700e930 d14700e470">
<p>Allows you to suppress the output of the operation position from the source trail file.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e954" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.includePosition</code></p>
</td>
<td class="cellalignment151" headers="d14700e954 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e954 d14700e464">
<p><code>true | false</code></p>
</td>
<td class="cellalignment169" headers="d14700e954 d14700e467">
<p>true</p>
</td>
<td class="cellalignment170" headers="d14700e954 d14700e470">
<p>Allows you to suppress the output of the operation position from the source trail file.</p>
</td>
</tr>
<tr>
<td class="cellalignment151" id="d14700e977" headers="d14700e458">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.iso8601Forma</code></p>
</td>
<td class="cellalignment151" headers="d14700e977 d14700e461">
<p>Optional</p>
</td>
<td class="cellalignment165" headers="d14700e977 d14700e464">
<p><code>true | false</code></p>
</td>
<td class="cellalignment169" headers="d14700e977 d14700e467">
<p><code>true</code></p>
</td>
<td class="cellalignment170" headers="d14700e977 d14700e470">
<p>Controls the format of the current timestamp. The default is the ISO 8601 format. Set to <code>false</code> removes the <code>&ldquo;T&rdquo;</code> between the date and time in the current timestamp, which outputs <code>&ldquo; &ldquo;</code> instead.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD494"></a>
<div class="props_rev_3"><a id="GUID-9E69A0E7-70DF-4466-B7A5-AC71EB8F40A4"></a>
<h3 id="GADBD-GUID-9E69A0E7-70DF-4466-B7A5-AC71EB8F40A4" class="sect3"><span class="enumeration_section">6.2.6</span> Sample Configuration</h3>
<div>
<div class="section">
<p>The following is the sample configuration for the Delimited Text formatter from the Java Adapter configuration file:</p>
<pre dir="ltr">
gg.handler.hdfs.format.includeColumnNames=false
gg.handler.hdfs.format.includeOpTimestamp=true
gg.handler.hdfs.format.includeCurrentTimestamp=true
gg.handler.hdfs.format.insertOpKey=I
gg.handler.hdfs.format.updateOpKey=U
gg.handler.hdfs.format.deleteOpKey=D
gg.handler.hdfs.format.truncateOpKey=T
gg.handler.hdfs.format.encoding=UTF-8
gg.handler.hdfs.format.fieldDelimiter=CDATA[\u0001]
gg.handler.hdfs.format.lineDelimiter=CDATA[\n]
gg.handler.hdfs.format.includeTableName=true
gg.handler.hdfs.format.keyValueDelimiter=CDATA[=]
gg.handler.hdfs.format.kevValuePairDelimiter=CDATA[,]
gg.handler.hdfs.format.pkUpdateHandling=abend
gg.handler.hdfs.format.nullValueRepresentation=NULL
gg.handler.hdfs.format.missingValueRepresentation=CDATA[]
gg.handler.hdfs.format.includePosition=true
gg.handler.hdfs.format=delimitedtext
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD495"></a>
<div class="props_rev_3"><a id="GUID-30A01FF3-B2AB-411D-A885-F56799047F8C"></a>
<h3 id="GADBD-GUID-30A01FF3-B2AB-411D-A885-F56799047F8C" class="sect3"><span class="enumeration_section">6.2.7</span> Metadata Change Events</h3>
<div>
<div class="section">
<p>Oracle GoldenGate for Big Data now handles metadata change events at runtime. This assumes the replicated database and upstream replication processes are propagating metadata change events.The Delimited Text Formatter will simply change the output format to accommodate the change and continue running.</p>
<p>However, it is important to understand that a metadata change may impact downstream applications. Delimited text formats are comprised of a fixed number of fields that are positionally relevant. Deleting a column in the source table can be handled seamlessly during Oracle GoldenGate runtime, but will result in a change in the total number of fields and potentially the positional relevance of some fields. Adding an additional column or columns is probably the least impactful metadata change event assuming the new column is added to the end. You should consider the impact of a metadata change event before executing the event. In a scenario where metadata change events will be frequent, it is recommended that you consider a more flexible and self describing format, such as JSON or XML.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD496"></a>
<div class="props_rev_3"><a id="GUID-BE3DF7F8-ACEC-45AA-B2D9-5A681495FCFF"></a>
<h3 id="GADBD-GUID-BE3DF7F8-ACEC-45AA-B2D9-5A681495FCFF" class="sect3"><span class="enumeration_section">6.2.8</span> Special Considerations</h3>
<div>
<div class="section">
<p>Big Data applications differ from RDBMSs in how data is stored. Update and delete operations in an RDBMS result in a change to the existing data. On the contrary, data is not changed in Big Data applications but simply appended to existing data. Therefore, the current state of a given row becomes a consolidation of all of the existing operations for that row in the HDFS system. This leads to some special scenarios.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD498"></a><a id="GADBD497"></a>
<div class="props_rev_3"><a id="GUID-D0B9B8BB-80FC-4619-B80B-485148603759"></a>
<h4 id="GADBD-GUID-D0B9B8BB-80FC-4619-B80B-485148603759" class="sect4"><span class="enumeration_section">6.2.8.1</span> Primary Key Updates</h4>
<div>
<div class="section">
<p>Primary key update operations require special consideration and planning for Big Data integrations. Primary key updates are update operations that modify one or more of the primary keys for the given row from the source database. Since data is simply appended in Big Data applications a primary key update operation looks more like a new insert than an update without any special handling. The Delimited Text formatter provides specialized handling for primary keys that is configurable to you. These are the configurable behaviors:</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-D0B9B8BB-80FC-4619-B80B-485148603759__GUID-2E8B048A-FA52-411F-9D24-0AC9923492FC">
<p class="titleintable">Table 6-2 Configurable Behavior</p>
<table class="cellalignment145" title="Configurable Behavior" summary="A two column table explaining the configuration behavior of Delimited Text formatter">
<thead align="left">
<tr>
<th class="cellalignment171" id="d14700e1101">Value</th>
<th class="cellalignment172" id="d14700e1104">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment171" id="d14700e1109" headers="d14700e1101">
<p><code>abend</code></p>
</td>
<td class="cellalignment172" headers="d14700e1109 d14700e1104">
<p>The default behavior is that the delimited text formatter will abend in the case of a primary key update.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e1117" headers="d14700e1101">
<p><code>update</code></p>
</td>
<td class="cellalignment172" headers="d14700e1117 d14700e1104">
<p>With this configuration the primary key update will be treated just like any other update operation. This configuration alternative should only be selected if you can guarantee that the primary key that is being changed is not being used as the selection criteria when selecting row data from a Big Data system.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e1125" headers="d14700e1101">
<p><code>delete-insert</code></p>
</td>
<td class="cellalignment172" headers="d14700e1125 d14700e1104">
<p>Using this configuration the primary key update is treated as a special case of a delete using the before image data and an insert using the after image data. This configuration may more accurately model the effect of a primary key update in a Big Data application. However, if this configuration is selected it is important to have full supplemental logging enabled on replication at the source database. Without full supplemental logging, the delete operation will be correct, but the insert operation will not contain all of the data for all of the columns for a full representation of the row data in the Big Data application.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD499"></a>
<div class="props_rev_3"><a id="GUID-0993E0F0-9376-437A-9E6F-042F31DD4E53"></a>
<h4 id="GADBD-GUID-0993E0F0-9376-437A-9E6F-042F31DD4E53" class="sect4"><span class="enumeration_section">6.2.8.2</span> Data Consolidation</h4>
<div>
<div class="section">
<p>As previously stated, Big Data applications simply append data to the underlying storage. Analytic tools generally spawn map reduce programs that traverse the data files and consolidate all the operations for a given row into a single output. Therefore, it is important to have an indicator of the order of operations. The Delimited Text formatter provides a number of metadata fields to fulfill this need. The operation timestamp may be sufficient to fulfill this requirement. However, two update operations may have the same operation timestamp especially if they share a common transaction. The trail position can provide a tie breaking field on the operation timestamp. Lastly, the current timestamp may provide the best indicator of order of operations in Big Data.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="GADBD500"></a>
<div class="props_rev_3"><a id="GUID-5B255190-419E-417C-B09D-4169E09B418E"></a>
<h2 id="GADBD-GUID-5B255190-419E-417C-B09D-4169E09B418E" class="sect2"><span class="enumeration_section">6.3</span> JSON Formatter</h2>
<div>
<div class="section">
<p>The JSON Formatter is an operation based formatter. It formats operation data from the source trail file into a JSON object. Each individual insert, update, delete and truncate operation will be formatted into an individual JSON message.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD501"></a>
<div class="props_rev_3"><a id="GUID-9E6C553D-3452-42C1-912A-CB059B92A84B"></a>
<h3 id="GADBD-GUID-9E6C553D-3452-42C1-912A-CB059B92A84B" class="sect3"><span class="enumeration_section">6.3.1</span> Message Formatting Details</h3>
<div>
<div class="section">
<p>The following two subsections detail the contents of generated JSON messages. The first section details the operation metadata and the second section details the before and after image column data values.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD503"></a><a id="GADBD502"></a>
<div class="props_rev_3"><a id="GUID-32A49341-08BF-46C0-9462-04330B9081BB"></a>
<h4 id="GADBD-GUID-32A49341-08BF-46C0-9462-04330B9081BB" class="sect4"><span class="enumeration_section">6.3.1.1</span> Operation Metadata</h4>
<div>
<div class="section">
<p>JSON objects generated by the JSON Formatter contain the following metadata fields at the beginning of each message:</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-32A49341-08BF-46C0-9462-04330B9081BB__GUID-67B186FA-D10D-45DA-9EBC-9CCDCA465FDE">
<p class="titleintable">Table 6-3 JSON metadata</p>
<table class="cellalignment145" title="JSON metadata" summary="This two column table lists the JSON metadata">
<thead align="left">
<tr>
<th class="cellalignment171" id="d14700e1220">Value</th>
<th class="cellalignment172" id="d14700e1223">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment171" id="d14700e1228" headers="d14700e1220">
<p><code>table</code></p>
</td>
<td class="cellalignment172" headers="d14700e1228 d14700e1223">
<p>Contains fully qualified table name. The format of the fully qualified table name is: <span class="italic"><code>CATALOG NAME.SCHEMA NAME.TABLE NAME</code></span></p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e1239" headers="d14700e1220">
<p><code>op_type</code></p>
</td>
<td class="cellalignment172" headers="d14700e1239 d14700e1223">
<p>Contains the operation type that is the indicator of the type of database operation from the source trail file. Default values are <code>I</code> for insert, <code>U</code> for update, <code>D</code> for delete, <code>T</code> for truncate.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e1259" headers="d14700e1220">
<p><code>op_ts</code></p>
</td>
<td class="cellalignment172" headers="d14700e1259 d14700e1223">
<p>The operation timestamp is the timestamp of the operation from the source trail file. Since this timestamp is from the source trail it is fixed. Replaying the trail file will result in the same timestamp for the same operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e1267" headers="d14700e1220">
<p><code>current_ts</code></p>
</td>
<td class="cellalignment172" headers="d14700e1267 d14700e1223">
<p>The current timestamp is a timestamp of the current time when delimited text formatter processes the current operation record. This timestamp follows the ISO-8601 format and includes microsecond precision. Replaying the trail file will <span class="italic">not</span> result in the same timestamp for the same operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e1278" headers="d14700e1220">
<p><code>pos</code></p>
</td>
<td class="cellalignment172" headers="d14700e1278 d14700e1223">
<p>This is the trail file position with is the concatenated sequence number and RBA number from the source trail file. The trail position provides traceability of the operation back to the source trail file. The sequence number is the source trail file number. The RBA number is the offset in the trail file.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e1286" headers="d14700e1220">
<p><code>primary_keys</code></p>
</td>
<td class="cellalignment172" headers="d14700e1286 d14700e1223">
<p>An array variable holding the column names of the primary keys of the source table. The <code>primary_keys</code> field is only include in the JSON output if the <code>includePrimaryKeys</code> configuration property is set to <code>true</code>.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e1303" headers="d14700e1220">
<p><code>tokens</code></p>
</td>
<td class="cellalignment172" headers="d14700e1303 d14700e1223">
<p>This member is an object whose members are the token key value pairs from the source trail file.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD504"></a>
<div class="props_rev_3"><a id="GUID-8ED6B4AA-8E8C-42B5-A9AE-0B29F20B9A29"></a>
<h4 id="GADBD-GUID-8ED6B4AA-8E8C-42B5-A9AE-0B29F20B9A29" class="sect4"><span class="enumeration_section">6.3.1.2</span> Operation Data</h4>
<div>
<div class="section">
<p>The data following the operation metadata is the operation data. This data is represented by <code>before</code> and <code>after</code> members that are objects. The objects contain members with the keys being the column names and the values being the column values.</p>
<p>Column values for an operation from the source trail file can have one of three states: column has a value, column value is NULL, or column value is missing. The JSON Formatter maps these column value states into the created JSON objects as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>Column has a value - The column value is output. In the following example the member <code>STATE</code> has a value.</p>
<pre dir="ltr">
    "after":{        "CUST_CODE":"BILL",        "NAME":"BILL'S USED CARS",        "CITY":"DENVER",        "STATE":"CO"    }
</pre></li>
<li>
<p>Column value is NULL - The default output value is a JSON NULL. In the following example the member <code>STATE</code> is NULL.</p>
<pre dir="ltr">
    "after":{        "CUST_CODE":"BILL",        "NAME":"BILL'S USED CARS",        "CITY":"DENVER",        "STATE":null    }
</pre></li>
<li>
<p>Column value is missing - The JSON will contain no element for a missing column value. In the following example the member <code>STATE</code> is missing.</p>
<pre dir="ltr">
    "after":{        "CUST_CODE":"BILL",        "NAME":"BILL'S USED CARS",        "CITY":"DENVER",    }
</pre></li>
</ul>
<p>The default setting of the JSON Formatter is to map the data types from the source trail file to the associated JSON data type. JSON supports few data types so this functionality largely results in the mapping of numeric fields from the source trail file to members typed as numbers. This data type mapping is configurable to alternatively treat all data as strings.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="GADBD505"></a>
<div class="props_rev_3"><a id="GUID-EFBE916A-3DA3-451E-A21F-760B808BA2F0"></a>
<h3 id="GADBD-GUID-EFBE916A-3DA3-451E-A21F-760B808BA2F0" class="sect3"><span class="enumeration_section">6.3.2</span> Sample JSON Messages</h3>
<div>
<div class="section">
<p>The following are sample JSON messages created by the JSON Formatter for insert, update, delete, and truncate operations.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD506"></a>
<div class="props_rev_3"><a id="GUID-4870A1B1-89FE-450A-B5B0-40A226F8D443"></a>
<h4 id="GADBD-GUID-4870A1B1-89FE-450A-B5B0-40A226F8D443" class="sect4"><span class="enumeration_section">6.3.2.1</span> Sample Insert Message</h4>
<div>
<pre dir="ltr">
{
    "table":"GG.TCUSTORD",
    "op_type":"I",
    "op_ts":"2013-06-02 22:14:36.000000",
    "current_ts":"2015-09-18T13:39:35.447000",
    "pos":"00000000000000001444",
    "tokens":{
        "R":"AADPkvAAEAAEqL2AAA"
    },
    "after":{
        "CUST_CODE":"WILL",
        "ORDER_DATE":"1994-09-30:15:33:00",
        "PRODUCT_CODE":"CAR",
        "ORDER_ID":"144",
        "PRODUCT_PRICE":17520.00,
        "PRODUCT_AMOUNT":3,
        "TRANSACTION_ID":"100"
    }
}
</pre></div>
</div>
<a id="GADBD507"></a>
<div class="props_rev_3"><a id="GUID-507F81F2-A98F-43A7-827C-F6A0B1C9806E"></a>
<h4 id="GADBD-GUID-507F81F2-A98F-43A7-827C-F6A0B1C9806E" class="sect4"><span class="enumeration_section">6.3.2.2</span> Sample Update Message</h4>
<div>
<pre dir="ltr">
{
    "table":"GG.TCUSTORD",
    "op_type":"U",
    "op_ts":"2013-06-02 22:14:41.000000",
    "current_ts":"2015-09-18T13:39:35.748000",
    "pos":"00000000000000002891",
    "tokens":{
        "R":"AADPkvAAEAAEqLzAAA"
    },
    "before":{
        "CUST_CODE":"BILL",
        "ORDER_DATE":"1995-12-31:15:00:00",
        "PRODUCT_CODE":"CAR",
        "ORDER_ID":"765",
        "PRODUCT_PRICE":15000.00,
        "PRODUCT_AMOUNT":3,
        "TRANSACTION_ID":"100"
    },
    "after":{
        "CUST_CODE":"BILL",
        "ORDER_DATE":"1995-12-31:15:00:00",
        "PRODUCT_CODE":"CAR",
        "ORDER_ID":"765",
        "PRODUCT_PRICE":14000.00,
        "PRODUCT_AMOUNT":3,
        "TRANSACTION_ID":"100"
    }
}
</pre></div>
</div>
<a id="GADBD508"></a>
<div class="props_rev_3"><a id="GUID-C9B95EC9-B98D-4A77-AF24-C932B14BA71E"></a>
<h4 id="GADBD-GUID-C9B95EC9-B98D-4A77-AF24-C932B14BA71E" class="sect4"><span class="enumeration_section">6.3.2.3</span> Sample Delete Message</h4>
<div>
<pre dir="ltr">
{
    "table":"GG.TCUSTORD",
    "op_type":"D",
    "op_ts":"2013-06-02 22:14:41.000000",
    "current_ts":"2015-09-18T13:39:35.766000",
    "pos":"00000000000000004338",
    "tokens":{
        "L":"206080450",
        "6":"9.0.80330",
        "R":"AADPkvAAEAAEqLzAAC"
    },
    "before":{
        "CUST_CODE":"DAVE",
        "ORDER_DATE":"1993-11-03:07:51:35",
        "PRODUCT_CODE":"PLANE",
        "ORDER_ID":"600"
    }
}
</pre></div>
</div>
<a id="GADBD509"></a>
<div class="props_rev_3"><a id="GUID-3DC7CBA9-865E-4FB4-92B8-DD1D3843B399"></a>
<h4 id="GADBD-GUID-3DC7CBA9-865E-4FB4-92B8-DD1D3843B399" class="sect4"><span class="enumeration_section">6.3.2.4</span> Sample Truncate Message</h4>
<div>
<pre dir="ltr">
{
    "table":"GG.TCUSTORD",
    "op_type":"T",
    "op_ts":"2013-06-02 22:14:41.000000",
    "current_ts":"2015-09-18T13:39:35.767000",
    "pos":"00000000000000004515",
    "tokens":{
        "R":"AADPkvAAEAAEqL2AAB"
    }
}
</pre></div>
</div>
</div>
<a id="GADBD510"></a>
<div class="props_rev_3"><a id="GUID-190C332E-BD36-4BE8-9124-5A40BF86539E"></a>
<h3 id="GADBD-GUID-190C332E-BD36-4BE8-9124-5A40BF86539E" class="sect3"><span class="enumeration_section">6.3.3</span> JSON Schemas</h3>
<div>
<div class="section">
<p>By default JSON schemas are generated for each source table encountered. JSON schemas are generated on a just in time basis when an operation for that table is first encountered. A JSON schema is not required to parse a JSON object. However, many JSON parsers can use a JSON schema to perform a validating parse of a JSON object. Alternatively, you can review the JSON schemas to understand the layout of output JSON objects. The JSON schemas are created in the <span class="italic"><code>GoldenGate_Home</code></span><code>/dirdef</code> directory by default and are named by the following convention: <span class="italic"><code>FULLY_QUALIFIED_TABLE_NAME</code></span><code>.schema.json</code>. The generation of the JSON schemas is suppressible. The following is an example of a JSON schema for the JSON object listed in the previous section.</p>
<pre dir="ltr">
{
    "$schema":"http://json-schema.org/draft-04/schema#",
    "title":"GG.TCUSTORD",
    "description":"JSON schema for table GG.TCUSTORD",
    "definitions":{
        "row":{
            "type":"object",
            "properties":{
                "CUST_CODE":{
                    "type":[
                        "string",
                        "null"
                    ]
                },
                "ORDER_DATE":{
                    "type":[
                        "string",
                        "null"
                    ]
                },
                "PRODUCT_CODE":{
                    "type":[
                        "string",
                        "null"
                    ]
                },
                "ORDER_ID":{
                    "type":[
                        "string",
                        "null"
                    ]
                },
                "PRODUCT_PRICE":{
                    "type":[
                        "number",
                        "null"
                    ]
                },
                "PRODUCT_AMOUNT":{
                    "type":[
                        "number",
                        "null"
                    ]
                },
                "TRANSACTION_ID":{
                    "type":[
                        "string",
                        "null"
                    ]
                }
            },
            "additionalProperties":false
        },
        "tokens":{
            "type":"object",
            "description":"Token keys and values are free form key value pairs.",
            "properties":{
            },
            "additionalProperties":true
        }
    },
    "type":"object",
    "properties":{
        "table":{
            "description":"The fully qualified table name",
            "type":"string"
        },
        "op_type":{
            "description":"The operation type",
            "type":"string"
        },
        "op_ts":{
            "description":"The operation timestamp",
            "type":"string"
        },
        "current_ts":{
            "description":"The current processing timestamp",
            "type":"string"
        },
        "pos":{
            "description":"The position of the operation in the data source",
            "type":"string"
        },
        "tokens":{
            "$ref":"#/definitions/tokens"
        },
        "before":{
            "$ref":"#/definitions/row"
        },
        "after":{
            "$ref":"#/definitions/row"
        }
    },
    "required":[
        "table",
        "op_type",
        "op_ts",
        "current_ts",
        "pos"
    ],
    "additionalProperties":false
}
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD512"></a><a id="GADBD511"></a>
<div class="props_rev_3"><a id="GUID-68FB5E05-153B-400D-8B19-319098BBE6B9"></a>
<h3 id="GADBD-GUID-68FB5E05-153B-400D-8B19-319098BBE6B9" class="sect3"><span class="enumeration_section">6.3.4</span> JSON Schema Configuration</h3>
<div>
<div class="tblformalwide" id="GUID-68FB5E05-153B-400D-8B19-319098BBE6B9__GUID-43B6CC5F-C44E-4848-94BF-A11AEC3D0710">
<p class="titleintable">Table 6-4 JSON Schema Configuration Parameters</p>
<table class="cellalignment152" title="JSON Schema Configuration Parameters" summary="This two column table lists the configuration parameters for JSON schemas.">
<thead align="left">
<tr>
<th class="cellalignment168" id="d14700e1520">Parameters</th>
<th class="cellalignment160" id="d14700e1523">Required/ Optional</th>
<th class="cellalignment166" id="d14700e1526">Legal Values</th>
<th class="cellalignment166" id="d14700e1529">Default</th>
<th class="cellalignment173" id="d14700e1532">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment168" id="d14700e1537" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.insertOpKey</code></p>
</td>
<td class="cellalignment160" headers="d14700e1537 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1537 d14700e1526">
<p>Any string</p>
</td>
<td class="cellalignment166" headers="d14700e1537 d14700e1529">
<p><code>I</code></p>
</td>
<td class="cellalignment173" headers="d14700e1537 d14700e1532">
<p>Indicator to be inserted into the output record to indicate an insert operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1560" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.updateOpKey</code></p>
</td>
<td class="cellalignment160" headers="d14700e1560 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1560 d14700e1526">
<p>Any string</p>
</td>
<td class="cellalignment166" headers="d14700e1560 d14700e1529">
<p><code>U</code></p>
</td>
<td class="cellalignment173" headers="d14700e1560 d14700e1532">
<p>Indicator to be inserted into the output record to indicate an update operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1583" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.deleteOpKey</code></p>
</td>
<td class="cellalignment160" headers="d14700e1583 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1583 d14700e1526">
<p>Any string</p>
</td>
<td class="cellalignment166" headers="d14700e1583 d14700e1529">
<p><code>D</code></p>
</td>
<td class="cellalignment173" headers="d14700e1583 d14700e1532">
<p>Indicator to be inserted into the output record to indicate a delete operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1606" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.truncateOpKey</code></p>
</td>
<td class="cellalignment160" headers="d14700e1606 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1606 d14700e1526">
<p>Any string</p>
</td>
<td class="cellalignment166" headers="d14700e1606 d14700e1529">
<p><code>T</code></p>
</td>
<td class="cellalignment173" headers="d14700e1606 d14700e1532">
<p>Indicator to be inserted into the output record to indicate a truncate operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1629" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.prettyPrintformat.prettyPrint</code></p>
</td>
<td class="cellalignment160" headers="d14700e1629 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1629 d14700e1526">
<p><code>true</code> | <code>false</code></p>
</td>
<td class="cellalignment166" headers="d14700e1629 d14700e1529">
<p><code>false</code></p>
</td>
<td class="cellalignment173" headers="d14700e1629 d14700e1532">
<p>Controls the output format of the JSON data. True is pretty print, formatted with white space to be more easily read by humans. False is not pretty print, more compact but very difficult for humans to read.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1656" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.jsonDelimiter</code></p>
</td>
<td class="cellalignment160" headers="d14700e1656 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1656 d14700e1526">
<p>Any string</p>
</td>
<td class="cellalignment166" headers="d14700e1656 d14700e1529">
<p><code>""</code> (no value)</p>
</td>
<td class="cellalignment173" headers="d14700e1656 d14700e1532">
<p>Allows you to insert an optional delimiter between generated JSONs to allow them to be more easily parsed out of a continuous stream of data. Configuration value supports <code>CDATA[]</code> wrapping.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1683" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.generateSchema</code></p>
</td>
<td class="cellalignment160" headers="d14700e1683 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1683 d14700e1526">
<p><code>true</code> | <code>false</code></p>
</td>
<td class="cellalignment166" headers="d14700e1683 d14700e1529">
<p><code>true</code></p>
</td>
<td class="cellalignment173" headers="d14700e1683 d14700e1532">
<p>Controls the generation of JSON schemas for the generated JSON documents. JSON schemas are generated on a table by table basis. A JSON schema is not required to parse a JSON document. However, a JSON schema can provide you an indication of what the JSON documents will look like and can be used for a validating JSON parse.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1710" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.schemaDirectory</code></p>
</td>
<td class="cellalignment160" headers="d14700e1710 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1710 d14700e1526">
<p>Any legal, existing file system path</p>
</td>
<td class="cellalignment166" headers="d14700e1710 d14700e1529">
<p><code>./dirdef</code></p>
</td>
<td class="cellalignment173" headers="d14700e1710 d14700e1532">
<p>Controls the output location of generated JSON schemas.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1733" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.treatAllColumnsAsStrings</code></p>
</td>
<td class="cellalignment160" headers="d14700e1733 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1733 d14700e1526">
<p><code>true | false</code></p>
</td>
<td class="cellalignment166" headers="d14700e1733 d14700e1529">
<p><code>false</code></p>
</td>
<td class="cellalignment173" headers="d14700e1733 d14700e1532">
<p>Controls the output typing of generated JSON documents. If set to false then the formatter will attempt to map Oracle GoldenGate types to the corresponding JSON type. If set to true then all data will be treated as Strings in the generated JSONs and JSON schemas.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1757" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.encoding</code></p>
</td>
<td class="cellalignment160" headers="d14700e1757 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1757 d14700e1526">
<p>Any legal encoding name or alias supported by Java.</p>
</td>
<td class="cellalignment166" headers="d14700e1757 d14700e1529">
<p><code>UTF-8</code> (the JSON default)</p>
</td>
<td class="cellalignment173" headers="d14700e1757 d14700e1532">
<p>Controls the output encoding of generated JSON schemas and documents.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1781" headers="d14700e1520">
<p><code>gg.handler.</code><span class="italic"><code>name</code></span><code>.format.versionSchemas</code></p>
</td>
<td class="cellalignment160" headers="d14700e1781 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1781 d14700e1526">
<p><code>true | false</code></p>
</td>
<td class="cellalignment166" headers="d14700e1781 d14700e1529">
<p><code>false</code></p>
</td>
<td class="cellalignment173" headers="d14700e1781 d14700e1532">
<p>Controls the version of created schemas. Schema versioning causes a schema with a timestamp to be created in the schema directory on the local file system every time a new schema is created. True enables schema versioning. False disables schema versioning.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1806" headers="d14700e1520">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.iso8601Format</code></p>
</td>
<td class="cellalignment160" headers="d14700e1806 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1806 d14700e1526">
<p><code>true</code> | <code>false</code></p>
</td>
<td class="cellalignment166" headers="d14700e1806 d14700e1529">
<p><code>true</code></p>
</td>
<td class="cellalignment173" headers="d14700e1806 d14700e1532">
<p>Controls the format of the current timestamp. The default is the &nbsp;ISO 8601 format. Set to <code>false</code> removes the <code>&ldquo;T&rdquo;</code> between the date and time in the current timestamp, which outputs <code>&ldquo; &ldquo;</code> instead.</p>
</td>
</tr>
<tr>
<td class="cellalignment168" id="d14700e1841" headers="d14700e1520">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.includePrimaryKeys</code></p>
</td>
<td class="cellalignment160" headers="d14700e1841 d14700e1523">
<p>Optional</p>
</td>
<td class="cellalignment166" headers="d14700e1841 d14700e1526">
<p><code>true</code> | <code>false</code></p>
</td>
<td class="cellalignment166" headers="d14700e1841 d14700e1529">
<p><code>false</code></p>
</td>
<td class="cellalignment173" headers="d14700e1841 d14700e1532">
<p>Set this configuration property to <code>true</code> to include an array of the primary key column names from the source table in the JSON output.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD513"></a>
<div class="props_rev_3"><a id="GUID-40056CE9-8E0C-4581-993B-6F508E17AD73"></a>
<h3 id="GADBD-GUID-40056CE9-8E0C-4581-993B-6F508E17AD73" class="sect3"><span class="enumeration_section">6.3.5</span> Sample Configuration</h3>
<div>
<div class="section">
<p>The following is sample configuration for the JSON Formatter from the Java Adapter configuration file:</p>
<pre dir="ltr">
gg.handler.hdfs.format=json
gg.handler.hdfs.format.insertOpKey=I
gg.handler.hdfs.format.updateOpKey=U
gg.handler.hdfs.format.deleteOpKey=D
gg.handler.hdfs.format.truncateOpKey=T
gg.handler.hdfs.format.prettyPrint=false
gg.handler.hdfs.format.jsonDelimiter=CDATA[]
gg.handler.hdfs.format.generateSchema=true
gg.handler.hdfs.format.schemaDirectory=dirdef
gg.handler.hdfs.format.treatAllColumnsAsString
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD514"></a>
<div class="props_rev_3"><a id="GUID-A1C88CE4-58E0-478A-8B7F-377DF40B71E1"></a>
<h3 id="GADBD-GUID-A1C88CE4-58E0-478A-8B7F-377DF40B71E1" class="sect3"><span class="enumeration_section">6.3.6</span> Metadata Change Events</h3>
<div>
<div class="section">
<p>Metadata change events are now handled at runtime. A metadata change event for a given table will result in the regeneration of the JSON schema the next time an operation for that table is encountered. The content of created JSON messages will be changed to reflect the metadata change. For example, if the metadata change is to add an additional column, the new column will be included in created JSON messages after the metadata change event.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD515"></a>
<div class="props_rev_3"><a id="GUID-FAADA8EB-63FD-4AFF-B3B2-882F1209A3A2"></a>
<h3 id="GADBD-GUID-FAADA8EB-63FD-4AFF-B3B2-882F1209A3A2" class="sect3"><span class="enumeration_section">6.3.7</span> Primary Key Updates</h3>
<div>
<div class="section">
<p>Since the JSON models the operation data primary key updates require no special treatment are treated just as any other update. The before and after values will reflect the change in the primary key.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="GADBD516"></a>
<div class="props_rev_3"><a id="GUID-3282CC22-92E8-4637-AD8D-E5E3F48BE9F5"></a>
<h2 id="GADBD-GUID-3282CC22-92E8-4637-AD8D-E5E3F48BE9F5" class="sect2"><span class="enumeration_section">6.4</span> Avro Row Formatter</h2>
<div>
<div class="section">
<p>Apache Avro is an open source data serialization/deserialization framework known for its flexibility, compactness of serialized data, and good serialization/deserialization performance. Apache Avro is commonly used in Big Data applications.</p>
<p>The Avro Row Formatter formats operation data from the source trail file into messages in an Avro binary array format. Each individual insert, update, delete and truncate operation will be formatted into an individual Avro message. The source trail file will contain the before and after images of the operation data. The Avro Row Formatter takes that before and after image data and formats the data into an Avro binary representation of the operation data.</p>
<p>The Avro Row Formatter formats operations from the source trail file into a format that represents the row data. This format is more compact than the output from the Avro Operation Formatter for that the Avro messages model the change data operation.</p>
<p>The Avro Row Formatter may be a good choice when streaming Avro data to HDFS. Hive supports data files in HDFS in an Avro format.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD517"></a>
<div class="props_rev_3"><a id="GUID-B1CC8E18-1BE5-42C2-BD69-5A76A381A3BF"></a>
<h3 id="GADBD-GUID-B1CC8E18-1BE5-42C2-BD69-5A76A381A3BF" class="sect3"><span class="enumeration_section">6.4.1</span> Message Formatting Details</h3>
<div>
<div class="section">
<p>The following two subsections detail the contents of generated Avro row messages. The first section details the operation metadata and the second section details the column values data.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD519"></a><a id="GADBD518"></a>
<div class="props_rev_3"><a id="GUID-466CFF40-8EF4-4CC2-A860-A27BB2C3F3D7"></a>
<h4 id="GADBD-GUID-466CFF40-8EF4-4CC2-A860-A27BB2C3F3D7" class="sect4"><span class="enumeration_section">6.4.1.1</span> Operation Metadata</h4>
<div>
<div class="section">
<p>Avro messages generated by the Avro Row Formatter contain the following seven metadata fields that begin the message:</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-466CFF40-8EF4-4CC2-A860-A27BB2C3F3D7__GUID-26618B89-8EF0-4EBF-AC29-4DB77F3BED09">
<p class="titleintable">Table 6-5 Avro Formatter Metadata</p>
<table class="cellalignment145" title="Avro Formatter Metadata" summary="This two column table lists the Avro formatter metadata">
<thead align="left">
<tr>
<th class="cellalignment171" id="d14700e2003">Value</th>
<th class="cellalignment172" id="d14700e2006">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment171" id="d14700e2011" headers="d14700e2003">
<p><code>table</code></p>
</td>
<td class="cellalignment172" headers="d14700e2011 d14700e2006">
<p>The fully qualified table name. The format of the fully qualified table name is: <span class="italic"><code>CATALOG_NAME.SCHEMA_NAME.TABLE_NAME</code></span></p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e2023" headers="d14700e2003">
<p><code>op_type</code></p>
</td>
<td class="cellalignment172" headers="d14700e2023 d14700e2006">
<p>The operation type that is the indicator of the type of database operation from the source trail file. Default values are <code>I</code> for insert, <code>U</code> for update, <code>D</code> for delete, <code>T</code> for truncate.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e2043" headers="d14700e2003">
<p><code>op_ts</code></p>
</td>
<td class="cellalignment172" headers="d14700e2043 d14700e2006">
<p>The operation timestamp is the timestamp of the operation from the source trail file. Since this timestamp is from the source trail it is fixed. Replaying the trail file will result in the same timestamp for the same operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e2051" headers="d14700e2003">
<p><code>current_ts</code></p>
</td>
<td class="cellalignment172" headers="d14700e2051 d14700e2006">
<p>The current timestamp is the current time when the formatter processed the current operation record. This timestamp follows the ISO-8601 format and includes microsecond precision. Replaying the trail file will <span class="italic">NOT</span> result in the same timestamp for the same operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e2062" headers="d14700e2003">
<p><code>pos</code></p>
</td>
<td class="cellalignment172" headers="d14700e2062 d14700e2006">
<p>The trail file position is the concatenated sequence number and rba number from the source trail file. The trail position provides traceability of the operation back to the source trail file. The sequence number is the source trail file number. The rba number is the offset in the trail file.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e2070" headers="d14700e2003">
<p><code>primary_keys</code></p>
</td>
<td class="cellalignment172" headers="d14700e2070 d14700e2006">
<p>An array variable holding the column names of the primary keys of the source table.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e2078" headers="d14700e2003">
<p><code>tokens</code></p>
</td>
<td class="cellalignment172" headers="d14700e2078 d14700e2006">
<p>A map variable holding the token key value pairs from the source trail file.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD520"></a>
<div class="props_rev_3"><a id="GUID-3FDA8982-8146-4663-8CFF-AA1144F174C0"></a>
<h4 id="GADBD-GUID-3FDA8982-8146-4663-8CFF-AA1144F174C0" class="sect4"><span class="enumeration_section">6.4.1.2</span> Operation Data</h4>
<div>
<div class="section">
<p>The data following the operation metadata is the operation data. This data is represented as individual fields identified by the column names.</p>
<p>Column values for an operation from the source trail file can have one of three states: column has a value, column value is NULL, or column value is missing. Avro attributes only support two states, column has a value or column value is NULL. Missing column values will be treated the same as NULL values. It is highly recommended that when using the Avro Row Formatter, you configures the Oracle GoldenGate capture process to provide full image data for all columns in the source trail file. Refer to the Oracle GoldenGate documentation for your specific RDBMS for instructions to enable this functionality.</p>
<p>The default setting of the Avro Row Formatter is to map the data types from the source trail file to the associated Avro data type. Avro supports few data types so this functionality largely results in the mapping of numeric fields from the source trail file to members typed as numbers. This data type mapping is configurable to alternatively treat all data as strings.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="GADBD521"></a>
<div class="props_rev_3"><a id="GUID-DA3D0062-E28C-4090-B1AB-DFA6D73FEFAC"></a>
<h3 id="GADBD-GUID-DA3D0062-E28C-4090-B1AB-DFA6D73FEFAC" class="sect3"><span class="enumeration_section">6.4.2</span> Sample Avro Row Messages</h3>
<div>
<div class="section">
<p>Avro messages are binary and therefore not human readable. For the sample messages the JSON representation of the messages are displayed here.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD522"></a>
<div class="props_rev_3"><a id="GUID-77685BA1-15DA-46DE-A375-23CFAA162760"></a>
<h4 id="GADBD-GUID-77685BA1-15DA-46DE-A375-23CFAA162760" class="sect4"><span class="enumeration_section">6.4.2.1</span> Sample Insert Message</h4>
<div>
<pre dir="ltr">
{"table": "GG.TCUSTORD", 
"op_type": "I", 
"op_ts": "2013-06-02 22:14:36.000000", 
"current_ts": "2015-09-18T10:13:11.172000", 
"pos": "00000000000000001444", 
"primary_keys": ["CUST_CODE", "ORDER_DATE", "PRODUCT_CODE", "ORDER_ID"], 
"tokens": {"R": "AADPkvAAEAAEqL2AAA"}, 
"CUST_CODE": "WILL", 
"ORDER_DATE": "1994-09-30:15:33:00", 
"PRODUCT_CODE": "CAR", 
"ORDER_ID": "144", 
"PRODUCT_PRICE": 17520.0, 
"PRODUCT_AMOUNT": 3.0, 
"TRANSACTION_ID": "100"}
</pre></div>
</div>
<a id="GADBD523"></a>
<div class="props_rev_3"><a id="GUID-7092DFEC-37B2-4A32-A881-7FEAF13790FB"></a>
<h4 id="GADBD-GUID-7092DFEC-37B2-4A32-A881-7FEAF13790FB" class="sect4"><span class="enumeration_section">6.4.2.2</span> Sample Update Message</h4>
<div>
<pre dir="ltr">
{"table": "GG.TCUSTORD", 
"op_type": "U", 
"op_ts": "2013-06-02 22:14:41.000000", 
"current_ts": "2015-09-18T10:13:11.492000", 
"pos": "00000000000000002891", 
"primary_keys": ["CUST_CODE", "ORDER_DATE", "PRODUCT_CODE", "ORDER_ID"], "tokens":
 {"R": "AADPkvAAEAAEqLzAAA"}, 
"CUST_CODE": "BILL", 
"ORDER_DATE": "1995-12-31:15:00:00", 
"PRODUCT_CODE": "CAR", 
"ORDER_ID": "765", 
"PRODUCT_PRICE": 14000.0, 
"PRODUCT_AMOUNT": 3.0, 
"TRANSACTION_ID": "100"}
</pre></div>
</div>
<a id="GADBD524"></a>
<div class="props_rev_3"><a id="GUID-37630F6F-1295-4E08-A695-119F7D5B5AD8"></a>
<h4 id="GADBD-GUID-37630F6F-1295-4E08-A695-119F7D5B5AD8" class="sect4"><span class="enumeration_section">6.4.2.3</span> Sample Delete Message</h4>
<div>
<pre dir="ltr">
{"table": "GG.TCUSTORD",
"op_type": "D", 
"op_ts": "2013-06-02 22:14:41.000000", 
"current_ts": "2015-09-18T10:13:11.512000", 
"pos": "00000000000000004338", 
"primary_keys": ["CUST_CODE", "ORDER_DATE", "PRODUCT_CODE", "ORDER_ID"], "tokens":
 {"L": "206080450", "6": "9.0.80330", "R": "AADPkvAAEAAEqLzAAC"}, "CUST_CODE":
 "DAVE", 
"ORDER_DATE": "1993-11-03:07:51:35", 
"PRODUCT_CODE": "PLANE", 
"ORDER_ID": "600", 
"PRODUCT_PRICE": null, 
"PRODUCT_AMOUNT": null, 
"TRANSACTION_ID": null}
</pre></div>
</div>
<a id="GADBD525"></a>
<div class="props_rev_3"><a id="GUID-5AA0CC47-A24F-4D38-A223-73BC59A93F7F"></a>
<h4 id="GADBD-GUID-5AA0CC47-A24F-4D38-A223-73BC59A93F7F" class="sect4"><span class="enumeration_section">6.4.2.4</span> Sample Truncate Message</h4>
<div>
<pre dir="ltr">
{"table": "GG.TCUSTORD", 
"op_type": "T", 
"op_ts": "2013-06-02 22:14:41.000000", 
"current_ts": "2015-09-18T10:13:11.514000", 
"pos": "00000000000000004515", 
"primary_keys": ["CUST_CODE", "ORDER_DATE", "PRODUCT_CODE", "ORDER_ID"], "tokens":
 {"R": "AADPkvAAEAAEqL2AAB"}, 
"CUST_CODE": null, 
"ORDER_DATE": null, 
"PRODUCT_CODE": null, 
"ORDER_ID": null, 
"PRODUCT_PRICE": null, 
"PRODUCT_AMOUNT": null, 
"TRANSACTION_ID": null}
</pre></div>
</div>
</div>
<a id="GADBD526"></a>
<div class="props_rev_3"><a id="GUID-A97788B6-FEA1-4586-8E86-18B298340D3C"></a>
<h3 id="GADBD-GUID-A97788B6-FEA1-4586-8E86-18B298340D3C" class="sect3"><span class="enumeration_section">6.4.3</span> Avro Schemas</h3>
<div>
<div class="section">
<p>Avro uses JSONs to represent schemas. Avro schemas define the format of generated Avro messages and are required to serialize and deserialize Avro messages. Schemas are generated on a JIT (just in time) basis when the first operation for a table is encountered. Generated Avro schemas are specific to a table definition that means that a separate Avro schema will be generated for every table encountered for processed operations. Avro schemas are by default written to the <span class="italic"><code>GoldenGate_Home</code></span><code>/dirdef</code> directory although the write location is configurable. Avro schema file names adhere to the following naming convention: <span class="italic"><code>FullyQualifiedTableName</code></span><code>.avsc</code>.</p>
<p>The following is a sample Avro schema for the Avro Row Format for the previous references examples:</p>
<pre dir="ltr">
{
  "type" : "record",
  "name" : "TCUSTORD",
  "namespace" : "GG",
  "fields" : [ {
    "name" : "table",
    "type" : "string"
  }, {
    "name" : "op_type",
    "type" : "string"
  }, {
    "name" : "op_ts",
    "type" : "string"
  }, {
    "name" : "current_ts",
    "type" : "string"
  }, {
    "name" : "pos",
    "type" : "string"
  }, {
    "name" : "primary_keys",
    "type" : {
      "type" : "array",
      "items" : "string"
    }
  }, {
    "name" : "tokens",
    "type" : {
      "type" : "map",
      "values" : "string"
    },
    "default" : { }
  }, {
    "name" : "CUST_CODE",
    "type" : [ "null", "string" ],
    "default" : null
  }, {
    "name" : "ORDER_DATE",
    "type" : [ "null", "string" ],
    "default" : null
  }, {
    "name" : "PRODUCT_CODE",
    "type" : [ "null", "string" ],
    "default" : null
  }, {
    "name" : "ORDER_ID",
    "type" : [ "null", "string" ],
    "default" : null
  }, {
    "name" : "PRODUCT_PRICE",
    "type" : [ "null", "double" ],
    "default" : null
  }, {
    "name" : "PRODUCT_AMOUNT",
    "type" : [ "null", "double" ],
    "default" : null
  }, {
    "name" : "TRANSACTION_ID",
    "type" : [ "null", "string" ],
    "default" : null
  } ]
}
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD528"></a><a id="GADBD527"></a>
<div class="props_rev_3"><a id="GUID-2345E761-DA5D-4214-9C8C-80C4E70B9AC1"></a>
<h3 id="GADBD-GUID-2345E761-DA5D-4214-9C8C-80C4E70B9AC1" class="sect3"><span class="enumeration_section">6.4.4</span> Avro Row Configuration</h3>
<div>
<div class="tblformal" id="GUID-2345E761-DA5D-4214-9C8C-80C4E70B9AC1__GUID-9F43C7C7-284C-452C-9283-8E7A2AD72E46">
<p class="titleintable">Table 6-6 Avro Row Configuration Options</p>
<table class="cellalignment145" title="Avro Row Configuration Options" summary="This five column table lists the Avro Row configuration parameters.">
<thead align="left">
<tr>
<th class="cellalignment174" id="d14700e2266">Parameter</th>
<th class="cellalignment163" id="d14700e2269">Optional/ Required</th>
<th class="cellalignment160" id="d14700e2272">Legal Values</th>
<th class="cellalignment175" id="d14700e2275">Default</th>
<th class="cellalignment176" id="d14700e2278">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment174" id="d14700e2283" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.insertOpKey</code></p>
</td>
<td class="cellalignment163" headers="d14700e2283 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2283 d14700e2272">
<p>Any string</p>
</td>
<td class="cellalignment175" headers="d14700e2283 d14700e2275">
<p>I</p>
</td>
<td class="cellalignment176" headers="d14700e2283 d14700e2278">
<p>Indicator to be inserted into the output record to indicate an insert operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2305" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.updateOpKey</code></p>
</td>
<td class="cellalignment163" headers="d14700e2305 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2305 d14700e2272">
<p>Any string</p>
</td>
<td class="cellalignment175" headers="d14700e2305 d14700e2275">
<p>U</p>
</td>
<td class="cellalignment176" headers="d14700e2305 d14700e2278">
<p>Indicator to be inserted into the output record to indicate an update operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2327" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.deleteOpKey</code></p>
</td>
<td class="cellalignment163" headers="d14700e2327 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2327 d14700e2272">
<p>Any string</p>
</td>
<td class="cellalignment175" headers="d14700e2327 d14700e2275">
<p>D</p>
</td>
<td class="cellalignment176" headers="d14700e2327 d14700e2278">
<p>Indicator to be inserted into the output record to indicate a delete operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2349" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.truncateOpKey</code></p>
</td>
<td class="cellalignment163" headers="d14700e2349 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2349 d14700e2272">
<p>Any string</p>
</td>
<td class="cellalignment175" headers="d14700e2349 d14700e2275">
<p>T</p>
</td>
<td class="cellalignment176" headers="d14700e2349 d14700e2278">
<p>Indicator to be inserted into the output record to indicate a truncate operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2371" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.encoding</code></p>
</td>
<td class="cellalignment163" headers="d14700e2371 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2371 d14700e2272">
<p>Any legal encoding name or alias supported by Java.</p>
</td>
<td class="cellalignment175" headers="d14700e2371 d14700e2275">
<p>UTF-8 (the JSON default)</p>
</td>
<td class="cellalignment176" headers="d14700e2371 d14700e2278">
<p>Controls the output encoding of generated Avro schema that is a JSON. The JSON default is UTF-8. Avro messages are binary and support their own internal representation of encoding.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2393" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.treatAllColumnsAsStrings</code></p>
</td>
<td class="cellalignment163" headers="d14700e2393 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2393 d14700e2272">
<p><code>true</code> | <code>false</code></p>
</td>
<td class="cellalignment175" headers="d14700e2393 d14700e2275">
<p><code>false</code></p>
</td>
<td class="cellalignment176" headers="d14700e2393 d14700e2278">
<p>Controls the output typing of generated Avro messages. If set to false then the formatter will attempt to map Oracle GoldenGate types to the corresponding AVRO type. If set to true then all data will be treated as Strings in the generated Avro messages and schemas.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2420" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.pkUpdateHandlingformat.pkUpdateHandling</code></p>
</td>
<td class="cellalignment163" headers="d14700e2420 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2420 d14700e2272">
<p><code>abend</code> | <code>update</code> | <code>delete-insert</code></p>
</td>
<td class="cellalignment175" headers="d14700e2420 d14700e2275">
<p><code>abend</code></p>
</td>
<td class="cellalignment176" headers="d14700e2420 d14700e2278">
<p>Provides configuration for how the formatter should handle update operations that change a primary key. Primary key operations can be problematic for the Avro Row formatter and require special consideration by you.</p>
<ul style="list-style-type: disc;">
<li>
<p><code>abend</code> - indicates the process will abend.</p>
</li>
<li>
<p><code>update</code> - indicates the process will treat this as a normal update.</p>
</li>
<li>
<p><code>delete-insert</code> - indicates the process will treat this as a delete and an insert. Full supplemental logging needs to be enabled for this to work. Without full before and after row images the insert data will be incomplete.</p>
</li>
</ul>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2466" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.lineDelimiter</code></p>
</td>
<td class="cellalignment163" headers="d14700e2466 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2466 d14700e2272">
<p>Any string</p>
</td>
<td class="cellalignment175" headers="d14700e2466 d14700e2275">
<p>no value</p>
</td>
<td class="cellalignment176" headers="d14700e2466 d14700e2278">
<p>Optionally allows a user to insert a delimiter after each Avro message. This is not considered the best practice but in certain use cases customers may wish to parse a stream of data and extract individual Avro messages from the stream. This property allows the customer that option. Select a unique delimiter that cannot occur in any Avro message. This property supports <code>CDATA[]</code> wrapping.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2491" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.versionSchemas</code></p>
</td>
<td class="cellalignment163" headers="d14700e2491 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2491 d14700e2272">
<p><code>true</code>|<code>false</code></p>
</td>
<td class="cellalignment175" headers="d14700e2491 d14700e2275">
<p><code>false</code></p>
</td>
<td class="cellalignment176" headers="d14700e2491 d14700e2278">
<p>The created Avro schemas always follow the convention {fully qualified table name}<code>.avsc</code>. Setting this property to <code>true</code> creates an additional Avro schema in the schema directory named <code>{</code><span class="italic"><code>fully qualified table name</code></span><code>}_{</code><span class="italic"><code>current timestamp</code></span><code>}.avsc</code>. The additional Avro schema does not get destroyed or removed and thereby provides a history of schema evolution.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2537" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.wrapMessageInGenericAvroSchema</code></p>
</td>
<td class="cellalignment163" headers="d14700e2537 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2537 d14700e2272">
<p><code>true</code>|<code>false</code></p>
</td>
<td class="cellalignment175" headers="d14700e2537 d14700e2275">
<p><code>false</code></p>
</td>
<td class="cellalignment176" headers="d14700e2537 d14700e2278">
<p>Provides functionality to wrap the Avro messages for operations from the source trail file in a generic Avro wrapper message. For more information, see <a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-24CC9E72-20A4-478E-8503-9777B9029A9B">Generic Wrapper Functionality</a>.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2567" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.schemaDirectory</code></p>
</td>
<td class="cellalignment163" headers="d14700e2567 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2567 d14700e2272">
<p>Any legal, existing file system path.</p>
</td>
<td class="cellalignment175" headers="d14700e2567 d14700e2275">
<p><code>./dirdef</code></p>
</td>
<td class="cellalignment176" headers="d14700e2567 d14700e2278">
<p>Controls the output location of generated Avro schemas.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2591" headers="d14700e2266">
<p><code>gg.handler.</code><span class="italic"><code>name</code></span><code>.schemaFilePath=</code></p>
</td>
<td class="cellalignment163" headers="d14700e2591 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2591 d14700e2272">
<p>Any legal encoding name or alias supported by Java.</p>
</td>
<td class="cellalignment175" headers="d14700e2591 d14700e2275">
<p><code>./dirdef</code></p>
</td>
<td class="cellalignment176" headers="d14700e2591 d14700e2278">
<p>Controls the configuration property to a file directory inside of HDFS where you want schemas to be output. A metadata change event causes the schema to be overwritten when the next operation for the associated table is encountered. Schemas follow the same naming convention as schemas written to the local file system, <code><span class="codeinlineitalic">catalog.schema.table</span></code><code>.avsc</code>.</p>
</td>
</tr>
<tr>
<td class="cellalignment174" id="d14700e2620" headers="d14700e2266">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.iso8601Format</code></p>
</td>
<td class="cellalignment163" headers="d14700e2620 d14700e2269">
<p>Optional</p>
</td>
<td class="cellalignment160" headers="d14700e2620 d14700e2272">
<p><code>true</code> | <code>false</code></p>
</td>
<td class="cellalignment175" headers="d14700e2620 d14700e2275">
<p><code>true</code></p>
</td>
<td class="cellalignment176" headers="d14700e2620 d14700e2278">Controls the format of the current timestamp. The default is the &nbsp;ISO 8601 format. Set to <code>false</code> removes the <code>&ldquo;T&rdquo;</code> between the date and time in the current timestamp, which outputs <code>&ldquo; &ldquo;</code> instead.</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD529"></a>
<div class="props_rev_3"><a id="GUID-5AB2D030-A209-4CD3-A6B6-37355FF1612B"></a>
<h3 id="GADBD-GUID-5AB2D030-A209-4CD3-A6B6-37355FF1612B" class="sect3"><span class="enumeration_section">6.4.5</span> Sample Configuration</h3>
<div>
<div class="section">
<p>The following is sample configuration for the Avro Row Formatter from the Java Adapter properties file:</p>
<pre dir="ltr">
gg.handler.hdfs.format=avro_row
gg.handler.hdfs.format.insertOpKey=I
gg.handler.hdfs.format.updateOpKey=U
gg.handler.hdfs.format.deleteOpKey=D
gg.handler.hdfs.format.truncateOpKey=T
gg.handler.hdfs.format.encoding=UTF-8
gg.handler.hdfs.format.pkUpdateHandling=abend
gg.handler.hafs.format.wrapMessageInGenericAvroMessage=false
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD530"></a>
<div class="props_rev_3"><a id="GUID-54A079BF-B672-47B2-9F11-A6F734C7563B"></a>
<h3 id="GADBD-GUID-54A079BF-B672-47B2-9F11-A6F734C7563B" class="sect3"><span class="enumeration_section">6.4.6</span> Metadata Change Events</h3>
<div>
<div class="section">
<p>The Avro Row Formatter is capable of taking action in the case of a metadata change event. This assumes that the replicated database and upstream Oracle GoldenGate replication process can propagate metadata change events. Metadata change events are of particular importance when formatting using Avro due to the tight dependency of Avro messages to its corresponding schema.</p>
<p>Metadata change events are handled seamlessly by the Avro Row Formatter and an updated Avro schema will be generated upon the first encounter of an operation of that table after the metadata change event. You should understand the impact of a metadata change event and change downstream targets to the new Avro schema. The tight dependency of Avro messages to Avro schemas may result in compatibility issues. Avro messages generated before the schema change may not be able to be deserialized with the newly generated Avro schema.</p>
<p>Conversely, Avro messages generated after the schema change may not be able to be deserialized with the previous Avro schema. It is a best practice to use the same version of the Avro schema that was used to generate the message. Consult the Apache Avro documentation for more details.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD531"></a>
<div class="props_rev_3"><a id="GUID-7E290838-F287-453C-AB55-EAF41930CD81"></a>
<h3 id="GADBD-GUID-7E290838-F287-453C-AB55-EAF41930CD81" class="sect3"><span class="enumeration_section">6.4.7</span> Special Considerations</h3>
<div>
<div class="section">
<p>This sections describes special considerations:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-823DADB3-ED30-414B-8F73-816DE6624CC0">Troubleshooting</a></p>
</li>
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-0DB9EC9C-C060-4AEE-A60C-4251AFFFA99C">Primary Key Updates</a></p>
</li>
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-24CC9E72-20A4-478E-8503-9777B9029A9B">Generic Wrapper Functionality</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<a id="GADBD532"></a>
<div class="sect4"><a id="GUID-823DADB3-ED30-414B-8F73-816DE6624CC0"></a>
<h4 id="GADBD-GUID-823DADB3-ED30-414B-8F73-816DE6624CC0" class="sect4"><span class="enumeration_section">6.4.7.1</span> Troubleshooting</h4>
<div>
<p>Avro is a binary format therefore is not human readable. Since Avro messages are in binary format, it will be difficult to debug any issue. The Avro Row Formatter provides a special feature to mitigate this issue. When the <code>log4j</code> Java logging level is set to <code>TRACE</code> the created Avro messages will be deserialized and displayed in the log file as a JSON object. This allows you to view the structure and contents of the created Avro messages. <code>TRACE</code> should never be enabled in a production environment as it has substantial negative impact on performance. Alternatively, you may want to consider switching to use a formatter that produces human readable content for content troubleshooting. The XML or JSON formatters both produce content in human readable format that may facilitate troubleshooting.</p>
</div>
</div>
<a id="GADBD534"></a><a id="GADBD533"></a>
<div class="sect4"><a id="GUID-0DB9EC9C-C060-4AEE-A60C-4251AFFFA99C"></a>
<h4 id="GADBD-GUID-0DB9EC9C-C060-4AEE-A60C-4251AFFFA99C" class="sect4"><span class="enumeration_section">6.4.7.2</span> Primary Key Updates</h4>
<div>
<p>Primary key update operations require special consideration and planning for Big Data integrations. Primary key updates are update operations that modify one or more of the primary keys for the given row from the source database. Since data is simply appended in Big Data applications a primary key update operation looks more like a new insert than an update without any special handling. The Avro Row Formatter provides specialized handling for primary keys that is configurable by you. These are the configurable behaviors:</p>
<div class="tblformal" id="GUID-0DB9EC9C-C060-4AEE-A60C-4251AFFFA99C__GUID-5114468F-E637-4CB0-8C5B-1FCFBF6F4400">
<p class="titleintable">Table 6-7 Configurable behavior</p>
<table class="cellalignment145" title="Configurable behavior" summary="This two column table lists the configurable behavior for Avro Row Formatter">
<thead align="left">
<tr>
<th class="cellalignment171" id="d14700e2786">Value</th>
<th class="cellalignment172" id="d14700e2789">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment171" id="d14700e2794" headers="d14700e2786">
<p><code>abend</code></p>
</td>
<td class="cellalignment172" headers="d14700e2794 d14700e2789">
<p>The default behavior is that the delimited text formatter will abend in the case of a primary key update.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e2802" headers="d14700e2786">
<p><code>update</code></p>
</td>
<td class="cellalignment172" headers="d14700e2802 d14700e2789">
<p>With this configuration the primary key update will be treated just like any other update operation. This configuration alternative should only be selected if you can guarantee that the primary key that is being changed is not being used as the selection criteria when selecting row data from a Big Data system.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e2810" headers="d14700e2786">
<p><code>delete-insert</code></p>
</td>
<td class="cellalignment172" headers="d14700e2810 d14700e2789">
<p>Using this configuration the primary key update is treated as a special case of a delete using the before image data and an insert using the after image data. This configuration may more accurately model the effect of a primary key update in a Big Data application. However, if this configuration is selected it is important to have full supplemental logging enabled on Replication at the source database. Without full supplemental logging the delete operation will be correct, however, the insert operation will not contain all of the data for all of the columns for a full representation of the row data in the Big Data application.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD535"></a>
<div class="sect4"><a id="GUID-24CC9E72-20A4-478E-8503-9777B9029A9B"></a>
<h4 id="GADBD-GUID-24CC9E72-20A4-478E-8503-9777B9029A9B" class="sect4"><span class="enumeration_section">6.4.7.3</span> Generic Wrapper Functionality</h4>
<div>
<p>Avro messages are not self describing, which means that the receiver of the message must know the schema associated with the message before the message can be deserialized. Avro messages are binary and provide no consistent or reliable way to inspect the message contents in order to ascertain the message type. Therefore, Avro can be especially troublesome when messages are interlaced into a single stream of data like Kafka.</p>
<p>The Avro formatter provides a special feature to wrap the Avro message in a generic Avro message. This functionality is enabled by setting the following configuration parameter.</p>
<pre dir="ltr">
gg.handler.<span class="italic">name</span>.formatter.wrapMessageInGenericAvroMessage=true
</pre>
<p>The generic message is Avro message wrapping the Avro payload message that is common to all Avro messages that are output. The schema for the generic message is name <code>generic_wrapper.avsc</code> and is written to the output schema directory. This message has the following three fields.</p>
<ul style="list-style-type: disc;">
<li>
<p><code>table_name</code> - The fully qualified source table name.</p>
</li>
<li>
<p><code>schema_hash</code> - The hash code of the Avro schema generating the message.</p>
</li>
<li>
<p><code>payload</code> - The wrapped Avro message.</p>
</li>
</ul>
<p>The following is the Avro Formatter generic wrapper schema.</p>
<pre dir="ltr">
{
  "type" : "record",
  "name" : "generic_wrapper",
  "namespace" : "oracle.goldengate",
  "fields" : [ {
    "name" : "table_name",
    "type" : "string"
  }, {
    "name" : "schema_hash",
    "type" : "int"
  }, {
    "name" : "payload",
    "type" : "bytes"
  } ]
}
</pre></div>
</div>
</div>
</div>
<a id="GADBD536"></a>
<div class="props_rev_3"><a id="GUID-D77D819B-FDA2-4348-9899-711B50302F96"></a>
<h2 id="GADBD-GUID-D77D819B-FDA2-4348-9899-711B50302F96" class="sect2"><span class="enumeration_section">6.5</span> Avro Operation Formatter</h2>
<div>
<div class="section">
<p>Apache Avro is an open source data serialization/deserialization framework known for its flexibility, compactness of serialized data, and good serialization/deserialization performance. Apache Avro is commonly used in Big Data applications.</p>
<p>The Avro Operation Formatter formats operation data from the source trail file into messages in an Avro binary array format. Each individual insert, update, delete and truncate operation will be formatted into an individual Avro message. The source trail file will contain the before and after images of the operation data. The Avro Operation Formatter takes that before and after image data and formats the data into an Avro binary representation of the operation data.</p>
<p>The Avro Operation Formatter formats operations from the source trail file into a format that represents the operation data. This format is more verbose than the output from the Avro Row Formatter for which the Avro messages model the row data.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD537"></a>
<div class="props_rev_3"><a id="GUID-474F85B0-5C5E-4385-B993-9CEDBFD3BDDA"></a>
<h3 id="GADBD-GUID-474F85B0-5C5E-4385-B993-9CEDBFD3BDDA" class="sect3"><span class="enumeration_section">6.5.1</span> Message Formatting Details</h3>
<div>
<div class="section">
<p>This section contains following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-B4F1C3BC-6B95-4184-B98F-CCF2AD2BC3D2">Operation Metadata</a></p>
</li>
<li>
<p><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-EECE0A95-2A5A-4154-A1B7-72D59909AC87">Operation Data</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<a id="GADBD539"></a><a id="GADBD538"></a>
<div class="props_rev_3"><a id="GUID-B4F1C3BC-6B95-4184-B98F-CCF2AD2BC3D2"></a>
<h4 id="GADBD-GUID-B4F1C3BC-6B95-4184-B98F-CCF2AD2BC3D2" class="sect4"><span class="enumeration_section">6.5.1.1</span> Operation Metadata</h4>
<div>
<p>Avro messages, generated by the Avro Operation Formatter, contain the following metadata fields that begin the message:</p>
<div class="tblformal" id="GUID-B4F1C3BC-6B95-4184-B98F-CCF2AD2BC3D2__GUID-6B772FE4-0C97-4F3F-8039-C480AD1C4168">
<p class="titleintable">Table 6-8 Avro Messages and its Metadata</p>
<table class="cellalignment145" title="Avro Messages and its Metadata " summary="This two column table lists the Avro Messages and its Metadata">
<thead align="left">
<tr>
<th class="cellalignment177" id="d14700e2948">Fields</th>
<th class="cellalignment178" id="d14700e2951">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment177" id="d14700e2956" headers="d14700e2948">
<p><code>table</code></p>
</td>
<td class="cellalignment178" headers="d14700e2956 d14700e2951">
<p><span class="italic"><code>CATALOG_NAME.SCHEMA NAME.TABLE NAME</code></span>The fully qualified table name. The format of the fully qualified table name is the following:</p>
</td>
</tr>
<tr>
<td class="cellalignment177" id="d14700e2967" headers="d14700e2948">
<p><code>op_type</code></p>
</td>
<td class="cellalignment178" headers="d14700e2967 d14700e2951">
<p>The operation type that is the indicator of the type of database operation from the source trail file. Default values are "I" for insert, "U" for update, "D" for delete, "T" for truncate.</p>
</td>
</tr>
<tr>
<td class="cellalignment177" id="d14700e2975" headers="d14700e2948">
<p><code>op_ts</code></p>
</td>
<td class="cellalignment178" headers="d14700e2975 d14700e2951">
<p>The operation timestamp is the timestamp of the operation from the source trail file. Since this timestamp is from the source trail it is fixed. Replaying the trail file will result in the same timestamp for the same operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment177" id="d14700e2983" headers="d14700e2948">
<p><code>current_ts</code></p>
</td>
<td class="cellalignment178" headers="d14700e2983 d14700e2951">
<p>The current timestamp is the current time when the formatter processed the current operation record. This timestamp follows the ISO-8601 format and includes microsecond precision. Replaying the trail file will NOT result in the same timestamp for the same operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment177" id="d14700e2992" headers="d14700e2948">
<p><code>pos</code></p>
</td>
<td class="cellalignment178" headers="d14700e2992 d14700e2951">
<p>The trail file position with is the concatenated sequence number and rba number from the source trail file. The trail position provides traceability of the operation back to the source trail file. The sequence number is the source trail file number. The rba number is the offset in the trail file.</p>
</td>
</tr>
<tr>
<td class="cellalignment177" id="d14700e3000" headers="d14700e2948">
<p><code>primary_keys</code></p>
</td>
<td class="cellalignment178" headers="d14700e3000 d14700e2951">
<p>An array variable holding the column names of the primary keys of the source table.</p>
</td>
</tr>
<tr>
<td class="cellalignment177" id="d14700e3008" headers="d14700e2948">
<p><code>tokens</code></p>
</td>
<td class="cellalignment178" headers="d14700e3008 d14700e2951">
<p>A map variable holding the token key value pairs from the source trail file.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD540"></a>
<div class="props_rev_3"><a id="GUID-EECE0A95-2A5A-4154-A1B7-72D59909AC87"></a>
<h4 id="GADBD-GUID-EECE0A95-2A5A-4154-A1B7-72D59909AC87" class="sect4"><span class="enumeration_section">6.5.1.2</span> Operation Data</h4>
<div>
<p>The operation data is represented as individual fields identified by the column names.</p>
<p>Column values for an operation from the source trail file can have one of three states: column has a value, column value is NULL, or column value is missing. Avro attributes only support two states, column has a value or column value is NULL. The Avro Operation Formatter contains an additional Boolean field for each column as a special indicator if the column value is missing or not. This special Boolean field is name <span class="italic"><code>COLUMN_NAME</code></span><code>_isMissing</code>. Using the combination of the <span class="italic"><code>COLUMN_NAME</code></span> field, all three states can be defined.</p>
<ul style="list-style-type: disc;">
<li>
<p>State 1: Column has a value</p>
<p><span class="italic"><code>COLUMN_NAME</code></span> field has a value</p>
<p><span class="italic"><code>COLUMN_NAME</code></span><code>_isMissing</code> field is false</p>
</li>
<li>
<p>State 2: Column value is NULL</p>
<p><span class="italic"><code>COLUMN_NAME</code></span> field value is NULL</p>
<p><span class="italic"><code>COLUMN_NAME</code></span><code>_isMissing</code> field is false</p>
</li>
<li>
<p>State 3: Column value is missing</p>
<p><span class="italic"><code>COLUMN_NAME</code></span> field value is NULL</p>
<p><span class="italic"><code>COLUMN_NAME</code></span><code>_isMissing</code> field is true</p>
</li>
</ul>
<p>The default setting of the Avro Row Formatter is to map the data types from the source trail file to the associated Avro data type. Avro supports few data types so this functionality largely results in the mapping of numeric fields from the source trail file to members typed as numbers. This data type mapping is configurable to alternatively treat all data as strings.</p>
</div>
</div>
</div>
<a id="GADBD541"></a>
<div class="props_rev_3"><a id="GUID-008821C9-4F2D-435A-A1E8-7BF05248FCF5"></a>
<h3 id="GADBD-GUID-008821C9-4F2D-435A-A1E8-7BF05248FCF5" class="sect3"><span class="enumeration_section">6.5.2</span> Sample Avro Operation Messages</h3>
<div>
<div class="section">
<p>Avro messages are binary and therefore not human readable. Sample messages the JSON representation of the messages displayed:</p>
</div>
<!-- class="section" --></div>
<a id="GADBD542"></a>
<div class="props_rev_3"><a id="GUID-410F0B9F-B1AB-4C3A-AB64-8591A30A21C3"></a>
<h4 id="GADBD-GUID-410F0B9F-B1AB-4C3A-AB64-8591A30A21C3" class="sect4"><span class="enumeration_section">6.5.2.1</span> Sample Insert Message</h4>
<div>
<pre dir="ltr">
{"table": "GG.TCUSTORD",
"op_type": "I", 
"op_ts": "2013-06-02 22:14:36.000000", 
"current_ts": "2015-09-18T10:17:49.570000", 
"pos": "00000000000000001444", 
"primary_keys": ["CUST_CODE", "ORDER_DATE", "PRODUCT_CODE", "ORDER_ID"], "tokens":
 {"R": "AADPkvAAEAAEqL2AAA"}, 
"before": null, 
"after": {
"CUST_CODE": "WILL", 
"CUST_CODE_isMissing": false, 
"ORDER_DATE": "1994-09-30:15:33:00", 
"ORDER_DATE_isMissing": false, 
"PRODUCT_CODE": "CAR", 
"PRODUCT_CODE_isMissing": false, 
"ORDER_ID": "144", "ORDER_ID_isMissing": false, 
"PRODUCT_PRICE": 17520.0, 
"PRODUCT_PRICE_isMissing": false, 
"PRODUCT_AMOUNT": 3.0, "PRODUCT_AMOUNT_isMissing": false, 
"TRANSACTION_ID": "100", 
"TRANSACTION_ID_isMissing": false}}
</pre></div>
</div>
<a id="GADBD543"></a>
<div class="props_rev_3"><a id="GUID-FC3BB6A5-9083-489C-8533-A8EB4AB25624"></a>
<h4 id="GADBD-GUID-FC3BB6A5-9083-489C-8533-A8EB4AB25624" class="sect4"><span class="enumeration_section">6.5.2.2</span> Sample Update Message</h4>
<div>
<pre dir="ltr">
{"table": "GG.TCUSTORD", 
"op_type": "U", 
"op_ts": "2013-06-02 22:14:41.000000", 
"current_ts": "2015-09-18T10:17:49.880000", 
"pos": "00000000000000002891", 
"primary_keys": ["CUST_CODE", "ORDER_DATE", "PRODUCT_CODE", "ORDER_ID"], "tokens":
 {"R": "AADPkvAAEAAEqLzAAA"}, 
"before": {
"CUST_CODE": "BILL", 
"CUST_CODE_isMissing": false, 
"ORDER_DATE": "1995-12-31:15:00:00", 
"ORDER_DATE_isMissing": false, 
"PRODUCT_CODE": "CAR", 
"PRODUCT_CODE_isMissing": false, 
"ORDER_ID": "765", 
"ORDER_ID_isMissing": false, 
"PRODUCT_PRICE": 15000.0, 
"PRODUCT_PRICE_isMissing": false, 
"PRODUCT_AMOUNT": 3.0, 
"PRODUCT_AMOUNT_isMissing": false, 
"TRANSACTION_ID": "100", 
"TRANSACTION_ID_isMissing": false}, 
"after": {
"CUST_CODE": "BILL", 
"CUST_CODE_isMissing": false, 
"ORDER_DATE": "1995-12-31:15:00:00", 
"ORDER_DATE_isMissing": false, 
"PRODUCT_CODE": "CAR", 
"PRODUCT_CODE_isMissing": false, 
"ORDER_ID": "765", 
"ORDER_ID_isMissing": false, 
"PRODUCT_PRICE": 14000.0, 
"PRODUCT_PRICE_isMissing": false, 
"PRODUCT_AMOUNT": 3.0, 
"PRODUCT_AMOUNT_isMissing": false, 
"TRANSACTION_ID": "100", 
"TRANSACTION_ID_isMissing": false}}
</pre></div>
</div>
<a id="GADBD544"></a>
<div class="props_rev_3"><a id="GUID-75AF4E0C-5C56-4B9B-AF25-F3E3E858BEC7"></a>
<h4 id="GADBD-GUID-75AF4E0C-5C56-4B9B-AF25-F3E3E858BEC7" class="sect4"><span class="enumeration_section">6.5.2.3</span> Sample Delete Message</h4>
<div>
<pre dir="ltr">
{"table": "GG.TCUSTORD", 
"op_type": "D", 
"op_ts": "2013-06-02 22:14:41.000000", 
"current_ts": "2015-09-18T10:17:49.899000", 
"pos": "00000000000000004338", 
"primary_keys": ["CUST_CODE", "ORDER_DATE", "PRODUCT_CODE", "ORDER_ID"], "tokens":
 {"L": "206080450", "6": "9.0.80330", "R": "AADPkvAAEAAEqLzAAC"}, "before": {
"CUST_CODE": "DAVE", 
"CUST_CODE_isMissing": false, 
"ORDER_DATE": "1993-11-03:07:51:35", 
"ORDER_DATE_isMissing": false, 
"PRODUCT_CODE": "PLANE", 
"PRODUCT_CODE_isMissing": false, 
"ORDER_ID": "600", 
"ORDER_ID_isMissing": false, 
"PRODUCT_PRICE": null, 
"PRODUCT_PRICE_isMissing": true, 
"PRODUCT_AMOUNT": null, 
"PRODUCT_AMOUNT_isMissing": true, 
"TRANSACTION_ID": null, 
"TRANSACTION_ID_isMissing": true}, 
"after": null}
</pre></div>
</div>
<a id="GADBD545"></a>
<div class="props_rev_3"><a id="GUID-FD998BB6-9992-413C-965E-2BC1510AEC3E"></a>
<h4 id="GADBD-GUID-FD998BB6-9992-413C-965E-2BC1510AEC3E" class="sect4"><span class="enumeration_section">6.5.2.4</span> Sample Truncate Message</h4>
<div>
<pre dir="ltr">
{"table": "GG.TCUSTORD", 
"op_type": "T", 
"op_ts": "2013-06-02 22:14:41.000000", 
"current_ts": "2015-09-18T10:17:49.900000", 
"pos": "00000000000000004515", 
"primary_keys": ["CUST_CODE", "ORDER_DATE", "PRODUCT_CODE", "ORDER_ID"], "tokens":
 {"R": "AADPkvAAEAAEqL2AAB"}, 
"before": null, 
"after": null}
</pre></div>
</div>
</div>
<a id="GADBD546"></a>
<div class="props_rev_3"><a id="GUID-7D8D519D-7358-46D8-AABB-AE7487498394"></a>
<h3 id="GADBD-GUID-7D8D519D-7358-46D8-AABB-AE7487498394" class="sect3"><span class="enumeration_section">6.5.3</span> Avro Schema</h3>
<div>
<div class="section">
<p>Avro schemas are represented as JSONs. Avro schemas define the format of generated Avro messages and are required to serialize and deserialize Avro messages. Avro schemas are generated on a JIT (just in time) basis when the first operation for a table is encountered. Avro schemas are specific to a table definition, which means that a separate Avro schema will be generated for every table encountered for processed operations. Avro schemas are by default written to the <span class="italic"><code>GoldenGate_Home</code></span><code>/dirdef</code> directory although the write location is configurable. Avro schema file names adhere to the following naming convention: FullyQualifiedTableName<code>.avsc</code> directory although the write location is configurable. Avro schema file names adhere to the following naming convention: .</p>
<p>The following is a sample Avro schema for the Avro Operation Format for the previous references examples:</p>
<pre dir="ltr">
{
  "type" : "record",
  "name" : "TCUSTORD",
  "namespace" : "GG",
  "fields" : [ {
    "name" : "table",
    "type" : "string"
  }, {
    "name" : "op_type",
    "type" : "string"
  }, {
    "name" : "op_ts",
    "type" : "string"
  }, {
    "name" : "current_ts",
    "type" : "string"
  }, {
    "name" : "pos",
    "type" : "string"
  }, {
    "name" : "primary_keys",
    "type" : {
      "type" : "array",
      "items" : "string"
    }
  }, {
    "name" : "tokens",
    "type" : {
      "type" : "map",
      "values" : "string"
    },
    "default" : { }
  }, {
    "name" : "before",
    "type" : [ "null", {
      "type" : "record",
      "name" : "columns",
      "fields" : [ {
        "name" : "CUST_CODE",
        "type" : [ "null", "string" ],
        "default" : null
      }, {
        "name" : "CUST_CODE_isMissing",
        "type" : "boolean"
      }, {
        "name" : "ORDER_DATE",
        "type" : [ "null", "string" ],
        "default" : null
      }, {
        "name" : "ORDER_DATE_isMissing",
        "type" : "boolean"
      }, {
        "name" : "PRODUCT_CODE",
        "type" : [ "null", "string" ],
        "default" : null
      }, {
        "name" : "PRODUCT_CODE_isMissing",
        "type" : "boolean"
      }, {
        "name" : "ORDER_ID",
        "type" : [ "null", "string" ],
        "default" : null
      }, {
        "name" : "ORDER_ID_isMissing",
        "type" : "boolean"
      }, {
        "name" : "PRODUCT_PRICE",
        "type" : [ "null", "double" ],
        "default" : null
      }, {
        "name" : "PRODUCT_PRICE_isMissing",
        "type" : "boolean"
      }, {
        "name" : "PRODUCT_AMOUNT",
        "type" : [ "null", "double" ],
        "default" : null
      }, {
        "name" : "PRODUCT_AMOUNT_isMissing",
        "type" : "boolean"
      }, {
        "name" : "TRANSACTION_ID",
        "type" : [ "null", "string" ],
        "default" : null
      }, {
        "name" : "TRANSACTION_ID_isMissing",
        "type" : "boolean"
      } ]
    } ],
    "default" : null
  }, {
    "name" : "after",
    "type" : [ "null", "columns" ],
    "default" : null
  } ]
}
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD548"></a><a id="GADBD547"></a>
<div class="props_rev_3"><a id="GUID-98614A46-1E3F-4003-A965-5B3CA6F27668"></a>
<h3 id="GADBD-GUID-98614A46-1E3F-4003-A965-5B3CA6F27668" class="sect3"><span class="enumeration_section">6.5.4</span> Avro Operation Formatter Configuration</h3>
<div>
<div class="tblformal" id="GUID-98614A46-1E3F-4003-A965-5B3CA6F27668__GUID-B233ED06-584F-49F8-A5DC-89A102FF2836">
<p class="titleintable">Table 6-9 Configuration Options</p>
<table class="cellalignment145" title="Configuration Options" summary="This two column table lists the configuration options for Avro Schema">
<thead align="left">
<tr>
<th class="cellalignment179" id="d14700e3248">Properties</th>
<th class="cellalignment163" id="d14700e3251">Optional Y/N</th>
<th class="cellalignment150" id="d14700e3254">Legal Values</th>
<th class="cellalignment163" id="d14700e3257">Default</th>
<th class="cellalignment171" id="d14700e3260">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment179" id="d14700e3265" headers="d14700e3248">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.insertOpKey</code></p>
</td>
<td class="cellalignment163" headers="d14700e3265 d14700e3251">
<p>Optional</p>
</td>
<td class="cellalignment150" headers="d14700e3265 d14700e3254">
<p>Any string</p>
</td>
<td class="cellalignment163" headers="d14700e3265 d14700e3257">
<p>I</p>
</td>
<td class="cellalignment171" headers="d14700e3265 d14700e3260">
<p>Indicator to be inserted into the output record to indicate an insert operation</p>
</td>
</tr>
<tr>
<td class="cellalignment179" id="d14700e3287" headers="d14700e3248">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.updateOpKey</code></p>
</td>
<td class="cellalignment163" headers="d14700e3287 d14700e3251">
<p>Optional</p>
</td>
<td class="cellalignment150" headers="d14700e3287 d14700e3254">
<p>Any string</p>
</td>
<td class="cellalignment163" headers="d14700e3287 d14700e3257">
<p>U</p>
</td>
<td class="cellalignment171" headers="d14700e3287 d14700e3260">
<p>Indicator to be inserted into the output record to indicate an update operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment179" id="d14700e3309" headers="d14700e3248">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.deleteOpKey</code></p>
</td>
<td class="cellalignment163" headers="d14700e3309 d14700e3251">
<p>Optional</p>
</td>
<td class="cellalignment150" headers="d14700e3309 d14700e3254">
<p>Any string</p>
</td>
<td class="cellalignment163" headers="d14700e3309 d14700e3257">
<p>D</p>
</td>
<td class="cellalignment171" headers="d14700e3309 d14700e3260">
<p>Indicator to be inserted into the output record to indicate a delete operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment179" id="d14700e3331" headers="d14700e3248">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.truncateOpKey</code></p>
</td>
<td class="cellalignment163" headers="d14700e3331 d14700e3251">
<p>Optional</p>
</td>
<td class="cellalignment150" headers="d14700e3331 d14700e3254">
<p>Any string</p>
</td>
<td class="cellalignment163" headers="d14700e3331 d14700e3257">
<p>T</p>
</td>
<td class="cellalignment171" headers="d14700e3331 d14700e3260">
<p>Indicator to be inserted into the output record to indicate a truncate operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment179" id="d14700e3353" headers="d14700e3248">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.encoding</code></p>
</td>
<td class="cellalignment163" headers="d14700e3353 d14700e3251">
<p>Optional</p>
</td>
<td class="cellalignment150" headers="d14700e3353 d14700e3254">
<p>Any legal encoding name or alias supported by Java</p>
</td>
<td class="cellalignment163" headers="d14700e3353 d14700e3257">
<p>UTF-8 (the JSON default)</p>
</td>
<td class="cellalignment171" headers="d14700e3353 d14700e3260">
<p>Controls the output encoding of generated Avro schema that is a JSON. JSON default is UTF-8. Avro messages are binary and support their own internal representation of encoding.</p>
</td>
</tr>
<tr>
<td class="cellalignment179" id="d14700e3375" headers="d14700e3248">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.treatAllColumnsAsStrings</code></p>
</td>
<td class="cellalignment163" headers="d14700e3375 d14700e3251">
<p>Optional</p>
</td>
<td class="cellalignment150" headers="d14700e3375 d14700e3254">
<p><code>true</code> | <code>false</code></p>
</td>
<td class="cellalignment163" headers="d14700e3375 d14700e3257">
<p><code>false</code></p>
</td>
<td class="cellalignment171" headers="d14700e3375 d14700e3260">
<p>Controls the output typing of generated Avro messages. If set to false then the formatter will attempt to map Oracle GoldenGate types to the corresponding Avro type. If set to true then all data will be treated as Strings in the generated Avro messages and schemas.</p>
</td>
</tr>
<tr>
<td class="cellalignment179" id="d14700e3402" headers="d14700e3248">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.lineDelimiter</code></p>
</td>
<td class="cellalignment163" headers="d14700e3402 d14700e3251">
<p>Optional</p>
</td>
<td class="cellalignment150" headers="d14700e3402 d14700e3254">
<p>Any string</p>
</td>
<td class="cellalignment163" headers="d14700e3402 d14700e3257">
<p>no value</p>
</td>
<td class="cellalignment171" headers="d14700e3402 d14700e3260">
<p>Optionally allows a user to insert a delimiter after each Avro message. This is not considered the best practice but in certain use cases customers may wish to parse a stream of data and extract individual Avro messages from the stream. This property allows the customer that option. Select a unique delimiter that cannot occur in any Avro message. This property supports <code>CDATA[]</code> wrapping.</p>
</td>
</tr>
<tr>
<td class="cellalignment179" id="d14700e3427" headers="d14700e3248">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.schemaDirectory</code></p>
</td>
<td class="cellalignment163" headers="d14700e3427 d14700e3251">
<p>Optional</p>
</td>
<td class="cellalignment150" headers="d14700e3427 d14700e3254">
<p>Any legal, existing file system path.</p>
</td>
<td class="cellalignment163" headers="d14700e3427 d14700e3257">
<p><code>./dirdef</code></p>
</td>
<td class="cellalignment171" headers="d14700e3427 d14700e3260">
<p>Controls the output location of generated Avro schemas.</p>
</td>
</tr>
<tr>
<td class="cellalignment179" id="d14700e3450" headers="d14700e3248">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.wrapMessageInGenericAvroSchema</code></p>
</td>
<td class="cellalignment163" headers="d14700e3450 d14700e3251">
<p>Optional</p>
</td>
<td class="cellalignment150" headers="d14700e3450 d14700e3254">
<p><code>true</code>|<code>false</code></p>
</td>
<td class="cellalignment163" headers="d14700e3450 d14700e3257">
<p><code>false</code></p>
</td>
<td class="cellalignment171" headers="d14700e3450 d14700e3260">
<p>Provides functionality to wrap the Avro messages for operations from the source trail file in a generic Avro wrapper message. For more information, see <a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm#GUID-24CC9E72-20A4-478E-8503-9777B9029A9B">Generic Wrapper Functionality</a>.</p>
</td>
</tr>
<tr>
<td class="cellalignment179" id="d14700e3480" headers="d14700e3248">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.iso8601Format</code></p>
</td>
<td class="cellalignment163" headers="d14700e3480 d14700e3251">
<p>Optional</p>
</td>
<td class="cellalignment150" headers="d14700e3480 d14700e3254">
<p><code>true</code> | <code>false</code></p>
</td>
<td class="cellalignment163" headers="d14700e3480 d14700e3257">
<p><code>true</code></p>
</td>
<td class="cellalignment171" headers="d14700e3480 d14700e3260">Controls the format of the current timestamp. The default is the &nbsp;ISO 8601 format. Set to <code>false</code> removes the <code>&ldquo;T&rdquo;</code> between the date and time in the current timestamp, which outputs <code>&ldquo; &ldquo;</code> instead.</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD549"></a>
<div class="props_rev_3"><a id="GUID-2993BB83-4F79-4835-A40D-E53C52CD18AD"></a>
<h3 id="GADBD-GUID-2993BB83-4F79-4835-A40D-E53C52CD18AD" class="sect3"><span class="enumeration_section">6.5.5</span> Sample Configuration</h3>
<div>
<div class="section">
<p>The following is a sample configuration for the Avro Operation Formatter from the Java Adapter properg.handlerties file:</p>
<pre dir="ltr">
gg.hdfs.format=avro_row
gg.handler.hdfs.format.insertOpKey=I
gg.handler.hdfs.format.updateOpKey=U
gg.handler.hdfs.format.deleteOpKey=D
gg.handler.hdfs.format.truncateOpKey=T
gg.handler.hdfs.format.encoding=UTF-8
gg.handler.hafs.format.wrapMessageInGenericAvroMessage=false
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD550"></a>
<div class="props_rev_3"><a id="GUID-A314CBB0-AA5F-4141-A74A-DABE57106A9E"></a>
<h3 id="GADBD-GUID-A314CBB0-AA5F-4141-A74A-DABE57106A9E" class="sect3"><span class="enumeration_section">6.5.6</span> Metadata Change Events</h3>
<div>
<div class="section">
<p>The Avro Operation Formatter is capable of taking action in the case of a metadata change event. This assumes that the replicated database and upstream Oracle GoldenGate replication process can propagate metadata change events. Metadata change events are of particular importance when formatting using Avro due to the tight dependency of Avro messages to its corresponding schema. Metadata change events are handled seamlessly by the Avro Operation Formatter and an updated Avro schema will be generated upon the first encounter of an operation of that table after the metadata change event. You should understand the impact of a metadata change event and change downstream targets to the new Avro schema. The tight dependency of Avro messages to Avro schemas may result in compatibility issues. Avro messages generated before the schema change may not be able to be deserialized with the newly generated Avro schema. Conversely, Avro messages generated after the schema change may not be able to be deserialized with the previous Avro schema. It is a best practice to use the same version of the Avro schema that was used to generate the message. Consult the Apache Avro documentation for more details.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD551"></a>
<div class="props_rev_3"><a id="GUID-A53F03AC-F2CF-40E9-AE37-3CF5702CF565"></a>
<h3 id="GADBD-GUID-A53F03AC-F2CF-40E9-AE37-3CF5702CF565" class="sect3"><span class="enumeration_section">6.5.7</span> Special Considerations</h3>
<div>
<div class="section">
<p>This section describes the special considerations:</p>
</div>
<!-- class="section" --></div>
<a id="GADBD552"></a>
<div class="props_rev_3"><a id="GUID-33524400-58C4-4E9F-9DDF-D1A57AA465A0"></a>
<h4 id="GADBD-GUID-33524400-58C4-4E9F-9DDF-D1A57AA465A0" class="sect4"><span class="enumeration_section">6.5.7.1</span> Troubleshooting</h4>
<div>
<p>Avro is a binary format therefore is not human readable. Since Avro messages are in binary format, it will be difficult to debug any issues. When the <code>log4j</code> Java logging level is set to <code>TRACE</code> the created Avro messages will be deserialized and displayed in the log file as a JSON object. This allows you to view the structure and contents of the created Avro messages. <code>TRACE</code> should never be enabled in a production environment as it has a substantial impact on performance.</p>
</div>
</div>
<a id="GADBD553"></a>
<div class="props_rev_3"><a id="GUID-EF02EE2F-0C4E-4A27-9356-66B88AD31718"></a>
<h4 id="GADBD-GUID-EF02EE2F-0C4E-4A27-9356-66B88AD31718" class="sect4"><span class="enumeration_section">6.5.7.2</span> Primary Key Updates</h4>
<div>
<p>The Avro Operation Formatter creates messages with complete data of before and after images for update operations. Therefore, the Avro Operation Formatter requires no special treatment for primary key updates.</p>
</div>
</div>
<a id="GADBD554"></a>
<div class="props_rev_3"><a id="GUID-D130B867-16FE-4EE5-8AEE-E22341699E36"></a>
<h4 id="GADBD-GUID-D130B867-16FE-4EE5-8AEE-E22341699E36" class="sect4"><span class="enumeration_section">6.5.7.3</span> Generic Wrapper Message</h4>
<div>
<p>Avro messages are not self describing, which means the receiver of the message must know the schema associated with the message before the message can be deserialized. Avro messages are binary and provide no consistent or reliable way to inspect the message contents in order to ascertain the message type. Therefore, Avro can be especially troublesome when messages are interlaced into a single stream of data like Kafka.</p>
<p>The Avro formatter provides a special feature to wrap the Avro message in a generic Avro message. This functionality is enabled by setting the following configuration parameter.</p>
<pre dir="ltr">
gg.handler.<span class="italic">name</span>.format.wrapMessageInGenericAvroMessage=true
</pre>
<p>The generic message is Avro message wrapping the Avro payload message that is common to all Avro messages that are output. The schema for the generic message is name <code>generic_wrapper.avsc</code> and is written to the output schema directory. This message has the following three fields.</p>
<ul style="list-style-type: disc;">
<li>
<p><code>table_name</code> - The fully qualified source table name.</p>
</li>
<li>
<p><code>schema_hash</code> - The hash code of the Avro schema generating the message.</p>
</li>
<li>
<p><code>payload</code> - The wrapped Avro message.</p>
</li>
</ul>
<p>The following is the Avro Formatter generic wrapper schema:</p>
<pre dir="ltr">
{
  "type" : "record",
  "name" : "generic_wrapper",
  "namespace" : "oracle.goldengate",
  "fields" : [ {
    "name" : "table_name",
    "type" : "string"
  }, {
    "name" : "schema_hash",
    "type" : "int"
  }, {
    "name" : "payload",
    "type" : "bytes"
  } ]
}
]
}
</pre></div>
</div>
</div>
</div>
<div class="sect2"><a id="GUID-87FC20F6-E23C-442C-BC99-24311B0BE406"></a>
<h2 id="GADBD-GUID-87FC20F6-E23C-442C-BC99-24311B0BE406" class="sect2"><span class="enumeration_section">6.6</span> Avro Object Container File Formatter</h2>
<div>
<p>Oracle GoldenGate for Big Data can write to HDFS in Avro Object Container File (OCF) format. Using Avro OCF is a good choice for data formatting into HDFS because it handles schema evolution more efficiently than other formats. Compression and decompression is also supported in the Avro OCF Formatter to allow more efficient use of disk space.</p>
<p>The HDFS Handler integration with the Avro formatters to write files to HDFS in Avro OCF format is a specialized use case of the HDFS Handler. The Avro OCF format is required for Hive to be able to read Avro data in HDFS. The Avro OCF format is detailed in the Avro specification.</p>
<p><a href="http://avro.apache.org/docs/current/spec.html#Object+Container+Files" target="_blank">http://avro.apache.org/docs/current/spec.html#Object+Container+Files</a></p>
<p>Another important feature is that the HDFS Handler can be configured to stream data in Avro OCF format, generate table definitions in Hive, and update table definitions in Hive in the case of a metadata change event.</p>
</div>
<div class="sect3"><a id="GUID-494E0A44-756B-40FF-A46C-A300EFB54A05"></a>
<h3 id="GADBD-GUID-494E0A44-756B-40FF-A46C-A300EFB54A05" class="sect3"><span class="enumeration_section">6.6.1</span> Avro OCF Formatter Configuration</h3>
<div>
<div class="tblformal" id="GUID-494E0A44-756B-40FF-A46C-A300EFB54A05__GUID-3B00C87F-58A3-49B7-A2C5-DB47018A829C">
<table class="cellalignment145" summary="Five column table describing the Avro OCF Formatter configuration.">
<thead align="left">
<tr>
<th class="cellalignment180" id="d14700e3721">Parameter</th>
<th class="cellalignment180" id="d14700e3724">Optional / Required</th>
<th class="cellalignment180" id="d14700e3727">Legal Values</th>
<th class="cellalignment180" id="d14700e3730">Default</th>
<th class="cellalignment180" id="d14700e3733">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment180" id="d14700e3738" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.insertOpKey</code></p>
</td>
<td class="cellalignment180" headers="d14700e3738 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3738 d14700e3727">
<p>Any string</p>
</td>
<td class="cellalignment180" headers="d14700e3738 d14700e3730">
<p><code>I</code></p>
</td>
<td class="cellalignment180" headers="d14700e3738 d14700e3733">
<p>Indicator to be inserted into the output record to indicate an insert operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment180" id="d14700e3759" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.updateOpKey</code></p>
</td>
<td class="cellalignment180" headers="d14700e3759 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3759 d14700e3727">
<p>Any string</p>
</td>
<td class="cellalignment180" headers="d14700e3759 d14700e3730">
<p><code>U</code></p>
</td>
<td class="cellalignment180" headers="d14700e3759 d14700e3733">
<p>Indicator to be inserted into the output record to indicate an update operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment180" id="d14700e3780" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.truncateOpKey</code></p>
</td>
<td class="cellalignment180" headers="d14700e3780 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3780 d14700e3727">
<p>Any string</p>
</td>
<td class="cellalignment180" headers="d14700e3780 d14700e3730">
<p><code>T</code></p>
</td>
<td class="cellalignment180" headers="d14700e3780 d14700e3733">
<p>Indicator to be truncated into the output record to indicate a truncate operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment180" id="d14700e3801" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.deleteOpKey</code></p>
</td>
<td class="cellalignment180" headers="d14700e3801 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3801 d14700e3727">
<p>Any string</p>
</td>
<td class="cellalignment180" headers="d14700e3801 d14700e3730">
<p><code>D</code></p>
</td>
<td class="cellalignment180" headers="d14700e3801 d14700e3733">
<p>Indicator to be inserted into the output record to indicate a truncate operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment180" id="d14700e3822" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.encoding</code></p>
</td>
<td class="cellalignment180" headers="d14700e3822 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3822 d14700e3727">
<p>Any legal encoding name or alias supported by Java.</p>
</td>
<td class="cellalignment180" headers="d14700e3822 d14700e3730">
<p><code>UTF-8</code></p>
</td>
<td class="cellalignment180" headers="d14700e3822 d14700e3733">
<p>Controls the output encoding of generated Avro schema, which is a JSON. JSON default is UTF-8. Avro messages are binary and support their own internal representation of encoding.</p>
</td>
</tr>
<tr>
<td class="cellalignment180" id="d14700e3843" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.treatAllColumnsAsStrings</code></p>
</td>
<td class="cellalignment180" headers="d14700e3843 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3843 d14700e3727">
<p><code>true | false</code></p>
</td>
<td class="cellalignment180" headers="d14700e3843 d14700e3730">
<p><code>false</code></p>
</td>
<td class="cellalignment180" headers="d14700e3843 d14700e3733">
<p>Controls the output typing of generated Avro messages. If set to <code>false</code>, then the formatter attempts to map Oracle GoldenGate types to the corresponding Avro type. If set to <code>true</code>, then all data is treated as strings in the generated Avro messages and schemas.</p>
</td>
</tr>
<tr>
<td class="cellalignment180" id="d14700e3871" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.pkUpdateHandling</code></p>
</td>
<td class="cellalignment180" headers="d14700e3871 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3871 d14700e3727">
<p><code>abend</code> | <code>update</code> | <code>delete-insert</code></p>
</td>
<td class="cellalignment180" headers="d14700e3871 d14700e3730">
<p><code>abend</code></p>
</td>
<td class="cellalignment180" headers="d14700e3871 d14700e3733">
<p>Controls how the formatter should handle update operations that change a primary key. Primary key operations can be problematic for the Avro Row formatter and require special consideration by you.</p>
<ul style="list-style-type: disc;">
<li>
<p><code>abend</code> - indicates the process will abend</p>
</li>
<li>
<p><code>update</code> - indicates the process will treat this as a normal update</p>
</li>
<li>
<p><code>delete-insert</code> - indicates the process will treat this as a delete and an insert. The full before image is required for this feature to work properly. This can be achieved by using full supplemental logging in Oracle. Without full before and after row images the insert data will be incomplete.</p>
</li>
</ul>
</td>
</tr>
<tr>
<td class="cellalignment180" id="d14700e3915" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.generateSchema</code></p>
</td>
<td class="cellalignment180" headers="d14700e3915 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3915 d14700e3727">
<p><code>true | false</code></p>
</td>
<td class="cellalignment180" headers="d14700e3915 d14700e3730">
<p><code>true</code></p>
</td>
<td class="cellalignment180" headers="d14700e3915 d14700e3733">
<p>Schemas must be generated for Avro serialization so this property can be set to <code>false</code> to suppress the writing of the generated schemas to the local file system.</p>
</td>
</tr>
<tr>
<td class="cellalignment180" id="d14700e3940" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.schemaDirectory</code></p>
</td>
<td class="cellalignment180" headers="d14700e3940 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3940 d14700e3727">
<p>Any legal, existing file system path</p>
</td>
<td class="cellalignment180" headers="d14700e3940 d14700e3730">
<p><code>./dirdef</code></p>
</td>
<td class="cellalignment180" headers="d14700e3940 d14700e3733">
<p>Controls the output location of generated Avro schemas to the local file system. This property does not control where the Avro schema is written to in HDFS; that is controlled by an HDFS Handler property.</p>
</td>
</tr>
<tr>
<td class="cellalignment180" id="d14700e3961" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.iso8601Format</code></p>
</td>
<td class="cellalignment180" headers="d14700e3961 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3961 d14700e3727">
<p><code>true | false</code></p>
</td>
<td class="cellalignment180" headers="d14700e3961 d14700e3730">
<p><code>true</code></p>
</td>
<td class="cellalignment180" headers="d14700e3961 d14700e3733">
<p>The default format for the current timestamp is ISO8601. Set to <code>false</code> to remove the <code>T</code> between the date and time in the current timestamp and output a space instead.</p>
</td>
</tr>
<tr>
<td class="cellalignment180" id="d14700e3989" headers="d14700e3721">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.versionSchemas</code></p>
</td>
<td class="cellalignment180" headers="d14700e3989 d14700e3724">
<p>Optional</p>
</td>
<td class="cellalignment180" headers="d14700e3989 d14700e3727">
<p><code>true | false</code></p>
</td>
<td class="cellalignment180" headers="d14700e3989 d14700e3730">
<p><code>false</code></p>
</td>
<td class="cellalignment180" headers="d14700e3989 d14700e3733">
<p>If set to true, an Avro schema is created in the schema directory and versioned by a time stamp. The format of the schema is the following:</p>
<p><code><span class="codeinlineitalic">{fully qualified table name}_{time stamp}</span>.avsc</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
</div>
<a id="GADBD555"></a>
<div class="props_rev_3"><a id="GUID-2EBC39AB-CF4E-45DC-AD50-A16465AB534D"></a>
<h2 id="GADBD-GUID-2EBC39AB-CF4E-45DC-AD50-A16465AB534D" class="sect2"><span class="enumeration_section">6.7</span> XML Formatter</h2>
<div>
<div class="section">
<p>The XML Formatter formats operation data from the source trail file into a XML documents. The XML Formatter takes that before and after image data and formats the data into an XML document representation of the operation data. The format of the XML document is effectively the same as the XML format in the previous releases of the Oracle GoldenGate Java Adapter product.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD557"></a><a id="GADBD556"></a>
<div class="props_rev_3"><a id="GUID-F2FF4D61-3683-4AC1-A3B6-837EC9CC5F1F"></a>
<h3 id="GADBD-GUID-F2FF4D61-3683-4AC1-A3B6-837EC9CC5F1F" class="sect3"><span class="enumeration_section">6.7.1</span> Message Formatting Details</h3>
<div>
<div class="section">
<p>The XML formatted messages contain the following information:</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-F2FF4D61-3683-4AC1-A3B6-837EC9CC5F1F__GUID-89187670-98F6-4BB7-A854-59B0E489DCB6">
<p class="titleintable">Table 6-10 XML formatting details</p>
<table class="cellalignment145" title="XML formatting details" summary="This two column table lists the XML formatting details">
<thead align="left">
<tr>
<th class="cellalignment171" id="d14700e4064">Value</th>
<th class="cellalignment172" id="d14700e4067">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment171" id="d14700e4072" headers="d14700e4064">
<p><code>table</code></p>
</td>
<td class="cellalignment172" headers="d14700e4072 d14700e4067">
<p>The fully qualified table name.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e4080" headers="d14700e4064">
<p><code>type</code></p>
</td>
<td class="cellalignment172" headers="d14700e4080 d14700e4067">
<p>The operation type.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e4088" headers="d14700e4064">
<p><code>current_ts</code></p>
</td>
<td class="cellalignment172" headers="d14700e4088 d14700e4067">
<p>The current timestamp is the time when the formatter processed the current operation record. This timestamp follows the ISO-8601 format and includes micro second precision. Replaying the trail file does not result in the same timestamp for the same operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e4096" headers="d14700e4064">
<p><code>pos</code></p>
</td>
<td class="cellalignment172" headers="d14700e4096 d14700e4067">
<p>The position from the source trail file.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e4104" headers="d14700e4064">
<p><code>numCols</code></p>
</td>
<td class="cellalignment172" headers="d14700e4104 d14700e4067">
<p>The total number of columns in the source table.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e4112" headers="d14700e4064">
<p><code>col</code></p>
</td>
<td class="cellalignment172" headers="d14700e4112 d14700e4067">
<p>The col element is a repeating element that contains the before and after images of operation data.</p>
</td>
</tr>
<tr>
<td class="cellalignment171" id="d14700e4120" headers="d14700e4064">
<p><code>tokens</code></p>
</td>
<td class="cellalignment172" headers="d14700e4120 d14700e4067">
<p>The tokens element contains the token values from the source trail file.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD558"></a>
<div class="props_rev_3"><a id="GUID-FC5D016C-74D8-430A-A47B-026372C395F9"></a>
<h3 id="GADBD-GUID-FC5D016C-74D8-430A-A47B-026372C395F9" class="sect3"><span class="enumeration_section">6.7.2</span> Sample XML Messages</h3>
<div>
<div class="section">
<p>This sections provides sample XML messages.</p>
</div>
<!-- class="section" --></div>
<a id="GADBD559"></a>
<div class="props_rev_3"><a id="GUID-62055326-22F2-4937-9375-02A6AFE939AE"></a>
<h4 id="GADBD-GUID-62055326-22F2-4937-9375-02A6AFE939AE" class="sect4"><span class="enumeration_section">6.7.2.1</span> Sample Insert Message</h4>
<div>
<pre dir="ltr">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;operation table='GG.TCUSTORD' type='I' ts='2013-06-02 22:14:36.000000' current_ts='2015-10-06T12:21:50.100001' pos='00000000000000001444' numCols='7'&gt;
 &lt;col name='CUST_CODE' index='0'&gt;
   &lt;before missing='true'/&gt;
   &lt;after&gt;&lt;![CDATA[WILL]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='ORDER_DATE' index='1'&gt;
   &lt;before missing='true'/&gt;
   &lt;after&gt;&lt;![CDATA[1994-09-30:15:33:00]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='PRODUCT_CODE' index='2'&gt;
   &lt;before missing='true'/&gt;
   &lt;after&gt;&lt;![CDATA[CAR]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='ORDER_ID' index='3'&gt;
   &lt;before missing='true'/&gt;
   &lt;after&gt;&lt;![CDATA[144]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='PRODUCT_PRICE' index='4'&gt;
   &lt;before missing='true'/&gt;
   &lt;after&gt;&lt;![CDATA[17520.00]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='PRODUCT_AMOUNT' index='5'&gt;
   &lt;before missing='true'/&gt;
   &lt;after&gt;&lt;![CDATA[3]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='TRANSACTION_ID' index='6'&gt;
   &lt;before missing='true'/&gt;
   &lt;after&gt;&lt;![CDATA[100]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;tokens&gt;
   &lt;token&gt;
     &lt;Name&gt;&lt;![CDATA[R]]&gt;&lt;/Name&gt;
     &lt;Value&gt;&lt;![CDATA[AADPkvAAEAAEqL2AAA]]&gt;&lt;/Value&gt;
   &lt;/token&gt;
 &lt;/tokens&gt;
&lt;/operation&gt;
</pre></div>
</div>
<a id="GADBD560"></a>
<div class="props_rev_3"><a id="GUID-5ABD698C-FBC3-4A11-BFE1-E65FA784ECD7"></a>
<h4 id="GADBD-GUID-5ABD698C-FBC3-4A11-BFE1-E65FA784ECD7" class="sect4"><span class="enumeration_section">6.7.2.2</span> Sample Update Message</h4>
<div>
<pre dir="ltr">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;operation table='GG.TCUSTORD' type='U' ts='2013-06-02 22:14:41.000000' current_ts='2015-10-06T12:21:50.413000' pos='00000000000000002891' numCols='7'&gt;
 &lt;col name='CUST_CODE' index='0'&gt;
   &lt;before&gt;&lt;![CDATA[BILL]]&gt;&lt;/before&gt;
   &lt;after&gt;&lt;![CDATA[BILL]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='ORDER_DATE' index='1'&gt;
   &lt;before&gt;&lt;![CDATA[1995-12-31:15:00:00]]&gt;&lt;/before&gt;
   &lt;after&gt;&lt;![CDATA[1995-12-31:15:00:00]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='PRODUCT_CODE' index='2'&gt;
   &lt;before&gt;&lt;![CDATA[CAR]]&gt;&lt;/before&gt;
   &lt;after&gt;&lt;![CDATA[CAR]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='ORDER_ID' index='3'&gt;
   &lt;before&gt;&lt;![CDATA[765]]&gt;&lt;/before&gt;
   &lt;after&gt;&lt;![CDATA[765]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='PRODUCT_PRICE' index='4'&gt;
   &lt;before&gt;&lt;![CDATA[15000.00]]&gt;&lt;/before&gt;
   &lt;after&gt;&lt;![CDATA[14000.00]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='PRODUCT_AMOUNT' index='5'&gt;
   &lt;before&gt;&lt;![CDATA[3]]&gt;&lt;/before&gt;
   &lt;after&gt;&lt;![CDATA[3]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;col name='TRANSACTION_ID' index='6'&gt;
   &lt;before&gt;&lt;![CDATA[100]]&gt;&lt;/before&gt;
   &lt;after&gt;&lt;![CDATA[100]]&gt;&lt;/after&gt;
 &lt;/col&gt;
 &lt;tokens&gt;
   &lt;token&gt;
     &lt;Name&gt;&lt;![CDATA[R]]&gt;&lt;/Name&gt;
     &lt;Value&gt;&lt;![CDATA[AADPkvAAEAAEqLzAAA]]&gt;&lt;/Value&gt;
   &lt;/token&gt;
 &lt;/tokens&gt;
&lt;/operation&gt;
</pre></div>
</div>
<a id="GADBD561"></a>
<div class="props_rev_3"><a id="GUID-83BDF19C-07EB-4A84-B61E-217EA7DA66DC"></a>
<h4 id="GADBD-GUID-83BDF19C-07EB-4A84-B61E-217EA7DA66DC" class="sect4"><span class="enumeration_section">6.7.2.3</span> Sample Delete Message</h4>
<div>
<pre dir="ltr">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;operation table='GG.TCUSTORD' type='D' ts='2013-06-02 22:14:41.000000' current_ts='2015-10-06T12:21:50.415000' pos='00000000000000004338' numCols='7'&gt;
 &lt;col name='CUST_CODE' index='0'&gt;
   &lt;before&gt;&lt;![CDATA[DAVE]]&gt;&lt;/before&gt;
   &lt;after missing='true'/&gt;
 &lt;/col&gt;
 &lt;col name='ORDER_DATE' index='1'&gt;
   &lt;before&gt;&lt;![CDATA[1993-11-03:07:51:35]]&gt;&lt;/before&gt;
   &lt;after missing='true'/&gt;
 &lt;/col&gt;
 &lt;col name='PRODUCT_CODE' index='2'&gt;
   &lt;before&gt;&lt;![CDATA[PLANE]]&gt;&lt;/before&gt;
   &lt;after missing='true'/&gt;
 &lt;/col&gt;
 &lt;col name='ORDER_ID' index='3'&gt;
   &lt;before&gt;&lt;![CDATA[600]]&gt;&lt;/before&gt;
   &lt;after missing='true'/&gt;
 &lt;/col&gt;
 &lt;col name='PRODUCT_PRICE' index='4'&gt;
  &lt;missing/&gt;
 &lt;/col&gt;
 &lt;col name='PRODUCT_AMOUNT' index='5'&gt;
  &lt;missing/&gt;
 &lt;/col&gt;
 &lt;col name='TRANSACTION_ID' index='6'&gt;
  &lt;missing/&gt;
 &lt;/col&gt;
 &lt;tokens&gt;
   &lt;token&gt;
     &lt;Name&gt;&lt;![CDATA[L]]&gt;&lt;/Name&gt;
     &lt;Value&gt;&lt;![CDATA[206080450]]&gt;&lt;/Value&gt;
   &lt;/token&gt;
   &lt;token&gt;
     &lt;Name&gt;&lt;![CDATA[6]]&gt;&lt;/Name&gt;
     &lt;Value&gt;&lt;![CDATA[9.0.80330]]&gt;&lt;/Value&gt;
   &lt;/token&gt;
   &lt;token&gt;
     &lt;Name&gt;&lt;![CDATA[R]]&gt;&lt;/Name&gt;
     &lt;Value&gt;&lt;![CDATA[AADPkvAAEAAEqLzAAC]]&gt;&lt;/Value&gt;
   &lt;/token&gt;
 &lt;/tokens&gt;
&lt;/operation&gt;
</pre></div>
</div>
<a id="GADBD562"></a>
<div class="props_rev_3"><a id="GUID-612A00F6-AC94-4C17-939C-243D4849603A"></a>
<h4 id="GADBD-GUID-612A00F6-AC94-4C17-939C-243D4849603A" class="sect4"><span class="enumeration_section">6.7.2.4</span> Sample Truncate Message</h4>
<div>
<pre dir="ltr">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;operation table='GG.TCUSTORD' type='T' ts='2013-06-02 22:14:41.000000' current_ts='2015-10-06T12:21:50.415001' pos='00000000000000004515' numCols='7'&gt;
 &lt;col name='CUST_CODE' index='0'&gt;
   &lt;missing/&gt; 
 &lt;/col&gt;
 &lt;col name='ORDER_DATE' index='1'&gt;
   &lt;missing/&gt; 
 &lt;/col&gt;
 &lt;col name='PRODUCT_CODE' index='2'&gt;
   &lt;missing/&gt; 
 &lt;/col&gt;
 &lt;col name='ORDER_ID' index='3'&gt;
   &lt;missing/&gt; 
 &lt;/col&gt;
 &lt;col name='PRODUCT_PRICE' index='4'&gt;
  &lt;missing/&gt;
 &lt;/col&gt;
 &lt;col name='PRODUCT_AMOUNT' index='5'&gt;
  &lt;missing/&gt;
 &lt;/col&gt;
 &lt;col name='TRANSACTION_ID' index='6'&gt;
  &lt;missing/&gt;
 &lt;/col&gt;
 &lt;tokens&gt;
   &lt;token&gt;
     &lt;Name&gt;&lt;![CDATA[R]]&gt;&lt;/Name&gt;
     &lt;Value&gt;&lt;![CDATA[AADPkvAAEAAEqL2AAB]]&gt;&lt;/Value&gt;
   &lt;/token&gt;
 &lt;/tokens&gt;
&lt;/operation&gt;
</pre></div>
</div>
</div>
<a id="GADBD563"></a>
<div class="props_rev_3"><a id="GUID-1A3CA163-4EE9-48CA-A8C9-A7CB932F454D"></a>
<h3 id="GADBD-GUID-1A3CA163-4EE9-48CA-A8C9-A7CB932F454D" class="sect3"><span class="enumeration_section">6.7.3</span> XML Schema</h3>
<div>
<div class="section">
<p>An XML schema (XSD) is not generated as part of the XML Formatter functionality. The XSD is generic to any and all messages generated by the XML Formatter. An XSD defining the structure of output XML documents is defined as follows:</p>
<pre dir="ltr">
&lt;xs:schema attributeFormDefault="unqualified" 
elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;
   &lt;xs:element name="operation"&gt;
     &lt;xs:complexType&gt;
       &lt;xs:sequence&gt;
          &lt;xs:element name="col" maxOccurs="unbounded" minOccurs="0"&gt;
           &lt;xs:complexType&gt;
             &lt;xs:sequence&gt;
               &lt;xs:element name="before" minOccurs="0"&gt;
                 &lt;xs:complexType&gt;
                   &lt;xs:simpleContent&gt;
                     &lt;xs:extension base="xs:string"&gt;
                       &lt;xs:attribute type="xs:string" name="missing" 
use="optional"/&gt;
                     &lt;/xs:extension&gt;
                   &lt;/xs:simpleContent&gt;
                 &lt;/xs:complexType&gt;
               &lt;/xs:element&gt;
               &lt;xs:element name="after" minOccurs="0"&gt;
                 &lt;xs:complexType&gt;
                   &lt;xs:simpleContent&gt;
                     &lt;xs:extension base="xs:string"&gt;
                       &lt;xs:attribute type="xs:string" name="missing" 
use="optional"/&gt;
                     &lt;/xs:extension&gt;
                   &lt;/xs:simpleContent&gt;
                 &lt;/xs:complexType&gt;
               &lt;/xs:element&gt;
               &lt;xs:element type="xs:string" name="missing" minOccurs="0"/&gt;
             &lt;/xs:sequence&gt;
             &lt;xs:attribute type="xs:string" name="name"/&gt;
             &lt;xs:attribute type="xs:short" name="index"/&gt;
           &lt;/xs:complexType&gt;
         &lt;/xs:element&gt;
         &lt;xs:element name="tokens" minOccurs="0"&gt;
           &lt;xs:complexType&gt;
             &lt;xs:sequence&gt;
               &lt;xs:element name="token" maxOccurs="unbounded" minOccurs="0"&gt;
                 &lt;xs:complexType&gt;
                   &lt;xs:sequence&gt;
                     &lt;xs:element type="xs:string" name="Name"/&gt;
                     &lt;xs:element type="xs:string" name="Value"/&gt;
                   &lt;/xs:sequence&gt;
                 &lt;/xs:complexType&gt;
               &lt;/xs:element&gt;
             &lt;/xs:sequence&gt;
           &lt;/xs:complexType&gt;
         &lt;/xs:element&gt;
       &lt;/xs:sequence&gt;
       &lt;xs:attribute type="xs:string" name="table"/&gt;
       &lt;xs:attribute type="xs:string" name="type"/&gt;
       &lt;xs:attribute type="xs:string" name="ts"/&gt;
       &lt;xs:attribute type="xs:dateTime" name="current_ts"/&gt;
       &lt;xs:attribute type="xs:long" name="pos"/&gt;
       &lt;xs:attribute type="xs:short" name="numCols"/&gt;
     &lt;/xs:complexType&gt;
   &lt;/xs:element&gt;
&lt;/xs:schema&gt;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD565"></a><a id="GADBD564"></a>
<div class="props_rev_3"><a id="GUID-B0DC7FC1-332C-4425-B412-9F7D3178CE42"></a>
<h3 id="GADBD-GUID-B0DC7FC1-332C-4425-B412-9F7D3178CE42" class="sect3"><span class="enumeration_section">6.7.4</span> XML Configuration</h3>
<div>
<div class="tblformal" id="GUID-B0DC7FC1-332C-4425-B412-9F7D3178CE42__GUID-7C15176F-9D19-40BA-A184-CAD7F100D83B">
<p class="titleintable">Table 6-11 Configuration Options</p>
<table class="cellalignment145" title="Configuration Options" summary="This two column table lists the XML configuration options">
<thead align="left">
<tr>
<th class="cellalignment181" id="d14700e4271">Parameter</th>
<th class="cellalignment166" id="d14700e4274">Optional Y/N</th>
<th class="cellalignment182" id="d14700e4277">Legal Values</th>
<th class="cellalignment158" id="d14700e4280">Default</th>
<th class="cellalignment168" id="d14700e4283">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment181" id="d14700e4288" headers="d14700e4271">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.insertOpKey</code></p>
</td>
<td class="cellalignment166" headers="d14700e4288 d14700e4274">
<p>Optional</p>
</td>
<td class="cellalignment182" headers="d14700e4288 d14700e4277">
<p>Any string</p>
</td>
<td class="cellalignment158" headers="d14700e4288 d14700e4280">
<p>I</p>
</td>
<td class="cellalignment168" headers="d14700e4288 d14700e4283">
<p>Indicator to be inserted into the output record to indicate an insert operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment181" id="d14700e4310" headers="d14700e4271">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.updateOpKey</code></p>
</td>
<td class="cellalignment166" headers="d14700e4310 d14700e4274">
<p>Optional</p>
</td>
<td class="cellalignment182" headers="d14700e4310 d14700e4277">
<p>Any string</p>
</td>
<td class="cellalignment158" headers="d14700e4310 d14700e4280">
<p>U</p>
</td>
<td class="cellalignment168" headers="d14700e4310 d14700e4283">
<p>Indicator to be inserted into the output record to indicate an update operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment181" id="d14700e4332" headers="d14700e4271">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.deleteOpKey</code></p>
</td>
<td class="cellalignment166" headers="d14700e4332 d14700e4274">
<p>Optional</p>
</td>
<td class="cellalignment182" headers="d14700e4332 d14700e4277">
<p>Any string</p>
</td>
<td class="cellalignment158" headers="d14700e4332 d14700e4280">
<p>D</p>
</td>
<td class="cellalignment168" headers="d14700e4332 d14700e4283">
<p>Indicator to be inserted into the output record to indicate a delete operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment181" id="d14700e4354" headers="d14700e4271">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.truncateOpKey</code></p>
</td>
<td class="cellalignment166" headers="d14700e4354 d14700e4274">
<p>Optional</p>
</td>
<td class="cellalignment182" headers="d14700e4354 d14700e4277">
<p>Any string</p>
</td>
<td class="cellalignment158" headers="d14700e4354 d14700e4280">
<p>T</p>
</td>
<td class="cellalignment168" headers="d14700e4354 d14700e4283">
<p>Indicator to be inserted into the output record to indicate a truncate operation.</p>
</td>
</tr>
<tr>
<td class="cellalignment181" id="d14700e4376" headers="d14700e4271">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.encoding</code></p>
</td>
<td class="cellalignment166" headers="d14700e4376 d14700e4274">
<p>Optional</p>
</td>
<td class="cellalignment182" headers="d14700e4376 d14700e4277">
<p>Any legal encoding name or alias supported by Java.</p>
</td>
<td class="cellalignment158" headers="d14700e4376 d14700e4280">
<p>UTF-8 (the XML default)</p>
</td>
<td class="cellalignment168" headers="d14700e4376 d14700e4283">
<p>Controls the output encoding of generated XML documents.</p>
</td>
</tr>
<tr>
<td class="cellalignment181" id="d14700e4398" headers="d14700e4271">
<p><code>gg.handler.</code><span class="italic"><code>name.</code></span><code>format.includeProlog</code></p>
</td>
<td class="cellalignment166" headers="d14700e4398 d14700e4274">
<p>Optional</p>
</td>
<td class="cellalignment182" headers="d14700e4398 d14700e4277">
<p>true | false</p>
</td>
<td class="cellalignment158" headers="d14700e4398 d14700e4280">
<p>false</p>
</td>
<td class="cellalignment168" headers="d14700e4398 d14700e4283">
<p>Controls the output of an XML prolog on generated XML documents. The XML prolog is optional for well formed XML. Sample XML prolog looks like <code>&lt;?xml version='1.0' encoding='UTF-8'?&gt;</code></p>
</td>
</tr>
<tr>
<td class="cellalignment181" id="d14700e4422" headers="d14700e4271">
<p><code>gg.handler.<span class="codeinlineitalic">name</span>.format.iso8601Format</code></p>
</td>
<td class="cellalignment166" headers="d14700e4422 d14700e4274">
<p>Optional</p>
</td>
<td class="cellalignment182" headers="d14700e4422 d14700e4277">
<p><code>true | false</code></p>
</td>
<td class="cellalignment158" headers="d14700e4422 d14700e4280">
<p><code>true</code></p>
</td>
<td class="cellalignment168" headers="d14700e4422 d14700e4283">
<p>Controls the format of the current timestamp in the XML message. Set to <code>false</code> to suppress the <code>"T"</code> between the date and time and instead include blank space.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD566"></a>
<div class="props_rev_3"><a id="GUID-2538C4A2-8D62-4B09-8EE7-0446714E82E0"></a>
<h3 id="GADBD-GUID-2538C4A2-8D62-4B09-8EE7-0446714E82E0" class="sect3"><span class="enumeration_section">6.7.5</span> Sample Configuration</h3>
<div>
<div class="section">
<p>The following is sample configuration for the XML Formatter from the Java Adapter properties file:</p>
<pre dir="ltr">
gg.handler.hdfs.format=xml
gg.handler.hdfs.format.insertOpKey=I
gg.handler.hdfs.format.updateOpKey=U
gg.handler.hdfs.format.deleteOpKey=D
gg.handler.hdfs.format.truncateOpKey=T
gg.handler.hdfs.format.encoding=ISO-8859-1
gg.handler.hdfs.format.includeProlog=false
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD567"></a>
<div class="props_rev_3"><a id="GUID-936298A4-A4B6-4081-AD93-386B035BACA8"></a>
<h3 id="GADBD-GUID-936298A4-A4B6-4081-AD93-386B035BACA8" class="sect3"><span class="enumeration_section">6.7.6</span> Metadata Change Events</h3>
<div>
<div class="section">
<p>The XML Formatter will seamlessly handle metadata change events. The format of the XML document is such that a metadata change event does not even result in a change to the XML schema. The XML schema is designed to be generic so that the same schema represents the data of any operation from any table.</p>
<p>The XML Formatter is capable of taking action in the case of a metadata change event. This assumes that the replicated database and upstream Oracle GoldenGate replication process can propagate metadata change events. The format of the XML document is such that a metadata change event does not result in a change to the XML schema. The XML schema is generic so that the same schema represents the data of any operation form any table. The resulting changes in the metadata will be reflected in messages after the metadata change event. For example in the case of adding a column, the new column and column data will begin showing up in XML messages for that table after the metadata change event.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD568"></a>
<div class="props_rev_3"><a id="GUID-C86FE871-3F4E-474E-91D7-A9BC83E1323E"></a>
<h3 id="GADBD-GUID-C86FE871-3F4E-474E-91D7-A9BC83E1323E" class="sect3"><span class="enumeration_section">6.7.7</span> Primary Key Updates</h3>
<div>
<div class="section">
<p>Updates to a primary key require no special handling by the XML formatter. The XML formatter creates messages that model the database operations. For update operations this includes before and after images of column values. Primary key changes are simply represented in this format as a change to a column value just like a change to any other column value</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment135">
<tr>
<td class="cellalignment142">
<table class="cellalignment140">
<tr>
<td class="cellalignment139"><a href="GUID-2561CA12-9BAC-454B-A2E3-2D36C5C60EE5.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment139"><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2015, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment144">
<table class="cellalignment138">
<tr>
<td class="cellalignment139"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment139"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
