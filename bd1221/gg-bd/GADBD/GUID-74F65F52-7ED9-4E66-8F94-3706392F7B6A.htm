<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Using the Flume Handler</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2016-06-08T07:49:17Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Integrating Oracle GoldenGate for Big Data" />
<meta name="dcterms.identifier" content="E65148-03" />
<meta name="dcterms.isVersionOf" content="GADBD" />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="GUID-3EC975E2-1F9A-4AB3-B3F6-7B4ADFEED390.htm" title="Previous" type="text/html" />
<link rel="Next" href="GUID-2561CA12-9BAC-454B-A2E3-2D36C5C60EE5.htm" title="Next" type="text/html" />
<link rel="alternate" href="E65148-03.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="E65148-03.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="E65148-03.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Skip Headers</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr"><a id="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A"></a> <span id="PAGE" style="display:none;">7/15</span> <!-- End Header --><a id="GADBD420"></a>
<h1 id="GADBD-GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A" class="sect1"><span class="enumeration_chapter">4</span> Using the Flume Handler</h1>
<div>
<p>The chapter includes the following sections:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-9CA7E19C-FDF2-422E-AE57-CCE8E4FE3BF3">Overview</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-DE10334E-71AC-41E1-8AC2-075DEBE30775">Runtime Prerequisites</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-53081475-7487-48C8-A801-AC581ABA38EC">Classpath Configuration</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-4C4968F3-097B-4629-84C5-4E78807E21D7">Pluggable Formatters</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-36456B87-E00C-4906-AD1C-44FD7923F6F6">Flume Handler Configuration</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-79F6A7A2-2EC3-4EE6-8721-606980C8BBD0">Sample Configuration</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-06757D87-A23A-4B11-A5DB-74A13912E504">Troubleshooting</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-6920E6D1-05E7-4CB7-86D1-6D7A3178FDEE">Data Mapping of Operations to Flume Events</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-84432ABF-EA8C-419A-AAAF-090C21A225FA">Flume Handler Certification Matrix</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-02D2F46C-D31A-46C5-8536-FEA9101113F3">Performance Considerations</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-5BA29358-EE61-475D-926E-89CB195F43FB">Metadata Change Events</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-28C37117-3746-431A-AE25-04E54ACBA31B">Example Flume Source Configuration</a></p>
</li>
<li>
<p><a href="GUID-74F65F52-7ED9-4E66-8F94-3706392F7B6A.htm#GUID-DD59F911-5BA1-4C1C-845C-29BD6E0E1693">Advanced Features</a></p>
</li>
</ul>
</div>
<a id="GADBD421"></a>
<div class="props_rev_3"><a id="GUID-9CA7E19C-FDF2-422E-AE57-CCE8E4FE3BF3"></a>
<h2 id="GADBD-GUID-9CA7E19C-FDF2-422E-AE57-CCE8E4FE3BF3" class="sect2"><span class="enumeration_section">4.1</span> Overview</h2>
<div>
<div class="section">
<p>The Oracle GoldenGate for Big Data Flume Handler is designed to stream change capture data from a Oracle GoldenGate trail to a Flume source. Apache Flume is an open source application for which the primary purpose is streaming data into Big Data applications. The Flume architecture contains three main components namely, Sources, Channels and Sinks which collectively make a pipeline for data. A Flume source publishes the data to a Flume channel. A Flume sink retrieves the data out of a Flume channel and streams the data to different targets. A Flume Agent is a container process that owns and manages a source, channel and sink. A single Flume installation can host many agent processes. The Flume Handler can stream data from a trail file to Avro or Thrift RPC Flume sources.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD423"></a>
<div class="props_rev_3"><a id="GUID-DE10334E-71AC-41E1-8AC2-075DEBE30775"></a>
<h2 id="GADBD-GUID-DE10334E-71AC-41E1-8AC2-075DEBE30775" class="sect2"><span class="enumeration_section">4.2</span> Runtime Prerequisites</h2>
<div>
<div class="section">
<p>In order to run the Flume Handler, a Flume Agent configured with an Avro or Thrift Flume source must be up and running. Oracle GoldenGate can be collocated with Flume or located on a different machine. If located on a different machine the host and port of the Flume source must be reachable via network connection. For instructions on how to configure and start a Flume Agent process, see the <span class="italic">Flume User Guide</span> at</p>
<p><a href="https://flume.apache.org/releases/content/1.6.0/FlumeUserGuide.pdf" target="_blank"><code>https://flume.apache.org/releases/content/1.6.0/FlumeUserGuide.pdf</code></a></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD424"></a>
<div class="props_rev_3"><a id="GUID-53081475-7487-48C8-A801-AC581ABA38EC"></a>
<h2 id="GADBD-GUID-53081475-7487-48C8-A801-AC581ABA38EC" class="sect2"><span class="enumeration_section">4.3</span> Classpath Configuration</h2>
<div>
<div class="section">
<p>You must configure two things in the <code>gg.classpathconfiguration</code> variable for the Flume Handler to connect to the Flume source and run. The first thing is the Flume Agent configuration file and the second are the Flume client jars. The Flume Handler uses the contents of the Flume Agent configuration file to resolve the host, port, and source type for the connection to Flume source. The Flume client libraries do <span class="italic">not</span> ship with Oracle GoldenGate for Big Data. The Flume client library versions must match the version of Flume to which the Flume Handler is connecting. For a listing for the required Flume client JAR files by version, see <a href="GUID-BD3A5EF2-2EBD-4BB0-BD34-6A62743A5D90.htm#GUID-BD3A5EF2-2EBD-4BB0-BD34-6A62743A5D90">Flume Handler Client Dependencies</a>.</p>
<p>The Oracle GoldenGate property, <code>gg.classpath</code>, needs to be set to include the following default locations:</p>
<ul style="list-style-type: disc;">
<li>
<p>The default location of the <code>core-site.xml</code> file is <span class="italic"><code>Flume_Home</code></span><code>/conf</code>.</p>
</li>
<li>
<p>The default location of the Flume client jars is <span class="italic"><code>Flume_Home</code></span><code>/lib/*</code>.</p>
</li>
</ul>
<p>The <code>gg.classpath</code> must be configured exactly as shown in the preceding example. Pathing to the Flume Agent configuration file should simply contain the path with no wild card appended. The inclusion of the <code>*wildcard</code> in the path to the Flume Agent configuration file will cause it not to be accessible. Conversely, pathing to the dependency jars should include the * wild card character in order to include all of the jar files in that directory in the associated classpath. Do not use <code>*.jar</code>. An example of a correctly configured <code>gg.classpath</code> variable is the following:</p>
<p><code>gg.classpath=dirprm/:/var/lib/flume/lib/*</code></p>
<p>If the Oracle GoldenGate for Big Data Flume Handler and Flume are not collocated, then the Flume Agent configuration file and the Flume client libraries will need to be copied to the machine hosting the Oracle GoldenGate for Big Data Flume Handler process.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD425"></a>
<div class="props_rev_3"><a id="GUID-4C4968F3-097B-4629-84C5-4E78807E21D7"></a>
<h2 id="GADBD-GUID-4C4968F3-097B-4629-84C5-4E78807E21D7" class="sect2"><span class="enumeration_section">4.4</span> Pluggable Formatters</h2>
<div>
<div class="section">
<p>The Oracle GoldenGate for Big Data Flume Handler supports all of the Big Data formatters included with the Oracle GoldenGate for Big Data release. The formatters are:</p>
<ul style="list-style-type: disc;">
<li>
<p>Avro Row</p>
</li>
<li>
<p>Avro Operation</p>
</li>
<li>
<p>JSON</p>
</li>
<li>
<p>XML</p>
</li>
<li>
<p>Delimited Text</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD426"></a>
<div class="props_rev_3"><a id="GUID-36456B87-E00C-4906-AD1C-44FD7923F6F6"></a>
<h2 id="GADBD-GUID-36456B87-E00C-4906-AD1C-44FD7923F6F6" class="sect2"><span class="enumeration_section">4.5</span> Flume Handler Configuration</h2>
<div>
<div class="section">
<p>The configuration properties for 12.2.0.1 Flume Handler are outlined as follows:</p>
</div>
<!-- class="section" -->
<div class="tblformalwide" id="GUID-36456B87-E00C-4906-AD1C-44FD7923F6F6__GUID-F5C16B6B-92D0-429B-9308-B71A995C3621">
<table class="cellalignment152" summary="Configuration elements">
<thead align="left">
<tr>
<th class="cellalignment153" id="d10474e257">Property Name</th>
<th class="cellalignment153" id="d10474e261">Property Value</th>
<th class="cellalignment154" id="d10474e265">Mandatory</th>
<th class="cellalignment155" id="d10474e269">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment153" id="d10474e275" headers="d10474e257">
<p><code>gg.handlerlist</code></p>
</td>
<td class="cellalignment153" headers="d10474e275 d10474e261">
<p><code>flumehandler</code> (choice of any name)</p>
</td>
<td class="cellalignment154" headers="d10474e275 d10474e265">
<p>Yes</p>
</td>
<td class="cellalignment155" headers="d10474e275 d10474e269">
<p>List of handlers. Only one is allowed with grouping properties <code>ON</code>.</p>
</td>
</tr>
<tr>
<td class="cellalignment153" id="d10474e294" headers="d10474e257">
<p><code>gg.handler.flumehandler.type</code></p>
</td>
<td class="cellalignment153" headers="d10474e294 d10474e261">
<p><code>flume</code></p>
</td>
<td class="cellalignment154" headers="d10474e294 d10474e265">
<p>Yes</p>
</td>
<td class="cellalignment155" headers="d10474e294 d10474e269">
<p>Type of handler to use.</p>
</td>
</tr>
<tr>
<td class="cellalignment153" id="d10474e309" headers="d10474e257">
<p><code>gg.handler.flumehandler.format</code></p>
</td>
<td class="cellalignment153" headers="d10474e309 d10474e261">
<p>Formatter class or short code</p>
</td>
<td class="cellalignment154" headers="d10474e309 d10474e265">
<p>No. Defaults to <code>delimitedtext</code></p>
</td>
<td class="cellalignment155" headers="d10474e309 d10474e269">
<p>The Formatter to be used. Can be one of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><code>avro_row</code></p>
</li>
<li>
<p><code>avro_op</code></p>
</li>
<li>
<p><code>delimitedtext</code></p>
</li>
<li>
<p><code>xml</code></p>
</li>
<li>
<p><code>json</code></p>
</li>
</ul>
<p>Alternatively, it is possible to write a custom formatter and include the fully qualified class name here.</p>
</td>
</tr>
<tr>
<td class="cellalignment153" id="d10474e348" headers="d10474e257">
<p><code>gg.handler.flumehandler.RpcClientPropertiesFile</code></p>
</td>
<td class="cellalignment153" headers="d10474e348 d10474e261">
<p>Any choice of filename</p>
</td>
<td class="cellalignment154" headers="d10474e348 d10474e265">
<p>No. Defaults to <code>default-flume-rpc.properties</code></p>
</td>
<td class="cellalignment155" headers="d10474e348 d10474e269">
<p>Either the default <code>default-flume-rpc.properties</code> or a specified custom RPC client properties file should exist in the classpath.</p>
</td>
</tr>
<tr>
<td class="cellalignment153" id="d10474e367" headers="d10474e257">
<p><code>gg.handler.flumehandler.mode</code></p>
</td>
<td class="cellalignment153" headers="d10474e367 d10474e261">
<p><code>op</code>|<code>tx</code></p>
</td>
<td class="cellalignment154" headers="d10474e367 d10474e265">
<p>No. Defaults to <code>op</code></p>
</td>
<td class="cellalignment155" headers="d10474e367 d10474e269">
<p>Operation mode or Transaction Mode. Java Adapter grouping options can be used only in tx mode.</p>
</td>
</tr>
<tr>
<td class="cellalignment153" id="d10474e387" headers="d10474e257">
<p><code>gg.handler.flumehandler.EventHeaderClass</code></p>
</td>
<td class="cellalignment153" headers="d10474e387 d10474e261">
<p>A custom implementation fully qualified class name</p>
</td>
<td class="cellalignment154" headers="d10474e387 d10474e265">
<p>No. Defaults to <code>DefaultFlumeEventHeader</code></p>
</td>
<td class="cellalignment155" headers="d10474e387 d10474e269">
<p>Class to be used which defines what headers properties are to be added to a flume event.</p>
</td>
</tr>
<tr>
<td class="cellalignment153" id="d10474e403" headers="d10474e257">
<p><code>gg.handler.flumehandler.EventMapsTo</code></p>
</td>
<td class="cellalignment153" headers="d10474e403 d10474e261">
<p><code>op</code>|<code>tx</code></p>
</td>
<td class="cellalignment154" headers="d10474e403 d10474e265">
<p>No. Defaults to <code>op</code></p>
</td>
<td class="cellalignment155" headers="d10474e403 d10474e269">
<p>Defines whether each flume event would represent an operation or a transaction. If <code>handler mode = op</code>, <code>EventMapsTo</code> will always be <code>op</code>.</p>
</td>
</tr>
<tr>
<td class="cellalignment153" id="d10474e432" headers="d10474e257">
<p><code>gg.handler.flumehandler.PropagateSchema</code></p>
</td>
<td class="cellalignment153" headers="d10474e432 d10474e261">
<p><code>true</code>|<code>false</code></p>
</td>
<td class="cellalignment154" headers="d10474e432 d10474e265">
<p>No. Defaults to <code>false</code></p>
</td>
<td class="cellalignment155" headers="d10474e432 d10474e269">
<p>When set to <code>true</code>, the Flume handler will begin to publish schema events.</p>
</td>
</tr>
<tr>
<td class="cellalignment153" id="d10474e455" headers="d10474e257">
<p><code>gg.handler.flumehandler.includeTokens</code></p>
</td>
<td class="cellalignment153" headers="d10474e455 d10474e261">
<p><code>true</code>|<code>false</code></p>
</td>
<td class="cellalignment154" headers="d10474e455 d10474e265">
<p>No. Defaults to <code>false</code></p>
</td>
<td class="cellalignment155" headers="d10474e455 d10474e269">
<p>When set to <code>true</code>, includes token data from the source trail files in the output. When set to <code>false</code> to excludes the token data from the source trail files in the output.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD427"></a>
<div class="props_rev_3"><a id="GUID-79F6A7A2-2EC3-4EE6-8721-606980C8BBD0"></a>
<h2 id="GADBD-GUID-79F6A7A2-2EC3-4EE6-8721-606980C8BBD0" class="sect2"><span class="enumeration_section">4.6</span> Sample Configuration</h2>
<div>
<div class="section">
<pre dir="ltr">
gg.handlerlist = flumehandler
gg.handler.flumehandler.type = flume
gg.handler.flumehandler.RpcClientPropertiesFile=custom-flume-rpc.properties
gg.handler.flumehandler.format =avro_op
gg.handler.flumehandler.mode =tx
gg.handler.flumehandler.EventMapsTo=tx
gg.handler.flumehandler.PropagateSchema =true
gg.handler.flumehandler.includeTokens=false
</pre>
<p>A sample Replicat configuration and a Java Adapter properties file for a Flume integration can be found at the following directory:</p>
<p><span class="italic"><code>GoldenGate_install_directory</code></span><code>/AdapterExamples/big-data/flume</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD428"></a>
<div class="props_rev_3"><a id="GUID-06757D87-A23A-4B11-A5DB-74A13912E504"></a>
<h2 id="GADBD-GUID-06757D87-A23A-4B11-A5DB-74A13912E504" class="sect2"><span class="enumeration_section">4.7</span> Troubleshooting</h2>
<div>
<div class="section"></div>
<!-- class="section" --></div>
<a id="GADBD429"></a>
<div class="props_rev_3"><a id="GUID-9E0B8569-DFF8-43E6-A4BD-40A1810F49FD"></a>
<h3 id="GADBD-GUID-9E0B8569-DFF8-43E6-A4BD-40A1810F49FD" class="sect3"><span class="enumeration_section">4.7.1</span> Java Classpath</h3>
<div>
<div class="section">
<p>Issues with the Java classpath are one of the most common problems. The indication of a classpath problem is a <code>ClassNotFoundException</code> in the Oracle GoldenGate Java <code>log4j</code> log file. The Java <code>log4j</code> log file can be used to troubleshoot this issue. Setting the log level to <code>DEBUG</code> allows for logging of each of the jars referenced in the <code>gg.classpath</code> object to be logged to the log file. In this way you can make sure that all of the required dependency jars are resolved.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD430"></a>
<div class="props_rev_3"><a id="GUID-398E5E2D-0252-4CF6-84A6-E4AEC1FBFC5A"></a>
<h3 id="GADBD-GUID-398E5E2D-0252-4CF6-84A6-E4AEC1FBFC5A" class="sect3"><span class="enumeration_section">4.7.2</span> Flume Flow Control Issues</h3>
<div>
<div class="section">
<p>The Flume Handler may in certain scenarios write to the Flume source faster than the Flume sink can dispatch messages. In the scenario, the Flume Handler will work for a while but once Flume can no longer accept messages it will abend. The cause in the Oracle GoldenGate Java log file will likely be an <code>EventDeliveryException</code> indicating the Flume Handler was unable to send an event. Check the Flume log to for the exact cause of the problem. You may be able to reconfigure the Flume channel to increase capacity or increase the configuration for Java heap if the Flume Agent is experiencing an <code>OutOfMemoryException</code>. However, this may not entirely solve the problem. If the Flume Handler can push data to the Flume source faster than messages are dispatched by the Flume sink, any change may simply extend the period the Oracle GoldenGate Handler can run before failing.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD431"></a>
<div class="props_rev_3"><a id="GUID-468A6170-5E35-4B2B-A994-B57CB8604497"></a>
<h3 id="GADBD-GUID-468A6170-5E35-4B2B-A994-B57CB8604497" class="sect3"><span class="enumeration_section">4.7.3</span> Flume Agent Configuration File Not Found</h3>
<div>
<div class="section">
<p>The Flume Handler will abend at start up if the Flume Agent configuration file is not in the classpath. The result is generally a <code>ConfigException</code> listing the issue as an error loading the Flume producer properties. Check the <code>gg.handler.{</code><span class="italic"><code>name</code></span>}. <code>RpcClientProperites</code> configuration file to ensure that the naming of the Flume Agent Properties file is correct. Check the GoldenGate <code>gg.classpath</code> properties to ensure that the classpath contains the directory containing the Flume Agent properties file. Also check the classpath to ensure that the path to the Flume Agent properties file does not end with a wildcard "*" character.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD432"></a>
<div class="props_rev_3"><a id="GUID-42118FC2-D7EF-48CA-ADC6-71A5627CF7F3"></a>
<h3 id="GADBD-GUID-42118FC2-D7EF-48CA-ADC6-71A5627CF7F3" class="sect3"><span class="enumeration_section">4.7.4</span> Flume Connection Exception</h3>
<div>
<div class="section">
<p>The Flume Handler will abend at start up if it is unable to make a connection to the Flume source. The root cause of this problem will likely be reported as an <code>IOExeption</code> in the Oracle GoldenGate Java <code>log4j</code> file indicating a problem connecting to Flume at a given host and port. Check the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>The Flume Agent process is running.</p>
</li>
<li>
<p>That the Flume agent configuration file that the Oracle for Big Data Flume Handler is accessing contains the correct host and port.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD433"></a>
<div class="props_rev_3"><a id="GUID-DD41EAC1-3408-4726-9D83-31E94871B3D2"></a>
<h3 id="GADBD-GUID-DD41EAC1-3408-4726-9D83-31E94871B3D2" class="sect3"><span class="enumeration_section">4.7.5</span> Other Failures</h3>
<div>
<div class="section">
<p>Review the contents of the Oracle GoldenGate Java <code>log4j</code> file.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="GADBD434"></a>
<div class="props_rev_3"><a id="GUID-6920E6D1-05E7-4CB7-86D1-6D7A3178FDEE"></a>
<h2 id="GADBD-GUID-6920E6D1-05E7-4CB7-86D1-6D7A3178FDEE" class="sect2"><span class="enumeration_section">4.8</span> Data Mapping of Operations to Flume Events</h2>
<div>
<div class="section">
<p>This section explains how operation data from the Oracle GoldenGate trail file is mapped by the Flume Handler into Flume Events based on different configurations. A Flume Event is a unit of data that flows through a Flume agent. The Event flows from Source to Channel to Sink, and is represented by an implementation of the Event interface. An Event carries a payload (byte array) that is accompanied by an optional set of headers (string attributes).</p>
</div>
<!-- class="section" --></div>
<a id="GADBD435"></a>
<div class="sect3"><a id="GUID-7275B200-2A8A-4A71-B92C-ADD2EA8A36D0"></a>
<h3 id="GADBD-GUID-7275B200-2A8A-4A71-B92C-ADD2EA8A36D0" class="sect3"><span class="enumeration_section">4.8.1</span> Operation Mode</h3>
<div>
<p>The configuration for the Flume Handler is the following in the Oracle GoldenGate Java configuration file.</p>
<pre dir="ltr">
gg.handler.{name}.mode=op
</pre>
<p>The data for each individual operation from Oracle GoldenGate trail file maps into a single Flume Event. Each event is immediately flushed to Flume. Each Flume Event will have the following headers.</p>
<ul style="list-style-type: disc;">
<li>
<p><code>TABLE_NAME:</code> The table name for the operation.</p>
</li>
<li>
<p><code>SCHEMA_NAME</code>: The catalog name (if available) and the schema name of the operation.</p>
</li>
<li>
<p><code>SCHEMA_HASH</code>: The hash code of the Avro schema. (Only applicable for Avro Row and Avro Operation formatters.)</p>
</li>
</ul>
</div>
</div>
<a id="GADBD436"></a>
<div class="sect3"><a id="GUID-6E3A28FD-BAC7-4FC6-97D8-D6484E08DA8F"></a>
<h3 id="GADBD-GUID-6E3A28FD-BAC7-4FC6-97D8-D6484E08DA8F" class="sect3"><span class="enumeration_section">4.8.2</span> Transaction Mode and <code>EventMapsTo</code> Operation</h3>
<div>
<p>The configuration for the Flume Handler is the following in the Oracle GoldenGate Java configuration file.</p>
<pre dir="ltr">
gg.handler.<span class="italic">flume_handler_name</span>.mode=tx
gg.handler.flume_handler_name.EventMapsTo=op
</pre>
<p>The data for each individual operation from Oracle GoldenGate trail file maps into a single Flume Event. Events are flushed to Flume at transaction commit. Each Flume Event will have the following headers.</p>
<ul style="list-style-type: disc;">
<li>
<p><code>TABLE_NAME</code>: The table name for the operation.</p>
</li>
<li>
<p><code>SCHEMA_NAME</code>: The catalog name (if available) and the schema name of the operation.</p>
</li>
<li>
<p><code>SCHEMA_HASH</code>: The hash code of the Avro schema. (Only applicable for Avro Row and Avro Operation formatters.)</p>
</li>
</ul>
<p>It is suggested to use this mode when formatting data as Avro or delimited text. It is important to understand that configuring Extract or Replicat batching functionality will increase the number of operations processed in a transaction.</p>
</div>
</div>
<a id="GADBD437"></a>
<div class="props_rev_3"><a id="GUID-D37812BF-4531-4128-AC1B-6BD4321F1B0E"></a>
<h3 id="GADBD-GUID-D37812BF-4531-4128-AC1B-6BD4321F1B0E" class="sect3"><span class="enumeration_section">4.8.3</span> Transaction Mode and <code>EventMapsTo</code> Transaction</h3>
<div>
<div class="section">
<p>The configuration for the Flume Handler is the following in the Oracle GoldenGate Java configuration file.</p>
<pre dir="ltr">
gg.handler.<span class="italic">flume_handler_name</span>.mode=tx
gg.handler.<span class="italic">flume_handler_name</span>.EventMapsTo=tx
</pre>
<p>The data for all operations for a transaction from the source trail file are concatenated and mapped into a single Flume Event. The event is flushed at transaction commit. Each Flume Event has the following headers.</p>
<ul style="list-style-type: disc;">
<li>
<p><code>GG_TRANID</code>: The transaction ID of the transaction</p>
</li>
<li>
<p><code>OP_COUNT</code>: The number of operations contained in this Flume payload event</p>
</li>
</ul>
<p>It is suggested to use this mode only when using self describing formats such as JSON or XML. In is important to understand that configuring Extract or Replicat batching functionality will increase the number of operations processed in a transaction.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="GADBD438"></a>
<div class="props_rev_3"><a id="GUID-84432ABF-EA8C-419A-AAAF-090C21A225FA"></a>
<h2 id="GADBD-GUID-84432ABF-EA8C-419A-AAAF-090C21A225FA" class="sect2"><span class="enumeration_section">4.9</span> Flume Handler Certification Matrix</h2>
<div>
<div class="section">
<p>The Oracle GoldenGate for Big Data Flume Handler works with versions 1.6.x, 1.5.x and 1.4.x of Apache Flume. Compatibility with versions of Flume before 1.4.0 is not guaranteed.</p>
<p>The Flume Handler is compatible with the following versions of the Hortonworks Data Platform (HDP):</p>
<ul style="list-style-type: disc;">
<li>
<p>HDP 2.4 (Flume 1.5.2)</p>
</li>
<li>
<p>HDP 2.3 (Flume 1.5.2)</p>
</li>
<li>
<p>HDP 2.2 (Flume 1.5.2)</p>
</li>
<li>
<p>HDP 2.1 (Flume 1.4.0)</p>
</li>
</ul>
<p>The Flume Handler is compatible with the following versions of the Cloudera Distributions of Hadoop (CDH):</p>
<ul style="list-style-type: disc;">
<li>
<p>CDH 5.7.<span class="italic">x</span> (Flume 1.6.0)</p>
</li>
<li>
<p>CDH 5.6.<span class="italic">x</span> (Flume 1.6.0)</p>
</li>
<li>
<p>CDH 5.5.<span class="italic">x</span> (Flume 1.6.0)</p>
</li>
<li>
<p>CDH 5.4.<span class="italic">x</span> (Flume 1.5.0)</p>
</li>
<li>
<p>CDH 5.3.<span class="italic">x</span> (Flume 1.5.0)</p>
</li>
<li>
<p>CDH 5.2.<span class="italic">x</span> (Flume 1.5.0)</p>
</li>
<li>
<p>CDH 5.1.<span class="italic">x</span> (Flume 1.5.0)</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD439"></a>
<div class="props_rev_3"><a id="GUID-02D2F46C-D31A-46C5-8536-FEA9101113F3"></a>
<h2 id="GADBD-GUID-02D2F46C-D31A-46C5-8536-FEA9101113F3" class="sect2"><span class="enumeration_section">4.10</span> Performance Considerations</h2>
<div>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Replicat based grouping is recommended to be used to improve performance.</p>
</li>
<li>
<p>Extract based grouping uses the grouping in the Java Adapter. Message size based grouping with Java Adapter may be slower than operation count based grouping. If Adapter based grouping is really needed, operation count based grouping is recommended.</p>
</li>
<li>
<p>Transaction mode with <code>gg.handler.</code><span class="italic"><code>flume_handler_name</code></span>. <code>EventMapsTo=tx</code> setting is recommended for best performance.</p>
</li>
<li>
<p>The maximum heap size of the Flume Handler may affect performance. Too little heap may results in frequent garbage collections by the JVM. Increasing the maximum heap size of the JVM in the Oracle GoldenGate Java properties file may improve performance.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD440"></a>
<div class="props_rev_3"><a id="GUID-5BA29358-EE61-475D-926E-89CB195F43FB"></a>
<h2 id="GADBD-GUID-5BA29358-EE61-475D-926E-89CB195F43FB" class="sect2"><span class="enumeration_section">4.11</span> Metadata Change Events</h2>
<div>
<div class="section">
<p>The Oracle GoldenGate for Big Data 12.2.0.1 Flume Handler is adaptive to changes in DDL at the source. However, this functionality depends on the source replicated database and the upstream Oracle GoldenGate Capture process to capture and replicate DDL events. This feature is not immediately available for all database implementations in Oracle GoldenGate 12.2. Refer to the Oracle GoldenGate documentation for your database implementation for information about DDL replication.</p>
<p>Whenever a metadata change occurs at the source, the flume handler will notify the associated formatter of the metadata change event. Any cached schema that the formatter is holding for that table will be deleted. The next time the associated formatter encounters an operation for that table the schema will be regenerated.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD441"></a>
<div class="props_rev_3"><a id="GUID-28C37117-3746-431A-AE25-04E54ACBA31B"></a>
<h2 id="GADBD-GUID-28C37117-3746-431A-AE25-04E54ACBA31B" class="sect2"><span class="enumeration_section">4.12</span> Example Flume Source Configuration</h2>
<div>
<div class="section"></div>
<!-- class="section" --></div>
<a id="GADBD442"></a>
<div class="sect3"><a id="GUID-A57176E8-7C30-4B62-97B5-5DABDE0DC265"></a>
<h3 id="GADBD-GUID-A57176E8-7C30-4B62-97B5-5DABDE0DC265" class="sect3"><span class="enumeration_section">4.12.1</span> Avro Flume Source</h3>
<div>
<div class="section">
<p>The following is sample configuration for an Avro Flume source from the Flume Agent configuration file:</p>
<pre dir="ltr">
client.type = default
hosts = h1
hosts.h1 = host_ip:host_port
batch-size = 100
connect-timeout = 20000
request-timeout = 20000
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD443"></a>
<div class="props_rev_3"><a id="GUID-8DE4F297-614B-445C-A319-093D3A29F118"></a>
<h3 id="GADBD-GUID-8DE4F297-614B-445C-A319-093D3A29F118" class="sect3"><span class="enumeration_section">4.12.2</span> Thrift Flume Source</h3>
<div>
<div class="section">
<p>The following is sample configuration for an Avro Flume source from the Flume Agent configuration file:</p>
<pre dir="ltr">
client.type = thrift
hosts = h1
hosts.h1 = host_ip:host_port
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="GADBD444"></a>
<div class="props_rev_3"><a id="GUID-DD59F911-5BA1-4C1C-845C-29BD6E0E1693"></a>
<h2 id="GADBD-GUID-DD59F911-5BA1-4C1C-845C-29BD6E0E1693" class="sect2"><span class="enumeration_section">4.13</span> Advanced Features</h2>
<div>
<div class="section"></div>
<!-- class="section" --></div>
<a id="GADBD445"></a>
<div class="props_rev_3"><a id="GUID-230516C3-5C7E-40C6-B2EE-BC8A8574F266"></a>
<h3 id="GADBD-GUID-230516C3-5C7E-40C6-B2EE-BC8A8574F266" class="sect3"><span class="enumeration_section">4.13.1</span> Schema Propagation</h3>
<div>
<div class="section">
<p>The Flume Handler can propagate schemas to Flume. This is currently only supported for the Avro Row and Operation formatters. To enable this feature set the following property:</p>
<pre dir="ltr">
gg.handler.<span class="italic">flume_handler_name</span>.propagateSchema=true
</pre>
<p>The Avro Row or Operation Formatters generate Avro schemas on a just in time basis. Avro schemas are generated the first time an operation for a table is encountered. A metadata change event results in the schema reference being for a table being cleared and thereby a new schema is generated the next time an operation is encountered for that table.</p>
<p>When schema propagation is enabled the Flume Handler will propagate schemas an Avro Event when they are encountered.</p>
<p>Default Flume Schema Event headers for Avro include the following information:</p>
<ul style="list-style-type: disc;">
<li>
<p><code>SCHEMA_EVENT</code>: TRUE</p>
</li>
<li>
<p><code>GENERIC_WRAPPER</code>: TRUE/FALSE</p>
</li>
<li>
<p><code>TABLE_NAME</code>: The table name as seen in the trail</p>
</li>
<li>
<p><code>SCHEMA_NAME</code>: The catalog name (if available) and the schema name</p>
</li>
<li>
<p><code>SCHEMA_HASH</code>: The hash code of the Avro schema</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD446"></a>
<div class="props_rev_3"><a id="GUID-24028618-D5D5-4AD3-80C2-7E15B5A8A5A2"></a>
<h3 id="GADBD-GUID-24028618-D5D5-4AD3-80C2-7E15B5A8A5A2" class="sect3"><span class="enumeration_section">4.13.2</span> Security</h3>
<div>
<div class="section">
<p>Kerberos authentication for the Oracle GoldenGate for Big Data Flume Handler connection to the Flume source is possible, but this feature is only supported in Flume 1.6.0 (and assumed higher) using the Thrift Flume source. This feature is enabled solely by changing the configuration of the Flume source in the Flume Agent configuration file. Following is an example of the Flume source configuration from the Flume Agent configuration file showing how to enable Kerberos authentication. The Kerberos principal name of the client and the server need to be provided. The path to a Kerberos keytab file must be provided so that the password of the client principal can be resolved at runtime. For information on how to administrate Kerberos, Kerberos principals and their associated passwords, and the creation of a Kerberos keytab file, refer to the Kerberos documentation.</p>
<pre dir="ltr">
client.type = thrift
hosts = h1
hosts.h1 =host_ip:host_port
kerberos=true
client-principal=flumeclient/client.example.org@EXAMPLE.ORG
client-keytab=/tmp/flumeclient.keytab
server-principal=flume/server.example.org@EXAMPLE.ORG
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD447"></a>
<div class="props_rev_3"><a id="GUID-19344CBF-30AB-433A-A4EA-49A0DEB4EB30"></a>
<h3 id="GADBD-GUID-19344CBF-30AB-433A-A4EA-49A0DEB4EB30" class="sect3"><span class="enumeration_section">4.13.3</span> Fail Over Functionality</h3>
<div>
<div class="section">
<p>It is possible to configure the Flume Handler so that it will fail over in the event that the primary Flume source becomes unavailable. This feature is currently only supported in Flume 1.6.0 (and assumed higher) using the Avro Flume source. This feature is enabled solely with Flume source configuration in the Flume Agent configuration file. The following is sample configuration for enabling fail over functionality:</p>
<pre dir="ltr">
client.type=default_failover
hosts=h1 h2 h3
hosts.h1=host_ip1:host_port1
hosts.h2=host_ip2:host_port2
hosts.h3=host_ip3:host_port3
max-attempts = 3
batch-size = 100
connect-timeout = 20000
request-timeout = 20000
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD448"></a>
<div class="props_rev_3"><a id="GUID-A440852A-A32F-4C7A-8B12-8D5D5DA3A6B4"></a>
<h3 id="GADBD-GUID-A440852A-A32F-4C7A-8B12-8D5D5DA3A6B4" class="sect3"><span class="enumeration_section">4.13.4</span> Load Balancing Functionality</h3>
<div>
<div class="section">
<p>It is possible to configure the Oracle GoldenGate for Big Data Flume Handler so that produced Flume events will be load balanced across multiple Flume sources. This feature is currently only supported in Flume 1.6.0 (and assumed higher) using the Avro Flume source. This feature is enabled solely with Flume source configuration in the Flume Agent configuration file. The following is sample configuration for enabling load balancing functionality:</p>
<pre dir="ltr">
client.type = default_loadbalance
hosts = h1 h2 h3
hosts.h1 = host_ip1:host_port1
hosts.h2 = host_ip2:host_port2
hosts.h3 = host_ip3:host_port3
backoff = false
maxBackoff = 0
host-selector = round_robin
batch-size = 100
connect-timeout = 20000
request-timeout = 20000
</pre></div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment135">
<tr>
<td class="cellalignment142">
<table class="cellalignment140">
<tr>
<td class="cellalignment139"><a href="GUID-3EC975E2-1F9A-4AB3-B3F6-7B4ADFEED390.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment139"><a href="GUID-2561CA12-9BAC-454B-A2E3-2D36C5C60EE5.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2015, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment144">
<table class="cellalignment138">
<tr>
<td class="cellalignment139"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment139"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
