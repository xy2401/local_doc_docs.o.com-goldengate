<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Using the Metadata Provider</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2016-06-08T07:49:17Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Fusion Middleware Integrating Oracle GoldenGate for Big Data" />
<meta name="dcterms.identifier" content="E65148-03" />
<meta name="dcterms.isVersionOf" content="GADBD" />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm" title="Previous" type="text/html" />
<link rel="Next" href="GUID-B68DF414-3FE0-4C0D-B13B-BC9A024DABD5.htm" title="Next" type="text/html" />
<link rel="alternate" href="E65148-03.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="E65148-03.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="E65148-03.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Skip Headers</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr"><a id="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65"></a> <span id="PAGE" style="display:none;">10/15</span> <!-- End Header --><a id="GADBD570"></a><a id="GADBD569"></a>
<h1 id="GADBD-GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65" class="sect1"><span class="enumeration_chapter">7</span> Using the Metadata Provider</h1>
<div>
<p>This chapter explains the Metadata Provider functionality, different types of Metadata Providers and examples that can be used to understand the functionality.</p>
<p>This chapter contains the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-737CF013-FC71-4D10-8F03-709A6D86096F">Avro Metadata Provider</a></p>
</li>
<li>
<p><a href="GUID-B68DF414-3FE0-4C0D-B13B-BC9A024DABD5.htm#GUID-B68DF414-3FE0-4C0D-B13B-BC9A024DABD5">Hive Metadata Provider</a></p>
</li>
</ul>
<p>Valid only if handlers are configured to run with Replicat process.</p>
<p>The Replicat process provides functionality to perform source table to target table and source column to target column mapping using syntax in the Replicat configuration file. This mapping syntax is documented as part of the Oracle GoldenGate Replicat documentation. The source metadata definitions are included in the Oracle GoldenGate trail file (or by source definitions files for Oracle GoldenGate versions older than 12.2). When the replication target is a database, the Replicat process obtains the target metadata definitions from the target database. However, this is a shortcoming when pushing data to Big Data applications or Java Delivery in general. Big Data applications generally provide no target metadata therefore the Replicat mapping is not possible. The Metadata Provider exists to address this deficiency. The Metadata Provider can be used to define target metadata using either Avro or Hive which in turn enables source table to target table and source column to target column Replicat mapping. The use of the Metadata Provider is not required. If the metadata included in the source Oracle GoldenGate trail file is acceptable for the output, then do not use the Metadata Provider. The Metadata Provider should be used in the following cases:</p>
<ul style="list-style-type: disc;">
<li>
<p>The requirement is for mapping source table names into target table names that do not match.</p>
</li>
<li>
<p>The requirement is for mapping of source column names into target column name that do not match.</p>
</li>
<li>
<p>The requirement is for the inclusion of certain columns from the source trail file and omitting other columns.</p>
</li>
</ul>
<p>Replicat mapping has a general limitation in that the mapping defined in the Replicat configuration file is static. Oracle GoldenGate 12.2 provides functionality for DDL propagation when using an Oracle Database as the source. Therefore the proper handling of schema evolution can be problematic when the Metadata Provider and Replicat mapping are being used. Users will need to consider their particular use cases for schema evolution and plan for how they will update the Metadata Provider and the Replicat mapping syntax for required changes.</p>
<p>For every table mapped in <code>REPLICAT</code> using <code>COLMAP</code>, the metadata will be retrieved from a configured metadata provider and retrieved metadata will then be used by <code>REPLICAT</code> for column mapping functionality.</p>
<p>Users have the choice of configuring one Metadata Provider implementation. Currently Hive and Avro Metadata Providers are supported. Details on configuring Hive and Avro Metadata Providers will be discussed in the following sections.</p>
<p>The Metadata Provider is optional and is enabled if the <code>gg.mdp.type</code> property is specified in the Java Adapter Properties file.</p>
<div class="section">
<p class="subhead1">Scenarios - When to use Metadata Provider</p>
</div>
<!-- class="section" -->
<ol>
<li>
<p>The following scenarios do <span class="italic">not</span> require the Metadata Provider to be configured:</p>
<p>The mapping of schema name whereby the source schema named <code>GG</code> is mapped to the target schema named <code>GGADP</code>.*</p>
<p>The mapping of schema and table name whereby the schema <code>GG.TCUSTMER</code> is mapped to the table name <code>GGADP.TCUSTMER_NEW</code></p>
<pre dir="ltr">
MAP GG.*, TARGET GGADP.*;
(OR)
MAP GG.TCUSTMER, TARGET GG_ADP.TCUSTMER_NEW;
</pre></li>
<li>
<p>The following scenario requires Metadata Provider to be configured:</p>
<p>The mapping of column names whereby the source column name does not match the target column name. For example source column <code>CUST_CODE</code> mapped to target column <code>CUST_CODE_NEW</code></p>
<pre dir="ltr">
MAP <span class="italic">GG.TCUSTMER</span>, TARGET GG_ADP.TCUSTMER_NEW, COLMAP(USEDEFAULTS, CUST_CODE_NEW=CUST_CODE, CITY2=CITY);
</pre></li>
</ol>
</div>
<a id="GADBD571"></a>
<div class="props_rev_3"><a id="GUID-737CF013-FC71-4D10-8F03-709A6D86096F"></a>
<h2 id="GADBD-GUID-737CF013-FC71-4D10-8F03-709A6D86096F" class="sect2"><span class="enumeration_section">7.1</span> Avro Metadata Provider</h2>
<div>
<p>The Avro Metadata Provider is used to retrieve the table metadata from Avro Schema files. For every table mapped in <code>REPLICAT</code> using <code>COLMAP</code>, the metadata will be retrieved from Avro Schema and retrieved metadata will then be used by <code>REPLICAT</code> for column mapping.</p>
<p>This section contains the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-3DDEF373-5995-464A-9D40-43614D55F59D">Detailed Functionality</a></p>
</li>
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-0BBA0061-FF79-4891-B17D-3092DA4B275C">Runtime Prerequisites</a></p>
</li>
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-6DB2B303-636D-4B10-A075-D4A2FA624711">Classpath Configuration</a></p>
</li>
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B">Avro Metadata Provider Configuration</a></p>
</li>
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-BCFE0447-C562-4BDC-814B-58BB2928DBA0">Sample Configuration</a></p>
</li>
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-2B8DD4B9-CA20-41DA-BDA0-1E0F921E8B64">Metadata Change Event</a></p>
</li>
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-97F91AE5-1461-41AC-98B6-50890313AC19">Limitations</a></p>
</li>
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-2EE6F213-BB7B-4D02-9FD3-BD84084C8CD9">Troubleshooting</a></p>
</li>
</ul>
</div>
<a id="GADBD573"></a><a id="GADBD574"></a><a id="GADBD572"></a>
<div class="props_rev_3"><a id="GUID-3DDEF373-5995-464A-9D40-43614D55F59D"></a>
<h3 id="GADBD-GUID-3DDEF373-5995-464A-9D40-43614D55F59D" class="sect3"><span class="enumeration_section">7.1.1</span> Detailed Functionality</h3>
<div>
<div class="section">
<p>The Avro Metadata Provider uses Avro schema definition files to retrieve metadata. The Avro schemas are defined using the <code>JSON</code>. For each table mapped in <code>Replicat.prm</code> file, a corresponding The Avro schema definition file should be created. More information on defining Avro schemas can be found at:</p>
<p><a href="http://avro.apache.org/docs/current/gettingstartedjava.html#Defining+a+schema" target="_blank"><code>http://avro.apache.org/docs/current/gettingstartedjava.html#Defining+a+schema</code></a></p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Avro Metadata Provider Schema definition syntax:</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">
{"namespace": "[$catalogname.]$schemaname",
"type": "record",
"name": "$tablename",
"fields": [
     {"name": "$col1", "type": "$datatype"},
     {"name": "$col2 ",  "type": "$datatype ", "primary_key":true}, 
     {"name": "$col3", "type": "$datatype ", "primary_key":true}, 
     {"name": "$col4", "type": ["$datatype","null"]}   
   ]
}
 
namespace            - name of catalog/schema being mapped
name                 - name of the table being mapped
fields.name          - array of column names
fields.type          - datatype of the column
fields.primary_key   - indicates the column is part of primary key.

Representing nullable and not nullable columns:

"type":"$datatype" - indicates the column is not nullable, where "$datatype" is the actual datatype.
"type": ["$datatype","null"] - indicates the column is nullable, where "$datatype" is the actual datatype
</pre>
<p>The file naming convention for Avro schema files accessed by the Avro Metadata Provider must be in the following format:</p>
<pre dir="ltr">
[$catalogname.]$schemaname.$tablename.mdp.avsc
 
$catalogname    - name of the catalog if exists
$schemaname   - name of the schema
$tablename        - name of the table
.mdp.avsc           -  constant, which should be appended always
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Supported Avro Data Types:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>boolean</p>
</li>
<li>
<p>bytes</p>
</li>
<li>
<p>double</p>
</li>
<li>
<p>float</p>
</li>
<li>
<p>int</p>
</li>
<li>
<p>long</p>
</li>
<li>
<p>string</p>
</li>
</ul>
<p>For more information on Avro data types, see <a href="https://avro.apache.org/docs/1.7.5/spec.html#schema_primitive" target="_blank"><code>https://avro.apache.org/docs/1.7.5/spec.html#schema_primitive</code></a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD575"></a>
<div class="props_rev_3"><a id="GUID-0BBA0061-FF79-4891-B17D-3092DA4B275C"></a>
<h3 id="GADBD-GUID-0BBA0061-FF79-4891-B17D-3092DA4B275C" class="sect3"><span class="enumeration_section">7.1.2</span> Runtime Prerequisites</h3>
<div>
<div class="section">
<p>The Avro schema definitions should be created for all tables mapped in Replicat's parameter file before starting the Replicat process.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD576"></a>
<div class="props_rev_3"><a id="GUID-6DB2B303-636D-4B10-A075-D4A2FA624711"></a>
<h3 id="GADBD-GUID-6DB2B303-636D-4B10-A075-D4A2FA624711" class="sect3"><span class="enumeration_section">7.1.3</span> Classpath Configuration</h3>
<div>
<div class="section">
<p>There is no additional classpath setting required for Avro Metadata Provider.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD577"></a>
<div class="props_rev_3"><a id="GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B"></a>
<h3 id="GADBD-GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B" class="sect3"><span class="enumeration_section">7.1.4</span> Avro Metadata Provider Configuration</h3>
<div>
<div class="section">
<p>The configuration properties of Oracle GoldenGate Avro Metadata Provider are detailed in this section</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-4F13F8EC-F5D4-4DC1-AE71-DBE280B7BF0B__GUID-8322C613-8A8E-4014-B559-6D08AB2F0F88">
<hr />
<table class="cellalignment145" summary="metadata-1">
<thead align="left">
<tr>
<th class="cellalignment150" id="d28279e311">Property</th>
<th class="cellalignment151" id="d28279e315">Required/Optional</th>
<th class="cellalignment146" id="d28279e322">Legal Values</th>
<th class="cellalignment150" id="d28279e326">Default</th>
<th class="cellalignment146" id="d28279e330">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="cellalignment150" id="d28279e336" headers="d28279e311">
<p><code>gg.mdp.type</code></p>
</td>
<td class="cellalignment151" headers="d28279e336 d28279e315">
<p>Required</p>
</td>
<td class="cellalignment146" headers="d28279e336 d28279e322">
<p><code>avro</code></p>
</td>
<td class="cellalignment150" headers="d28279e336 d28279e326">
<p>-</p>
</td>
<td class="cellalignment146" headers="d28279e336 d28279e330">
<p>Selects Avro Metadata Provider</p>
</td>
</tr>
<tr>
<td class="cellalignment150" id="d28279e354" headers="d28279e311">
<p><code>gg.mdp.schemaFilesPath</code></p>
</td>
<td class="cellalignment151" headers="d28279e354 d28279e315">
<p>Required</p>
</td>
<td class="cellalignment146" headers="d28279e354 d28279e322">
<p>Example for a legal value could be <code>/home/user/ggadp/avroschema/</code></p>
</td>
<td class="cellalignment150" headers="d28279e354 d28279e326">
<p>-</p>
</td>
<td class="cellalignment146" headers="d28279e354 d28279e330">
<p>Path to Avro schema files directory</p>
</td>
</tr>
<tr>
<td class="cellalignment150" id="d28279e373" headers="d28279e311">
<p><code>gg.mdp.charset</code></p>
</td>
<td class="cellalignment151" headers="d28279e373 d28279e315">
<p>Optional</p>
</td>
<td class="cellalignment146" headers="d28279e373 d28279e322">
<p>Valid character set</p>
</td>
<td class="cellalignment150" headers="d28279e373 d28279e326">
<p>UTF-8</p>
</td>
<td class="cellalignment146" headers="d28279e373 d28279e330">
<p>Specifies the character set of the column with character data type. This is used to convert the source data from trail file to the correct target charset.</p>
</td>
</tr>
<tr>
<td class="cellalignment150" id="d28279e390" headers="d28279e311">
<p><code>gg.mdp.nationalCharse</code><code>t</code></p>
</td>
<td class="cellalignment151" headers="d28279e390 d28279e315">
<p>Optional</p>
</td>
<td class="cellalignment146" headers="d28279e390 d28279e322">
<p>Valid character set</p>
</td>
<td class="cellalignment150" headers="d28279e390 d28279e326">
<p>UTF-8</p>
</td>
<td class="cellalignment146" headers="d28279e390 d28279e330">
<p>Specifies the character set of the column with character data type. This is used to convert the source data from trail file to the correct target charset.</p>
<p>Example: Indicates character set of columns like <code>NCHAR</code>, <code>NVARCHAR</code> in case of Oracle Database.</p>
</td>
</tr>
</tbody>
</table>
<hr /></div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="GADBD578"></a>
<div class="props_rev_3"><a id="GUID-BCFE0447-C562-4BDC-814B-58BB2928DBA0"></a>
<h3 id="GADBD-GUID-BCFE0447-C562-4BDC-814B-58BB2928DBA0" class="sect3"><span class="enumeration_section">7.1.5</span> Sample Configuration</h3>
<div>
<div class="section">
<p>This section provides an example for configuring the Avro Metadata Provider. Consider a source with following table:</p>
<pre dir="ltr">
TABLE GG.TCUSTMER {
     CUST_CODE VARCHAR(4) PRIMARY KEY,
     NAME VARCHAR(100),
     CITY VARCHAR(200),
     STATE VARCHAR(200)
}
</pre>
<p>Map column <code>CUST_CODE (GG.TCUSTMER)</code> in source to <code>CUST_CODE2 (GG_AVRO.TCUSTMER_AVRO)</code> on target and column <code>CITY</code> <code>(GG.TCUSTMER)</code> in source to <code>CITY2</code> <code>(GG_AVRO.TCUSTMER_AVRO)</code> on target.</p>
<p>Mapping in <code>Replicat .prm</code> file:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, CUST_CODE2=CUST_CODE, CITY2=CITY);
 
Mapping definition in this example:
1.Source schema GG is mapped to target schema GG_AVRO
2.Source column CUST_CODE is mapped to target column CUST_CODE2
3.Source column CITY is mapped to target column CITY2
4.USEDEFAULTS specifies that rest of the columns names are same on both source and target (NAME and STATE columns).
</pre>
<p>The Avro schema definition file for the preceding example:</p>
<p><span class="bold">File path</span>: <code>/home/ggadp/avromdpGG_AVRO.TCUSTMER_AVRO.mdp.avsc</code></p>
<pre dir="ltr">
{"namespace": "GG_AVRO",
"type": "record",
"name": "TCUSTMER_AVRO",
"fields": [
     {"name": "NAME", "type": "string"},
    {"name": "CUST_CODE2",  "type": "string", "primary_key":true},
     {"name": "CITY2", "type": "string"},
     {"name": "STATE", "type": ["string","null"]}
]
}
</pre>
<p>The configuration in the Java Adapter Properties file will include the following:</p>
<pre dir="ltr">
gg.mdp.type = avro
gg.mdp.schemaFilesPath = /home/ggadp/avromdp
</pre>
<p>Following is the sample output using delimited text formatter with "<code>;</code>" as delimiter for the preceding example.</p>
<pre dir="ltr">
I;GG_AVRO.TCUSTMER_AVRO;2013-06-02 22:14:36.000000;NAME;BG SOFTWARE CO;CUST_CODE2;WILL;CITY2;SEATTLE;STATE;WA
</pre>
<p>The Oracle GoldenGate for Big Data installation include a sample Replicat configuration file, a sample Java Adapter properties file, and sample Avro schemas at:</p>
<p><span class="italic"><code>GoldenGate_install_directory</code></span><code>/AdapterExamples/big-data/metadata_provider/avro</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD579"></a>
<div class="props_rev_3"><a id="GUID-2B8DD4B9-CA20-41DA-BDA0-1E0F921E8B64"></a>
<h3 id="GADBD-GUID-2B8DD4B9-CA20-41DA-BDA0-1E0F921E8B64" class="sect3"><span class="enumeration_section">7.1.6</span> Metadata Change Event</h3>
<div>
<div class="section">
<p>The Avro schema definitions and the mappings in the Replicat configuration file may need to be modified if there is a DDL change in the source database tables. You may wish to abort or suspend the Replicat process in the case of a metadata change event. The Replicat process can be aborted by adding the following to the Replicat configuration file (<code>.prm file</code>).</p>
<p><code>DDL INCLUDE ALL, EVENTACTIONS (ABORT)</code></p>
<p>Alternatively, the Replicat process can be suspended by adding the following to the Replication configuration file (<code>.prm file)</code>.</p>
<p><code>DDL INCLUDE ALL, EVENTACTIONS (SUSPEND)</code></p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD580"></a>
<div class="props_rev_3"><a id="GUID-97F91AE5-1461-41AC-98B6-50890313AC19"></a>
<h3 id="GADBD-GUID-97F91AE5-1461-41AC-98B6-50890313AC19" class="sect3"><span class="enumeration_section">7.1.7</span> Limitations</h3>
<div>
<div class="section">
<p>Avro bytes data type cannot be used as primary key.</p>
<p>The source to target mapping defined in the Replicat configuration file is static. Oracle GoldenGate 12.2 supports DDL propagation and source schema evolution for Oracle Databases as the replication source. However, evolution of the source schemas may be problematic the static mapping configured in the Replicat configuration file.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="GADBD581"></a>
<div class="props_rev_3"><a id="GUID-2EE6F213-BB7B-4D02-9FD3-BD84084C8CD9"></a>
<h3 id="GADBD-GUID-2EE6F213-BB7B-4D02-9FD3-BD84084C8CD9" class="sect3"><span class="enumeration_section">7.1.8</span> Troubleshooting</h3>
<div>
<p>This section contains the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-91CF5CB4-627F-4E56-AF3C-BB72750B753E">Invalid Schema Files Location</a></p>
</li>
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-9854F8C8-44C0-4F16-B3C0-54E5D32BCFD9">Invalid Schema File Name</a></p>
</li>
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-9893F974-4F15-443A-BFBA-23CC5BCEA237">Invalid Namespace in Schema File</a></p>
</li>
<li>
<p><a href="GUID-F90702A9-0FFB-42D2-9261-89E2BB952C65.htm#GUID-AAA0ADE9-1BC0-4C7D-A0A4-6F42A08684E4">Invalid Table Name in Schema File</a></p>
</li>
</ul>
</div>
<a id="GADBD582"></a>
<div class="props_rev_3"><a id="GUID-91CF5CB4-627F-4E56-AF3C-BB72750B753E"></a>
<h4 id="GADBD-GUID-91CF5CB4-627F-4E56-AF3C-BB72750B753E" class="sect4"><span class="enumeration_section">7.1.8.1</span> Invalid Schema Files Location</h4>
<div>
<div class="section">
<p>The Avro schema files directory location specified by the configuration property <code>gg.mdp.schemaFilesPath</code> should be a valid directory. Failure to configure a valid directory in <code>gg.mdp.schemaFilesPath</code> property leads to following exception:</p>
<pre dir="ltr">
oracle.goldengate.util.ConfigException: Error initializing Avro metadata provider
Specified schema location does not exist. {/path/to/schema/files/dir}
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD583"></a>
<div class="props_rev_3"><a id="GUID-9854F8C8-44C0-4F16-B3C0-54E5D32BCFD9"></a>
<h4 id="GADBD-GUID-9854F8C8-44C0-4F16-B3C0-54E5D32BCFD9" class="sect4"><span class="enumeration_section">7.1.8.2</span> Invalid Schema File Name</h4>
<div>
<div class="section">
<p>For every table mapped in <code>Replicat.prm</code> file, a corresponding Avro schema file must be created in the directory specified in <code>gg.mdp.schemaFilesPath</code>.</p>
<p>For example, consider the following scenario:</p>
<p><span class="bold">Mapping</span>:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, cust_code2=cust_code, CITY2 = CITY);
 
</pre>
<p><span class="bold">Property</span>:</p>
<pre dir="ltr">
gg.mdp.schemaFilesPath=/home/usr/avro/
</pre>
<p>A file called <code>GG_AVRO.TCUSTMER_AVRO.mdp.avsc</code> must be created in the <code>/home/usr/avro/</code> directory. that is, <code>/home/usr/avro/GG_AVRO.TCUSTMER_AVRO.mdp.avsc</code></p>
<p>Failing to create the <code>/home/usr/avro/GG_AVRO.TCUSTMER_AVRO.mdp.avsc</code> file results in the following exception:</p>
<pre dir="ltr">
java.io.FileNotFoundException: /home/usr/avro/GG_AVRO.TCUSTMER_AVRO.mdp.avsc
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD584"></a>
<div class="props_rev_3"><a id="GUID-9893F974-4F15-443A-BFBA-23CC5BCEA237"></a>
<h4 id="GADBD-GUID-9893F974-4F15-443A-BFBA-23CC5BCEA237" class="sect4"><span class="enumeration_section">7.1.8.3</span> Invalid Namespace in Schema File</h4>
<div>
<div class="section">
<p>The target schema name specified in <code>REPLICAT</code> mapping must be same as namespace in the Avro schema definition file.</p>
<p>For example, consider the following scenario:</p>
<p><span class="bold">Mapping</span>:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, cust_code2 = cust_code, CITY2 = CITY);
 
Avro Schema Definition:
 
{
"namespace": "GG_AVRO",
..
}
</pre>
<p>In this scenario, <code>REPLICAT</code> abends with following exception if the target schema name specified in Replicat mapping does not match with Avro schema namespace:</p>
<pre dir="ltr">
Unable to retrieve table matadata. Table : GG_AVRO.TCUSTMER_AVRO
Mapped [catalogname.]schemaname (GG_AVRO) does not match with the schema namespace {schema namespace}
</pre></div>
<!-- class="section" --></div>
</div>
<a id="GADBD585"></a>
<div class="props_rev_3"><a id="GUID-AAA0ADE9-1BC0-4C7D-A0A4-6F42A08684E4"></a>
<h4 id="GADBD-GUID-AAA0ADE9-1BC0-4C7D-A0A4-6F42A08684E4" class="sect4"><span class="enumeration_section">7.1.8.4</span> Invalid Table Name in Schema File</h4>
<div>
<div class="section">
<p>The target table name specified in Replicat mapping must be same as name in the Avro schema definition file.</p>
<p>For example, consider the following scenario:</p>
<p><span class="bold">Mapping</span>:</p>
<pre dir="ltr">
MAP GG.TCUSTMER, TARGET GG_AVRO.TCUSTMER_AVRO, COLMAP(USEDEFAULTS, cust_code2 = cust_code, CITY2 = CITY);
 
Avro Schema Definition:
 
{
"namespace": "GG_AVRO",
"name": "TCUSTMER_AVRO",
..
}
</pre>
<p>In this scenario, <code>REPLICAT</code> abends with following exception if the target table name specified in Replicat mapping does not match with Avro schema name.</p>
<pre dir="ltr">
Unable to retrieve table matadata. Table : GG_AVRO.TCUSTMER_AVRO
Mapped table name (TCUSTMER_AVRO) does not match with the schema table name {table name}
</pre></div>
<!-- class="section" --></div>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment135">
<tr>
<td class="cellalignment142">
<table class="cellalignment140">
<tr>
<td class="cellalignment139"><a href="GUID-F0FA2781-0802-4530-B1F0-5E102B982EC0.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment139"><a href="GUID-B68DF414-3FE0-4C0D-B13B-BC9A024DABD5.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2015, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment144">
<table class="cellalignment138">
<tr>
<td class="cellalignment139"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment139"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
